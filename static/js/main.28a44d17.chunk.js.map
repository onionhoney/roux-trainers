{"version":3,"sources":["lib/Hooks.tsx","worker/index.ts","lib/Defs.tsx","lib/Math.ts","lib/three/OrbitControls.js","components/CubeSim.tsx","lib/CubeLib.tsx","components/SelectorViews.tsx","components/Input.tsx","components/CaseVisualizer.tsx","components/Dialog.tsx","theme.js","components/CaseSelectView.tsx","lib/Algs.tsx","components/CubeSim2D.tsx","components/CmllTrainerView.tsx","components/ScrambleInputView.tsx","components/Tooltip.tsx","components/BlockTrainerView.tsx","components/PanoramaView.tsx","lib/Pruner.tsx","lib/min2phase/min2phase-wrapper.ts","lib/Solver.tsx","lib/CachedSolver.tsx","components/FavListView.tsx","components/TopBarView.tsx","lib/Evaluator.tsx","lib/Analyzer.ts","components/AnalyzerView.tsx","components/AppView.tsx","Version.tsx","lib/Selector.tsx","Config.tsx","lib/LocalStorage.tsx","reducers/AbstractStateM.tsx","reducers/BlockTrainerStateM.tsx","reducers/SsStateM.tsx","reducers/LSETrainerStateM.tsx","reducers/CmllStateM.tsx","reducers/StateFactory.tsx","KeyMapping.tsx","reducers/InitialState.tsx","reducers/Reducer.tsx","app/App.tsx","serviceWorker.js","index.tsx","lib/min2phase/min2phase.js"],"names":["useAnalyzer","analyzerState","data","setData","useState","isRunning","solutions","undefined","workerApi","workerApiAndCleanup","useMemo","worker","Worker","name","type","wrap","cleanup","releaseProxy","terminate","makeWorkerApiAndCleanup","useEffect","useWorker","scramble","analyze","then","module","exports","Face","U","D","F","B","L","R","Typ","C","E","T","corners_coord","edges_coord","centers_coord","cstimer_corners_coord","cstimer_edges_coord","u","cpc","coc","epc","eoc","tpc","f","r","l","d","b","m","e","s","u_face","f_face","FBpairPosBackFS","FBpairPosFrontFS","color_map","rand_int","Math","floor","random","rand_incl","rand_choice","arr","length","cartesianProduct","_len","arguments","allEntries","Array","_key","reduce","results","entries","map","result","entry","concat","subResults","getParity","perm","visited","fill","follow","i","cnt","res","x","arrayEqual","arr1","arr2","OrbitControls","object","domElement","console","warn","document","error","this","enabled","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","MOUSE","ROTATE","MIDDLE","DOLLY","PAN","touches","ONE","TOUCH","TWO","DOLLY_PAN","target0","clone","position0","position","zoom0","zoom","_domElementKeyEvents","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","listenToKeyEvents","addEventListener","onKeyDown","saveState","scope","copy","reset","updateProjectionMatrix","dispatchEvent","changeEvent","update","state","STATE","NONE","offset","quat","Quaternion","setFromUnitVectors","up","quatInverse","invert","lastPosition","lastQuaternion","twoPI","sub","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","min","max","isFinite","makeSafe","radius","scale","addScaledVector","panOffset","add","setFromSpherical","lookAt","multiplyScalar","set","zoomChanged","distanceToSquared","EPS","dot","quaternion","dispose","removeEventListener","onContextMenu","onPointerDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","ownerDocument","onPointerMove","onPointerUp","startEvent","endEvent","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","isOrthographicCamera","right","left","clientWidth","top","bottom","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","event","clientX","clientY","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","y","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchMoveRotate","subVectors","handleTouchMovePan","handleTouchMoveDolly","pointerType","mouseAction","preventDefault","focus","window","button","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","onMouseDown","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","onMouseMove","onMouseUp","stopPropagation","handleMouseWheel","needsUpdate","keyCode","handleKeyDown","handleTouchStartDollyPan","DOLLY_ROTATE","handleTouchStartDollyRotate","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","prototype","Object","create","EventDispatcher","constructor","MapControls","call","THREE","TAU","axesInfo","CameraState","roundedFace","rounded","cornerRadius","geo","cornerVertices","cornerCenter","squareCorner","degree","push","cos","sin","vertices","applyAxisAngle","faces","i1","setFromPoints","redraw_cube","cube","config","width","height","colorScheme","mode","theme","enableControl","hintDistance","bgColor","facesToReveal","scene","camera","renderer","antialias","setSize","setClearColor","setPixelRatio","devicePixelRatio","controls","angleScale","cameraState","HOME","cameraPositionRaw","cameraUp","cstate","cameraPosUFR","cameraPosUFL","cameraPosDFL","cameraPosDFR","cameraPosUBR","cameraPosUBL","upVecLookingDownUB","upVecLookingDownUBL","upVecDefault","PEEK_DFL","PEEK_DFR","PEEK_UFL","PEEK_UBL","getCameraPosFromState","cameraPosition","stickers_tmpl","stickerwrap_tmpl","aspect","geos","geo_border","materials_border","color","side","mesh","setRotationFromEuler","sticker_scale","hint_scale","rounded_patterns","drawCube","materials","_","mat","alphaTest","pattern","flat","hint_mesh","chroma","hex","cubie","rot","makeRotationFromEuler","rot1","setRotationFromMatrix","multiply","z","idx","sticker","stickerwrap","eps","indexOf","stickerhint","cubeG","render","frameID","animate","requestAnimationFrame","updateCubeAndColor","remove","clear","getRenderer","cleanupFunc","forEach","g","cancelAnimationFrame","renderControls","config_cache","painter","func","_painter","_painter2","_painter3","CubeSim","props","mount","React","useRef","setCameraState","cubePainter","useMediaQuery","useTheme","breakpoints","dom","downHandler","suppressLogging","key","PEEK_UBR","upHandler","current","appendChild","removeChild","_jsx","ref","style","zIndex","CubieCube","deserialize","obj","JSON","parse","serialize","cp","co","ep","eo","tp","stringify","Id","value","_apply_partial","o","p","oc","pc","mod","o_new","p_new","src","dst","_apply_partial_perm","apply_one","move","static","join","ori","Function","generate_apply_partial_func","generate_apply_partial_func_perm","apply","isArray","MoveSeq","moves","fs","last_face","first_face","_to_facelet_mapping","facelet_mapping","pos","piece","j","_rotate_coord","_from_facelet_mapping","fm","custom_corners_coord","custom_edges_coord","custom_centers_coord","match_pos_piece","coord","parity","expected","Map","toString","has","_backward_rotate_coord","get","coord_pair","newOri","newpos","newPerm","to_cstimer_cube","is_solveable","perm_correct","ori_correct","changeBasis","transformed_mapping","mapping","face_mapping","fromEntries","_ref","face_pos","face_target","_face_mapping$f","_face_mapping$f2","Move","arg","from_moves","from_cube","get_change","acc_p","acc_o","inv","slice","all","generate_base_moves","make_rot_set","us","rs","ls","ds","bs","ms","es","ss","rws","lws","uws","fws","xs","ys","zs","moves_dict","toQuarter","nm","k","quarterMap","move1","move2","getCnt","getStr","remove_setup","rotset","Set","shift","parse_line","str","tokens","token","comment_idx","search","ch","ord","charCodeAt","split","collapse","newMoves","nextMove","pop","combined","_combine","reverse","n","auf_moves","auf_move","useMetric","FaceletCube","mult_move","face","face_new","work","typ","mod_for_typ","p1","p2","p_curr","o_curr","typ_curr","color_of_c","o1","o2","color_of_e","color_of_t","color_of_sticker","Error","d_face","l_face","r_face","b_face","from_cubie","mask","facelet","from_cubie_partial_masked","_ref2","X","from_cubie_partial","to_unfolded_cube_str","faceletCube","face_count","str_face_map","color_cube","face_char","hasOwnProperty","count","as_actrm","fcube","uu_only","nmcll_faces","u_or_nmcll_faces","stickers","includes","fidx","as_kata","log","shape_maps","found","match_count","alert","lse_mask","CubeUtil","ext","a","c","find_pairs","edge_stickers","filter","corner_stickers","ep_stickers","cp_stickers","epcp_pairs","efs","cfs","match","get_color","connected_pairs","u_premove","m2_premove","oris","get_random_with_mask","_ref4","cp_rand","ep_rand","par","random_ori","ori_mask","sum","random_perm","perm_mask","undecided","tmp","rand_shuffle","is_cmll_solved","is_mask_solved2","_ref3","premove","cube1","solved","is_solved","co_","eo_","tp_","every","get_random_lse","is_cube_solved","id","rebase_to_edge","cube_rebased","ColorScheme","save","localStorage","setItem","load","item","getItem","_setDefault","suppressLoad","super","colors","toUserInput","newScheme","setWithDefault","default_colors","getColorsForOri","valid_schemes_map","valid_schemes","Mask","fs_back_mask","fs_front_mask","fbdr_mask","fb_mask","f2b_mask","sb_mask","cmll_mask","ss_front_mask","ss_back_mask","ssdp_front_mask","ssdp_back_mask","ssdp_both_mask","empty_mask","dl_solved_mask","bl_solved_mask","solved_mask","zhouheng_mask","lse_4c_mask","useStyles","makeStyles","container","paddingTop","spacing","paddingBottom","backgroundColor","palette","background","default","paper","padding","display","overflow","flexDirection","canvasPaper","infoColumn","scrambleColumn","paddingLeft","textColumn","minHeight","fixedHeight","title","flexGrow","select","text","primary","selectLabel","secondary","LevelSlider","styled","Slider","fontSize","SliderView","slider","classes","label","marks","suffix","extend_l","extend_r","_jsxs","Box","children","FormLabel","component","className","paddingX","track","onChange","handleChange","newValue","onFocus","evt","blur","SliderSelect","sliderName","sliderOpt","dispatch","content","SingleSelect","sel","radioValue","names","flags","FormControl","RadioGroup","new_flags","setFlags","row","FormControlLabel","control","Radio","labelPlacement","MultiSelectContent","options","checked","manipChecked","setManipChecked","manipulator_row","manipulators","FormGroup","manip","enableIdx","Checkbox","fillValue","makeManipulator","Fragment","makeBox","MultiSelect","open","setOpen","handleClose","noDialog","Button","variant","borderWidth","onClick","handleClickOpen","SettingsIcon","marginLeft","marginRight","Dialog","disableEscapeKeyDown","onClose","DialogTitle","DialogContent","DialogActions","ColorSetter","setText","TextField","helperText","fullWidth","size","handleClick","ColorPanel","reason","Divider","CaseVisualizer","args","view","algorithm","alg","cubeOptions","SRVisualizer","innerHTML","defaultOptions","components","MuiSlider","styleOverrides","root","createTheme","adaptV4Theme","main","red","A400","disabled","themeDark","overrides","MuiDivider","caseBoxOn","groupBox","makeDialog","Component","CaseSelectDialog","selector","groups","algs","visualizeMask","settings","algGroups","prefix","splitAlgIntoGroups","handleSelectGroup","groupname","newFlags","handleSelectAll","gt_sm","marginBottom","ButtonGroup","startIcon","CheckCircleIcon","CancelIcon","Typography","gutterBottom","toUpperCase","substr","alignItems","flexWrap","border","borderColor","caseIdx","transition","maxWidth","createAlg","kind","setup","empty_alg","cmll_algs_raw","ollcp_algs_raw","nmcll_to_cmll_mapping","cmll_algs_raw_lookup","nmcll_algs","group_name","cases","cmll_name","nmcll_display_parity","cmll_algs","trigger_algs","u_auf_algs","ori_algs","lookup_algset","alg_generator_from_group","algSet","lookup","getActiveNames","next","alg_generator_from_cases_exact","activeNames","activeNamesSet","CubeSim2D","canvasRef","canvas","ratio","ctx","clearRect","uSize","uStickerSize","uStrokeWidth","sideStrokeWidth","lineWidth","resetTransform","translate","sStickerHeight","sStickerOuterShift","sStickerInnerShift","drawSideSticker","rotate","beginPath","topLeftX","topRightX","topY","bottomLeftX","bottomRightX","moveTo","lineTo","closePath","fillStyle","stroke","restore","drawUSticker","fillRect","strokeStyle","strokeRect","draw","getContext","fontWeight","borderBottom","prompt","cmll_name_to_alg","nmcll_display_algs","NMCLLSelect","CmllTrainerView","clsx","_getMask","cmllCubeMaskSelector","getActiveName","use3D","cmll2D3DSelector","kataMode","cmllKataSelector","hyperori","hyperOriSelector","panel","setReveal","reveal","keyMapping","handle","case","desc","moves_c","colorSchemeColors","Grid","Paper","margin","elevation","lineHeight","whiteSpace","sm","md","handleNext","OllcpTrainerView","setupEdit","down","ScrambleInputView","editing","setEditing","setValue","scrambles","textField","onKeyPress","toggleEdit","_Fragment","EditIcon","marginTop","onKeyUp","inputRef","multiline","maxRows","rows","InputProps","autoFocus","handleInvert","inverted","handleSubmit","trim","CustomTooltip","Tooltip","popper","tooltipClasses","tooltip","borderRadius","condGap","fgap","flexShrink","flexBasis","minWidth","sourceIcon","sourceIconWrap","fab","ConfigPanelGroup","DRManip","select1","select2","select3","select4","select5","LPEdgeManip","pos1","pos3","BlockTrainerView","fsSelector","startsWith","fbssSsSelector","ssSelector","dpair","ssPairOnlySelector","getMask","spaceButtonText","showMoveCountHint","moveCountHint","algText","minMove","describe_hide","get_algs","describe_reveal","setFav","favSelected","canvas_wh","ADD_STR","levelSelectionSuccess","levelSuccess","scramblePanel","scrambleInput","handleFav","case_","solver","action","FavoriteIcon","alignSelf","justifyContent","showCube","handleSpace","sx","IconButton","ErrorOutlineIcon","fontFamily","textAlign","gridList","VisualCube","stage","sch","template","alt","PanoramaTable","ImageList","ImageListItem","cols","PanoramaView","PrunerPiece","globalThis","$RefreshReg$","$RefreshSig$","S","I","htm_rwm","rrwmu","rrwmu_m_first","rrwmu_f","rrwmu_b","htm_rwm_uw","htm_rwm_fws","xyz","fbdrPrunerConfigGen","max_depth","encode","c1","c2","enc_c","e1","e2","e3","e4","solved_states","moveset","fbdrPrunerConfig","fbAtBLPrunerConfig","esize","csize","enc_e","t1","fbAtBLPrunerConfigGen","fbAtDLPrunerConfig","fbAtDLPrunerConfigGen","fbPrunerConfig","sbPrunerConfig","lpSbSbPrunerConfigGen","lp_front","lpSbDiagPrunerConfigGen","fbssPrunerConfigs","fbssPrunerConfigsManual","is_front","c3","lsePrunerConfig","edge_encode","enc","edge_enc","eodmPrunerConfig","edge_idx","centerPrunerConfig","solve","min2phaseSolve","toMin2Phase","Solver","MAX_STATE_COUNT","accum","min_depth","SState","pruners","state_count","prune_count","solve_depth","min_depth_","max_depth_","accum_","nextMoves","depth","solution","STOP","CONTINUE","capacity","flag","sol","try_push","query","availableMoves","seen_encodings","pruneSeenEncodings","BigInt","new_cube","_seen_encodings","st","expand","getAvailableMove","base","generateNextMoveTable","depth_l","depth_r","getPruners","solverFactory","prunerConfig","pruner","CachedPruner","init","solverFactory2","prunerConfigs","SsSolver","ssPrunerConfig","SsDpSolver","v0","v1","ssDpPrunerConfig","FbssSolver","LpsbSolver","FsSolver","v2","fsPrunerConfig","FsPseudoSolver","fsPseudoPrunerConfig","FELineP1Solver","fELineP1PrunerConfig","FsDrSolver","v3","fsDrPrunerConfig","EOLRSolver","center_flag","barbie_mode","moves_ac","moves_mc","barb_moves","eolrPrunerConfig","all_solvers","cache","pcs","dist","moveset_str","initialized","level_states","Uint8Array","frontier","total_expanded","new_frontier","newState","rev_lookup_depth","equal","cube2","Pruner","CachedSolver","min2phase_init","assert","transformed_cube","min2phase_solve","table","FavListView","favList","dialogID","setDialogID","dialogDelete","handleRemove","addDialogOpen","setAddDialogOpen","addString","setAddString","handleAddClose","dialogAdd","DialogContentText","handleAddSuccess","status","allSolvers","line","parseAddString","Table","TableHead","TableRow","TableCell","align","rowSpan","handleAdd","edge","AddIcon","TableBody","play","PlaylistPlayIcon","DeleteOutlineIcon","is_bright","page","icon","bar","TopBarView","DPGrip","toggleFav","toggleBright","handleInfoOpen","value_str","tab_modes","is_sm","boxShadow","Toolbar","wordWrap","Select","tab_idx","findIndex","MenuItem","mx","BookmarkIcon","Brightness6Icon","InfoIcon","Evaluator","SeqEvaluator","evaluate","moveCost","moveCost_gen","TwoGramEvaluator","moves_input","score","two_gram","curr_score","Number","parseFloat","meter","isNaN","two_gram_meter","DPEvaluator","HI","R_AWAY","R2_AWAY","Rp_AWAY","DEAD_END","evaluate_with_plan","cost","len","DP","DP_path","regripCost","moveTransition","prev_grip","shifted_grip","cur_scheme","cur_grip","optimal_cost","optimal_ending_grip","grip","current_grip","optimal_plan","previous_grip","previous_shifted_grip","grip_str","current_segment","g1","g2","moveTransition_gen","regripCost_gen","initialState","post_scramble","full_solution","orientation","pre_orientation","num_solution","fb_stage","show_mode","hide_solutions","paper2","title1","configItem","paddingRight","stageText","textTransform","formControl","menu","textOverflow","resetState","postScramble","ScrambleView","setState","isSmallScreen","inputProps","gap","handleGen","handleBegin","ConfigView","menuProps","PaperProps","selectSx","fb_ori_str","display_mode_str","rowGap","InputLabel","labelId","MenuProps","FormHelperText","parseInt","memoize","fn","String","get_shortened_rotation","rotation","rotation_inv","colorMap","ColorPair","get_orientation_fb_colors","dl_d","dl_l","color_lookup","StageSolutionView","fb_tag","tags","getTags","Boolean","isShortest","shortestLength","shortened_rotation","t","Chip","StageSolutionListView","num_to_display","isRevealed","setIsRevealed","shortestSolution","shortest","shortest_length","shortest_solutions","tag_full_name","shortest_tag_names","tag","fb_name","acc","curr","shortest_tag_names_str","fb_names","colorPairs","color1","color2","mb","cursor","mt","AnalyzerView","appState","cubieCube","analyzerData","solutions_to_display","num_solutions_to_display","sort","gt_md","configPanel","TabPanel","index","other","role","hidden","_getInitialHashLocation","default_idx","location","hash","Intro","Markdown","AppView","useCallback","handleInfoClose","showFav","dividers","theme_flag","paddingY","Container","elements","el","version","Selector","annotation","ans","initialFavList","cmll_alg_names","ollcp_alg_names","EOLRMode","initialLevels","fbdrLevelSelector","fbssLevelSelector","fsLevelSelector","fbLevelSelector","ssLevelSelector","initialConfig","arr_ori_flag","evaluator","cmllSelector","nmcllSelector","cmllCaseSelector","cmllAufSelector","triggerSelector","ollcpCaseSelector","orientationSelector","fbBasisSelector","fbdrSelector","fbdrScrambleSelector","fbOnlySelector","fbPairSolvedSelector","fbdrPosSelector1","fbdrPosSelector2","fbdrPosSelector3","ssEOSelector","ssPosSelector","solutionNumSelector","fbPieceSolvedSelector","fbssLpSelector","lseMCSelector","lseBarSelector","lseStageSelector","lseEOSelector","lseEOLRMCSelector","lseBarbieSelector","lseEOLRScrambleSelector","favListManager","getFavList","setFavList","item1","serializeConfig","deserializeConfig","configManager","versionKey","getConfig","vers","item2","setConfig","partial","newConfig","assign","resetConfig","AbstractStateM","onReplay","StateFactory","BlockTrainerStateM","getLevelSelector","checkLevelConstraint","levelConstraintOkayWithUpperBound","getRandom","levelMaxAttempt","solvers","ssolver","getRandomAnyLevel","premoves","bound","pm","level","solverR","debug","failed","solverL","scrambleMargin","scrambleCount","algDescWithMoveCount","expansionFactor","orientations","_solve_with_solvers","solverNames","totalSolutionCap","selectedSolutionCap","solverName","pre","_solve","algDescs","updateSolutionOnly","scrambleSolver","_rand_choice","solutionLength","algDesc","_updateCase","inputScramble","_updateCap","onControl","onMove","movestr","onConfig","conf","FbdrStateM","edgePositionMap","allowed_pedge","allowed_dr","_get_pair_solved_front","_get_pair_solved_back","_edge_piece_in_pattern","dr_ep","dr_eo","find","_get_random_fs_back","_get_random_fs_front","fbOnly","pairSolved","active","_ref5","FbStateM","_find_center_connected_edges","is_l_only","centers","_get_random","basis","hard_str","g_hard_str","pairs","cc_edges","FsStateM","FsDrStateM","FbssStateM","lp_option","ss_option","lp_is_front","randomMask","SsStateM","_get_random_fb","allowed_dr_eo_ep","ep_","drOPPositionMap","allowed_dr_eo_ep_patterns","LSEStateM","bars","lse_premove","lseEODef","lseEODefLookup","def","EOLRStateM","_getEOType","eo_arr","targetEO","eolrMCMode","compare","useBarbie","eodmMode","useFullScramble","acSolver","mcSolver","acLength","mcLength","CmllStateM","_get2PhaseSolution","m2_away","_generateCase","isHyperOri","isHyperOriFB","lse_cube","generator","alg_generator_from_cases_contain","some","alg_generator_from_cases","trig_generator","u_auf_generator","ori_generator","trigger_alg","cmll_alg","u_auf_alg","post_auf_alg","alg_str","history","CmllSolvingStateM","CmllSolvedStateM","defaultKeyMapping","lseKeyMapping","DefaultKeyMapping","altKey","LSEKeyMapping","getInitialState","initialStateName","prev","reducer","code","stateM","reduceByKey","reduceByConfig","ReactGA","pageview","rem","reduceByFavlist","body","App","useReducer","appTheme","StyledEngineProvider","injectFirst","ThemeProvider","CssBaseline","hostname","initialize","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister","createArray","bitCount","get8Parity","get12Parity","binarySearch","mid","val","fact","perm3","ud2std","std2ud","Cnk","length1","length2","createArrays","move2str","urfMove","ckmv","ckmv2","getFlip","getFlipSym","FlipR2S","EdgeConjugate","SymInv","temps","FlipS2R","setFlip","bitOdd","getTwist","getTwistSym","TwistR2S","CornConjugate","TwistS2R","setTwist","twst","getUDSlice","setUDSlice","getMPerm","setMPerm","getMid3","idxA","idxB","setMid3","getURtoUL","getDRtoDL","setEdgePerm","getEdgePerm","getCPermSym","EPermR2S","get8Perm","e2c","CPermS2R","getEPermSym","EPermS2R","URFConjugate","CornMult","urf2","urf1","EdgeMult","invCubieCube","corn","cperm","twist","eperm","flip","set8Perm","cctemp","prod","oriA","oriB","ed","CubeSym","moveCube","SymMult","SymMove","Sym8Mult","Sym8Move","Sym8MultInv","SymMoveUD","MtoEPerm","merge","UDSliceMove","TwistMove","FlipMove","UDSliceConj","UDSliceTwistPrun","UDSliceFlipPrun","TwistFlipPrun","Mid3Move","Mid32MPerm","CParity","CPermMove","EPermMove","MPermMove","MPermConj","MCPermPrun","MEPermPrun","urfidx","csym","mid3","tsym","fsym","corn0","csym0","mid30","e10","e20","prun","maxlength2","valid1","valid2","phase1","maxl","lm","cornx","ex","get4Parity","esym","phase2","sb","urf","init2","slicex","twistx","tsymx","flipx","fsymx","midx","edgex","esymx","csymx","mc","temp","f2","u4","lr2","occ","CubieInit","SymState","SymStateF","check","done","sym","symF","fsymxx","idxx","symx","CoordInit","cc","Solve","randomCube"],"mappings":"g3QAAA,kEAIO,SAASA,EAAYC,GACxB,MAAOC,EAAMC,GAAWC,mBAAS,CAC7BC,WAAW,EACXC,eAAWC,KAET,UAAEC,GAaZ,WAGI,MAAMC,EAAsBC,mBAAQ,IAcxC,WAEI,MAAMC,EAAS,IAAIC,OAAO,EAAmB,CAC3CC,KAAM,kBACNC,UAAKA,IAEDN,EAAYO,YAA+CJ,GAG3DK,EAAUA,KACdR,EAAUS,OACVN,EAAOO,aAKT,MAF4B,CAAEV,YAAWQ,WA5BCG,IAA2B,IAWrE,OATAC,qBAAU,KACR,MAAM,QAAEJ,GAAYP,EAGpB,MAAO,KACLO,OAED,CAACP,IAEGA,EA3BeY,GAStB,OAPAD,qBAAU,KACNjB,EAAQ,CAAEE,WAAW,EAAMC,eAAWC,IACP,KAA3BN,EAAcqB,UACdd,EAAUe,QAAQtB,GAAeuB,MAAKlB,GAAaH,EAAQ,CAAEE,WAAW,EAAOC,kBAEpF,CAACE,EAAWL,EAASF,IAEjBC,K,uCClBXuB,EAAOC,QAAU,IAA0B,sD,8JCApC,IAAKC,GAEX,SAFWA,OAAI,SAAJA,IAAI,SAAJA,IAAI,SAAJA,IAAI,SAAJA,IAAI,SAAJA,IAAI,SAAJA,IAAI,SAEf,CAFWA,MAAI,KAIhB,MAAMC,EAAID,EAAKC,EACTC,EAAIF,EAAKE,EACTC,EAAIH,EAAKG,EACTC,EAAIJ,EAAKI,EACTC,EAAIL,EAAKK,EACTC,EAAIN,EAAKM,EAGR,IAAKC,GAEX,SAFWA,OAAG,SAAHA,IAAG,SAAHA,IAAG,SAEd,CAFWA,MAAG,KAGf,MAAMC,EAAID,EAAIC,EACRC,EAAIF,EAAIE,EACRC,EAAIH,EAAIG,EAcd,IAAIC,EAAqC,CACrC,CAACV,EAAEE,EAAEE,GAAI,CAACJ,EAAEI,EAAED,GAAI,CAACH,EAAEG,EAAEE,GAAI,CAACL,EAAEK,EAAEH,GAChC,CAACD,EAAEG,EAAEF,GAAI,CAACD,EAAEE,EAAEC,GAAI,CAACH,EAAEI,EAAEF,GAAI,CAACF,EAAEC,EAAEG,IAIhCM,EAAiC,CACjC,CAACX,EAAEE,GAAI,CAACF,EAAEI,GAAI,CAACJ,EAAEG,GAAI,CAACH,EAAEK,GACxB,CAACJ,EAAEC,GAAI,CAACD,EAAEG,GAAI,CAACH,EAAEE,GAAI,CAACF,EAAEI,GACxB,CAACH,EAAEE,GAAI,CAACD,EAAEC,GAAI,CAACD,EAAEE,GAAI,CAACH,EAAEG,IAGxBO,EAAqC,CACrC,CAACZ,GAAI,CAACC,GAAI,CAACC,GAAI,CAACC,GAAI,CAACC,GAAI,CAACC,IAG1BQ,EAA6C,CAC7C,CAACb,EAAEK,EAAEH,GAAG,CAACF,EAAEE,EAAEE,GAAI,CAACJ,EAAEI,EAAED,GAAI,CAACH,EAAEG,EAAEE,GAC/B,CAACJ,EAAEC,EAAEG,GAAG,CAACJ,EAAEG,EAAEF,GAAI,CAACD,EAAEE,EAAEC,GAAI,CAACH,EAAEI,EAAEF,IAG/BW,EAAyC,CACzC,CAACd,EAAGK,GAAI,CAACL,EAAEE,GAAI,CAACF,EAAEI,GAAI,CAACJ,EAAEG,GACzB,CAACF,EAAGI,GAAI,CAACJ,EAAEC,GAAI,CAACD,EAAEG,GAAI,CAACH,EAAEE,GACzB,CAACD,EAAGG,GAAI,CAACH,EAAEE,GAAI,CAACD,EAAEC,GAAI,CAACD,EAAEE,IAmBzBU,EAAY,CACZC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,GACLnC,KAAM,KAGNoC,EAAY,CACZL,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,IAAK,CAAC,GAAI,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IACpCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,GACLnC,KAAM,KAGNqC,EAAY,CACZN,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,IAAK,CAAC,GAAI,GAAI,CAAC,EAAG,IAAK,CAAC,GAAI,IACtCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,GACLnC,KAAM,KAGNsC,EAAY,CACZP,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,GACLnC,KAAM,KAGNuC,EAAY,CACZR,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,GACLnC,KAAM,KAGNwC,EAAY,CACZT,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAAK,CAAC,GAAI,IACpCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,GACLnC,KAAM,KAGNyC,EAAY,CACZV,IAAK,GACLC,IAAK,GACLC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCnC,KAAM,KAGN0C,EAAY,CACZX,IAAK,GACLC,IAAK,GACLC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,IAAK,CAAC,GAAI,IAAK,CAAC,GAAI,IACtCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCnC,KAAM,KAGN2C,EAAY,CACZZ,IAAK,GACLC,IAAK,GACLC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCC,IAAK,CAAC,EAAG,EAAG,EAAG,GACfC,IAAK,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,IAClCnC,KAAM,KASN4C,EAAoB,CACpB,CAAC,EAAG,EAAGtB,GAAI,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGD,GAC7B,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGD,GAC7B,CAAC,EAAG,EAAGD,GAAI,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGD,IAG7BuB,EAAoB,CACpB,CAAC,EAAG,EAAGvB,GAAI,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGD,GAC7B,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGC,GAAI,CAAC,GAAG,EAAGD,GAC7B,CAAC,EAAG,EAAGD,GAAI,CAAC,EAAG,EAAGC,GAAI,CAAC,EAAG,EAAGD,IAOjC,MAAMwB,EAAuD,CACzD,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAE,EAAG,EAAI,EAAG,GAExC,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACxB,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACvC,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GAEvC,CAAC,EAAG,EAAG,EAAG,GAEV,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACvC,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,IAGrCC,EAAwD,CAE1D,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACxB,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACtC,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACvC,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GAGvC,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,GACvC,CAAC,EAAG,EAAG,GAAI,GAAI,CAAC,EAAG,EAAG,EAAG,GAAI,CAAC,EAAG,EAAG,EAAG,IAS3C,IAAIC,EAAW,2F,YCjNf,IAAIC,EAAYZ,GACLa,KAAKC,MAAMD,KAAKE,SAAWf,GAGlCgB,EAAYA,CAACf,EAAWD,IACjBY,EAASZ,EAAIC,EAAI,GAAKA,EAE7BgB,EAAc,SAAYC,GAC1B,OAAOA,EAAIN,EAASM,EAAIC,UAa5B,SAASC,IAAkD,IAAD,IAAAC,EAAAC,UAAAH,OAA1BI,EAAU,IAAAC,MAAAH,GAAAI,EAAA,EAAAA,EAAAJ,EAAAI,IAAVF,EAAUE,GAAAH,UAAAG,GACtC,OAAOF,EAAWG,QAChB,CAACC,EAASC,IACRD,EACGE,KAAIC,GAAUF,EAAQC,KAAIE,GAASD,EAAOE,OAAO,CAACD,QAClDL,QAAO,CAACO,EAAYH,IAAWG,EAAWD,OAAOF,IAAS,KAC/D,CAAC,KAIP,IAAII,EAAaC,IACb,IAAIC,EAAUZ,MAAMW,EAAKhB,QAAQkB,MAAK,GAClCC,EAASA,CAACC,EAAWC,IACjBJ,EAAQG,GACD,GAEPH,EAAQG,GAAK,EACTH,EAAQD,EAAKI,IACNC,EAEAF,EAAOH,EAAKI,GAAIC,EAAM,IAGrCC,EAAM,EACV,IAAK,IAAIC,KAAKP,EACVM,GAAOH,EAAOI,EAAG,GAErB,OAAOD,GAGPE,EAAa,SAAYC,EAAWC,GACpC,GAAID,EAAKzB,SAAW0B,EAAK1B,OAAQ,OAAO,EACxC,IAAK,IAAIoB,EAAI,EAAGA,EAAIK,EAAKzB,OAAQoB,IAC7B,GAAIK,EAAKL,KAAOM,EAAKN,GAAI,OAAO,EAEpC,OAAO,G,+BCvCPO,GAAgB,SAAWC,EAAQC,QAElB3F,IAAf2F,GAA2BC,QAAQC,KAAM,4EACzCF,IAAeG,UAAWF,QAAQG,MAAO,4HAE9CC,KAAKN,OAASA,EACdM,KAAKL,WAAaA,EAGlBK,KAAKC,SAAU,EAGfD,KAAKE,OAAS,IAAIC,UAGlBH,KAAKI,YAAc,EACnBJ,KAAKK,YAAcC,IAGnBN,KAAKO,QAAU,EACfP,KAAKQ,QAAUF,IAIfN,KAAKS,cAAgB,EACrBT,KAAKU,cAAgBlD,KAAKmD,GAI1BX,KAAKY,iBAAoBN,IACzBN,KAAKa,gBAAkBP,IAIvBN,KAAKc,eAAgB,EACrBd,KAAKe,cAAgB,IAIrBf,KAAKgB,YAAa,EAClBhB,KAAKiB,UAAY,EAGjBjB,KAAKkB,cAAe,EACpBlB,KAAKmB,YAAc,EAGnBnB,KAAKoB,WAAY,EACjBpB,KAAKqB,SAAW,EAChBrB,KAAKsB,oBAAqB,EAC1BtB,KAAKuB,YAAc,EAInBvB,KAAKwB,YAAa,EAClBxB,KAAKyB,gBAAkB,EAGvBzB,KAAK0B,KAAO,CAAEC,KAAM,GAAIC,GAAI,GAAIC,MAAO,GAAIC,OAAQ,IAGnD9B,KAAK+B,aAAe,CAAEJ,KAAMK,QAAMC,OAAQC,OAAQF,QAAMG,MAAON,MAAOG,QAAMI,KAG5EpC,KAAKqC,QAAU,CAAEC,IAAKC,QAAMN,OAAQO,IAAKD,QAAME,WAG/CzC,KAAK0C,QAAU1C,KAAKE,OAAOyC,QAC3B3C,KAAK4C,UAAY5C,KAAKN,OAAOmD,SAASF,QACtC3C,KAAK8C,MAAQ9C,KAAKN,OAAOqD,KAGzB/C,KAAKgD,qBAAuB,KAM5BhD,KAAKiD,cAAgB,WAEpB,OAAOC,EAAUC,KAIlBnD,KAAKoD,kBAAoB,WAExB,OAAOF,EAAUG,OAIlBrD,KAAKsD,kBAAoB,SAAW3D,GAEnCA,EAAW4D,iBAAkB,UAAWC,GACxCxD,KAAKgD,qBAAuBrD,GAI7BK,KAAKyD,UAAY,WAEhBC,EAAMhB,QAAQiB,KAAMD,EAAMxD,QAC1BwD,EAAMd,UAAUe,KAAMD,EAAMhE,OAAOmD,UACnCa,EAAMZ,MAAQY,EAAMhE,OAAOqD,MAI5B/C,KAAK4D,MAAQ,WAEZF,EAAMxD,OAAOyD,KAAMD,EAAMhB,SACzBgB,EAAMhE,OAAOmD,SAASc,KAAMD,EAAMd,WAClCc,EAAMhE,OAAOqD,KAAOW,EAAMZ,MAE1BY,EAAMhE,OAAOmE,yBACbH,EAAMI,cAAeC,GAErBL,EAAMM,SAENC,EAAQC,EAAMC,MAKfnE,KAAKgE,OAAS,WAEb,IAAII,EAAS,IAAIjE,UAGbkE,GAAO,IAAIC,cAAaC,mBAAoB7E,EAAO8E,GAAI,IAAIrE,UAAS,EAAG,EAAG,IAC1EsE,EAAcJ,EAAK1B,QAAQ+B,SAE3BC,EAAe,IAAIxE,UACnByE,EAAiB,IAAIN,aAErBO,EAAQ,EAAIrH,KAAKmD,GAErB,OAAO,WAEN,IAAIkC,EAAWa,EAAMhE,OAAOmD,SAE5BuB,EAAOT,KAAMd,GAAWiC,IAAKpB,EAAMxD,QAGnCkE,EAAOW,gBAAiBV,GAGxBnB,EAAU8B,eAAgBZ,GAErBV,EAAMlC,YAAcyC,IAAUC,EAAMC,MAExCc,EA0LK,EAAIzH,KAAKmD,GAAK,GAAK,GAAK+C,EAAMjC,iBAtL/BiC,EAAM5C,eAEVoC,EAAUG,OAAS6B,EAAe7B,MAAQK,EAAM3C,cAChDmC,EAAUC,KAAO+B,EAAe/B,IAAMO,EAAM3C,gBAI5CmC,EAAUG,OAAS6B,EAAe7B,MAClCH,EAAUC,KAAO+B,EAAe/B,KAMjC,IAAIgC,EAAMzB,EAAM9C,gBACZwE,EAAM1B,EAAM7C,gBA2EhB,OAzEKwE,SAAUF,IAASE,SAAUD,KAE5BD,GAAQ3H,KAAKmD,GAAKwE,GAAON,EAAiBM,EAAM3H,KAAKmD,KAAKwE,GAAON,GAEjEO,GAAQ5H,KAAKmD,GAAKyE,GAAOP,EAAiBO,EAAM5H,KAAKmD,KAAKyE,GAAOP,GAIrE3B,EAAUG,MAFN8B,GAAOC,EAEO5H,KAAK4H,IAAKD,EAAK3H,KAAK2H,IAAKC,EAAKlC,EAAUG,QAItCH,EAAUG,OAAU8B,EAAMC,GAAQ,EACrD5H,KAAK4H,IAAKD,EAAKjC,EAAUG,OACzB7F,KAAK2H,IAAKC,EAAKlC,EAAUG,QAO5BH,EAAUC,IAAM3F,KAAK4H,IAAK1B,EAAMjD,cAAejD,KAAK2H,IAAKzB,EAAMhD,cAAewC,EAAUC,MAExFD,EAAUoC,WAGVpC,EAAUqC,QAAUC,EAGpBtC,EAAUqC,OAAS/H,KAAK4H,IAAK1B,EAAMtD,YAAa5C,KAAK2H,IAAKzB,EAAMrD,YAAa6C,EAAUqC,UAI1D,IAAxB7B,EAAM5C,cAEV4C,EAAMxD,OAAOuF,gBAAiBC,EAAWhC,EAAM3C,eAI/C2C,EAAMxD,OAAOyF,IAAKD,GAInBtB,EAAOwB,iBAAkB1C,GAGzBkB,EAAOW,gBAAiBN,GAExB5B,EAASc,KAAMD,EAAMxD,QAASyF,IAAKvB,GAEnCV,EAAMhE,OAAOmG,OAAQnC,EAAMxD,SAEE,IAAxBwD,EAAM5C,eAEVoE,EAAe7B,OAAW,EAAIK,EAAM3C,cACpCmE,EAAe/B,KAAS,EAAIO,EAAM3C,cAElC2E,EAAUI,eAAgB,EAAIpC,EAAM3C,iBAIpCmE,EAAea,IAAK,EAAG,EAAG,GAE1BL,EAAUK,IAAK,EAAG,EAAG,IAItBP,EAAQ,KAMHQ,GACJrB,EAAasB,kBAAmBvC,EAAMhE,OAAOmD,UAAaqD,GAC1D,GAAM,EAAItB,EAAeuB,IAAKzC,EAAMhE,OAAO0G,aAAiBF,KAE5DxC,EAAMI,cAAeC,GAErBY,EAAahB,KAAMD,EAAMhE,OAAOmD,UAChC+B,EAAejB,KAAMD,EAAMhE,OAAO0G,YAClCJ,GAAc,GAEP,IAnII,GA6IdhG,KAAKqG,QAAU,WAEd3C,EAAM/D,WAAW2G,oBAAqB,cAAeC,GAErD7C,EAAM/D,WAAW2G,oBAAqB,cAAeE,GACrD9C,EAAM/D,WAAW2G,oBAAqB,QAASG,GAE/C/C,EAAM/D,WAAW2G,oBAAqB,aAAcI,GACpDhD,EAAM/D,WAAW2G,oBAAqB,WAAYK,GAClDjD,EAAM/D,WAAW2G,oBAAqB,YAAaM,GAEnDlD,EAAM/D,WAAWkH,cAAcP,oBAAqB,cAAeQ,GACnEpD,EAAM/D,WAAWkH,cAAcP,oBAAqB,YAAaS,GAG7B,OAA/BrD,EAAMV,sBAEVU,EAAMV,qBAAqBsD,oBAAqB,UAAW9C,IAY7D,IAAIE,EAAQ1D,KAER+D,EAAc,CAAExJ,KAAM,UACtByM,EAAa,CAAEzM,KAAM,SACrB0M,EAAW,CAAE1M,KAAM,OAEnB2J,EAAQ,CACXC,MAAQ,EACRlC,OAAQ,EACRE,MAAO,EACPC,IAAK,EACL8E,aAAc,EACdC,UAAW,EACXC,gBAAiB,EACjBC,mBAAoB,GAGjBpD,EAAQC,EAAMC,KAEd+B,EAAM,KAGNhD,EAAY,IAAIoE,YAChBpC,EAAiB,IAAIoC,YAErB9B,EAAQ,EACRE,EAAY,IAAIvF,UAChB6F,GAAc,EAEduB,EAAc,IAAIC,UAClBC,EAAY,IAAID,UAChBE,EAAc,IAAIF,UAElBG,EAAW,IAAIH,UACfI,EAAS,IAAIJ,UACbK,EAAW,IAAIL,UAEfM,EAAa,IAAIN,UACjBO,EAAW,IAAIP,UACfQ,EAAa,IAAIR,UAQrB,SAASS,IAER,OAAOzK,KAAK0K,IAAK,IAAMxE,EAAMzC,WAI9B,SAASgE,EAAYkD,GAEpBjD,EAAe7B,OAAS8E,EAIzB,SAASC,EAAUD,GAElBjD,EAAe/B,KAAOgF,EAIvB,IAAIE,EAAU,WAEb,IAAIC,EAAI,IAAInI,UAEZ,OAAO,SAAkBoI,EAAUC,GAElCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAExC,gBAAkByC,GAEpB7C,EAAUC,IAAK2C,IATH,GAeVI,EAAQ,WAEX,IAAIJ,EAAI,IAAInI,UAEZ,OAAO,SAAgBoI,EAAUC,IAEE,IAA7B9E,EAAMpC,mBAEVgH,EAAEG,oBAAqBD,EAAc,IAIrCF,EAAEG,oBAAqBD,EAAc,GACrCF,EAAEK,aAAcjF,EAAMhE,OAAO8E,GAAI8D,IAIlCA,EAAExC,eAAgByC,GAElB7C,EAAUC,IAAK2C,IAnBL,GA0BRM,EAAM,WAET,IAAIxE,EAAS,IAAIjE,UAEjB,OAAO,SAAc0I,EAAQC,GAE5B,IAAIC,EAAUrF,EAAM/D,WAEpB,GAAK+D,EAAMhE,OAAOsJ,oBAAsB,CAGvC,IAAInG,EAAWa,EAAMhE,OAAOmD,SAC5BuB,EAAOT,KAAMd,GAAWiC,IAAKpB,EAAMxD,QACnC,IAAI+I,EAAiB7E,EAAOtG,SAG5BmL,GAAkBzL,KAAK0L,IAAOxF,EAAMhE,OAAOyJ,IAAM,EAAM3L,KAAKmD,GAAK,KAGjE0H,EAAS,EAAIQ,EAASI,EAAiBF,EAAQK,aAAc1F,EAAMhE,OAAO2J,QAC1EX,EAAO,EAAII,EAASG,EAAiBF,EAAQK,aAAc1F,EAAMhE,OAAO2J,aAE7D3F,EAAMhE,OAAO4J,sBAGxBjB,EAASQ,GAAWnF,EAAMhE,OAAO6J,MAAQ7F,EAAMhE,OAAO8J,MAAS9F,EAAMhE,OAAOqD,KAAOgG,EAAQU,YAAa/F,EAAMhE,OAAO2J,QACrHX,EAAOI,GAAWpF,EAAMhE,OAAOgK,IAAMhG,EAAMhE,OAAOiK,QAAWjG,EAAMhE,OAAOqD,KAAOgG,EAAQK,aAAc1F,EAAMhE,OAAO2J,UAKpHzJ,QAAQC,KAAM,gFACd6D,EAAMtC,WAAY,IAhCX,GAwCV,SAASwI,EAAUC,GAEbnG,EAAMhE,OAAOsJ,oBAEjBxD,GAASqE,EAEEnG,EAAMhE,OAAO4J,sBAExB5F,EAAMhE,OAAOqD,KAAOvF,KAAK4H,IAAK1B,EAAMnD,QAAS/C,KAAK2H,IAAKzB,EAAMlD,QAASkD,EAAMhE,OAAOqD,KAAO8G,IAC1FnG,EAAMhE,OAAOmE,yBACbmC,GAAc,IAIdpG,QAAQC,KAAM,uFACd6D,EAAM1C,YAAa,GAMrB,SAAS8I,EAASD,GAEZnG,EAAMhE,OAAOsJ,oBAEjBxD,GAASqE,EAEEnG,EAAMhE,OAAO4J,sBAExB5F,EAAMhE,OAAOqD,KAAOvF,KAAK4H,IAAK1B,EAAMnD,QAAS/C,KAAK2H,IAAKzB,EAAMlD,QAASkD,EAAMhE,OAAOqD,KAAO8G,IAC1FnG,EAAMhE,OAAOmE,yBACbmC,GAAc,IAIdpG,QAAQC,KAAM,uFACd6D,EAAM1C,YAAa,GAUrB,SAAS+I,EAAuBC,GAE/BzC,EAAYxB,IAAKiE,EAAMC,QAASD,EAAME,SAUvC,SAASC,EAAoBH,GAE5BrC,EAAS5B,IAAKiE,EAAMC,QAASD,EAAME,SAwHpC,SAASE,EAAwBJ,GAEhC,GAA6B,GAAxBA,EAAM3H,QAAQvE,OAElByJ,EAAYxB,IAAKiE,EAAM3H,QAAS,GAAIgI,MAAOL,EAAM3H,QAAS,GAAIiI,WAExD,CAEN,IAAIjL,EAAI,IAAQ2K,EAAM3H,QAAS,GAAIgI,MAAQL,EAAM3H,QAAS,GAAIgI,OAC1DE,EAAI,IAAQP,EAAM3H,QAAS,GAAIiI,MAAQN,EAAM3H,QAAS,GAAIiI,OAE9D/C,EAAYxB,IAAK1G,EAAGkL,IAMtB,SAASC,EAAqBR,GAE7B,GAA6B,GAAxBA,EAAM3H,QAAQvE,OAElB6J,EAAS5B,IAAKiE,EAAM3H,QAAS,GAAIgI,MAAOL,EAAM3H,QAAS,GAAIiI,WAErD,CAEN,IAAIjL,EAAI,IAAQ2K,EAAM3H,QAAS,GAAIgI,MAAQL,EAAM3H,QAAS,GAAIgI,OAC1DE,EAAI,IAAQP,EAAM3H,QAAS,GAAIiI,MAAQN,EAAM3H,QAAS,GAAIiI,OAE9D3C,EAAS5B,IAAK1G,EAAGkL,IAMnB,SAASE,EAAuBT,GAE/B,IAAIU,EAAKV,EAAM3H,QAAS,GAAIgI,MAAQL,EAAM3H,QAAS,GAAIgI,MACnDM,EAAKX,EAAM3H,QAAS,GAAIiI,MAAQN,EAAM3H,QAAS,GAAIiI,MAEnD/B,EAAW/K,KAAKoN,KAAMF,EAAKA,EAAKC,EAAKA,GAEzC7C,EAAW/B,IAAK,EAAGwC,GAoBpB,SAASsC,EAAuBb,GAE/B,GAA6B,GAAxBA,EAAM3H,QAAQvE,OAElB2J,EAAU1B,IAAKiE,EAAM3H,QAAS,GAAIgI,MAAOL,EAAM3H,QAAS,GAAIiI,WAEtD,CAEN,IAAIjL,EAAI,IAAQ2K,EAAM3H,QAAS,GAAIgI,MAAQL,EAAM3H,QAAS,GAAIgI,OAC1DE,EAAI,IAAQP,EAAM3H,QAAS,GAAIiI,MAAQN,EAAM3H,QAAS,GAAIiI,OAE9D7C,EAAU1B,IAAK1G,EAAGkL,GAInB7C,EAAYoD,WAAYrD,EAAWF,GAAczB,eAAgBpC,EAAMvC,aAEvE,IAAI4H,EAAUrF,EAAM/D,WAEpBsF,EAAY,EAAIzH,KAAKmD,GAAK+G,EAAYrI,EAAI0J,EAAQK,cAElDhB,EAAU,EAAI5K,KAAKmD,GAAK+G,EAAY6C,EAAIxB,EAAQK,cAEhD7B,EAAY5D,KAAM8D,GAInB,SAASsD,EAAoBf,GAE5B,GAA6B,GAAxBA,EAAM3H,QAAQvE,OAElB8J,EAAO7B,IAAKiE,EAAM3H,QAAS,GAAIgI,MAAOL,EAAM3H,QAAS,GAAIiI,WAEnD,CAEN,IAAIjL,EAAI,IAAQ2K,EAAM3H,QAAS,GAAIgI,MAAQL,EAAM3H,QAAS,GAAIgI,OAC1DE,EAAI,IAAQP,EAAM3H,QAAS,GAAIiI,MAAQN,EAAM3H,QAAS,GAAIiI,OAE9D1C,EAAO7B,IAAK1G,EAAGkL,GAIhB1C,EAASiD,WAAYlD,EAAQD,GAAW7B,eAAgBpC,EAAMrC,UAE9DuH,EAAKf,EAASxI,EAAGwI,EAAS0C,GAE1B5C,EAAShE,KAAMiE,GAIhB,SAASoD,EAAsBhB,GAE9B,IAAIU,EAAKV,EAAM3H,QAAS,GAAIgI,MAAQL,EAAM3H,QAAS,GAAIgI,MACnDM,EAAKX,EAAM3H,QAAS,GAAIiI,MAAQN,EAAM3H,QAAS,GAAIiI,MAEnD/B,EAAW/K,KAAKoN,KAAMF,EAAKA,EAAKC,EAAKA,GAEzC5C,EAAShC,IAAK,EAAGwC,GAEjBP,EAAWjC,IAAK,EAAGvI,KAAK0K,IAAKH,EAASwC,EAAIzC,EAAWyC,EAAG7G,EAAMzC,YAE9D2I,EAAU5B,EAAWuC,GAErBzC,EAAWnE,KAAMoE,GA8BlB,SAASvB,EAAewD,GAEvB,IAAuB,IAAlBtG,EAAMzD,QAEX,OAAS+J,EAAMiB,aAEd,IAAK,QACL,IAAK,OA0CP,SAAsBjB,GAUrB,IAAIkB,EAEJ,OATAlB,EAAMmB,iBAKNzH,EAAM/D,WAAWyL,MAAQ1H,EAAM/D,WAAWyL,QAAUC,OAAOD,QAIlDpB,EAAMsB,QAEd,KAAK,EAEJJ,EAAcxH,EAAM3B,aAAaJ,KACjC,MAED,KAAK,EAEJuJ,EAAcxH,EAAM3B,aAAaG,OACjC,MAED,KAAK,EAEJgJ,EAAcxH,EAAM3B,aAAaF,MACjC,MAED,QAECqJ,GAAgB,EAIlB,OAASA,GAER,KAAKlJ,QAAMG,MAEV,IAA0B,IAArBuB,EAAM1C,WAAuB,QAlXrC,SAA+BgJ,GAE9BlC,EAAW/B,IAAKiE,EAAMC,QAASD,EAAME,SAkXnCqB,CAAsBvB,GAEtB/F,EAAQC,EAAM/B,MAEd,MAED,KAAKH,QAAMC,OAEV,GAAK+H,EAAMwB,SAAWxB,EAAMyB,SAAWzB,EAAM0B,SAAW,CAEvD,IAAyB,IAApBhI,EAAMtC,UAAsB,OAEjC+I,EAAoBH,GAEpB/F,EAAQC,EAAM9B,QAER,CAEN,IAA4B,IAAvBsB,EAAMxC,aAAyB,OAEpC6I,EAAuBC,GAEvB/F,EAAQC,EAAMjC,OAIf,MAED,KAAKD,QAAMI,IAEV,GAAK4H,EAAMwB,SAAWxB,EAAMyB,SAAWzB,EAAM0B,SAAW,CAEvD,IAA4B,IAAvBhI,EAAMxC,aAAyB,OAEpC6I,EAAuBC,GAEvB/F,EAAQC,EAAMjC,WAER,CAEN,IAAyB,IAApByB,EAAMtC,UAAsB,OAEjC+I,EAAoBH,GAEpB/F,EAAQC,EAAM9B,IAIf,MAED,QAEC6B,EAAQC,EAAMC,KAIXF,IAAUC,EAAMC,OAEpBT,EAAM/D,WAAWkH,cAActD,iBAAkB,cAAeuD,GAChEpD,EAAM/D,WAAWkH,cAActD,iBAAkB,YAAawD,GAE9DrD,EAAMI,cAAekD,IA/IpB2E,CAAa3B,IAShB,SAASlD,EAAekD,GAEvB,IAAuB,IAAlBtG,EAAMzD,QAEX,OAAS+J,EAAMiB,aAEd,IAAK,QACL,IAAK,OAqIP,SAAsBjB,GAErB,IAAuB,IAAlBtG,EAAMzD,QAAoB,OAI/B,OAFA+J,EAAMmB,iBAEGlH,GAER,KAAKC,EAAMjC,OAEV,IAA4B,IAAvByB,EAAMxC,aAAyB,QArbvC,SAAgC8I,GAE/BvC,EAAU1B,IAAKiE,EAAMC,QAASD,EAAME,SAEpCxC,EAAYoD,WAAYrD,EAAWF,GAAczB,eAAgBpC,EAAMvC,aAEvE,IAAI4H,EAAUrF,EAAM/D,WAEpBsF,EAAY,EAAIzH,KAAKmD,GAAK+G,EAAYrI,EAAI0J,EAAQK,cAElDhB,EAAU,EAAI5K,KAAKmD,GAAK+G,EAAY6C,EAAIxB,EAAQK,cAEhD7B,EAAY5D,KAAM8D,GAElB/D,EAAMM,SAyaJ4H,CAAuB5B,GAEvB,MAED,KAAK9F,EAAM/B,MAEV,IAA0B,IAArBuB,EAAM1C,WAAuB,QA3arC,SAA+BgJ,GAE9BjC,EAAShC,IAAKiE,EAAMC,QAASD,EAAME,SAEnClC,EAAW8C,WAAY/C,EAAUD,GAE5BE,EAAWuC,EAAI,EAEnBX,EAAU3B,KAECD,EAAWuC,EAAI,GAE1BT,EAAS7B,KAIVH,EAAWnE,KAAMoE,GAEjBrE,EAAMM,SA2ZJ6H,CAAsB7B,GAEtB,MAED,KAAK9F,EAAM9B,IAEV,IAAyB,IAApBsB,EAAMtC,UAAsB,QA7ZpC,SAA6B4I,GAE5BpC,EAAO7B,IAAKiE,EAAMC,QAASD,EAAME,SAEjCrC,EAASiD,WAAYlD,EAAQD,GAAW7B,eAAgBpC,EAAMrC,UAE9DuH,EAAKf,EAASxI,EAAGwI,EAAS0C,GAE1B5C,EAAShE,KAAMiE,GAEflE,EAAMM,SAqZJ8H,CAAoB9B,IAhKpB+B,CAAa/B,IAShB,SAASjD,EAAaiD,GAErB,OAASA,EAAMiB,aAEd,IAAK,QACL,IAAK,OA0JP,SAAoBjB,GAKnB,GAHAtG,EAAM/D,WAAWkH,cAAcP,oBAAqB,cAAeQ,GACnEpD,EAAM/D,WAAWkH,cAAcP,oBAAqB,YAAaS,IAE1C,IAAlBrD,EAAMzD,QAAoB,OAI/ByD,EAAMI,cAAemD,GAErBhD,EAAQC,EAAMC,KApKZ6H,IAwKH,SAASvF,EAAcuD,IAEC,IAAlBtG,EAAMzD,UAA0C,IAArByD,EAAM1C,YAA0BiD,IAAUC,EAAMC,MAAQF,IAAUC,EAAMjC,SAExG+H,EAAMmB,iBACNnB,EAAMiC,kBAENvI,EAAMI,cAAekD,GAzatB,SAA2BgD,GAErBA,EAAMlB,OAAS,EAEnBgB,EAAS7B,KAEE+B,EAAMlB,OAAS,GAE1Bc,EAAU3B,KAIXvE,EAAMM,SA+ZNkI,CAAkBlC,GAElBtG,EAAMI,cAAemD,IAItB,SAASzD,EAAWwG,IAEI,IAAlBtG,EAAMzD,UAAyC,IAApByD,EAAMtC,WAnavC,SAAwB4I,GAEvB,IAAImC,GAAc,EAElB,OAASnC,EAAMoC,SAEd,KAAK1I,EAAMhC,KAAKE,GACfgH,EAAK,EAAGlF,EAAMnC,aACd4K,GAAc,EACd,MAED,KAAKzI,EAAMhC,KAAKI,OACf8G,EAAK,GAAKlF,EAAMnC,aAChB4K,GAAc,EACd,MAED,KAAKzI,EAAMhC,KAAKC,KACfiH,EAAKlF,EAAMnC,YAAa,GACxB4K,GAAc,EACd,MAED,KAAKzI,EAAMhC,KAAKG,MACf+G,GAAOlF,EAAMnC,YAAa,GAC1B4K,GAAc,EAKXA,IAGJnC,EAAMmB,iBAENzH,EAAMM,UAoYPqI,CAAerC,GAIhB,SAAStD,EAAcsD,GAEtB,IAAuB,IAAlBtG,EAAMzD,QAAX,CAIA,OAFA+J,EAAMmB,iBAEGnB,EAAM3H,QAAQvE,QAEtB,KAAK,EAEJ,OAAS4F,EAAMrB,QAAQC,KAEtB,KAAKC,QAAMN,OAEV,IAA4B,IAAvByB,EAAMxC,aAAyB,OAEpCkJ,EAAwBJ,GAExB/F,EAAQC,EAAMgD,aAEd,MAED,KAAK3E,QAAMH,IAEV,IAAyB,IAApBsB,EAAMtC,UAAsB,OAEjCoJ,EAAqBR,GAErB/F,EAAQC,EAAMiD,UAEd,MAED,QAEClD,EAAQC,EAAMC,KAIhB,MAED,KAAK,EAEJ,OAAST,EAAMrB,QAAQG,KAEtB,KAAKD,QAAME,UAEV,IAA0B,IAArBiB,EAAM1C,aAA4C,IAApB0C,EAAMtC,UAAsB,QAlYpE,SAAmC4I,GAE7BtG,EAAM1C,YAAayJ,EAAuBT,GAE1CtG,EAAMtC,WAAYoJ,EAAqBR,GAgYxCsC,CAA0BtC,GAE1B/F,EAAQC,EAAMkD,gBAEd,MAED,KAAK7E,QAAMgK,aAEV,IAA0B,IAArB7I,EAAM1C,aAA+C,IAAvB0C,EAAMxC,aAAyB,QApYvE,SAAsC8I,GAEhCtG,EAAM1C,YAAayJ,EAAuBT,GAE1CtG,EAAMxC,cAAekJ,EAAwBJ,GAkY9CwC,CAA6BxC,GAE7B/F,EAAQC,EAAMmD,mBAEd,MAED,QAECpD,EAAQC,EAAMC,KAIhB,MAED,QAECF,EAAQC,EAAMC,KAIXF,IAAUC,EAAMC,MAEpBT,EAAMI,cAAekD,IAMvB,SAASJ,EAAaoD,GAErB,IAAuB,IAAlBtG,EAAMzD,QAKX,OAHA+J,EAAMmB,iBACNnB,EAAMiC,kBAEGhI,GAER,KAAKC,EAAMgD,aAEV,IAA4B,IAAvBxD,EAAMxC,aAAyB,OAEpC2J,EAAuBb,GAEvBtG,EAAMM,SAEN,MAED,KAAKE,EAAMiD,UAEV,IAAyB,IAApBzD,EAAMtC,UAAsB,OAEjC2J,EAAoBf,GAEpBtG,EAAMM,SAEN,MAED,KAAKE,EAAMkD,gBAEV,IAA0B,IAArB1D,EAAM1C,aAA4C,IAApB0C,EAAMtC,UAAsB,QAtXlE,SAAkC4I,GAE5BtG,EAAM1C,YAAagK,EAAsBhB,GAEzCtG,EAAMtC,WAAY2J,EAAoBf,GAoXzCyC,CAAyBzC,GAEzBtG,EAAMM,SAEN,MAED,KAAKE,EAAMmD,mBAEV,IAA0B,IAArB3D,EAAM1C,aAA+C,IAAvB0C,EAAMxC,aAAyB,QAxXrE,SAAqC8I,GAE/BtG,EAAM1C,YAAagK,EAAsBhB,GAEzCtG,EAAMxC,cAAe2J,EAAuBb,GAsX/C0C,CAA4B1C,GAE5BtG,EAAMM,SAEN,MAED,QAECC,EAAQC,EAAMC,MAMjB,SAASwC,EAAYqD,IAEG,IAAlBtG,EAAMzD,UAIXyD,EAAMI,cAAemD,GAErBhD,EAAQC,EAAMC,MAIf,SAASoC,EAAeyD,IAEA,IAAlBtG,EAAMzD,SAEX+J,EAAMmB,iBAMPzH,EAAM/D,WAAW4D,iBAAkB,cAAegD,GAElD7C,EAAM/D,WAAW4D,iBAAkB,cAAeiD,GAClD9C,EAAM/D,WAAW4D,iBAAkB,QAASkD,GAE5C/C,EAAM/D,WAAW4D,iBAAkB,aAAcmD,GACjDhD,EAAM/D,WAAW4D,iBAAkB,WAAYoD,GAC/CjD,EAAM/D,WAAW4D,iBAAkB,YAAaqD,GAIhD5G,KAAKgE,WAINvE,GAAckN,UAAYC,OAAOC,OAAQC,kBAAgBH,YACjCI,YAActN,GAWtC,IAAIuN,GAAc,SAAWtN,EAAQC,GAEpCF,GAAcwN,KAAMjN,KAAMN,EAAQC,GAElCK,KAAKsB,oBAAqB,EAE1BtB,KAAK+B,aAAaJ,KAAOK,QAAMI,IAC/BpC,KAAK+B,aAAaF,MAAQG,QAAMC,OAEhCjC,KAAKqC,QAAQC,IAAMC,QAAMH,IACzBpC,KAAKqC,QAAQG,IAAMD,QAAMgK,eAI1BS,GAAYL,UAAYC,OAAOC,OAAQC,kBAAgBH,YACjCI,YAAcC,G,YC1rCpC,IAAI,QAAE7M,IAAY+M,EAclB,MAAMC,GAAgB,EAAV3P,KAAKmD,GACXyM,GAA2C,CAE7C,CAAC,IAAIF,UAAc,EAAG,EAAG,GAAI,IAAIA,SAAaC,GAAM,EAAG,EAAG,IAC1D,CAAC,IAAID,UAAc,GAAI,EAAG,GAAI,IAAIA,QAAYC,GAAM,EAAG,EAAG,IAC1D,CAAC,IAAID,UAAc,EAAG,EAAG,GAAI,IAAIA,QAAY,EAAG,EAAG,IACnD,CAAC,IAAIA,UAAc,EAAG,GAAI,GAAI,IAAIA,QAAY,EAAGC,GAAM,EAAG,IAC1D,CAAC,IAAID,WAAe,EAAG,EAAG,GAAI,IAAIA,QAAY,GAAIC,GAAM,EAAG,IAC3D,CAAC,IAAID,UAAc,EAAG,EAAG,GAAI,IAAIA,QAAY,EAAGC,GAAM,EAAG,KAC3D,IAGGE,IAAW,SAAXA,OAAW,eAAXA,IAAW,uBAAXA,IAAW,uBAAXA,IAAW,uBAAXA,IAAW,uBAAXA,IAAW,wBAAXA,QAAW,KAahB,MAAMC,GAAeA,CAACC,EAAoBC,KACtCA,EAAeA,GAAgB,GAC/BD,EAAUA,GAAW,CAAC,EAAG,EAAG,EAAG,GAC/B,IAAIE,EAAM,IAAIP,iBACVQ,EAAiB,GACjBC,EAAe,IAAIT,UAAc,EAAIM,EAAc,EAAIA,EAAc,GACrEI,EAAe,IAAIV,UAAc,EAAG,EAAG,GAC3C,IAAK,IAAIhO,EAAI,EAAGA,GAAK,GAAIA,GAAK,GAAI,CAC9B,IAAI2O,EAAU3O,EAAI1B,KAAKmD,GAAM,IAC7B+M,EAAeI,KACXH,EAAahL,QAAQgD,IAAI,IAAIuH,UAAc1P,KAAKuQ,IAAIF,GAASrQ,KAAKwQ,IAAIH,GAAS,GAAG/H,eAAe0H,KAGzG,IAAIS,EAAW,GACf,IAAK,IAAI/O,EAAI,EAAGA,EAAI,EAAGA,IACfqO,EAAQrO,GACR+O,EAASH,QAAQJ,GAEjBO,EAASH,KAAKF,EAAajL,SAE/B+K,EAAiBA,EAAelP,KAAIa,GAAKA,EAAEsD,QAAQuL,eAAe,IAAI/N,GAAQ,EAAG,EAAG,GAAI,GAAM3C,KAAKmD,MACnGiN,EAAaM,eAAe,IAAI/N,GAAQ,EAAG,EAAG,GAAI,GAAM3C,KAAKmD,IAOjE,IAAIwN,EAAQ,GACZ,IAAK,IAAIjP,EAAI,EAAGA,EAAG+O,EAASnQ,OAAQoB,IAAK,CACrC,IAAIkP,GAAMlP,EAAI,GAAK+O,EAASnQ,OAC5BqQ,EAAML,KAAKG,EAASA,EAASnQ,OAAS,IACtCqQ,EAAML,KAAKG,EAAS/O,IACpBiP,EAAML,KAAKG,EAASG,IAIxB,OAFAX,EAAIY,cAAcF,GAEXV,GAuBLa,GAAc,SAAUC,EAAoBC,GAC9C,IAAI,MAAEC,EAAK,OAAEC,EAAM,YAAEC,EAAW,KAAEC,EAAI,MAAET,EAAK,MAAEU,EAAK,cAAEC,GAAiBN,EACnEO,EAAeP,EAAOO,cAAgB,EAC1C,MAAMC,EAAoB,WAAVH,EAAqB,UAAY,UAEjDD,EAAOA,GAAQ,MACf,IAAIK,EAAgBd,GAAS,CAAC/S,EAAKK,EAAGL,EAAKI,EAAGJ,EAAKE,GAGnD,MAAM4T,EAAQ,IAAIhC,QAEZiC,EAAS,IAAIjC,oBADL,GACoCuB,EAAQC,EAAQ,GAAK,KAMjEU,EAAW,IAAIlC,gBAAoB,CAAEmC,WAAW,IACtDD,EAASE,QAAQb,EAAOC,GAAQ,GAEhCU,EAASG,cAAcP,GACvBI,EAASI,cAAcnE,OAAOoE,kBAC9B,IAAIC,EAAW,IAAIjQ,GAAe0P,EAAQC,EAASzP,YACnD+P,EAASzP,UAAYuO,EAAOM,cAE5B,MAAMa,EAAanS,KAAKwQ,IAAI,GAAK,IAAMxQ,KAAKmD,IAAQnD,KAAKwQ,IAf3C,GAeuD,IAAMxQ,KAAKmD,IAC1E6E,EAASuJ,EAAe,EAAK,IAAMY,EAAa,GAAKA,EAErDC,EAAcpB,EAAOoB,aAAevC,GAAYwC,MAC/CC,EAAmBC,GAjDA,SAAUC,GACpC,MAAMC,EAAe,CAAC,IAAK,IAAK,GAC1BC,EAAe,EAAE,EAAG,IAAK,GACzBC,EAAe,EAAE,GAAI,IAAK,GAC1BC,EAAe,CAAC,GAAI,IAAK,GACzBC,EAAe,CAAC,IAAK,KAAM,GAC3BC,EAAe,EAAE,EAAG,KAAM,GAE1BC,EAAqB,IAAIrD,UAAc,EAAG,GAAI,GAC9CsD,EAAsB,IAAItD,UAAc,EAAG,IAAM,GACjDuD,EAAe,IAAIvD,UAAc,EAAG,EAAG,GAC7C,OAAQ8C,GACJ,KAAK3C,GAAYwC,KAAM,MAAO,CAACI,EAAcQ,GAC7C,KAAKpD,GAAYqD,SAAU,MAAO,CAACP,EAAcM,GACjD,KAAKpD,GAAYsD,SAAU,MAAO,CAACP,EAAcK,GACjD,KAAKpD,GAAYuD,SAAU,MAAO,CAACV,EAAcO,GACjD,KAAKpD,GAAYwD,SAAU,MAAO,CAACP,EAAcE,GACjD,QAAS,MAAO,CAACH,EAAcE,IAgCGO,CAAsBlB,GACtDmB,EAA2B,QAATnC,EACpB,IAAI1B,UAAc4C,EAAkB,GAAKtK,EACvBsK,EAAkB,GAAKtK,EACvBsK,EAAkB,GAAKtK,GACzC,IAAI0H,UAAc,EAAS,EAAI,IAAK,EAAI,KAQ5C,IAAI8D,EAA6BC,EALjC9B,EAAO3K,GAAGb,KAAKoM,GACfZ,EAAOtM,SAASc,KAAKoN,GACrB5B,EAAO+B,OAASzC,EAAQC,EACxBS,EAAOtJ,OAAO,IAAIqH,UAAc,EAAG,EAAG,IAItC,MAAMiE,EAAgC,GAChCC,EAAa,IAAIlE,gBAAoB,EAAK,GAEhD,IAAImE,EAAmB,IAAInE,oBAAwB,CAAEoE,MAAO,EAAUC,KAAMrE,cAC5E+D,EAAmB,MACf,IAAIO,EAAO,IAAItE,OAAWkE,EAAYC,GAEtC,OADAG,EAAKC,qBAAqBrE,GAAS,GAAG,IAC/BoE,GAHQ,GAMnB,MAAME,EAAgB,IAEhBC,EAAa,IACbC,EAAmB,CACrB,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,IAGd,SAASC,EAAS1D,EAAqBQ,GAEnC,IAAImD,EAAY3T,MAAM,GAAGa,KAAK,GAAGR,KAAI,CAACuT,EAAG7S,KACrC,IAAI8S,EAAM,IAAI9E,oBAAwB,CAAEoE,MAAO3C,EAAYzP,GAAIqS,KAAMrE,eAErE,OADA8E,EAAIC,UA3DE,GA4DCD,KAGXhB,EAAgBc,EAAUtT,KAAKwT,GACpBJ,EAAiBpT,KAAI0T,IACxB,IAAIzE,EAAMH,GAAY4E,EAxBZ,IAyBVf,EAAKrD,KAAKL,GACV,IAAI+D,EAAO,IAAItE,OAAWO,EAAKuE,GAG/B,OAFAR,EAAKhM,MAAMO,IAAI2L,EAAeA,EAAeA,GAC7CF,EAAKC,qBAAqBrE,GAAS,GAAG,IAC/BoE,OAEZW,OAEH,IAAIC,EAAYjU,MAAM,GAAGa,KAAK,GAAGR,KAAI,CAACuT,EAAG7S,KACrC,IAAIoS,EAAmB,WAAVzC,EACPwD,MAAW1D,EAAYzP,GAAI,QAAS,KAAMoT,MAC1CD,MAAW1D,EAAYzP,GAAI,QAAS,KAAMoT,MAK5CN,EAAM,IAAI9E,oBAAwB,CAAEoE,QAAOC,KAAMrE,eAEjDO,EAAMH,GAAY,CAAC,EAAE,EAAE,EAAE,GA3Cf,IA4Cd6D,EAAKrD,KAAKL,GACV,IAAI+D,EAAO,IAAItE,OAAWO,EAAKuE,GAG/B,OAFAR,EAAKhM,MAAMO,IAAI4L,EAAYA,EAAYA,GACvCH,EAAKC,qBAAqBrE,GAAS,GAAG,IAC/BoE,KAIX,MAAMjD,EAAO,IAAIrB,QACjB,IAAK,IAAIhO,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,MAAMqT,EAAQ,IAAIrF,QACZsF,GAAM,IAAItF,WAAgBuF,sBAAsBrF,GAASlO,GAAG,IAC5DwT,GAAO,IAAIxF,WAAgBuF,sBAAsBrF,GAAS,GAAG,IACnEmF,EAAMI,sBAAsBH,EAAII,SAASF,IACzC,IAAK,IAAIG,GAAK,EAAGA,GAAK,EAAGA,IACrB,IAAK,IAAIxT,GAAK,EAAGA,GAAK,EAAGA,IAAK,CAC1B,IAAIyT,EAAgB,GAATD,EAAI,IAAUxT,EAAI,GAE7B,MACM0T,EADY/B,EAA8B,EAAhB7C,EAAMjP,GAAG4T,GAAWA,GAC1BnQ,QACpBqQ,EAAc/B,EAAiBtO,QAE/BsQ,EAAM,IAIZ,GAHAF,EAAQlQ,SAASc,KAAK,IAAIuJ,UAAkB,EAAJ7N,EAAO,EAAO,EAAJwT,IAClDG,EAAYnQ,SAASc,KAAK,IAAIuJ,UAAkB,EAAJ7N,EAAO,EAAI4T,EAAS,EAAJJ,IAExD5D,EAAciE,QAAQhU,IAAM,EAAG,CAC/B,MAAMiU,EAAcf,EAAUjE,EAAMjP,GAAG4T,IAAMnQ,QAC7CwQ,EAAYtQ,SAASc,KAAK,IAAIuJ,UAAkB,EAAJ7N,EAAO,EAAI0P,EAAkB,EAAJ8D,IACrEN,EAAM5M,IAAIwN,GAGVZ,EAAM5M,IAAIqN,GAEdT,EAAM5M,IAAIoN,GAIlBxE,EAAK5I,IAAI4M,GAGb,OADAhE,EAAK/I,MAAMO,IAAI,EAAI,EAAG,EAAI,EAAG,EAAI,GAC1BwI,EAGX,IAAI6E,EAAQvB,EAAStD,EAAMI,GAC3BO,EAAMvJ,IAAIyN,GAEV,MAAMC,EAASA,KACX3D,EAAS1L,SACToL,EAASiE,OAAOnE,EAAOC,IAE3BkE,IAEA,IAAIC,GAAW,EACf,MAAMC,EAAUA,KACZD,EAAUE,sBAAsBD,GAChCnE,EAASiE,OAAOnE,EAAOC,IAE3BoE,IAkBA,MAAO,CACHE,mBAjBuBA,CAAClF,EAAoBI,KAC5CO,EAAMwE,OAAON,GACbA,EAAMO,QACNP,EAAQvB,EAAStD,EAAMI,GACvBO,EAAMvJ,IAAIyN,GACVhE,EAASiE,OAAOnE,EAAOC,GAChBC,GAYPwE,YAAaA,IAAMxE,EACnByE,YAVYpZ,KACZ0W,EAAK2C,SAAQC,GAAKA,EAAE1N,YACpBgL,EAAiBhL,UACjB+K,EAAW/K,UACX6I,EAAMwE,OAAON,GACbY,qBAAqBV,IAMrBW,eAAgBZ,IAKxB,IAAIxB,GAAY,WACZ,IAAIqC,EAAgC,KAChCC,EAA2B,KAwB/B,MAvBWC,CAAC7F,EAAoBC,KACA,IAAD6F,EAU6BC,EAKjDC,EAfP,OAAqB,OAAjBL,GACO,QAAPG,EAAAF,SAAO,IAAAE,GAAPA,EAASR,cAETM,EAAU7F,GAAYC,EAAMC,GAC5B0F,EAAe1F,EACR2F,GAEF3F,EAAOC,QAAUyF,EAAazF,OAASD,EAAOE,SAAWwF,EAAaxF,QAC3EpP,EAAWkP,EAAOL,OAAS,GAAI+F,EAAa/F,OAAS,KAAOK,EAAOK,QAAUqF,EAAarF,OAC1FL,EAAOO,eAAiBmF,EAAanF,cAAgBP,EAAOM,gBAAkBoF,EAAapF,eACxFN,EAAOoB,cAAgBsE,EAAatE,aAEhC,QAAP0E,EAAAH,SAAO,IAAAG,GAAPA,EAASb,mBAAmBlF,EAAMC,EAAOG,aACzCuF,EAAe1F,EACR2F,IAEA,QAAPI,EAAAJ,SAAO,IAAAI,GAAPA,EAASV,cACTM,EAAU7F,GAAYC,EAAMC,GAC5B0F,EAAe1F,EACR2F,KA+EJK,OAjEf,SAAiBC,GACb,MAAMC,EAAQC,IAAMC,OAA8B,OAC3ChF,EAAaiF,GAAkBF,IAAM9a,SAAsBwT,GAAYwC,MAC9E,IAAI,MAAEpB,EAAK,OAAEC,EAAM,YAAEC,EAAW,cAAEM,EAAa,aAAEF,EAAY,MAAEF,GAAS4F,EACpEK,EAAcH,IAAMxa,QAAQ0X,GAAU,IAE1C,MACM/C,EADQiG,aAAcC,eAAWC,YAAYzQ,GAAG,OAGtD,IAAI2P,EAAUW,EAAYL,EAAMlG,KAAM,CAC9BE,QAAOC,SAAQC,cAAaR,MAAOc,EAAeJ,QAAOE,eAAcD,gBACvEc,gBAgDR,OA9CA/U,qBAAW,KACP,IAAIqa,EAAM7J,OACV,SAAS8J,EAAcnL,GACnB,IAAIoL,EAAkB,EAEJ,MAAdpL,EAAMqL,KACNR,EAAexH,GAAYqD,UAEb,MAAd1G,EAAMqL,KACNR,EAAexH,GAAYsD,UAEb,MAAd3G,EAAMqL,KACNR,EAAexH,GAAYuD,UAEb,MAAd5G,EAAMqL,KACNR,EAAexH,GAAYwD,UAEb,MAAd7G,EAAMqL,IACNR,EAAexH,GAAYiI,UAG3BF,EAAkB,EAM1B,SAASG,EAAWvL,GAChB6K,EAAexH,GAAYwC,MAI/B,OAFAqF,EAAI3R,iBAAiB,UAAW4R,GAChCD,EAAI3R,iBAAiB,QAASgS,GACvB,KACHL,EAAI5O,oBAAoB,UAAW6O,GACnCD,EAAI3R,iBAAiB,QAASgS,OAItC1a,qBAAW,KACP,IAAIqa,EAAMR,EAAMc,QAEhB,OADAN,EAAIO,YAAYtB,EAAQP,cAAcjU,YAC/B,KACHuV,EAAIQ,YAAYvB,EAAQP,cAAcjU,gBAIvCgW,eAAA,OACHC,IAAKlB,EACLmB,MAAO,CAAEpH,MAAOgG,EAAMhG,MAAOC,OAAQ+F,EAAM/F,OAAQoH,OAAQ,M,wCCnY5D,MAAMC,GAOTC,YAAY/Y,GACR,IAAIgZ,EAAMC,KAAKC,MAAMlZ,GAErB,OADA+C,KAAK+F,IAAIkQ,GACFjW,KAEXoW,YACI,IAAI,GAACC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,EAAE,GAAEC,GAAMzW,KAC3B,OAAOkW,KAAKQ,UAAU,CAACL,KAAIC,KAAIC,KAAIC,KAAIC,OAG3CE,KAQI,OAPA3W,KAAK+F,IAAI,CACLsQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BC,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BC,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,IACvCC,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCC,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,KAEjBzW,KAEX2C,QACI,OAAO,IAAIoT,GAAU,CACjBM,GAAI,IAAIrW,KAAKqW,IACbC,GAAI,IAAItW,KAAKsW,IACbC,GAAI,IAAIvW,KAAKuW,IACbC,GAAI,IAAIxW,KAAKwW,IACbC,GAAI,IAAIzW,KAAKyW,MAGrB1J,YAAY6J,GAA8F,KAnC1GP,GAAe,GAAG,KAClBC,GAAe,GAAG,KAClBC,GAAe,GAAG,KAClBC,GAAe,GAAG,KAClBC,GAAe,GAgCPG,aAAiBb,GACjB/V,KAAK+F,IAAI,CACLsQ,GAAIO,EAAMP,GAAIC,GAAIM,EAAMN,GAAIC,GAAIK,EAAML,GAAIC,GAAII,EAAMJ,GAAIC,GAAIG,EAAMH,KAGjEG,GACL5W,KAAKqW,GAAKO,EAAMP,GAChBrW,KAAKsW,GAAKM,EAAMN,GAChBtW,KAAKuW,GAAKK,EAAML,GAChBvW,KAAKwW,GAAKI,EAAMJ,GAChBxW,KAAKyW,GAAKG,EAAMH,IAAM,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAEtCzW,KAAK2W,KAGb5Q,IAAI6Q,GACA5W,KAAKqW,GAAKO,EAAMP,IAAMrW,KAAKqW,GAC3BrW,KAAKsW,GAAKM,EAAMN,IAAMtW,KAAKsW,GAC3BtW,KAAKuW,GAAKK,EAAML,IAAMvW,KAAKuW,GAC3BvW,KAAKwW,GAAKI,EAAMJ,IAAMxW,KAAKwW,GAC3BxW,KAAKyW,GAAKG,EAAMH,IAAMzW,KAAKyW,GAE/BI,eAAeC,EAAkBC,EAAkBC,EAAmBC,EAAoBC,GACtF,IAAIC,EAAQ,IAAIL,GACZM,EAAQ,IAAIL,GAEhB,IAAK,IAAI7X,EAAI,EAAGA,EAAI8X,EAAGlZ,OAAQoB,IAAK,CAEhC,IAAImY,EAAMJ,EAAG/X,GAAG,GAAIoY,EAAML,EAAG/X,GAAG,GAChCkY,EAAME,GAAOP,EAAEM,GACfF,EAAMG,IAAQR,EAAEO,GAAOL,EAAG9X,IAAMgY,EAEpC,MAAO,CAACC,EAAOC,GAEnBG,oBAAoBR,EAAkBE,EAAoBC,GACtD,IAAIE,EAAQ,IAAIL,GAEhB,IAAK,IAAI7X,EAAI,EAAGA,EAAI+X,EAAGnZ,OAAQoB,IAAK,CAEhC,IAAImY,EAAMJ,EAAG/X,GAAG,GAChBkY,EAD0BH,EAAG/X,GAAG,IACnB6X,EAAEM,GAEnB,OAAOD,EAIXI,UAAUC,GACN,IAAKnB,EAAID,GAAMrW,KAAK6W,eAAe7W,KAAKsW,GAAItW,KAAKqW,GAAIoB,EAAKnb,IAAKmb,EAAKpb,IAxF9D,IAyFDma,EAAID,GAAMvW,KAAK6W,eAAe7W,KAAKwW,GAAIxW,KAAKuW,GAAIkB,EAAKjb,IAAKib,EAAKlb,IAxF9D,GAyFFka,EAAKzW,KAAKuX,oBAAoBvX,KAAKyW,GAAIgB,EAAKhb,IAxF1C,GAyFN,OAAO,IAAIsZ,GAAU,CAAEO,KAAID,KAAIG,KAAID,KAAIE,OAG3CiB,wCAAwCT,EAAoBC,EAAaH,GACrE,MAAO,iBACDA,eAAeA,2CAEnB5Y,MAAM8Y,EAAGnZ,QAAQkB,KAAK,GAAGR,KAAK,CAACuT,EAAG7S,KAChC,IAAImY,EAAMJ,EAAG/X,GAAG,GAAIoY,EAAML,EAAG/X,GAAG,GAChC,MAAO,qBACD6X,SAASO,SAAWP,KAAKM,uBAEhCM,KAAK,8BACMZ,mBAGlBW,mCAAmCV,EAAmBC,EAAoBC,EAAaJ,EAAWC,GAC9F,MAAO,iBACDD,eAAeA,oBACfC,eAAeA,2CAEnB5Y,MAAM6Y,EAAGlZ,QAAQkB,KAAK,GAAGR,KAAK,CAACuT,EAAG7S,KAChC,IAAImY,EAAMJ,EAAG/X,GAAG,GAAIoY,EAAML,EAAG/X,GAAG,GAAI0Y,EAAMZ,EAAG9X,GAC7C,MAAO,qBACD6X,SAASO,SAAWP,KAAKM,wBACzBP,SAASQ,SAAWR,KAAKO,QAAUO,QAAUV,sBAEpDS,KAAK,6BACKb,UAAUC,mBAG3BW,2BAA2BD,GAEvB,OAAO,IAAII,SAAS,OAAQ,uDAE1B9B,GAAU+B,4BAA4BL,EAAKnb,IAAKmb,EAAKpb,IA9HjD,EA8H6D,KAAM,kBACvE0Z,GAAU+B,4BAA4BL,EAAKjb,IAAKib,EAAKlb,IA9HjD,EA8H6D,KAAM,kBACvEwZ,GAAUgC,iCAAiCN,EAAKhb,IA9H5C,EA8HwD,iHAMlEub,MAAMP,GACF,GAAItZ,MAAM8Z,QAAQR,IAASA,aAAgBS,GAAS,CAChD,IAAIC,EAAQha,MAAM8Z,QAAQR,GAAQA,EAAOA,EAAKU,MAC1C5J,EAAOvO,KAAK2C,QAChB,IAAK,IAAIzD,EAAI,EAAGA,EAAIiZ,EAAMra,OAAQoB,IAC9BqP,EAAOA,EAAKiJ,UAAUW,EAAMjZ,IAEhC,OAAOqP,EACJ,MAAoB,kBAATkJ,EACPzX,KAAKgY,MAAM,IAAIE,GAAQT,IAGvBzX,KAAKwX,UAAUC,GAI9BC,qBAAqBU,GACjB,IAAIjK,EAAQ,IAAIiK,GACZC,EAAYlK,EAAMA,EAAMrQ,OAAS,GACrC,IAAK,IAAIoB,EAAIiP,EAAMrQ,OAAS,EAAGoB,EAAI,EAAGA,IAClCiP,EAAMjP,GAAKiP,EAAMjP,EAAI,GAGzB,OADAiP,EAAM,GAAKkK,EACJlK,EAEXuJ,8BAA8BU,GAC1B,IAAIjK,EAAQ,IAAIiK,GACZE,EAAanK,EAAM,GACvB,IAAK,IAAIjP,EAAI,EAAGA,EAAIiP,EAAMrQ,OAAS,EAAGoB,IAClCiP,EAAMjP,GAAKiP,EAAMjP,EAAI,GAGzB,OADAiP,EAAMA,EAAMrQ,OAAS,GAAKwa,EACnBnK,EAIXoK,oBAAoBxc,EAA8BC,EAA0BC,GACxE,IAAIuc,EAAsC,GAE1C,IAAK,IAAItZ,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIuZ,EAAM1c,EAAcmD,GACpBwZ,EAAQ3c,EAAciE,KAAKqW,GAAGnX,IAElC,IAAK,IAAIyZ,EAAI,EAAGA,EAAI3Y,KAAKsW,GAAGpX,GAAGyZ,IAC3BD,EAAQ3C,GAAU6C,cAAcF,GAEpCF,EAAgB1K,KAAK,CAAC2K,EAAKC,IAE/B,IAAK,IAAIxZ,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACzB,IAAIuZ,EAAMzc,EAAYkD,GAClBwZ,EAAQ1c,EAAYgE,KAAKuW,GAAGrX,IAChC,IAAK,IAAIyZ,EAAI,EAAGA,EAAI3Y,KAAKwW,GAAGtX,GAAGyZ,IAC3BD,EAAQ3C,GAAU6C,cAAcF,GAEpCF,EAAgB1K,KAAK,CAAC2K,EAAKC,IAE/B,IAAK,IAAIxZ,EAAI,EAAGA,EAAE,EAAEA,IAAK,CACrB,IAAIuZ,EAAMxc,EAAciD,GACpBwZ,EAAQzc,EAAc+D,KAAKyW,GAAGvX,IAClCsZ,EAAgB1K,KAAK,CAAE2K,EAAKC,IAEhC,OAAOF,EAGXK,sBAAuBC,EAAwBC,EAAqCC,EAAiCC,GACjH,IAAI1K,EAAO,IAAIwH,GAEXmD,EAAkBA,CAACT,EAAaC,EAAeS,EAAiBC,KAChE,IAAIC,EAAW,IAAIC,IAAIH,EAAM3a,KAAK,CAACa,EAAGH,IAAM,CAACG,EAAEka,WAAYra,MACvD0Y,EAAM,EACV,MAAQyB,EAASG,IAAIf,EAAIc,cACrBd,EAAM1C,GAAU0D,uBAAuBhB,GACvCb,MACIA,IAAQwB,MAEhB,MAAQC,EAASG,IAAId,EAAMa,aAIvB,GAHAb,EAAQ3C,GAAU0D,uBAAuBf,GAEzCd,IACIA,GAAO,GAAI,CACXhY,QAAQC,KAAK,oBAAqB6Y,EAAOW,GACzC,MAKR,OADAzB,GAAOA,EAAMwB,GAAUA,EAChB,CAACxB,EAAKyB,EAASK,IAAIjB,EAAIc,YAAcF,EAASK,IAAIhB,EAAMa,cAGnE,IAAK,IAAII,KAAcb,EAAI,CACvB,IAAIL,EAAMkB,EAAW,GAAIjB,EAAQiB,EAAW,GACxCR,EAAmC,IAAfV,EAAI3a,OAAgBkb,EAChB,IAAfP,EAAI3a,OAAgBib,EACpBE,GACRW,EAAOC,EAAOC,GAAWZ,EAAgBT,EAAKC,EAAOS,EAAOV,EAAI3a,QAGlD,IAAf2a,EAAI3a,QACJyQ,EAAKiI,GAAGqD,GAAUD,EAClBrL,EAAKgI,GAAGsD,GAAUC,GACI,IAAfrB,EAAI3a,QACXyQ,EAAK+H,GAAGuD,GAAUD,EAClBrL,EAAK8H,GAAGwD,GAAUC,GAElBvL,EAAKkI,GAAGoD,GAAUC,EAG1B,OAAOvL,EAGXwL,kBACI,IAAIvB,EAAkBxY,KAAKuY,oBAAoBxc,EAAeC,EAAaC,GAE3E,OADW+D,KAAK6Y,sBAAsBL,EAAiBtc,EAAuBC,EAAqBF,GAIvG+d,eACuB,IAAfha,KAAKyW,GAAG,IACRzW,KAAKgY,MAAM,IAAIE,GAAQ,OAE3B,IAAI+B,GAAgBpb,EAAUmB,KAAKqW,IAAMxX,EAAUmB,KAAKuW,KAAO,IAAM,EACjE2D,EAAela,KAAKsW,GAAGjY,QAAO,CAACgB,EAAGkL,IAAMlL,EAAIkL,GAAG,GAAK,IAAM,GAAOvK,KAAKwW,GAAGnY,QAAO,CAACgB,EAAGkL,IAAMlL,EAAIkL,GAAG,GAAK,IAAM,EAChH,OAAO0P,GAAgBC,EAG3BC,YAAYld,GAER,IAAIub,EAAkBxY,KAAKuY,oBAAoBxc,EAAeC,EAAaC,GAEvEme,EAAsBnd,EAAEkb,MAAM9Z,QAAQ,CAACgc,EAAS5C,KAChD,IAAI6C,EAAe1N,OAAO2N,YAAY9C,EAAKhb,KAQ3C,OALa4d,EAAQ7b,KAAKgc,IAAA,IAAEC,EAAUC,GAAYF,EAAA,MAC9C,CAACC,EAASjc,KAAI9B,IAAC,IAAAie,EAAA,OAAmB,QAAnBA,EAAIL,EAAa5d,UAAE,IAAAie,IAAIje,KACrCge,EAAYlc,KAAI9B,IAAC,IAAAke,EAAA,OAAmB,QAAnBA,EAAIN,EAAa5d,UAAE,IAAAke,IAAIle,WAI7C8b,GAGJ,OADWxY,KAAK6Y,sBAAsBuB,EAAqBre,EAAeC,EAAaC,IASxF,MAAM4e,GAOT9N,YAAY+N,EAA8CxgB,GAAgB,KAN1E+B,IAAsB,GAAG,KACzBC,IAAqB,GAAG,KACxBC,IAAsB,GAAG,KACzBC,IAAqB,GAAG,KACxBC,IAAsB,GAAG,KACzBnC,KAAe,GAEP6D,MAAM8Z,QAAQ6C,GACd9a,KAAK+a,WAAWD,EAAKxgB,GACdwgB,aAAeD,IACtB7a,KAAK3D,IAAM,IAAIye,EAAIze,KACnB2D,KAAK1D,IAAM,IAAIwe,EAAIxe,KACnB0D,KAAKzD,IAAM,IAAIue,EAAIve,KACnByD,KAAKxD,IAAM,IAAIse,EAAIte,KACnBwD,KAAKvD,IAAM,IAAIqe,EAAIre,KACnBuD,KAAK1F,KAAOA,GACLwgB,aAAe/E,GACtB/V,KAAKgb,UAAUF,EAAKxgB,GACbwgB,GACP9a,KAAK+F,IAAI+U,GAGjB/U,IAAI0R,GACAzX,KAAK3D,IAAMob,EAAKpb,IAChB2D,KAAK1D,IAAMmb,EAAKnb,IAChB0D,KAAKzD,IAAMkb,EAAKlb,IAChByD,KAAKxD,IAAMib,EAAKjb,IAChBwD,KAAKvD,IAAMgb,EAAKhb,IAChBuD,KAAK1F,KAAOmd,EAAKnd,KAErB0gB,UAAUzM,EAAiBjU,GACvB,IAAI2gB,EAAaA,CAAClE,EAAkBD,EAAkBoE,EAAuBC,KACzE,IAAK,IAAIjc,EAAI,EAAGA,EAAI6X,EAAEjZ,OAAQoB,IACtBA,IAAM6X,EAAE7X,IAAe,IAAT4X,EAAE5X,KAEhBgc,EAAMpN,KAAK,CAACiJ,EAAE7X,GAAIA,IAClBic,EAAMrN,KAAKgJ,EAAE5X,MAQzB,OAJA+b,EAAW1M,EAAK8H,GAAI9H,EAAK+H,GAAItW,KAAK3D,IAAK2D,KAAK1D,KAC5C2e,EAAW1M,EAAKgI,GAAIhI,EAAKiI,GAAIxW,KAAKzD,IAAKyD,KAAKxD,KAC5Cye,EAAW1M,EAAKkI,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAIzW,KAAKvD,IAAK,IAClDuD,KAAK1F,KAAOA,EACL0F,KAEX+a,WAAY5C,EAAe7d,GAEvB,OADA0F,KAAKgb,WAAU,IAAIjF,IAAYiC,MAAMG,GAAQ7d,GACtC0F,KAEX2C,QACI,OAAO,IAAIkY,GAAK7a,KAAMA,KAAK1F,MAE/Bod,oBAAoBD,GAChB,MAAO,CAACA,GACJ,IAAIoD,IAAOE,WAAW,CAACtD,EAAMA,GAAOA,EAAKnd,KAAO,MAChD,IAAIugB,IAAOE,WAAW,CAACtD,EAAMA,EAAMA,GAAOA,EAAKnd,KAAO,MA6C9D8gB,MACI,IAAI9gB,EACJ,OAAQ0F,KAAK1F,KAAK0F,KAAK1F,KAAKwD,OAAS,IACjC,IAAK,IAAKxD,EAAO0F,KAAK1F,KAAK+gB,MAAM,EAAGrb,KAAK1F,KAAKwD,OAAS,GAAI,MAC3D,IAAK,IAAKxD,EAAO0F,KAAK1F,KAAM,MAC5B,QAASA,EAAO0F,KAAK1F,KAAO,IAEhC,OAAOugB,GAAKS,IAAIhhB,GAGpBif,WACI,OAAOvZ,KAAK1F,MAjHPugB,GA6DFU,oBAAsB,KACzB,IAAIC,EAAeX,GAAKW,aACpBC,EAAKD,EAAa,IAAIX,GAAKze,IAC3Bgc,EAAKoD,EAAa,IAAIX,GAAKne,IAC3Bgf,EAAKF,EAAa,IAAIX,GAAKle,IAC3Bgf,EAAKH,EAAa,IAAIX,GAAKje,IAC3Bgf,EAAKJ,EAAa,IAAIX,GAAKhe,IAC3Bgf,EAAKL,EAAa,IAAIX,GAAK/d,IAC3Bgf,EAAKN,EAAa,IAAIX,GAAK9d,IAC3Bgf,EAAKP,EAAa,IAAIX,GAAK7d,IAC3Bgf,EAAKR,EAAa,IAAIX,GAAK5d,IAG3Bgf,EAAMT,EADD,IAAIX,GAAK,CAAC,IAAIA,GAAKle,GAAImf,EAAG,IAAK,MAGpCI,EAAMV,EADD,IAAIX,GAAK,CAAC,IAAIA,GAAKje,GAAI,IAAIie,GAAK9d,IAAK,MAG1Cof,EAAMX,EADD,IAAIX,GAAK,CAAC,IAAIA,GAAKze,GAAI,IAAIye,GAAK7d,IAAK,MAG1Cof,EAAMZ,EADD,IAAIX,GAAK,CAAC,IAAIA,GAAKne,GAAI,IAAIme,GAAK5d,IAAK,MAG1CoC,EAAI,IAAIwb,GAAK,CAAC,IAAIA,GAAKle,GAAIgf,EAAG,GAAIG,EAAG,IAAK,KAC1CO,EAAKb,EAAanc,GAClBkL,EAAI,IAAIsQ,GAAK,CAAC,IAAIA,GAAKze,GAAI,IAAIye,GAAK7d,GAAI4e,EAAG,IAAK,KAChDU,EAAKd,EAAajR,GAElBgS,EAAKf,EADD,IAAIX,GAAK,CAACxb,EAAGkL,EAAGlL,EAAGA,EAAGA,GAAI,MAI9B8Y,EAAQ,CADH,IAAI0C,GAAK,IAAI9E,GAAa,MAG/B0F,EAAIrD,EAAIsD,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAChCK,EAAIC,EAAIC,EACRN,EAAKC,EAAKC,EAAKC,GACjBjK,OACEqK,EAAsC5P,OAAOC,OAAO,IAExD,OADAsL,EAAMrE,SAAQ/W,GAAKyf,EAAWzf,EAAEzC,MAAQyC,IACjCyf,GAlGF3B,GAoGFS,IAA6BT,GAAKU,sBAkBtC,MAAMrD,GAGTnL,YAAYoL,GAAyB,KAFrCA,MAAgB,GAGS,kBAAVA,EACPnY,KAAKmW,MAAMgC,GAEXnY,KAAKmY,MAAQA,EAWrBsE,YACI,IAAIC,EAAc,GAClB,IAAK,IAAIxd,EAAI,EAAIA,EAAIc,KAAKmY,MAAMra,OAAQoB,IAAK,CACzC,IAAInC,EAAIiD,KAAKmY,MAAMjZ,GACnB,GAAkB,MAAdnC,EAAEzC,KAAK,GAAY,CACnB,IAAIqiB,EAAIzE,GAAQ0E,WAAW7f,EAAEzC,OAASyC,EAAEzC,KAAK,GAC7CoiB,EAAG5O,KAAK+M,GAAKS,IAAKqB,IAClBD,EAAG5O,KAAK+M,GAAKS,IAAKqB,SAElBD,EAAG5O,KAAK/Q,GAGhB,OAAO,IAAImb,GAAQwE,GAGvBhF,gBAAgBmF,EAAaC,GACzB,MAAMC,EAAUziB,GACQ,IAAhBA,EAAKwD,OAAqB,EACX,MAAZxD,EAAK,GAAa,EAAI,EAE3B0iB,EAAU7d,GACI,IAARA,EAAa,GAAc,IAARA,EAAY,IAAM,IAEjD,GAAI0d,EAAMviB,KAAK,KAAOwiB,EAAMxiB,KAAK,GAAI,CACjC,IAAI6E,GAAO4d,EAAOF,EAAMviB,MAAQyiB,EAAOD,EAAMxiB,OAAS,EACtD,OAAsB,IAAI4d,GAAd,IAAR/Y,EAA8B,GACV,CAAE0b,GAAKS,IAAIuB,EAAMviB,KAAK,GAAK0iB,EAAO7d,MAE1D,OAAO,IAAI+Y,GAAQ,CAAC2E,EAAOC,IAInCG,eACI,IAAIC,EAAS,IAAIC,IAAI,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,OACnE,KAAOnd,KAAKmY,MAAMra,OAAS,GAAKof,EAAO1D,IAAIxZ,KAAKmY,MAAM,GAAG7d,OACrD0F,KAAKmY,MAAMiF,QAEf,OAAOpd,KAGXqd,WAAWC,GACP,IAAIC,EAAS,GACTC,EAAQ,GACRC,EAAcH,EAAII,OAAO,QACzBD,GAAe,IAAGH,EAAMA,EAAIjC,MAAM,EAAGoC,IACzC,IAAK,IAAIve,EAAI,EAAGA,EAAIoe,EAAIxf,OAAQoB,IAAK,CACjC,IAAIye,EAAKL,EAAIpe,GACb,GAAW,MAAPye,GAAqB,MAAPA,EACO,IAAjBH,EAAM1f,SACN0f,GAASF,EAAIpe,GACbqe,EAAOzP,KAAK0P,GACZA,EAAQ,SAET,GAAW,MAAPG,EACHH,EAAM1f,OAAS,IACfyf,EAAOzP,KAAK0P,GAAQA,EAAQ,QAE7B,CACH,MAAMI,EAAMD,EAAGE,WAAW,IACpB,IAAMD,GAAOA,EAAM,IAAa,IAAMA,GAAOA,EAAM,OACjDJ,EAAM1f,OAAS,IACfyf,EAAOzP,KAAK0P,GACZA,EAAQ,IAEZA,GAASF,EAAIpe,KAIzB,IAAIiZ,EAAQ,GACRqF,EAAM1f,OAAS,GAAGyf,EAAOzP,KAAK0P,GAClC,IAAK,IAAIA,KAASD,EAAQ,CACtB,IAAI9F,EAAOoD,GAAKS,IAAIkC,GAChB/F,GACAU,EAAMrK,KAAK2J,GAGnB,OAAOU,EAEXhC,MAAMmH,GAEF,OADAtd,KAAKmY,MAAQmF,EAAIQ,MAAM,MAAMtf,KAAIa,GAAKW,KAAKqd,WAAWhe,KAAI8S,OACnDnS,KAGX+d,WACI,IAAIC,EAAoB,GACpB7F,EAAQnY,KAAKmY,MACjB,KAAOA,EAAMra,OAAS,GAAG,CACrB,MAAMmgB,EAAW9F,EAAMiF,QACvB,GAAwB,IAApBY,EAASlgB,OACTkgB,EAASlQ,KAAKmQ,OACX,CACH,MAAMxG,EAAOuG,EAASE,MAChBC,EAAWjG,GAAQkG,SAAS3G,EAAMwG,GACxC,IAAK,IAAIlhB,KAAKohB,EAAShG,MACnB6F,EAASlQ,KAAK/Q,IAG1B,OAAO,IAAImb,GAAQ8F,GAGvB5C,MACI,IAAIjD,EAAgBnY,KAAKmY,MAAMkD,MAAM,GAAGgD,UAAU7f,KAAIa,GAAKA,EAAE+b,QAAOjJ,OACpE,OAAO,IAAI+F,GAAQC,GAGvBkD,MAAMiD,GACF,IAAInG,EAAgBnY,KAAKmY,MAAMkD,MAAM,EAAGiD,GACxC,OAAO,IAAIpG,GAAQC,GAGvBra,SACI,OAAOkC,KAAKmY,MAAMra,OAGtB4Z,eAAeS,EAAoBoG,GAC/BA,EAAYA,GAAa,CAAE1D,GAAKS,IAAQ,GAAGT,GAAKS,IAAO,EAAGT,GAAKS,IAAI,MAAOT,GAAKS,IAAQ,IACvF,IAAIkD,EAAW5gB,EAAY2gB,GACvBC,aAAoBtG,GACpBC,EAAMxZ,OAAO6f,EAASrG,OAEtBA,EAAMrK,KAAK0Q,GAInBjF,SAASkF,GACL,OAAOze,KAAKmY,MAAM3Z,KAAIzB,GAAKA,EAAEwc,aAAY5B,KAAK,KAAO,KAAO8G,EAAY,IAAMze,KAAKmY,MAAMra,OAAS,IAAM,KA/InGoa,GAWF0E,WAAwC,CAC3C,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,KACN,GAAM,KAoId,IAAI8B,GAAc,WACd,IAAIC,EAAYA,CAACC,EAAgBnH,KAC7B,IAAIoH,EAAqB,IAAID,GAQzBE,EAAOA,CAAC/H,EAAYD,EAAWiI,KAC/B,IAAI7H,EARW6H,KACf,OAAQA,GACJ,KAAKnjB,EAAG,OAAO,EACf,KAAKC,EAAG,OAAO,EACf,KAAKC,EAAG,OAAO,IAITkjB,CAAYD,IACjBE,EAAIC,GAAMnI,EACf,IAAK,IAAI7X,EAAI,EAAGA,EAAI0f,EAAK9gB,OAAQoB,IAAK,CAClC,IAAKigB,EAAQC,EAAQC,GAAYT,EAAK1f,GAClCmgB,IAAaN,GAAOI,IAAWF,IAC/BJ,EAAS3f,GAAK,CAACggB,GAAKE,EAAStI,GAAKI,EAAK6H,MAInD,IAAK,IAAI7f,EAAI,EAAGA,EAAIuY,EAAKpb,IAAIyB,OAAQoB,IACjC4f,EAAKrH,EAAKpb,IAAI6C,GAAIuY,EAAKnb,IAAI4C,GAAItD,GAEnC,IAAK,IAAIsD,EAAI,EAAGA,EAAIuY,EAAKlb,IAAIuB,OAAQoB,IACjC4f,EAAKrH,EAAKlb,IAAI2C,GAAIuY,EAAKjb,IAAI0C,GAAIrD,GAEnC,IAAK,IAAIqD,EAAI,EAAGA,EAAIuY,EAAKhb,IAAIqB,OAAQoB,IACjC4f,EAAKrH,EAAKhb,IAAIyC,GAAI,EAAGpD,GAEzB,OAAO+iB,GAEPS,EAAaA,CAACvI,EAAWwI,EAAYC,IACzCzjB,EAAcgb,IAAI,EAAIwI,EAAKC,GAAM,GAC7BC,EAAaA,CAAC1I,EAAWwI,EAAYC,IACrCxjB,EAAY+a,IAAI,EAAIwI,EAAKC,GAAM,GAC/BE,EAAc3I,GAAc,CAAC1b,EAAGC,EAAGC,EAAGC,EAAGC,EAAGC,GAAGqb,GAE/C4I,EAAmBA,CAACpR,EAAiBwE,KACrC,IAAKgE,EAAGD,EAAGiI,GAAOhM,EAClB,GAAIgM,IAAQnjB,EACR,OAAO0jB,EAAW/Q,EAAK8H,GAAGU,GAAIxI,EAAK+H,GAAGS,GAAID,GACvC,GAAIiI,IAAQljB,EACf,OAAO4jB,EAAWlR,EAAKgI,GAAGQ,GAAIxI,EAAKiI,GAAGO,GAAID,GACvC,GAAIiI,IAAQjjB,EACf,OAAO4jB,EAAWnR,EAAKkI,GAAGM,IAE1B,MAAM6I,MAAM,qBAAuBb,IA8BvC5G,EAAQ0C,GAAKS,KAUb,OAAEuE,EAAM,OAAEC,EAAM,OAAEC,EAAM,OAAEC,GAJnB,CACHH,OALSlB,EAAUxhB,EAAQgb,EAAM,OAKzB2H,OAJCnB,EAAUxhB,EAAQgb,EAAS,GAIpB4H,OAHPpB,EAAUxhB,EAAQgb,EAAM,OAGT6H,OAFfrB,EAAUxhB,EAAQgb,EAAU,KA4G7C,MAAO,CACH8H,WAtGaA,CAAC1R,EAAiB2R,KAE/B,IAAI/R,EAAQ,CAACjR,EAAQ2iB,EAAQ1iB,EAAQ6iB,EAAQF,EAAQC,GACrD,OAAIG,EACO/R,EAAM3P,KAAK2hB,GAvCMC,EAAC7R,EAAiB4R,EAAmBD,IAC1DC,EAAQ3hB,KAAI6hB,IAAkB,IAAhBtJ,EAAGD,EAAGiI,GAAIsB,EAC3B,GAAItB,IAAQnjB,EACR,OAA4B,IAAxBskB,EAAK7J,GAAG9H,EAAK8H,GAAGU,IACTuI,EAAW/Q,EAAK8H,GAAGU,GAAIxI,EAAK+H,GAAGS,GAAID,GAEnC1b,EAAKklB,EACb,GAAIvB,IAAQljB,EACf,OAA4B,IAAxBqkB,EAAK3J,GAAGhI,EAAKgI,GAAGQ,IACT0I,EAAWlR,EAAKgI,GAAGQ,GAAIxI,EAAKiI,GAAGO,GAAID,GAEnC1b,EAAKklB,EACb,GAAIvB,IAAQjjB,EACf,OAAIokB,EAAKzJ,IAA8B,IAAxByJ,EAAKzJ,GAAGlI,EAAKkI,GAAGM,IACpB3b,EAAKklB,EAELZ,EAAWnR,EAAKkI,GAAGM,IAE9B,MAAM6I,MAAM,qBAAuBb,MAqBTqB,CAA0B7R,EAAM4R,EAASD,KAEhE/R,EAAM3P,KAAK2hB,GA5CDI,EAAChS,EAAiB4R,IAChCA,EAAQ3hB,KAAIvB,GAAK0iB,EAAiBpR,EAAMtR,KA2CbsjB,CAAmBhS,EAAM4R,MAiG3DK,qBAzBwBC,IACxB,IAAIC,EAAa,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAC7BC,EAAwC,CACxC,EAAKtlB,EAAG,EAAKC,EAAG,EAAKC,EAAG,EAAKC,EAAG,EAAKC,EAAG,EAAKC,GAG7CklB,EAAa,GACjB,IAAK,IAAI1hB,EAAI,EAAGA,EAAI5B,EAAUQ,OAAQoB,IAAK,CACvC,IAAI2hB,EAAYvjB,EAAU4B,GAC1B,GAAIyhB,EAAaG,eAAeD,GAAY,CACxC,IAAIjC,EAAe+B,EAAaE,GAC5BE,EAAQL,EAAW9B,GAEvBgC,GARW,SAOCH,EAAY7B,GAAMmC,IAE9BL,EAAW9B,IAAS,OAEpBgC,GAActjB,EAAU4B,GAGhC,OAAO0hB,GAOPjB,mBACAF,aACAuB,SAjGWA,CAACC,EAAqB9S,EAAoB+S,KAIrD,MAEMC,EAAyB,OAAVhT,EAAkB,CAAC/S,EAAKK,EAAGL,EAAKM,GAAK,CAACN,EAAKG,EAAGH,EAAKI,GAClE4lB,EAAmB,CAAChmB,EAAKC,KAAM8lB,GACrC,OAAOF,EAAMziB,KAAI,CAAC6iB,EAAUvO,IAJd,IAKNA,EACOuO,EAAS7iB,KAAIvB,GAAKmkB,EAAiBE,SAASrkB,GAAKA,EAAI7B,EAAKklB,IAEjExN,GAPM,EAQCuO,EAAS7iB,KAAI,CAACvB,EAAGskB,KAClBL,EAAUC,EAAcC,GAAkBE,SAASrkB,IAAMskB,EAAO,EACjEtkB,EACA7B,EAAKklB,IAEP,IAAIe,MAgFfG,QA5EWP,IAEXrhB,QAAQ6hB,IAAIR,GACZ,IAAI,EAAC1lB,EAAC,EAACC,EAAC,EAACC,EAAC,EAACC,EAAC,EAACL,GAAKD,EAClB,MAAMsmB,EAAa,CAEf,CAAC,CAACrmB,EAAG,GAAI,CAACA,EAAG,GAAI,CAACA,EAAG,GAAI,CAACA,EAAG,IAE7B,CAAC,CAACA,EAAG,GAAI,CAACA,EAAG,GAAI,CAACI,EAAG,GAAI,CAACC,EAAG,IAC7B,CAAC,CAACL,EAAG,GAAI,CAACA,EAAG,GAAI,CAACG,EAAG,GAAI,CAACD,EAAG,IAC7B,CAAC,CAACF,EAAG,GAAI,CAACA,EAAG,GAAI,CAACI,EAAG,GAAI,CAACC,EAAG,IAC7B,CAAC,CAACL,EAAG,GAAI,CAACA,EAAG,GAAI,CAACG,EAAG,GAAI,CAACD,EAAG,IAE7B,CAAC,CAACF,EAAG,GAAI,CAACA,EAAG,GAAI,CAACE,EAAG,GAAI,CAACC,EAAG,IAC7B,CAAC,CAACH,EAAG,GAAI,CAACA,EAAG,GAAI,CAACI,EAAG,GAAI,CAACC,EAAG,IAE7B,CAAC,CAACH,EAAG,GAAI,CAACA,EAAG,GAAI,CAACG,EAAG,GAAI,CAACA,EAAG,KAEjC,IAAIimB,GAAQ,EACZ,IAAK,IAAInjB,KAAOkjB,EAAY,CACxB,IAAIE,EAAc,EAClB,IAAK,IAAKllB,EAAGwC,KAAMV,EACfojB,GAAgBX,EAAMvkB,GAAGwC,KAAO9D,EAAKC,EAAK,EAAI,EAElD,GAAIumB,IAAgBpjB,EAAIV,OAAQ,CAE5B,IAAK,IAAIpB,IAAK,CAACtB,EAAKK,EAAGL,EAAKM,EAAGN,EAAKG,EAAGH,EAAKI,EAAGJ,EAAKC,GAChD,IAAK,IAAI6D,EAAI,EAAGA,GAAMxC,IAAMtB,EAAKC,EAAK,EAAI,GAAI6D,IAC1C,GAAI+hB,EAAMvkB,GAAGwC,KAAO9D,EAAKC,EAAG,CACT8C,MAAM,GAAGa,KAAK,GAAGR,KAAI,CAACuT,EAAG4G,IAAOna,EAAIma,GAAG,KAAOjc,GAAK8B,EAAIma,GAAG,KAAOzZ,IAAIoiB,UAAS,KAEzFL,EAAMvkB,GAAGwC,GAAK9D,EAAKklB,GAKnCqB,GAAQ,EACR,OAOR,OAHKA,GACDE,MAAM,yBAEHZ,GAiCP9S,MAAO,CACHjR,SAAQ2iB,SAAQC,SAAQC,SAAQ5iB,SAAQ6iB,WArMlC,GA4NlB,MAAM8B,GAAiB,CACnBzL,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAgG1C,IAAIwL,GAAW,MAwBX,SAASC,EAAIX,EAAsB3kB,GAC/B,OAAO2kB,EAAS7iB,KAAIa,IAChB,IAAK4iB,EAAGnlB,EAAGolB,GAAK7iB,EAChB,MAAO,CAAC4iB,EAAEnlB,EAAEolB,EAAExlB,MAItB,IAAI,OAAEQ,EAAM,OAAE2iB,EAAM,OAAEC,EAAM,OAAEC,EAAM,OAAE5iB,EAAM,OAAE6iB,GAAWtB,GAAYvQ,MACjEkT,EAAW,IAAKW,EAAI9kB,EAAQ7B,MAAO2mB,EAAInC,EAAQvkB,MAC5C0mB,EAAIlC,EAAQrkB,MAAOumB,EAAIjC,EAAQrkB,MAAOsmB,EAAI7kB,EAAO5B,MAAQymB,EAAIhC,EAAQxkB,IAExE2mB,EAAa,WAEb,IAAIC,EAAgBf,EAASgB,QAAOplB,GAAKA,EAAE,KAAOtB,EAAIE,IAClDymB,EAAkBjB,EAASgB,QAAOplB,GAAKA,EAAE,KAAOtB,EAAIC,IAEpD2mB,EAAgCpkB,MAAM,IAAIa,KAAK,GAAGR,KAAIuT,GAAK5T,MAAM,KACrEikB,EAAc5jB,KAAIvB,GAAKslB,EAAYtlB,EAAE,IAAI6Q,KAAK7Q,KAE9C,IAAIulB,EAAgCrkB,MAAM,GAAGa,KAAK,GAAGR,KAAIuT,GAAK5T,MAAM,KACpEmkB,EAAgB9jB,KAAIvB,GAAKulB,EAAYvlB,EAAE,IAAI6Q,KAAK7Q,KAEhD,MAAMwlB,EAAkC,GACxC,IAAK,IAAIzlB,EAAI,EAAGA,EAAI,GAAIA,IACpB,IAAK,IAAIklB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIQ,EAAMH,EAAYvlB,GAClB2lB,EAAMH,EAAYN,GAElBU,EAAQ,EACZF,EAAI5O,SAAU9W,IACV2lB,EAAI7O,SAAUoO,IAAYllB,EAAE,KAAOklB,EAAE,IAAIU,UAE/B,IAAVA,GACAH,EAAW3U,KAAM,CAAC9Q,EAAGklB,IAMjC,IAAIW,EAAYA,CAACtU,EAAiBtR,IACvByhB,GAAYiB,iBAAiBpR,EAAM,CAACtR,EAAE,GAAIA,EAAE,GAAIA,EAAE,KAoB7D,OAlBYsR,IAER,IAAIuU,EAAsC,GAE1C,IAAK,IAAKvM,EAAIF,KAAOoM,EAAY,CAC7B,IAAIC,EAAMH,EAAYhM,GAClBoM,EAAMH,EAAYnM,GAClBlX,EAAM,EACVujB,EAAI5O,SAAU9W,IACV,MAAMklB,EAAIS,EAAIN,QAASH,GAAMllB,EAAE,KAAOklB,EAAE,KAAI,GACxCW,EAAUtU,EAAMvR,KAAO6lB,EAAUtU,EAAM2T,IAAI/iB,OAEvC,IAARA,GACA2jB,EAAgBhV,KAAK,CAACyI,EAAIF,IAGlC,OAAOyM,GA/CE,GA4EjB,MAAMC,EAAY,CAAC,GAAIlI,GAAKS,IAAO,EAAGT,GAAKS,IAAI,MAAOT,GAAKS,IAAQ,IAC7D0H,EAAa,CAAC,GAAInI,GAAKS,IAAQ,IAMrC,MAAM2H,EAAO,CAAC,GAAI,IAAK,KAAM,KAAM,KAAM,MAAO,OAAQ,OACpD,IAAK,KAAM,MAAO,MAAO,KAAM,MAAO,OAAQ,OAC9C,IAAK,KAAM,MAAO,MAAO,KAAM,MAAO,OAAQ,QAClD,IAUIC,EAAuBC,IAA0C,IAAzC,GAAE7M,EAAE,GAAEE,EAAE,GAAEH,EAAE,GAAEE,GAAU4M,EAChD7M,EAAKA,GAAMD,EACXG,EAAKA,GAAMD,EAEX,IAkCI6M,EAASC,EAASC,EAlClBC,EAAaA,CAACC,EAAoBzE,KAClC,IAEI0E,EAFA7L,EAAMzZ,MAAMqlB,EAAS1lB,QAAQkB,KAAK,GAClCkY,EAAO6H,IAAQnjB,EAAK,EAAI,EAE5B,EAAG,CACC6nB,EAAM,EACN,IAAK,IAAIvkB,KAAKskB,EACU,IAAhBA,EAAStkB,KACT0Y,EAAI1Y,GAAK3B,EAAS2Z,GAClBuM,GAAO7L,EAAI1Y,UAGdukB,EAAMvM,EAAM,GACrB,OAAOU,GAEP8L,EAAeC,IACf,IAAI7kB,EAAiBX,MAAMwlB,EAAU7lB,QAAQkB,KAAK,GAC9C4kB,EAAsB,GAC1B,IAAK,IAAI1kB,EAAI,EAAGA,EAAIykB,EAAU7lB,OAAQoB,IACb,IAAjBykB,EAAUzkB,GACV0kB,EAAU9V,KAAK5O,GAEfJ,EAAKI,GAAKA,GH5/BX,SAAYrB,GAC3B,IAAK,IAAIqB,EAAI,EAAGtC,EAAIiB,EAAIC,OAAQoB,EAAItC,EAAI,EAAGsC,IAAK,CAC5C,IAAIyZ,EAAIhb,EAAUuB,EAAGtC,EAAI,GACrBinB,EAAMhmB,EAAIqB,GACdrB,EAAIqB,GAAKrB,EAAI8a,GACb9a,EAAI8a,GAAKkL,GG0/BLC,CAAaF,GACb,IAAK,IAAI1kB,EAAI,EAAGC,EAAM,EAAGD,EAAIykB,EAAU7lB,OAAQoB,IACtB,IAAjBykB,EAAUzkB,KACVJ,EAAKI,GAAK0kB,EAAUzkB,GACpBA,GAAO,GAGf,OAAOL,GAGX,IACKskB,EAASC,GAAW,CAACK,EAAYrN,GAAKqN,EAAYnN,IACnD+M,EAAOzkB,EAAUukB,GAAWvkB,EAAUwkB,GAAY,QAC7CC,EAAM,GAEf,OAAO,IAAIvN,GAAU,CACjBO,GAAIiN,EAAWjN,EAAI1a,GACnBya,GAAI+M,EACJ5M,GAAI+M,EAAW/M,EAAI3a,GACnB0a,GAAI8M,KAWZ,MAAO,CACHU,eA7EkBxV,GA3BAyV,EAACzV,EAAe0V,EAA4BC,KAAgC,IAA1D,GAAE5N,EAAE,GAAEE,EAAE,GAAEH,EAAE,GAAEE,GAAU0N,EAE5D3N,EAAKA,GAAMD,EACXG,EAAKA,GAAMD,EACX,IAAK,IAAIkB,KAAQyM,EAAS,CACtB,IAAIC,EAAQ5V,EAAKyJ,MAAMP,GACnB2M,GAAS,EACb,IAAK,IAAIllB,EAAI,EAAGA,EAAI,GAAKklB,EAAQllB,KACxBoX,EAAGpX,IAAsB,IAAhBilB,EAAM7N,GAAGpX,IACfmX,EAAGnX,IAAMilB,EAAM9N,GAAGnX,KAAOA,KAC7BklB,GAAS,GAGjB,IAAK,IAAIllB,EAAI,EAAGA,EAAI,IAAMklB,EAAQllB,KACzBsX,EAAGtX,IAAsB,IAAhBilB,EAAM3N,GAAGtX,IACfqX,EAAGrX,IAAMilB,EAAM5N,GAAGrX,KAAOA,KAC7BklB,GAAS,GAGjB,GAAIA,EAAQ,OAAO,EAEvB,OAAO,GAOAJ,CAAgBzV,EAAMuT,GAAUiB,GA6EvCsB,UAvLYA,CAAC9V,EAAiB2R,KAC9B,IAAK5J,GAAIgO,EAAG,GAAEjO,EAAIG,GAAI+N,EAAG,GAAEhO,EAAIE,GAAI+N,GAAOtE,EACtC5J,EAAKgO,GAAOjO,EACZG,EAAK+N,GAAOhO,EACZE,EAAK+N,GAAOrmB,MAAM,GAAGa,KAAK,GAG9B,QAFasX,EAAGmO,OAAO,CAAC1S,EAAG7S,KAAkB,IAAVmX,EAAGnX,IAAYqP,EAAK8H,GAAGnX,KAAOA,KACnC,IAAVoX,EAAGpX,IAA2B,IAAfqP,EAAK+H,GAAGpX,UAE9BsX,EAAGiO,OAAO,CAAC1S,EAAG7S,KAAkB,IAAVqX,EAAGrX,IAAYqP,EAAKgI,GAAGrX,KAAOA,KACnD,IAAVsX,EAAGtX,IAA2B,IAAfqP,EAAKiI,GAAGtX,OAEduX,EAAGgO,OAAO,CAAC1S,EAAG7S,IAAkB,IAAVuX,EAAGvX,IAAYqP,EAAKkI,GAAGvX,KAAOA,MA6KjEwlB,eAViBA,IACNxB,EAAqBpB,IACpB9J,MAAMpa,EAAYolB,IAS9BE,uBACAyB,eAlMkBpW,IAClB,IAAIqW,EAAK,IAAI7O,GACb,OAAOzW,EAAWiP,EAAK+H,GAAIsO,EAAGtO,KACvBhX,EAAWiP,EAAKiI,GAAIoO,EAAGpO,KACvBlX,EAAWiP,EAAK8H,GAAIuO,EAAGvO,KACvB/W,EAAWiP,EAAKgI,GAAIqO,EAAGrO,KA8L9B4L,aACAd,WACAwD,eA7EiBA,CAACtW,EAAiBgI,KACnC,IAAK,IAAIqB,KAAOqL,EAAM,CAClB,MAAM6B,EAAevW,EAAKyJ,MAAMJ,GAChC,GAAKkN,EAAavO,GAAGA,KAAQA,EACzB,MAAO,CAACuO,EAAclN,GAG9B,MAAO,CAACrJ,EAAM,OAhIP,GAyNR,MAAMwW,WAfN,MAAuBhY,cAAA,KACjBzS,UAAI,EAIb0qB,OACI3Z,OAAO4Z,aAAaC,QAAQllB,KAAK1F,KAAM0F,KAAKoW,aAEhD+O,OACI,MAAMC,EAAO/Z,OAAO4Z,aAAaI,QAAQrlB,KAAK1F,MAC1C8qB,EAAMplB,KAAKgW,YAAYoP,GACtBplB,KAAKslB,gBAoDdvY,YAAYwY,GACRC,QAAQ,KApCZlrB,KAAO,cAAc,KACrBmrB,OAAgC,GAoCvBF,GACDvlB,KAAKmlB,OAGbO,cACI,MAAO,UAAU5H,MAAM,IAAItf,KAAIa,GAAKW,KAAKylB,OAAOpmB,KAEpD0G,IAAK0f,GACD,IAAIE,EAAY,IAAIZ,IAAY,GAOhC,OANI5mB,MAAM8Z,QAAQwN,GACdA,EAAO3R,SAAS,CAACxC,EAAOpS,IAAMymB,EAAUF,OAAO,UAAUvmB,IAAMoS,IAE/DqU,EAAUF,OAAS,IAAIzlB,KAAKylB,UAAWA,GAE3CE,EAAUX,OACHW,EAEXC,iBACI,IAAID,EAAY,IAAIZ,IAAY,GAGhC,OAFAY,EAAUL,cACVK,EAAUX,OACHW,EAEXL,cAAgBtlB,KAAKylB,OAASV,GAAYc,eAC1CzP,YACI,OAAOF,KAAKQ,UAAU1W,KAAKylB,QAE/BzP,YAAY/Y,GACR+C,KAAKylB,OAASvP,KAAKC,MAAMlZ,GAE7B6oB,gBAAgB7oB,GACZ,IAAIkR,GAAS4W,GAAYgB,kBAAkBrM,IAAIzc,IAAM8nB,GAAYgB,kBAAkBrM,IAAI,OAAS,IAC5F7b,EAAiB,GACrB,IAAK,IAAIqB,EAAI,EAAGA,EAAIiP,EAAMrQ,OAAQoB,IAC9BrB,EAAIiQ,KAAK9N,KAAKylB,OAAOtX,EAAMjP,KAE/B,OAAOrB,GAtFFknB,GAIFc,eAAiB,CACpB,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,UACL,EAAK,WAXAd,GAiBFiB,cAAgB,CACnB,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SAEA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SAEA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,UA3CKjB,GA6CFgB,kBACI,IAAIzM,IAAIyL,GAAYiB,cAAcxnB,KAAIa,GAAK,CAAEA,EAAE,GAAKA,EAAE,GAAIA,MA4CzE,IAAI4mB,GAAO,CACPnE,YAAUoE,aA3Xa,CACvB7P,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAwXI0P,cArXA,CACxB9P,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAkXmB2P,UA9VnB,CACpB/P,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IA2V8B4P,QA/WhC,CAClBhQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IA4WuC6P,SAzWxC,CACnBjQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAsWiD8P,QA/TlD,CACnBlQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IA4T0D+P,UA1TzD,CACrBnQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAuTqEgQ,cAzVjE,CACxBpQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAsVoFiQ,aApVjF,CACvBrQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAkVpBkQ,gBAhV0B,CAC1BtQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IA6UHmQ,eA3UQ,CACzBvQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAwUaoQ,eAtUR,CACzBxQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAmU6BqQ,WAxY3B,CACtBzQ,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAsYuBwQ,eApYnC,CAC1B1Q,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAkYuCyQ,eAhYnD,CAC1B3Q,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IA8XuD0Q,YA5YtE,CACvB5Q,GAAI,CAAC,EAAG,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,GAC3BE,GAAG,CAAC,EAAG,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IA0YoE2Q,cApWlF,CACxB7Q,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAiWqG0Q,YAlZnG,CACtB9Q,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1BE,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACtCC,GAAI,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAgZtC7S,KAlaJ,SAAoB5G,GAChB,MAAO,CACHuZ,GAAIvZ,EAAEuZ,IAAM,IAAIvZ,EAAEuZ,IAClBE,GAAIzZ,EAAEyZ,IAAM,IAAIzZ,EAAEyZ,IAClBC,GAAI1Z,EAAE0Z,IAAM,IAAI1Z,EAAE0Z,IAClBJ,GAAI,IAAItZ,EAAEsZ,IACVE,GAAI,IAAIxZ,EAAEwZ,O,8GCvuBlB,MAAM6Q,GAAYC,aAAWxY,IAAK,CAC9ByY,UAAW,CACTC,WAAY1Y,EAAM2Y,QAAQ,GAC1BC,cAAe5Y,EAAM2Y,QAAQ,GAC7BE,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,SAE5Cvc,OAAQ,CACNmD,MAAO,QAETqZ,MAAO,CACLC,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,UAEjBC,YAAa,CACXJ,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,UAEjBE,WAAY,CACV9W,MAAOzC,EAAM8Y,QAAQC,WAAWE,OAElCO,eAAgB,CACdC,YAAazZ,EAAM2Y,QAAQ,IAE7Be,WAAY,CAEV,CAAC1Z,EAAMoG,YAAYzQ,GAAG,OAAQ,CAC5BgkB,UAAW,MAGfC,YAAa,CACX/Z,OAAQ,KAEVga,MAAQ,CACJC,SAAU,GAEdC,OAAQ,CACNtX,MAAOzC,EAAM8Y,QAAQkB,KAAKC,SAE5BC,YAAa,CACXzX,MAAOzC,EAAM8Y,QAAQkB,KAAKG,eAiBhC,MAAMC,GAAcC,aAAOC,KAAPD,CAAe,CACjC,yBAA0B,CACxBE,SAAU,UAId,SAASC,GAAW5U,GAElB,IAAI,OAAE6U,GAAW7U,EACb8U,EAAUnC,KAMFkC,EAAOE,MAAnB,IACIC,EAAQ9U,IAAMxa,SAAQ,KACxB,IAAI8b,EAAM,CAAC,CAACW,MAAO0S,EAAO1sB,EAAI,EAAG4sB,MAAO,QACxC,IAAK,IAAItqB,EAAIoqB,EAAO1sB,EAAGsC,GAAKoqB,EAAO3sB,EAAGuC,IAAK,CACzC,IAAIwqB,EAAS,GACTxqB,IAAMoqB,EAAO1sB,GAAK0sB,EAAOK,WAAUD,EAAS,KAC5CxqB,IAAMoqB,EAAO3sB,GAAK2sB,EAAOM,WAAUF,EAAS,KAChDzT,EAAInI,KAAK,CAAC8I,MAAO1X,EAAGsqB,MAAOtqB,EAAEqa,WAAamQ,IAE5C,OAAOzT,IACN,CAACqT,EAAO1sB,EAAG0sB,EAAO3sB,EAAG2sB,EAAOK,SAAUL,EAAOM,WAChD,OACAC,gBAACC,IAAG,CAAAC,SAAA,CACFpU,eAACqU,KAAS,CAACC,UAAU,SAASC,UAAWX,EAAQR,YAAYgB,SAAE,UAC/DpU,eAACmU,IAAG,CAACK,SAAU,EAAEJ,SACfpU,eAACsT,GAAW,CACZQ,MAAOA,EACPW,OAAO,EACPjlB,IAAKmkB,EAAO1sB,EAAI,EAChBwI,IAAKkkB,EAAO3sB,EACZia,MAAO0S,EAAO1S,MACdyT,SA1BiBC,CAACvY,EAAQwY,KAC1B,IAAIjiB,EAAInK,MAAM8Z,QAAQsS,GAAYA,EAAS,GAAKA,EAC3CjB,EAAO1sB,EAAI,GAAI0L,GAAKA,GAAKghB,EAAO3sB,GACnC8X,EAAM4V,SAAS/hB,IAwBjBkiB,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAC7B7U,MAAO,CAACuT,SAAU,iBAMxB,SAASuB,GAAalW,GAElB,IAAImW,EAAanW,EAAMmU,OACnBiC,EAAapW,EAAMxQ,MAAMuK,OAAeoc,GAC5C,OAAOjV,eAAC0T,GAAU,CAChBC,OAAS7U,EAAMxQ,MAAMuK,OAAeoc,GACpCP,SAAW/L,IACT7J,EAAMqW,SAAU,CAAEvwB,KAAM,SACvBwwB,QAAS,CAAE,CAACH,GAAc,IAAIC,EAAWjU,MAAM0H,SAOxD,SAAS0M,GAAavW,GAEpB,IAAI,MAAExQ,EAAK,SAAE6mB,EAAQ,OAAElC,GAAWnU,GAC9B,OAAEjG,GAAWvK,EACbgnB,EAAOzc,EAAeoa,GACtBW,EAAUnC,KAed,IAAI8D,EAAa,WACf,IAAI,MAAEC,EAAK,MAAEC,GAAUH,EACvB,IAAK,IAAI/rB,EAAI,EAAGA,EAAIksB,EAAMttB,OAAQoB,IAChC,GAAiB,IAAbksB,EAAMlsB,GAAU,OAAOisB,EAAMjsB,GAEnC,MAAO,GALQ,GASbsqB,EAAQyB,EAAIzB,OAAS/U,EAAM+U,OAAS,GACxC,OACAK,gBAACwB,KAAW,CAACpB,UAAU,WAAWC,UAAWX,EAAQX,OAAOmB,SAAA,CAC1DpU,eAACqU,KAAS,CAACC,UAAU,SAASC,UAAWX,EAAQR,YAAYgB,SAC1DP,IAOH7T,eAAC2V,KAAU,CAAC,aAAW,WAAWhxB,KAAK,WAAWsc,MAAOsU,EAAYb,SAjCjDI,IACpB,IAAI,MAAEU,GAAUF,EACZ3M,EAAI6M,EAAMrtB,OACVytB,EAAYptB,MAAMmgB,GAAGtf,KAAK,GAE9B,IAAK,IAAIE,EAAI,EAAGA,EAAIisB,EAAMrtB,OAAQoB,IAC5BisB,EAAMjsB,KAAOurB,EAAIvqB,OAAO0W,QAC1B2U,EAAUrsB,GAAK,GAGnB4rB,EAAU,CAAEvwB,KAAM,SAAUwwB,QAAS,CAAC,CAACnC,GAASqC,EAAIO,SAASD,OAuBgCE,KAAG,EAAA1B,SAE5FkB,EAAIE,MAAM3sB,KAAIlE,GACZqb,eAAC+V,KAAgB,CAEf9U,MAAOtc,EACPqxB,QAAShW,eAACiW,KAAK,CAACta,MAAM,YACtBkY,MAAOlvB,EACPuxB,eAAe,OAJVvxB,UAoBjB,SAASwxB,GAAmBrX,GAC1B,IAAI,MAAExQ,EAAK,SAAE6mB,EAAQ,OAAElC,EAAM,QAAEmD,GAAYtX,EAC3CsX,EAAUA,GAAW,GACrB,IAAI,OAAEvd,GAAWvK,EAEbgnB,EAAOzc,EAAeoa,GAC1B,MAAM0B,EAAgBG,IACpB,IAAI,MAAEU,EAAK,MAAEC,GAAUH,EACnBM,EAAY,IAAIH,GAEpB,IAAK,IAAIlsB,EAAI,EAAGA,EAAIisB,EAAMrtB,OAAQoB,IAC5BisB,EAAMjsB,KAAOurB,EAAIvqB,OAAO0W,QAC1B2U,EAAUrsB,GAAMurB,EAAIvqB,OAAO8rB,QAAU,EAAI,GAG7ClB,EAAU,CAAEvwB,KAAM,SAAUwwB,QAAS,CAAC,CAACnC,GAASqC,EAAIO,SAASD,OAe/D,MAAOU,EAAcC,GAAmBvX,IAAM9a,SAA0C,IACxF,IAAI2vB,EAAQyB,EAAIzB,OAASuC,EAAQvC,OAAS,GAuBtC2C,EAAkBJ,EAAQK,aAC3BzW,eAAC0W,KAAS,CAACZ,KAAG,EAAA1B,SACdgC,EAAQK,aAAa5tB,KAAIa,GAxBLitB,KACrB,IAAI,KAAChyB,EAAI,UAAEiyB,GAAaD,EAWxB,OACE3W,eAAC+V,KAAgB,CACjBC,QACAhW,eAAC6W,KAAQ,CAAClb,MAAM,UAAU0a,QAASC,EAAa3xB,GAAO+vB,SAbrCI,IAClByB,EAAiB,IAAID,EAAc,CAAC3xB,GAAQmwB,EAAIvqB,OAAO8rB,UACvD,IAAIS,EAAahC,EAAIvqB,OAAO8rB,SACxB,MAAEZ,GAAUH,EACZM,EAAY,IAAIH,GACpB,IAAK,IAAIlsB,KAAKqtB,EACZhB,EAAUrsB,GAAKutB,EAAY,EAAI,EAEjC3B,EAAU,CAAEvwB,KAAM,SAAUwwB,QAAS,CAAC,CAACnC,GAASqC,EAAIO,SAASD,SAO7D/B,MAAOlvB,EAEPsc,MAAOtc,GADFA,IAMwBoyB,CAAgBrtB,OAC/B,KASlB,MAAO,CAACmqB,QAAOuB,QAPblB,gBAAClV,IAAMgY,SAAQ,CAAA5C,SAAA,CACZoC,EACDxW,eAAC0W,KAAS,CAACZ,KAAG,EAAA1B,SACbkB,EAAIE,MAAM3sB,KAAK,CAAClE,EAAM4E,IA5Cb0tB,EAACtyB,EAAc0xB,IAE3BrW,eAAC+V,KAAgB,CACbC,QACAhW,eAAC6W,KAAQ,CAAClb,MAAM,UAAU0a,QAASA,EAAS3B,SAAUC,IAEtDd,MAAOlvB,EAEPsc,MAAOtc,GADFA,GAqCsBsyB,CAAQtyB,IAAQ2wB,EAAIG,MAAMlsB,YAO7D,SAAS2tB,GAAYpY,GACnB,IAAI,MAAExQ,EAAK,SAAE6mB,EAAQ,OAAElC,EAAM,QAAEmD,GAAYtX,GACvC,MAAC+U,EAAK,QAAEuB,GAAWe,GAAmB,CAAC7nB,QAAO6mB,WAAUlC,SAAQmD,YACpEA,EAAUA,GAAW,GAErB,MAAOe,EAAMC,GAAWpY,IAAM9a,UAAS,GAIjCmzB,EAAcA,KAClBD,GAAQ,IAEV,IAAIxD,EAAUnC,KAEd,OAAI2E,EAAQkB,SAEVpD,gBAACwB,KAAW,CAACpB,UAAU,WAAWC,UAAWX,EAAQX,OAAOmB,SAAA,CAC1DpU,eAACqU,KAAS,CAACC,UAAU,SAAQC,UAAWX,EAAQR,YAAYgB,SAAGP,IAC9DuB,KAKLlB,gBAACC,IAAG,CAAAC,SAAA,CACFpU,eAACqU,KAAS,CAACC,UAAU,SAAQF,SAAEP,IAC/B7T,eAACmU,IAAG,CAACpb,OAAQ,IACbmb,gBAACqD,IAAM,CAAC5b,MAAM,UAAU6b,QAAQ,WAAWtX,MAAO,CAACuX,YAAa,GAAIC,QApB9CC,KACtBP,GAAQ,IAmBqFhD,SAAA,CAC7FpU,eAAC4X,KAAY,CAACnE,SAAS,QAAQ9X,MAAM,UAAUuE,MAAO,CAAC2X,YAAa,EAAGC,YAAa,KAAmB,UAGvG9X,eAACmU,IAAG,CAACpb,OAAQ,IACbmb,gBAAC6D,IAAM,CAACC,sBAAoB,EAACb,KAAMA,EAAMc,QAASZ,EAAYjD,SAAA,CAC5DF,gBAACgE,KAAW,CAAA9D,SAAA,CAAC,IAAEP,EAAM,OACrB7T,eAACmY,IAAa,CAAA/D,SACXgB,IAEHpV,eAACoY,IAAa,CAAAhE,SACVpU,eAACuX,IAAM,CAACG,QAASL,EAAa1b,MAAM,UAASyY,SAAC,e,cC7SjD,SAASiE,GAAYvZ,GACxB,MAAOoU,EAAMoF,GAAWtZ,IAAM9a,SAAS4a,EAAMxQ,MAAM0K,YAAY+W,cAAc/N,KAAK,MASlF,OACIkS,gBAAC8C,WAAQ,CAAA5C,SAAA,CACTpU,eAACmU,IAAG,CAAAC,SACJpU,eAACuY,KAAS,CACN1E,MAAM,QACN2E,WAAW,mBACX9D,SAdcrgB,GAAeikB,EAAQjkB,EAAM9J,OAAO0W,OAelDwX,WAAS,EACTxX,MAAOiS,MAGXlT,eAACmU,IAAG,CAAAC,SACJpU,eAACuX,IAAM,CAACC,QAAQ,WAAWkB,KAAK,SAAS/c,MAAM,UAAU+b,QAnBzCiB,KAChB,IAAIzwB,EAAMgrB,EAAK/K,MAAM,KACrBrJ,EAAMqW,SAAS,CACXvwB,KAAM,cACNwwB,QAAwB,IAAfltB,EAAIC,OAAcD,EAAMknB,GAAYc,kBAe6BkE,SAAE,mBAQjF,SAASwE,GAAW9Z,GACvB,IAAI,MAAExQ,EAAK,SAAE6mB,GAAarW,GAEtB,QAACsW,GAAWe,GAAmB,CAAC7nB,QAAO6mB,WAAUlC,OADxC,wBAGb,MAAOkE,EAAMC,GAAWpY,IAAM9a,UAAS,GAQvC,OACIgwB,gBAAA,OAAAE,SAAA,CACApU,eAACqU,KAAS,CAACC,UAAU,SAAQF,SAAC,iCAC9BpU,eAACmU,IAAG,CAACpb,OAAQ,IACbmb,gBAACqD,IAAM,CAAC5b,MAAM,UAAU6b,QAAQ,WAAWtX,MAAO,CAACuX,YAAa,GAAIC,QAXhDC,KACtBP,GAAQ,IAUuFhD,SAAA,CAC7FpU,eAAC4X,KAAY,CAACnE,SAAS,QAAQ9X,MAAM,UAAUuE,MAAO,CAAC2X,YAAa,EAAGC,YAAa,KAAmB,UAGvG9X,eAACmU,IAAG,CAACpb,OAAQ,IACbmb,gBAAC6D,IAAM,CAACC,sBAAoB,EAACb,KAAMA,EAAMc,QAbzBZ,CAAChwB,EAAQwxB,KACZ,kBAAXA,GACFzB,GAAQ,IAWsDhD,SAAA,CAC5DpU,eAACkY,KAAW,CAAA9D,SAAC,8CACbF,gBAACiE,IAAa,CAAA/D,SAAA,CACXgB,EACDpV,eAACmU,IAAG,CAACpb,OAAQ,KACTiH,eAAC8Y,KAAO,IACZ9Y,eAACmU,IAAG,CAACpb,OAAQ,KACbiH,eAACqY,GAAW,CAAM/pB,QAAO6mB,gBAG3BnV,eAACoY,IAAa,CAAAhE,SACVpU,eAACuX,IAAM,CAACG,QAASA,IAAMN,GAAQ,GAAQzb,MAAM,UAASyY,SAAC,kB,cCvCtD2E,OAnCf,SAAwBja,GACtB,MAAMC,EAAQC,IAAMC,OAA8B,MA8BlD,OA7BA/Z,qBAAW,KACT,IAAIqa,EAAMR,EAAMc,QAChB,GAAIN,EAAK,CACP,MAAMyZ,EAAO,CACXlgB,MAAOgG,EAAM4Z,KACd3f,OAAQ+F,EAAM4Z,KACbO,KAAM,OACPC,UAAW,IAAI3W,GAAQzD,EAAMqa,KAAK1T,MAAM7B,WACvC2G,KAAMzL,EAAMyL,QACTzL,EAAMsa,aAELzd,EAAQmD,EAAMnD,MAChBA,IAEFqd,EAAKhgB,YAAc,CACjB2C,EAAM,GACNA,EAAM,GACNA,EAAM,GACNA,EAAM,GACNA,EAAM,GACNA,EAAM,KAGV0d,WAAqB9Z,EAAKyZ,GAE5B,MAAO,KACDzZ,IAAKA,EAAI+Z,UAAY,QAGrBtZ,eAAA,OAAKC,IAAKlB,KC1BpB,MAAMwa,GAAiB,CACrBd,WAAW,G,qFCRb,MAAMe,GAAa,CACjBA,WAAY,CACVC,UAAW,CACTC,eAAgB,CACdC,KAAM,CACJ5gB,OAAQ,KAEV0b,MAAO,CACL1b,OAAQ,SAOZG,GAAQ0gB,aAAYC,aAAa,CACrCl1B,KAAM,SACNqtB,QAAS,CACPmB,QAAS,CACP2G,KAAM,WAERzG,UAAW,CACTyG,KAAM,WAER1vB,MAAO,CACL0vB,KAAMC,KAAIC,MAEZ/H,WAAY,CACVC,QAAS,UACTC,MAAO,QAETe,KAAM,CACJC,QAAS,OACTE,UAAW,OACX4G,SAAU,eAGXT,MAYCU,GAAYN,aAAYC,aAAa,CACzCl1B,KAAM,OACNqtB,QAAS,CACPmB,QAAS,CACP2G,KAAM,WAERzG,UAAW,CACTyG,KAAM,WAER1vB,MAAO,CACL0vB,KAAMC,KAAIC,MAEZ/H,WAAY,CACVC,QAAS,UACTC,MAAO,WAETe,KAAM,CACJC,QAAS,OACTE,UAAW,OACX4G,SAAU,SAGdE,UAAW,CAETC,WAAY,CAGVT,KAAM,CACJ5H,gBAAiB,iCAIpByH,MCnDL,MAAM/H,GAAYC,aAAWxY,IAEnB,CACNmhB,UAAW,CACTtI,gBAH2C,YAA/B7Y,EAAM8Y,QAAQmB,QAAQ2G,KAGL,UAAY5gB,EAAM8Y,QAAQmB,QAAQ2G,MAEjEQ,SAAU,OFzBKC,IACjBC,GAAmCpE,GE2GtBqE,IF3GbD,GE6BF,SAA2B1b,GACzB,IAAI,SAAE4b,EAAQ,OAAEC,EAAM,KAAEC,EAAI,cAAEC,GAAkB/b,EAAMgc,SACtD,MAAMxF,EAAOxW,EAAMxQ,MAAMuK,OAAe6hB,GAClCK,EAxBR,SAA4BH,EAA0BD,EAAkBlF,GACtE,MAAMsF,EAA4D9jB,OAAO2N,YAAY+V,EAAO9xB,KAAIuV,GAAK,CAACA,EAAG,OAMzG,OALAwc,EAAKzc,SAAQ,CAACgb,EAAK5vB,KACjB,MAAMyxB,EAAS7B,EAAI,GAAGhR,MAAM,IAAK,GAAG,GAChC6S,KAAUD,GACZA,EAAUC,GAAQ7iB,KAAK,CAACghB,EAAK5vB,OAE1BwxB,EAiBWE,CAAmBL,EAAMD,EAAQrF,EAAIG,OACjDyF,EAAoBA,CAACC,EAAmBla,IAAkB,KAC9D,MAAMma,EAAW,IAAI9F,EAAIG,OACzBsF,EAAUI,GAAWhd,SAAS0G,IAAe,IAAbsU,EAAK5vB,GAAEsb,EACrCuW,EAAS7xB,GAAK0X,KAEhBnC,EAAMqW,SAAS,CAAEvwB,KAAM,SAAUwwB,QAAS,CAAC,CAACsF,GAAWpF,EAAIO,SAASuF,OAOhEC,EAAmBpa,GAAkB,KACzC,MAAMma,EAAW5yB,MAAM8sB,EAAIG,MAAMttB,QAAQkB,KAAK4X,GAC9CnC,EAAMqW,SAAS,CAAEvwB,KAAM,SAAUwwB,QAAS,CAAC,CAACsF,GAAWpF,EAAIO,SAASuF,OAEhExH,EAAUnC,KACV6J,EAAQlc,aAAclG,GAAMoG,YAAYzQ,GAAG,OACjD,OACEqlB,gBAACC,IAAG,CAAC9B,QAAQ,OAAOE,cAAc,SAASuF,YAAa,GAAG1D,SAAA,CACzDpU,eAACmU,IAAG,CAACoH,aAAc,EAAEnH,SACnBF,gBAACsH,KAAW,CAAC7f,MAAM,UAAUuE,MAAO,CAACnH,OAAQ,QAAQqb,SAAA,CACnDpU,eAACuX,IAAM,CAACG,QAAS2D,EAAgB,GAC/BI,UAAWzb,eAAC0b,KAAe,IAAGtH,SAAC,eACjCpU,eAACuX,IAAM,CAACG,QAAS2D,EAAgB,GAC/BI,UAAWzb,eAAC2b,KAAU,IAAGvH,SAAC,sBAG/BuG,EAAO9xB,KAAI,CAACsyB,EAAW5xB,IACtB2qB,gBAACC,IAAG,CAAC9B,QAAQ,OAAOE,cAAe+I,EAAQ,MAAQ,SAAkB/G,UAAWX,EAAQ0G,SAAUiB,aAAc,EAAEnH,SAAA,CAChHF,gBAACC,IAAG,CAAC9B,QAAQ,OAAOE,cAAe+I,EAAQ,SAAW,MAAOxD,YAAa,EAAE1D,SAAA,CAE1EpU,eAACmU,IAAG,CAAC2D,YAAa,EAAE1D,SACpBpU,eAAC4b,IAAU,CAACpE,QAAQ,KAAKqE,cAAY,EAAAzH,SAClC+G,EAAU,GAAGW,cAAgBX,EAAUY,OAAO,OAGjD/b,eAACmU,IAAG,CAAC9B,QAAQ,OAAO2J,WAAW,SAAQ5H,SACrCF,gBAACsH,KAAW,CAAC7f,MAAM,UAAU6b,QAAQ,YAAY,aAAW,gCAAgCtX,MAAO,CAACnH,OAAQ,UAAUqb,SAAA,CACpHpU,eAACuX,IAAM,CAACG,QAASwD,EAAkBC,EAAW,GAC5CM,UAAWzb,eAAC0b,KAAe,MAC7B1b,eAACuX,IAAM,CAAEC,QAAQ,WAAWE,QAASwD,EAAkBC,EAAW,GAChEM,UAAWzb,eAAC2b,KAAU,cAI9B3b,eAACmU,IAAG,CAAC9B,QAAQ,OAAOE,cAAc,MAAM0J,SAAS,OAAM7H,SAErD2G,EAAUI,GAAWtyB,KAAK6hB,IAAA,KAAG/lB,EAAMw0B,GAAMhc,GAAIuN,EAAA,OAC3C1K,eAACmU,IAAG,CAAC+H,OAAQ,EAAGC,YAAY,eAE1BzE,SA5CY0E,EA4Ccjf,EA5CM,KAC5C,MAAMie,EAAW,IAAI9F,EAAIG,OACzB2F,EAASgB,GAAkC,IAAtBhB,EAASgB,GAAkB,EAAI,EACpDtd,EAAMqW,SAAS,CAAEvwB,KAAM,SAAUwwB,QAAS,CAAC,CAACsF,GAAWpF,EAAIO,SAASuF,QA0CxDlb,MAAO,CAACmc,WAAY,gBACpB9H,UAAWe,EAAIG,MAAMtY,GAAOyW,EAAQyG,UAAY,GAAGjG,SACnDpU,eAAC+Y,GAAc,CACbp0B,KAAMA,EACN+zB,KAAM,IACNS,IAAKA,EACL5O,KAAMsQ,EACNzB,YAAata,EAAMgc,SAAS1B,aAAe,MATxCz0B,GA3COy3B,WA0DlBpc,eAAC8Y,KAAO,MApCwDvvB,SF7DpE,SAAoBuV,GACxBsX,GAAUA,IAAWmD,GACrB,MAAMxG,EAAQjU,EAAMiU,OAASjU,EAAM+U,OAC5BsD,EAAMC,GAAWpY,IAAM9a,UAAS,GAIjCmzB,EAAcA,KAClBD,GAAQ,IAGV,OACAlD,gBAACC,IAAG,CAAAC,SAAA,CACFpU,eAACqU,KAAS,CAACC,UAAU,SAAQF,SAAEtV,EAAM+U,QACrC7T,eAACmU,IAAG,CAACpb,OAAQ,IACbmb,gBAACqD,IAAM,CAAC5b,MAAM,UAAU6b,QAAQ,WAAWtX,MAAO,CAACuX,YAAa,GAAIC,QAX9CC,KACtBP,GAAQ,IAUqFhD,SAAA,CAC3FpU,eAAC4X,KAAY,CAACnE,SAAS,QAAQ9X,MAAM,UAAUuE,MAAO,CAAC2X,YAAa,EAAGC,YAAa,KACjF,YAEL9X,eAACmU,IAAG,CAACpb,OAAQ,IAGbmb,gBAAC6D,IAAM,CAACC,sBAAoB,EAACb,KAAMA,EAAMc,QAASZ,EAAaiF,SAAS,KAAKpc,MAAO,CAAC2X,WAAY,GAAGC,YAAa,IAAI1D,SAAA,CACnHF,gBAACgE,KAAW,CAAA9D,SAAA,CAAC,IAAErB,EAAM,OACrB/S,eAACmY,IAAa,CAAA/D,SACZpU,eAACmU,IAAG,CAACxB,YAAa,EAAEyB,SAClBpU,eAACwa,GAAS,IAAK1b,QAGnBkB,eAACoY,IAAa,CAAAhE,SACVpU,eAACuX,IAAM,CAACG,QAASL,EAAa1b,MAAM,UAAU+c,KAAK,QAAOtE,SACvD,oBG3BN,IAAImI,GAAYA,CAACtN,EAAYkK,EAAwBqD,EAAaC,KAAc,CACnFxN,KAAI2L,KAAKpyB,MAAM8Z,QAAQ6W,GAAOA,EAAM,CAACA,GAAMqD,OAAMC,UAGrD,MAAMC,GAAYH,GAAU,QAAS,GAAI,OAE5BI,GAAoC,CAC7C,CAAC,kBAAmB,qCACpB,CAAC,kBAAmB,8CACpB,CAAC,YAAa,iCACd,CAAC,SAAU,sCACX,CAAC,WAAY,oCACb,CAAC,QAAS,iCACV,CAAC,eAAgB,4BACjB,CAAC,gBAAiB,qCAClB,CAAC,oBAAqB,iCACtB,CAAC,mBAAoB,mCACrB,CAAC,aAAc,mCACf,CAAC,cAAe,mCAChB,CAAC,kBAAmB,+BACpB,CAAC,eAAgB,2BACjB,CAAC,cAAe,sCAChB,CAAC,SAAU,iCACX,CAAC,mBAAoB,kCACrB,CAAC,aAAc,qBACf,CAAC,aAAc,0BACf,CAAC,cAAe,yBAChB,CAAC,SAAU,sCACX,CAAC,cAAe,2BAChB,CAAC,aAAc,8BACf,CAAC,YAAa,oCACd,CAAC,aAAc,oBACf,CAAC,mBAAoB,yBACrB,CAAC,kBAAmB,yBACpB,CAAC,YAAa,yCACd,CAAC,cAAe,mCAChB,CAAC,eAAgB,qBACjB,CAAC,eAAgB,0BACjB,CAAC,aAAc,qCACf,CAAC,gBAAiB,yBAClB,CAAC,oBAAqB,0BACtB,CAAC,mBAAoB,oBACrB,CAAC,cAAe,qCAChB,CAAC,WAAY,0BACb,CAAC,YAAa,uBACd,CAAC,SAAU,4CACX,CAAC,qBAAsB,2BACvB,CAAC,SAAU,wCACX,CAAC,oBAAqB,gCAIbC,GAAqC,CAC9C,CAAC,SAAW,4CACZ,CAAC,SAAW,0CACZ,CAAC,SAAW,iCACZ,CAAC,SAAW,yBACZ,CAAC,SAAW,8CACZ,CAAC,SAAW,8BACZ,CAAC,SAAW,yCACZ,CAAC,SAAW,qCACZ,CAAC,SAAW,0BACZ,CAAC,SAAW,4BACZ,CAAC,SAAW,iCACZ,CAAC,SAAW,qCACZ,CAAC,SAAW,4CACZ,CAAC,SAAW,kBACZ,CAAC,SAAW,oCACZ,CAAC,SAAW,6CACZ,CAAC,SAAW,uCACZ,CAAC,SAAW,uCACZ,CAAC,UAAW,yCACZ,CAAC,UAAW,gCACZ,CAAC,UAAW,iCACZ,CAAC,UAAW,6CACZ,CAAC,UAAW,4BACZ,CAAC,UAAW,oCACZ,CAAC,SAAW,iCACZ,CAAC,SAAW,yCACZ,CAAC,SAAW,oCACZ,CAAC,SAAW,sCACZ,CAAC,SAAW,4BACZ,CAAC,SAAW,sCACZ,CAAC,SAAW,wCACZ,CAAC,SAAW,4BACZ,CAAC,SAAW,2CACZ,CAAC,SAAW,8BACZ,CAAC,UAAW,8CACZ,CAAC,UAAW,wCACZ,CAAC,UAAW,uCACZ,CAAC,UAAW,mCACZ,CAAC,UAAW,mCACZ,CAAC,UAAW,yCAGHC,GAAyD,CAClE,CAAC,MACE,CAAC,CAAC,SAAU,IACX,CAAC,aAAc,IACf,CAAC,YAAa,MAGlB,CAAC,MACG,CAAC,CAAC,oBAAqB,OAE3B,CAAC,MAAO,CACJ,CAAC,eAAgB,KACjB,CAAC,cAAe,KAChB,CAAC,SAAS,KACV,CAAC,mBAAoB,OAEzB,CAAC,MAAO,CACJ,CAAC,kBAAmB,KACpB,CAAC,cAAe,KAChB,CAAC,SAAU,IACX,CAAC,oBAAqB,OAE1B,CAAC,MAAO,CACJ,CAAC,eAAgB,KACjB,CAAC,aAAc,IACf,CAAC,gBAAiB,KAClB,CAAC,aAAc,MAEnB,CAAC,OAAQ,CACL,CAAC,aAAc,KACf,CAAC,aAAc,IACf,CAAC,SAAU,IACX,CAAC,eAAgB,OAErB,CAAC,OAAQ,CACL,CAAC,eAAgB,IACjB,CAAC,cAAe,KAChB,CAAC,SAAU,KACX,CAAC,mBAAoB,OAEzB,CAAC,OAAQ,CACL,CAAC,kBAAmB,KACpB,CAAC,cAAe,IAChB,CAAC,kBAAmB,IACpB,CAAC,YAAa,MAElB,CAAC,MAAO,CACJ,CAAC,aAAc,KACf,CAAC,aAAc,IACf,CAAC,QAAS,IACV,CAAC,eAAgB,OAErB,CAAC,MAAO,CACJ,CAAC,cAAe,KAChB,CAAC,gBAAiB,IAClB,CAAC,kBAAmB,IACpB,CAAC,cAAe,OAEpB,CAAC,MAAO,CACJ,CAAC,cAAe,KAChB,CAAC,mBAAoB,IACrB,CAAC,eAAgB,IACjB,CAAC,QAAS,OAEd,CAAC,MAAO,CACJ,CAAC,SAAU,IACX,CAAC,SAAU,IACX,CAAC,cAAe,IAChB,CAAC,WAAY,OAEjB,CAAC,MAAO,CACJ,CAAC,YAAa,IACd,CAAC,YAAa,KACd,CAAC,aAAc,KACf,CAAC,eAAgB,MAErB,CAAC,MAAO,CACJ,CAAC,mBAAoB,KACrB,CAAC,mBAAoB,IACrB,CAAC,oBAAqB,IACtB,CAAC,WAAY,MAEjB,CAAC,MAAO,CACJ,CAAC,YAAa,IACd,CAAC,eAAgB,IACjB,CAAC,cAAe,IAChB,CAAC,mBAAoB,OAEzB,CAAC,MAAO,CACJ,CAAC,WAAY,IACb,CAAC,cAAe,IAChB,CAAC,aAAc,KACf,CAAC,gBAAiB,MAEtB,CAAC,MAAO,CACJ,CAAC,oBAAqB,IACtB,CAAC,qBAAsB,IACvB,CAAC,mBAAoB,IACrB,CAAC,gBAAiB,OAEtB,CAAC,OAAQ,CACL,CAAC,kBAAmB,IACpB,CAAC,cAAe,IAChB,CAAC,YAAa,KACd,CAAC,oBAAqB,MAE1B,CAAC,OAAQ,CACL,CAAC,aAAc,IACf,CAAC,qBAAsB,KACvB,CAAC,oBAAqB,KACtB,CAAC,SAAU,OAEf,CAAC,OAAQ,CACL,CAAC,kBAAmB,KACpB,CAAC,WAAY,KACb,CAAC,YAAa,KACd,CAAC,aAAc,OAEnB,CAAC,MAAO,CACJ,CAAC,SAAU,KACX,CAAC,cAAe,IAChB,CAAC,SAAU,OAEf,CAAC,MAAO,CACJ,CAAC,kBAAmB,KACpB,CAAC,mBAAoB,IACrB,CAAC,YAAa,OAElB,CAAC,MAAO,CACJ,CAAC,SAAU,KACX,CAAC,aAAc,QAIjBC,GAAuB7lB,OAAO2N,YAAY+X,IAC1CI,GAAyBF,GAAsBh0B,KAAIgc,IAA0B,IAAxBmY,EAAYC,GAAMpY,EACrE,OAAOoY,EAAMp0B,KAAI6hB,IAAA,IAAEwS,EAAWzZ,GAAOiH,EAAA,MACrC,CAAC,SAASsS,KAAcE,IAAaJ,GAAqBI,GAAa,IAAMzZ,SAC9EjH,OAAO3T,KAAKylB,IAAA,IAAE5kB,EAAGkL,GAAE0Z,EAAA,OAAKiO,GAAU7yB,EAAGkL,EAAG,YAElCuoB,GAAoD,CAChE,CAAC,MAAO,IAAK,IACb,CAAC,MAAO,GAAI,IACZ,CAAC,MAAO,GAAI,KACZ,CAAC,MAAO,IAAK,KACb,CAAC,MAAO,GAAI,KACZ,CAAC,OAAO,GAAI,MACZ,CAAC,OAAO,IAAK,MACb,CAAC,OAAO,GAAI,IACZ,CAAC,MAAO,GAAI,MACZ,CAAC,MAAO,GAAI,MACZ,CAAC,MAAO,GAAI,MACZ,CAAC,MAAO,IAAK,MACb,CAAC,MAAO,IAAK,MACb,CAAC,MAAO,GAAI,MACZ,CAAC,MAAO,IAAK,IACb,CAAC,MAAO,IAAK,MACb,CAAC,MAAO,GAAI,IACZ,CAAC,OAAO,GAAI,MACZ,CAAC,OAAO,IAAK,MACb,CAAC,OAAO,GAAI,MACZ,CAAC,MAAO,IAAK,IACb,CAAC,MAAO,GAAI,IACZ,CAAC,MAAO,GAAI,KAEPC,GAAyBT,GAAc9zB,KAAK2kB,IAAA,IAAE9jB,EAAGkL,GAAE4Y,EAAA,OAAK+O,GAAU7yB,EAAGkL,EAAG,WAE9E,IAAIyoB,GAA2B,CAC3Bd,GAAU,SAAU,SAAU,WAC9BA,GAAU,SAAU,SAAU,WAC9BA,GAAU,UAAW,UAAW,WAChCA,GAAU,UAAW,UAAW,WAChCA,GAAU,UAAW,UAAW,WAChCA,GAAU,UAAW,UAAW,WAChCA,GAAU,SAAU,SAAU,WAC9BA,GAAU,SAAU,SAAU,WAC9BA,GAAU,UAAW,UAAW,WAChCA,GAAU,UAAW,UAAW,WAChCA,GAAU,UAAW,UAAW,WAChCA,GAAU,UAAW,UAAW,YAGhCe,GAAyB,CACzBf,GAAU,IAAK,IAAK,SACpBA,GAAU,KAAM,KAAM,SACtBA,GAAU,KAAM,KAAM,SACtBA,GAAU,OAAQ,GAAI,UAGtBgB,GACA,CAAC,KAAM,KAAM,KAAM,KACnB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,MAAM10B,KAAIvB,GAAKi1B,GAAUj1B,EAAG,GAAI,iBAElDk2B,GAAiBhB,IACjB,OAAQA,GACJ,IAAK,OACL,IAAK,YAAa,OAAOY,GACzB,IAAK,QAAS,OAAOL,GACrB,IAAK,UAAW,OAAOM,GACvB,IAAK,cAAe,OAAOE,GAC3B,IAAK,QAAS,OAAOD,GACrB,QAAS,MAAO,KAIpBG,GAA4B/C,IAC5B,IAAIgD,EAASF,GAAc9C,EAAS8B,MAChCmB,EAAS,IAAInW,IAAIkT,EAASkD,kBAI1BhD,EACO8C,EAAOhR,QAAOyM,IACjB,IAAI6B,EAAoB7B,EAAIlK,GAJtB9G,MAAM,IAAK,GAAG,GAKpB,OAAOwV,EAAO9Z,IAAImX,MAW1B,MAPW6C,IACa,IAAhBjD,EAAKzyB,OACEu0B,GAEAz0B,EAAY2yB,IAM3BkD,GAAiCA,CAACtB,EAAcuB,KAChD,IAAIC,EAAiB,IAAIxW,IAAIuW,GAC7B9zB,QAAQ6hB,IAAI,8BAA+BkS,GAC3C,IAAIpD,EAAO4C,GAAchB,GAAM9P,QAAOH,GAAKyR,EAAena,IAAI0I,EAAE0C,MAQhE,MAPW4O,IACa,IAAhBjD,EAAKzyB,OACEu0B,GAEAz0B,EAAY2yB,ICrQhBqD,OAjBf,SAAmBnf,GACf,MAAMof,EAAYlf,IAAMC,OAAiC,MAUzD,OATA/Z,qBAAW,KACP,MAAMi5B,EAASD,EAAUre,QACzB,IAAIue,EAAQ1oB,OAAOoE,kBAAoB,EACvCqkB,EAAOplB,OAAS+F,EAAM/F,OAASqlB,EAC/BD,EAAOrlB,MAAQgG,EAAMhG,MAAQslB,GA3ErC,SAAcC,EAA+Bvf,GACzC,IAAI,MAAEhG,EAAK,OAAEC,EAAM,YAAEC,GAAe8F,EAEpCuf,EAAIC,UAAU,EAAG,EAAGxlB,EAAOC,GAE3B,IAAI2f,EAAO7wB,KAAK2H,IAAIsJ,EAAOC,GACvBwlB,EAAe,GAAP7F,EACR8F,EAAeD,EAAQ,EAC3B,MAAME,EAA8B,GAAfD,EACfE,EAAiC,GAAfF,EACxBH,EAAIM,UAAYF,EAEhBJ,EAAIO,iBACJ,IAAIR,EAAQ1oB,OAAOoE,kBAAoB,EACvCukB,EAAIxuB,MAAMuuB,EAAOA,GACjBC,EAAIQ,WAAW/lB,EAAQylB,GAAS,GAAI7F,EAAO6F,GAAS,GACpD,IAAIO,EAAgC,IAAfN,EACjBO,EAAoC,GAAfP,EACrBQ,EAAoC,KAAfR,EACzB,SAASS,EAAgB9hB,EAAa3K,EAAe4K,GACjDihB,EAAIhP,OACJgP,EAAIQ,UAAUN,EAAQ,EAAGA,EAAQ,GACjCF,EAAIa,OAAO1sB,GACX6rB,EAAIQ,WAAWN,EAAQ,GAAIA,EAAQ,GACnCF,EAAIc,YAEJ,MAEMC,EAAWjiB,EAAMqhB,GAFK,IAARrhB,EAAa4hB,EAA8B,IAAR5hB,EAAa6hB,GAAsBA,GAGpFK,GAAaliB,EAAM,GAAKqhB,GAFF,IAARrhB,EAAa6hB,EAA8B,IAAR7hB,GAAc6hB,GAAsBD,GAGrFO,GAAQR,EACRS,EAAcpiB,EAAMqhB,EACpBgB,EAAeD,EAAcf,EAGnCH,EAAIoB,OAAOL,EAAUE,GACrBjB,EAAIqB,OAAOL,EAAWC,GACtBjB,EAAIqB,OAAOF,EAJK,GAKhBnB,EAAIqB,OAAOH,EALK,GAMhBlB,EAAIqB,OAAON,EAAUE,GACrBjB,EAAIsB,YACJtB,EAAIuB,UAAY5mB,EAAYoE,GAC5BihB,EAAIh1B,OACJg1B,EAAIwB,SACJxB,EAAIyB,UAER,SAASC,EAAar2B,EAAWkL,EAAUwI,GACvCihB,EAAIuB,UAAY5mB,EAAYoE,GAC5BihB,EAAI2B,SAASt2B,EAAGkL,EAAG4pB,EAAcA,GACjCH,EAAI4B,YAAc,QAClB5B,EAAI6B,WAAWx2B,EAAGkL,EAAG4pB,EAAcA,GAGvC,IAAK,IAAIj1B,EAAI,EAAGA,EAAI,EAAGA,IACnB,IAAK,IAAIyZ,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,MAAM5F,EAAU0B,EAAMlG,KAAK,GAAO,EAAJrP,EAAQyZ,GACtC+c,EAAa/c,EAAIwb,EAAcj1B,EAAIi1B,EAAcphB,GAIzDihB,EAAIM,UAAYD,EAChB,IAAK,IAAIn1B,EAAI,EAAGA,EAAI,EAAGA,IACnB01B,EAAgB,EAAE11B,EAAG1B,KAAKmD,GAAI8T,EAAMlG,KAAK,GAAGrP,IAC5C01B,EAAgB,EAAE11B,EAAG,EAAGuV,EAAMlG,KAAK,GAAGrP,IACtC01B,EAAgB,EAAE11B,EAAa,IAAV1B,KAAKmD,GAAU8T,EAAMlG,KAAK,GAAGrP,IAClD01B,EAAgB,EAAE11B,EAAa,GAAV1B,KAAKmD,GAAU8T,EAAMlG,KAAK,GAAGrP,IAYlD42B,CADYhC,EAAOiC,WAAW,MACnBthB,MAGRkB,eAAA,UACHC,IAAKie,EACLhe,MAAO,CAAEpH,MAAOgG,EAAMhG,MAAOC,OAAQ+F,EAAM/F,OAAQoH,OAAQ,MCnEnE,MAAMsR,GAAYC,aAAWxY,IAAK,CAC9ByY,UAAW,CACTC,WAAY1Y,EAAM2Y,QAAQ,GAC1BC,cAAe5Y,EAAM2Y,QAAQ,GAC7BE,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,SAE5CC,MAAO,CACLC,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,UAEjBO,YAAa,CACX/Z,OAAQ,KAEVyZ,YAAa,CACXJ,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,UAEjBQ,MAAQ,CACJpX,MAAOzC,EAAM8Y,QAAQkB,KAAK+G,SAC1BoG,WAAY,IACZ5M,SAAU,GACV6M,aAAc,aAElBC,OAAQ,CACN5kB,MAAOzC,EAAM8Y,QAAQkB,KAAKG,WAE5B1d,OAAQ,CACNmD,MAAO,YAIP0nB,GAAmBvpB,OAAO2N,YAAY+X,IACtC8D,GAAqB5D,GAAsBh0B,KAAK,CAAAgc,EAAStb,KAAO,IAAdG,EAAGkL,GAAEiQ,EACvDpB,EAAS0Z,GAAqB5zB,GAC9B4vB,EAAMqH,GAAiB5rB,EAAE,GAAG,IAEhC,OADAukB,EAAM1V,EAAO,GAAK,IAAM0V,EAAM,IAAM1V,EAAO,GACpC,CAAC/Z,EAAGyvB,MAIb,SAASuH,GAAY5hB,GACnB,MAAM,MAACxQ,EAAK,SAAE6mB,GAAYrW,EAE1B,OAAOkB,eAACya,GAAgB,CAAMnsB,QAAO6mB,WAAU2F,SAAU,CACvDJ,SAAU,gBACVC,OAHa,CAAC,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,KAAM,KAInDC,KAAM6F,GACN5F,cAAe,OACfzB,YAAa,CACXpgB,YAAa,CACX,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,aAIP+Z,MAAO,uHACPc,MAAO,oBAYJ,SAAS8M,GAAgB7hB,GAC5B,IAAI,MAAExQ,EAAK,SAAE6mB,GAAarW,EACtBlG,EAAOtK,EAAMsK,KAAKtK,MAClBslB,EAAUnC,KACd,MAAMe,EAAcoO,aAAKhN,EAAQpB,YAAaoB,EAAQd,aACtD,IAAItI,EAAUzB,GAAYuB,WAAW1R,EAbzC,SAAkBjU,GAChB,OAAQA,GAIN,QAAS,OAAO2rB,GAAKgB,YAFrB,IAAK,OAAQ,OAAOhB,GAAKa,WACzB,IAAK,WAAY,OAAOb,GAAKnE,UAU3B0U,CAAUvyB,EAAMuK,OAAOioB,qBAAqBC,iBAAmB,SAEjE,MAAMC,EAAoE,QAA3D1yB,EAAMuK,OAAOooB,iBAAiBF,iBAAmB,MAChE,IAAIG,EAAW5yB,EAAMuK,OAAOsoB,iBAAiBJ,gBAEzCK,EAAW9yB,EAAMuK,OAAOwoB,iBAAiBN,iBAAmB,MAC/C,QAAbK,EAGA5W,EADe,QAAb4W,EACQrY,GAAYsC,SAASb,EAAS,MAAM,GAEpCzB,GAAYsC,SAASb,EAAS,MAAM,GAQ/B,QAAb0W,IAGF1W,EAAUzB,GAAY8C,QAAQrB,IAGpBnL,eAAd,MAWMiiB,EACJpN,gBAACC,IAAG,CAAAC,SAAA,CACFpU,eAACya,GAAgB,CAAMnsB,QAAO6mB,WAAU2F,SAAU,CAChDJ,SAAU,mBACVE,KAAM+B,GACNhC,OAAQ,CAAC,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,KAAM,KAC9CE,cAAe,OACfzB,YAAa,CACXpgB,YAAa,CACX,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,aAIP6a,MAAO,sBAGT7T,eAACkX,GAAW,CAAM5oB,QAAO6mB,WAAUlC,OA5BpB,kBA4BwCmD,QAAS,CAAEvC,MAAO,WAAYyD,UAAU,KAC/FtX,eAACmU,IAAG,CAACrb,MAAO,GAAIuZ,QAAQ,iBACxBrS,eAACkX,GAAW,CAAM5oB,QAAO6mB,WAAUlC,OA7BpB,kBA6BwCmD,QAAS,CAAEvC,MAAO,mDAAoDyD,UAAU,KAEvItX,eAACmU,IAAG,CAACpb,OAAQ,KACbiH,eAAC8Y,KAAO,IACR9Y,eAACmU,IAAG,CAACpb,OAAQ,KAGbiH,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAtChB,uBAsCyCY,MAAO,iBACpE7T,eAAA,SAEAA,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OArCvB,mBAqCyCY,MAAO,iBAC7D7T,eAACmU,IAAG,CAACrb,MAAO,GAAIuZ,QAAQ,iBACxBrS,eAAA,SACAA,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAvCxB,mBAuCyCY,MAAO,gCAC5D7T,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,aAExBnV,eAACmU,IAAG,CAACpb,OAAQ,KACbiH,eAAC8Y,KAAO,IACR9Y,eAACmU,IAAG,CAACpb,OAAQ,KAEbiH,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAhDpB,mBAgDyCY,MAAO,qBAClD,QAAbuN,GAAsBphB,eAAC0gB,GAAW,CAAMpyB,QAAO6mB,gBAKpDnW,IAAM9Z,WAAW,KACfq8B,GAAU,KACT,CAAEjzB,IACL,MAAOkzB,EAAQD,GAAaviB,IAAM9a,UAAS,GAQ3C8a,IAAM9Z,WAAU,KACd,SAASsa,EAAYnL,GACnB/F,EAAMmzB,WAAWC,OAAOrtB,EAAO8gB,GAEb,MAAd9gB,EAAMqL,KACR6hB,GAAU,GAId,OADA7rB,OAAO9H,iBAAiB,UAAW4R,GAC5B,KACL9J,OAAO/E,oBAAoB,UAAW6O,OAI1C,IAAI2Z,EAAM,GACNsD,EAAQ,GAIZ,GAH+B,IAA3BnuB,EAAMqzB,KAAKC,KAAKz5B,SAClBs0B,EAAQnuB,EAAMqzB,KAAKC,KAAK,GAAGhH,KAAK,IAE9B4G,GAAUlzB,EAAMqzB,KAAKC,KAAKz5B,QAAU,EAAG,CAEzC,IAAI05B,EADU,IAAItf,GAAQjU,EAAMqzB,KAAKC,KAAK,GAAGhH,KAAK,GAAKtsB,EAAMqzB,KAAKC,KAAK,GAAGhH,KAAK,IAC3DxS,WAChByZ,EAAQrf,MAAMra,OAAS,IACQ,MAA7B05B,EAAQrf,MAAM,GAAG7d,KAAK,KACxBw0B,GAAO,IAAM0I,EAAQrf,MAAM,GAAG7d,KAAO,KACrCk9B,EAAQrf,MAAQqf,EAAQrf,MAAMkD,MAAM,IAEtCyT,GAAO0I,EAAQje,YAGnB,MAAMke,EAAoBxzB,EAAM0K,YAAYmX,gBAAgB7hB,EAAMsK,KAAKqJ,KACvE,OACAiS,gBAACC,IAAG,CAACI,UAAWX,EAAQjC,UAAUyC,SAAA,CAClCpU,eAAC+hB,IAAI,CAACpQ,WAAS,EAAAyC,SACbpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,GAAG0N,SACb4M,EACChhB,eAACgiB,KAAK,CAACzN,UAAW/B,EAAY4B,SAC5BpU,eAACmU,IAAG,CAAC8N,OAAO,OAAM7N,SACjBpU,eAACnB,GAAO,CACP/F,MAAO,IACPC,OAAQ,IACRH,KAAM4R,EACNxR,YAAa8oB,EACb5oB,MAAO5K,EAAMuK,OAAOK,MAAM6nB,gBAC1BznB,cAAe,CAAC7T,EAAKK,SAKzBka,eAACgiB,KAAK,CAACzN,UAAW/B,EAAY4B,SAC5BpU,eAACmU,IAAG,CAAC8N,OAAO,OAAM7N,SACjBpU,eAACie,GAAS,CACTnlB,MAAO,IACPC,OAAQ,IACRH,KAAM4R,EACNxR,YAAa8oB,EACb5oB,MAAO5K,EAAMuK,OAAOK,MAAM6nB,0BAQtC/gB,eAACmU,IAAG,CAACpb,OAAU,IAEfmb,gBAAC8N,KAAK,CAACzN,UAAWX,EAAQzB,MAAO+P,UAAW,EAAE9N,SAAA,CAC9CF,gBAAC6N,IAAI,CAACpQ,WAAS,EAACE,QAAS,EAAEuC,SAAA,CAEzBpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SAEjBpU,eAACmU,IAAG,CAAC9B,QAAQ,OAAM+B,SACXF,gBAACC,IAAG,CAAAC,SAAA,CACJpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAMqB,SAAE,aAE1B,WAGdpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SACfpU,eAACmU,IAAG,CAACrC,cAAe,EAAGqQ,WAAY,EAAE/N,SACnCpU,eAAC4b,IAAU,CAAC1b,MAAO,CAACkiB,WAAY,WAAY3O,SAAU,GAAI4M,WAAY,KAAKjM,SACvEqI,QAKRzc,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SAEjBpU,eAACmU,IAAG,CAAC9B,QAAQ,OAAM+B,SACXF,gBAACC,IAAG,CAAAC,SAAA,CACJpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAMqB,SAAE,SAE1B,WAGVoN,EAQJtN,gBAAC6N,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SAAA,CACfpU,eAACmU,IAAG,CAACrC,cAAe,EAAGqQ,WAAY,EAAE/N,SACnCpU,eAAC4b,IAAU,CAAC1b,MAAO,CAACkiB,WAAY,WAAY3O,SAAU,GAAI4M,WAAY,KAAKjM,SACvE+E,MAINnZ,eAACmU,IAAG,CAACgI,YAAY,eACTjc,MAAO,CAACmc,WAAY,gBAAiBjI,SAErCpU,eAAC+Y,GAAc,CACbp0B,KAAK,GACL+zB,KAAM,IACNS,IAAKA,EACL5O,KAAK,OACL5O,MAAOmmB,EACP1I,YAAa,UAvBzBpZ,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SACjBF,gBAACqD,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAASR,UAAWX,EAAQje,OACjE+iB,KAAK,SAASlB,QAAQ,WAAW7b,MAAM,UAAU+b,QAzG/BiB,KAClB4I,GAAU,IAwG4DnN,SAAA,CAAC,IAAuC,eA4BhHpU,eAACmU,IAAG,CAACpb,OAAQ,KAEbiH,eAAC+hB,IAAI,CAACpQ,WAAS,EAACE,QAAS,EAAEuC,SACvBpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAG2b,GAAI,EAAGC,GAAI,EAAElO,SAC7BpU,eAACuX,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAASR,UAAWX,EAAQje,OACjE+iB,KAAK,SAASlB,QAAQ,YAAY7b,MAAM,UAAU+b,QAvIrC6K,KACjBpN,EAAS,CAACvwB,KAAM,MAAOwwB,QAAS,YAsI0ChB,SAAC,gBAQ7EpU,eAACmU,IAAG,CAACpb,OAAQ,KACXiH,eAAC8Y,KAAO,IACV9Y,eAACmU,IAAG,CAACpb,OAAQ,KACXuoB,EAEFthB,eAACmU,IAAG,CAACpb,OAAQ,KACXiH,eAAC8Y,KAAO,IACV9Y,eAACmU,IAAG,CAACpb,OAAQ,KAEbiH,eAACmU,IAAG,CAAAC,SACJpU,eAAC0V,KAAW,CAACpB,UAAU,WAAWC,UAAWX,EAAQ2M,OAAOnM,SAC1DpU,eAACqU,KAAS,CAACC,UAAU,SAAQF,SAAC,yEAa7B,SAASoO,GAAiB1jB,GAC/B,IAAI,MAAExQ,EAAK,SAAE6mB,GAAarW,EACtBlG,EAAOtK,EAAMsK,KAAKtK,MAClBslB,EAAUnC,KACd,MAAMe,EAAcoO,aAAKhN,EAAQpB,YAAaoB,EAAQd,aACtD,IAAItI,EAAUzB,GAAYuB,WAAW1R,EAAM0X,GAAKgB,aAEhD,MAAM0P,EAAoE,QAA3D1yB,EAAMuK,OAAOooB,iBAAiBF,iBAAmB,MAG/C,QAFFzyB,EAAMuK,OAAOsoB,iBAAiBJ,kBAG3CvW,EAAUzB,GAAY8C,QAAQrB,IAGhC,MAGM8W,EACJpN,gBAACC,IAAG,CAAAC,SAAA,CACFpU,eAACya,GAAgB,CAAMnsB,QAAO6mB,WAAU2F,SAAU,CAChDJ,SAAU,oBACVE,KAAMgC,GACNjC,OAAQ,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC7CE,cAAe,OACfzB,YAAa,CACXpgB,YAAa,CACX,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,UACH,EAAG,aAIP6a,MAAO,uBAeT7T,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OApCvB,mBAoCyCY,MAAO,iBAC7D7T,eAACmU,IAAG,CAACrb,MAAO,GAAIuZ,QAAQ,iBACxBrS,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OArCxB,mBAqCyCY,MAAO,gCAC5D7T,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,aAExBnV,eAACmU,IAAG,CAACpb,OAAQ,KACbiH,eAAC8Y,KAAO,IACR9Y,eAACmU,IAAG,CAACpb,OAAQ,QAKjBiG,IAAM9Z,WAAW,KACfq8B,GAAU,KACT,CAAEjzB,IACL,MAAOkzB,EAAQD,GAAaviB,IAAM9a,UAAS,GAQ3C8a,IAAM9Z,WAAU,KACd,SAASsa,EAAYnL,GACnB/F,EAAMmzB,WAAWC,OAAOrtB,EAAO8gB,GAEb,MAAd9gB,EAAMqL,KACR6hB,GAAU,GAId,OADA7rB,OAAO9H,iBAAiB,UAAW4R,GAC5B,KACL9J,OAAO/E,oBAAoB,UAAW6O,OAI1C,IAAI2Z,EAAM,GACNsD,EAAQ,GAIZ,GAH+B,IAA3BnuB,EAAMqzB,KAAKC,KAAKz5B,SAClBs0B,EAAQnuB,EAAMqzB,KAAKC,KAAK,GAAGhH,KAAK,IAE9B4G,GAAUlzB,EAAMqzB,KAAKC,KAAKz5B,QAAU,EAAG,CAEzC,IAAI05B,EADU,IAAItf,GAAQjU,EAAMqzB,KAAKC,KAAK,GAAGhH,KAAK,GAAKtsB,EAAMqzB,KAAKC,KAAK,GAAGhH,KAAK,IAC3DxS,WAChByZ,EAAQrf,MAAMra,OAAS,IACQ,MAA7B05B,EAAQrf,MAAM,GAAG7d,KAAK,KACxBw0B,GAAO,IAAM0I,EAAQrf,MAAM,GAAG7d,KAAO,KACrCk9B,EAAQrf,MAAQqf,EAAQrf,MAAMkD,MAAM,IAEtCyT,GAAO0I,EAAQje,YAGnB,MAAMke,EAAoBxzB,EAAM0K,YAAYmX,gBAAgB7hB,EAAMsK,KAAKqJ,KACvE,OACAiS,gBAACC,IAAG,CAACI,UAAWX,EAAQjC,UAAUyC,SAAA,CAClCpU,eAAC+hB,IAAI,CAACpQ,WAAS,EAAAyC,SACbpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,GAAG0N,SACb4M,EACChhB,eAACgiB,KAAK,CAACzN,UAAW/B,EAAY4B,SAC5BpU,eAACmU,IAAG,CAAC8N,OAAO,OAAM7N,SACjBpU,eAACnB,GAAO,CACP/F,MAAO,IACPC,OAAQ,IACRH,KAAM4R,EACNxR,YAAa8oB,EACb5oB,MAAO5K,EAAMuK,OAAOK,MAAM6nB,gBAC1BznB,cAAe,CAAC7T,EAAKK,SAKzBka,eAACgiB,KAAK,CAACzN,UAAW/B,EAAY4B,SAC5BpU,eAACmU,IAAG,CAAC8N,OAAO,OAAM7N,SACjBpU,eAACie,GAAS,CACTnlB,MAAO,IACPC,OAAQ,IACRH,KAAM4R,EACNxR,YAAa8oB,EACb5oB,MAAO5K,EAAMuK,OAAOK,MAAM6nB,0BAQtC/gB,eAACmU,IAAG,CAACpb,OAAU,IAEfmb,gBAAC8N,KAAK,CAACzN,UAAWX,EAAQzB,MAAO+P,UAAW,EAAE9N,SAAA,CAC9CF,gBAAC6N,IAAI,CAACpQ,WAAS,EAACE,QAAS,EAAEuC,SAAA,CAEzBpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SAEjBpU,eAACmU,IAAG,CAAC9B,QAAQ,OAAM+B,SACXF,gBAACC,IAAG,CAAAC,SAAA,CACJpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAMqB,SAAE,aAE1B,WAGdpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SACfpU,eAACmU,IAAG,CAACrC,cAAe,EAAGqQ,WAAY,EAAE/N,SACnCpU,eAAC4b,IAAU,CAAC1b,MAAO,CAACkiB,WAAY,WAAY3O,SAAU,GAAI4M,WAAY,KAAKjM,SACvEqI,QAKRzc,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SAEjBpU,eAACmU,IAAG,CAAC9B,QAAQ,OAAM+B,SACXF,gBAACC,IAAG,CAAAC,SAAA,CACJpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAMqB,SAAE,SAE1B,WAGVoN,EAQJtN,gBAAC6N,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SAAA,CACfpU,eAACmU,IAAG,CAACrC,cAAe,EAAGqQ,WAAY,EAAE/N,SACnCpU,eAAC4b,IAAU,CAAC1b,MAAO,CAACkiB,WAAY,WAAY3O,SAAU,GAAI4M,WAAY,KAAKjM,SACvE+E,MAINnZ,eAACmU,IAAG,CAACgI,YAAY,eACTjc,MAAO,CAACmc,WAAY,gBAAiBjI,SAErCpU,eAAC+Y,GAAc,CACbp0B,KAAK,GACL+zB,KAAM,IACNS,IAAKA,EACL5O,KAAK,OACL5O,MAAOmmB,EACP1I,YAAa,UAvBzBpZ,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAE0N,SACjBF,gBAACqD,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAASR,UAAWX,EAAQje,OACjE+iB,KAAK,SAASlB,QAAQ,WAAW7b,MAAM,UAAU+b,QAzG/BiB,KAClB4I,GAAU,IAwG4DnN,SAAA,CAAC,IAAuC,eA4BhHpU,eAACmU,IAAG,CAACpb,OAAQ,KAEbiH,eAAC+hB,IAAI,CAACpQ,WAAS,EAACE,QAAS,EAAEuC,SACvBpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAG2b,GAAI,EAAGC,GAAI,EAAElO,SAC7BpU,eAACuX,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAASR,UAAWX,EAAQje,OACjE+iB,KAAK,SAASlB,QAAQ,YAAY7b,MAAM,UAAU+b,QAvIrC6K,KACjBpN,EAAS,CAACvwB,KAAM,MAAOwwB,QAAS,YAsI0ChB,SAAC,gBAQ7EpU,eAACmU,IAAG,CAACpb,OAAQ,KACXiH,eAAC8Y,KAAO,IACV9Y,eAACmU,IAAG,CAACpb,OAAQ,KACXuoB,EAEFthB,eAACmU,IAAG,CAACpb,OAAQ,KACXiH,eAAC8Y,KAAO,IACV9Y,eAACmU,IAAG,CAACpb,OAAQ,KAEbiH,eAACmU,IAAG,CAAAC,SACJpU,eAAC0V,KAAW,CAACpB,UAAU,WAAWC,UAAWX,EAAQ2M,OAAOnM,SAC1DpU,eAACqU,KAAS,CAACC,UAAU,SAAQF,SAAC,yE,qFCtjBlC,MAAM3C,GAAYC,aAAWxY,IAAK,CAE9BupB,UAAW,CACPL,WAAY,WACZ3O,SAAU,SACV4M,WAAW,IACX,CAACnnB,EAAMoG,YAAYojB,KAAK,OAAQ,CAChCjP,SAAU,SACV4M,WAAY,MAGhB1qB,OAAQ,CACJmiB,YAAa5e,EAAM2Y,QAAQ,QAK5B,SAAS8Q,GAAkB7jB,GAC9B,IAAI8U,EAAUnC,MACTmR,EAASC,GAAc7jB,IAAM9a,UAAS,IACtC+c,EAAO6hB,GAAY9jB,IAAM9a,SAAS4a,EAAMikB,UAAU/gB,KAAK,OACxDghB,EAAYhkB,IAAMC,OAAgC,MACtD,MAIMgkB,EAAc5uB,IAChBA,EAAMiC,mBAEJ4sB,EAAaA,KACfL,GAAYD,IAchB5jB,IAAM9Z,WAAY,KACd49B,EAAShkB,EAAMikB,UAAU/gB,KAAK,SAC/B,CAAClD,EAAMikB,YAYV,MAGMzH,EAAQlc,aAAclG,GAAMoG,YAAYzQ,GAAG,OACjD,OAAOqlB,gBAAAiP,YAAA,CAAA/O,SAAA,CACPpU,eAACmU,IAAG,CAAAC,SACEkH,EACEtb,eAACuX,IAAM,CAACC,QAASoL,EAAU,YAAc,WACrCjnB,MAAM,UACN+c,KAAK,QACLhB,QAASwL,EACT3O,UAAWX,EAAQje,OACnB8lB,UAAWzb,eAACojB,KAAQ,IAAIhP,SAC3B,UAIDpU,eAACuX,IAAM,CAACC,QAASoL,EAAU,YAAc,WACrCjnB,MAAM,UACN+c,KAAK,QACLhB,QAASwL,EACT3O,UAAWX,EAAQje,OAAOye,SAE1BpU,eAACmU,IAAG,CAACkP,UAAW,GAAIjP,SAChBpU,eAACojB,KAAQ,CAAC3P,SAAS,gBAiBnCS,gBAAC6D,IAAM,CAACZ,KAAMyL,EACN3K,QApEYZ,KAChBwL,GAAW,IAoEPI,WAAYA,EACZp1B,UAAWo1B,EACXK,QAASL,EACT7O,SAAA,CAEFpU,eAACkY,KAAW,CAAA9D,SAAC,yDACbpU,eAACmY,IAAa,CAAA/D,SACRpU,eAACuY,KAAS,CACNgL,SAAUP,EACVQ,WAAS,EACT9K,KAAK,SACLD,WAAS,EACTgL,QAAS,GACTC,KAAM,EACNC,WAAY,CACRpP,UAAUX,EAAQ6O,WAEtBmB,WAAS,EAET3iB,MAAOA,EACPyT,SAnGErgB,IACdyuB,EAASzuB,EAAM9J,OAAO0W,OACtB5M,EAAMiC,mBAkGMkhB,QAAQ,eAGlBxX,eAACoY,IAAa,CAAAhE,SACVF,gBAACC,IAAG,CAAC/B,QAAS,EAAEgC,SAAA,CAChBpU,eAACuX,IAAM,CAACG,QAxFGmM,KACjBhB,GAAW,GACX,MAAMiB,EAAY7iB,EAAMkH,MAAM,MAAMtf,KAAIa,GAAK,IAAI6Y,GAAQ7Y,GAAG+b,MAAM7B,aAClE9E,EAAMqW,SAAS,CAACvwB,KAAM,gBAAiBwwB,QAAS0O,KAqFXnoB,MAAM,UAAU6b,QAAQ,WAAWiB,WAAS,EAAArE,SAAE,oBAG7EpU,eAACuX,IAAM,CAACG,QA/FGqM,KACjBlB,GAAW,GACX/jB,EAAMqW,SAAS,CAACvwB,KAAM,gBAAiBwwB,QAASnU,EAAMkH,MAAM,MAAMuE,QAAOplB,GAAKA,EAAE08B,YA6F3CroB,MAAM,UAAU6b,QAAQ,WAAWiB,WAAS,EAAArE,SAAE,+B,uBCnJpF,MAAM6P,GAAgB1Q,cAAO1O,IAAA,IAAC,UAAE0P,KAAczV,GAAqB+F,EAAA,OACtE7E,eAACkkB,KAAO,IAAKplB,EAAO8U,QAAS,CAAEuQ,OAAQ5P,OADdhB,CAExB,CACD,CAAC,MAAM6Q,KAAeC,WAAY,CAChC/H,SAAU,IACV7I,SAAU,UCmBVhC,GAAYC,aAAWxY,IAAK,CAC9ByY,UAAW,CACTC,WAAY1Y,EAAM2Y,QAAQ,GAC1BC,cAAe5Y,EAAM2Y,QAAQ,GAC7BE,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,QAC1CmK,WAAY,uBAEd1mB,OAAQ,CACNmD,MAAO,OACPC,OAAQ,IAEVoZ,MAAO,CACLC,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,SACfgJ,aAAc,EACd+I,aAAc,GAEhB9R,YAAa,CACXJ,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,UAEjBE,WAAY,CACV9W,MAAOzC,EAAM8Y,QAAQC,WAAWE,OAElCO,eAAgB,CACdC,YAAazZ,EAAM2Y,QAAQ,IAE7Be,WAAY,CAEV,CAAC1Z,EAAMoG,YAAYzQ,GAAG,OAAQ,CAC5BgkB,UAAW,MAGf4J,MAAO,CACL2F,WAAY,WACZ3O,SAAU,SACV4M,WAAW,IACX,CAACnnB,EAAMoG,YAAYojB,KAAK,OAAQ,CAChCjP,SAAU,SACV4M,WAAY,MAGdkE,QAAS,GAETC,KAAM,CACJC,WAAY,IAAKC,UAAW,SAAUC,SAAU,QAChD,CAACzrB,EAAMoG,YAAYojB,KAAK,OAAQ,CAC9BgC,UAAW,SACXC,SAAU,WAGd7R,YAAa,CACX/Z,OAAQ,KAEVga,MAAQ,CACJpX,MAAOzC,EAAM8Y,QAAQkB,KAAK+G,SAC1BoG,WAAY,IACZC,aAAc,aAElBsE,WAAa,CACTjpB,MAAOzC,EAAM8Y,QAAQkB,KAAK+G,SAC1BxG,SAAU,GACVrB,QAAS,GAEbyS,eAAiB,GAIjBC,IAAK,CACH53B,SAAU,WACV6G,IAAKmF,EAAM2Y,QAAQ,GACnBhe,KAAMqF,EAAM2Y,QAAQ,IAEtB0O,OAAQ,CACN5kB,MAAOzC,EAAM8Y,QAAQkB,KAAKG,eA4ShC,SAAS0R,GAAiBjmB,GACxB,IAAI,MAAExQ,EAAK,SAAE6mB,GAAarW,EAC1B,GAAmB,OAAfxQ,EAAM2K,KAAe,CACvB,IAAI+rB,EAAU,CAGZ,CAAErgC,KAAM,oBAAqBiyB,UAAW,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,KACnG,CAAEjyB,KAAM,sBAAuBiyB,UAAW,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,MAExE,OACE1C,gBAAC8C,WAAQ,CAAA5C,SAAA,CACTpU,eAACgV,GAAY,CAAM1mB,QAAO6mB,WAAUlC,OAAQ,oBAE5CjT,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,aAAYmB,SAAG,MAC3DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,qBAAoBmB,SAAG,MACnEpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,sBAAqBmB,SAAG,MAGpEpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAG,MACzDpU,eAACkX,GAAW,CAAM5oB,QAAO6mB,WAAUlC,OAAQ,gBAAiBmD,QAAS,CAACK,aAAcuO,GAAQ5Q,SAAI,MAChGpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAIrB,GAAmB,SAAf7mB,EAAM2K,KAAiB,CAChC,IAAIgsB,EAAU,eACVC,EAAU,iBACVC,EAAU,uBACVC,EAAU,uBACVC,EAAU,sBAEVC,EAAc,CAChB,CAAE3gC,KAAM,oBAAqBiyB,UAAW,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,MAEjG2O,EAAO,mBACPC,EAAO,mBAEX,OACEtR,gBAAC8C,WAAQ,CAAA5C,SAAA,CACTpU,eAACgV,GAAY,CAAM1mB,QAAO6mB,WAAUlC,OAAQ,sBAE5CjT,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQiS,EAAO9Q,SAAG,MACtDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQgS,EAAO7Q,SAAG,MACtDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQkS,EAAO/Q,SAAG,MACtDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQmS,EAAOhR,SAAG,MACtDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQoS,EAAOjR,SAAG,MAEtDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAG,MAEzDpU,eAACkX,GAAW,CAAM5oB,QAAO6mB,WAAUlC,OAAQsS,EAAMnP,QAAS,CAACK,aAAc6O,GAAYlR,SAAI,MACzFpU,eAACkX,GAAW,CAAM5oB,QAAO6mB,WAAUlC,OAAQuS,EAAMpP,QAAS,CAACK,aAAc6O,GAAYlR,SAAI,MACzFpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAIrB,GAAmB,OAAf7mB,EAAM2K,KACf,OACEib,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACgV,GAAY,CAAM1mB,QAAO6mB,WAAUlC,OAAQ,oBAG5CjT,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQ,wBAAuBmB,SAAI,MAExEpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQ,sBAAqBmB,SAAG,MAErEpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAG,MAEzDpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAKtB,GAAmB,OAAf7mB,EAAM2K,KAAe,CAC/B,IAAIgsB,EAAU,aACVC,EAAU,sBAEd,OACEhR,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACgV,GAAY,CAAM1mB,QAAO6mB,WAAUlC,OAAQ,oBAE5CjT,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQgS,EAAO7Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQiS,EAAO9Q,SAAI,MAExDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAI,MAE1DpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAKtB,GAAmB,SAAf7mB,EAAM2K,KAAiB,CACjC,IAAIgsB,EAAU,aACVC,EAAU,sBAEd,OACEhR,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACgV,GAAY,CAAM1mB,QAAO6mB,WAAUlC,OAAQ,oBAE5CjT,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQgS,EAAO7Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQiS,EAAO9Q,SAAI,MAExDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAI,MAE1DpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAMxB,GAAmB,SAAf7mB,EAAM2K,KAAiB,CAC/B,IAAIgsB,EAAU,iBACVC,EAAU,iBACVC,EAAU,sBAEd,OACEjR,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACgV,GAAY,CAAM1mB,QAAO6mB,WAAUlC,OAAQ,sBAC5CjT,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQgS,EAAO7Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQiS,EAAO9Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQkS,EAAO/Q,SAAI,MAExDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAMxB,GAAmB,OAAf7mB,EAAM2K,KAAc,CAC5B,IAAIgsB,EAAU,mBACVC,EAAU,gBACVC,EAAU,iBACVC,EAAU,sBAEd,OACElR,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQgS,EAAO7Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQiS,EAAO9Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQkS,EAAO/Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQmS,EAAOhR,SAAI,MAExDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAG,MAEzDpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAGtB,GAAmB,WAAf7mB,EAAM2K,KAAkB,CAClC,IAAIgsB,EAAU,gBACVC,EAAU,oBACVC,EAAU,oBACVC,EAAU,0BACVC,EAAU,sBAEd,OACEnR,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACkX,GAAW,CAAO5oB,QAAO6mB,WAAUlC,OAAQgS,EAAS7O,QAAS,CAACkB,UAAU,GAAKlD,SAAI,MAClFpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQiS,EAAO9Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQkS,EAAO/Q,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQmS,EAAOhR,SAAI,MACxDpU,eAACqV,GAAY,CAAO/mB,QAAO6mB,WAAUlC,OAAQoS,EAAOjR,SAAI,MAExDpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,gBAAemB,SAAG,MAC9DpU,eAACqV,GAAY,CAAM/mB,QAAO6mB,WAAUlC,OAAQ,WAAUmB,SAAG,MAEzDpU,eAAC4Y,GAAU,CAAMtqB,QAAO6mB,gBAIxB,OAAOnV,eAACgX,WAAQ,IAKTyO,OA/Zf,SAA0B3mB,GACtB,IAAI,MAAExQ,EAAK,SAAE6mB,GAAarW,EACtBlG,EAAOtK,EAAMsK,KAAKtK,MAClBslB,EAAUnC,KAEVjH,EAAUzB,GAAYuB,WAAW1R,EAhEzC,SAAiBtK,GACb,GAAmB,SAAfA,EAAM2K,KAGR,OAF2C,IAA3B3K,EAAMqzB,KAAKC,KAAKz5B,QAA4C,OAA5BmG,EAAMqzB,KAAKC,KAAK,GAAGpF,KAEnDlM,GAAKI,QAAUJ,GAAKG,UAEjC,GAAmB,OAAfniB,EAAM2K,KAAe,CAC5B,IAAItU,EAAO2J,EAAMuK,OAAO6sB,WAAW3E,gBACnC,MAAQ,CACN,WAAYzQ,GAAKE,cACjB,UAAWF,GAAKC,aAChB,KAAQD,GAAKI,SACL/rB,GAEP,GAAmB,OAAf2J,EAAM2K,KAWV,IAAmB,OAAf3K,EAAM2K,KACb,OAA+B,IAA3B3K,EAAMqzB,KAAKC,KAAKz5B,QAA4C,OAA5BmG,EAAMqzB,KAAKC,KAAK,GAAGpF,MAAiBluB,EAAMqzB,KAAKC,KAAK,GAAGpF,KAAKmJ,WAAW,OAClGrV,GAAKI,QAEuB,SAA5BpiB,EAAMqzB,KAAKC,KAAK,GAAGpF,KACnBlM,GAAKG,UAELH,GAAKgB,YAGX,GAAmB,SAAfhjB,EAAM2K,KAAiB,CAC9B,IAAItU,EAAO2J,EAAMuK,OAAO+sB,eAAe7E,gBACvC,MAAQ,CACN,WAAYzQ,GAAKQ,cACjB,UAAWR,GAAKS,aAChB,KAAQT,GAAKK,UACLhsB,GAEP,MAAmB,OAAf2J,EAAM2K,MAAgC,WAAf3K,EAAM2K,KAC7BqX,GAAKgB,YAEFhB,GAAKM,QAhCa,CAC5B,GAA+B,IAA3BtiB,EAAMqzB,KAAKC,KAAKz5B,OAAc,OAAOmoB,GAAKM,QAC9C,IAAIjsB,EAAO2J,EAAMuK,OAAOgtB,WAAW9E,gBAC/B+E,EAA4D,gBAApDx3B,EAAMuK,OAAOktB,mBAAmBhF,gBAE5C,OAAQp8B,GACN,IAAK,WAAY,OAAOmhC,EAAQxV,GAAKU,gBAAkBV,GAAKQ,cAC5D,IAAK,UAAW,OAAOgV,EAAQxV,GAAKW,eAAiBX,GAAKS,aAC1D,QAAU,OAAO+U,EAAQxV,GAAKY,eAAiBZ,GAAKK,WA0CbqV,CAAQ13B,IAE/CszB,EAAoBtzB,EAAMqzB,KAAKC,KAAKz5B,OAASmG,EAAMqzB,KAAKC,KACzD,CAAE,CAAEhH,KAAM,CAAC,IAAK6B,MAAM,0BAA2BxN,GAAI,GAAIuN,KAAM,KAE9DyJ,EAAkC,WAAf33B,EAAM3J,KAAqB,SAAW,OACzDuhC,EAAmE,SAA/C53B,EAAMuK,OAAOstB,cAAcpF,gBAoB/CqF,EAA0B,WAAf93B,EAAM3J,KAAsBuhC,EAPtBtE,KACnB,IAAIyE,EAAUzE,EAAK/4B,KAAK3B,GACtBA,EAAE0zB,KAAK/xB,KAAIyjB,GAAK,IAAI/J,GAAQ+J,GAAGhF,eAAe9E,MAAMra,WACnDqU,OACA9T,QAAQ,CAAC4jB,EAAGnlB,IAAMU,KAAK2H,IAAI8c,EAAGnlB,IAAI,KACrC,MAAO,UAAUk/B,UAE4CC,CAAc1E,GAAQ,GACjE,aAAftzB,EAAM3J,KAnBW,SAASi2B,GAC7B,IAAI2L,EAAYr/B,GAAgBA,EAAE0zB,KAClC,OAAoB,IAAhBA,EAAKzyB,OACAo+B,EAAS3L,EAAK,IAAI5Y,KAAK,MAEvB4Y,EAAK/xB,KAAKswB,GACf,IAAIA,EAAIqD,WAAa+J,EAASpN,GAAKnX,KAAK,MAAQ,OAapBwkB,CAAgB5E,GAAQ,GAE1D,MAOMnF,EAAQmF,EAAKz5B,OAASy5B,EAAK,GAAGnF,MAAS,GACvCvjB,EAAQmG,eAIdL,IAAM9Z,WAAU,KACd,SAASsa,EAAYnL,GACD,MAAdA,EAAMqL,KAAmC,SAApBumB,GACvBQ,GAAO,GAETn4B,EAAMmzB,WAAWC,OAAOrtB,EAAO8gB,GAGjC,OADAzf,OAAO9H,iBAAiB,UAAW4R,GAC5B,KACL9J,OAAO/E,oBAAoB,UAAW6O,OAI1C,MAAOknB,EAAaD,GAAUznB,IAAM9a,UAAS,GAiBvCo3B,EAAQlc,aAAclG,EAAMoG,YAAYzQ,GAAG,OAC3C83B,EAAarL,EAAS,CAAC,IAAK,KAAO,CAAC,IAAK,KACzCsL,EAAWtL,EAAS,MAAQ,GAGlC,IAAI9C,EA1FO,QADevf,EA2FY3K,EAAM2K,OA1FhB,WAATA,EACX,qGAGD,KALX,IAA8BA,EA6F1B,IACI4tB,EAAwBv4B,EAAMsK,KAAKkuB,aAEvC,MAAMC,EACA7S,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQ4J,SAAU,OAAQ7J,QAAS,GAAGgC,SAAA,CAC1DpU,eAAC2iB,GAAiB,CAACtQ,QAAWoK,EAC1BtH,SAAUA,EAAU4N,UAAWz0B,EAAM04B,gBAEzChnB,eAACmU,IAAG,CAAAC,SAEFkH,EACAtb,eAACuX,IAAM,CAACC,QAASkP,EAAc,YAAc,WACzC/qB,MAAM,UACN+c,KAAK,QACL/zB,KAAK,MACL+yB,QAtCIuP,KAChB,GAA+B,IAA3B34B,EAAMqzB,KAAKC,KAAKz5B,OAAc,OAClC,MAAM++B,EAAkB,CACtBjuB,KAAM3K,EAAM2K,KACZkuB,OAAQ74B,EAAMqzB,KAAKC,KAAK/4B,KAAIa,GAAKA,EAAE8yB,OACnCC,MAAOA,GAAS,IAEbiK,GAIHD,GAAO,GACPtR,EAAS,CAACvwB,KAAM,UAAWwwB,QAAS,CAAE8R,GAASE,OAAQ,aAJvDX,GAAO,GACPtR,EAAS,CAACvwB,KAAM,UAAWwwB,QAAS,CAAE8R,GAASE,OAAQ,UA8B7C3L,UAAWzb,eAACqnB,KAAY,IAAGjT,SAE1BsS,EAAc,SAAME,IAGzB,UAeV,OACA1S,gBAACC,IAAG,CAACI,UAAWX,EAAQjC,UAAUyC,SAAA,CAChCpU,eAACgiB,KAAK,CAACzN,UAAWX,EAAQzB,MAAO+P,UAAW,EAAE9N,SAC5CF,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,QAAQ+B,SAAA,CAC5BpU,eAACmU,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQE,cAAe,SAAUyJ,WAAY,UAAU5H,SAC3EpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAO7S,MAAO,GAAGkU,SAAC,eAI5CpU,eAACmU,IAAG,CAACjU,MAAO,GAAIqU,UAAWX,EAAQ4Q,OACnCxkB,eAACmU,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQ2J,WAAY,SAAUhJ,SAAU,GAAGoB,SAC/DpU,eAAC4b,IAAU,CAACrH,UAAWX,EAAQ6I,MAAMrI,SAC9BqI,MAGTzc,eAACmU,IAAG,CAACjU,MAAO,GAAIqU,UAAWX,EAAQ4Q,OAElClJ,GAASyL,OAMd/mB,eAACgiB,KAAK,CAACzN,UAAYX,EAAQzB,MAAMiC,SACjCF,gBAAC6N,IAAI,CAACpQ,WAAS,EAAAyC,SAAA,CAEbpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC6S,GAAI,EAAGD,GAAI,GAAI3b,GAAI,GAAI6N,UAAWX,EAAQ2Q,QAAQnQ,SAC3DF,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,QAAS+B,SAAA,CAC7BpU,eAACmU,IAAG,CAAC9B,QAAQ,OAAM+B,SACfF,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQiV,UAAW,cAAclT,SAAA,CAAC,IAACpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAO7S,MAAO,GAAGkU,SAAC,cAE7F,SAEVpU,eAACmU,IAAG,CAACjU,MAAO,GAAIqU,UAAWX,EAAQ4Q,OACnCxkB,eAAA,OAAAoU,SACEpU,eAACmU,IAAG,CAACrC,cAAe,EAAGqQ,WAAY,EAAE/N,SACnCpU,eAAC4b,IAAU,CAAC1b,MAAO,CAACkiB,WAAY,WAAY3O,SAAU,UAAUW,SAC7DgS,aAQXpmB,eAAC+hB,IAAI,CAACtS,MAAI,EAAC6S,GAAI,EAAGD,GAAI,GAAI3b,GAAI,GAAIxG,MAAO,CAACmS,QAAS,OAAQkV,eAAgB,UAAUnT,SACnFpU,eAACmU,IAAG,CAACjU,MAAO,CAAC6R,gBAAiB,oBAAoBqC,SACE,SAAhDtV,EAAMxQ,MAAMuK,OAAO2uB,SAASzG,gBAC9B/gB,eAACnB,GAAO,CACN/F,MAAO6tB,EAAU,GACjB5tB,OAAQ4tB,EAAU,GAClB/tB,KAAM4R,EAENxR,YAAa1K,EAAM0K,YAAYmX,gBAAgB7hB,EAAMsK,KAAKqJ,KAC1D7I,aAA+B,OAAf9K,EAAM2K,MAAgC,WAAf3K,EAAM2K,KAAqB,EAAI,EACtEC,MAAO5K,EAAMuK,OAAOK,MAAM6nB,gBAC1BznB,cAAgB,CAAC7T,EAAKK,EAAGL,EAAKI,EAAGJ,EAAKE,KACnC,cAMXqa,eAACgiB,KAAK,CAACzN,UAAWX,EAAQzB,MAAOjS,MAAO,CAAC0R,WAAY,GAAIE,cAAe,IAAIsC,SAE5EF,gBAAC6N,IAAI,CAACpQ,WAAS,EAACE,QAAS,EAAEuC,SAAA,CACzBpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAG2b,GAAI,EAAGC,GAAI,EAAGzK,WAAY,EAAEzD,SAC5CpU,eAACuX,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAASR,UAAWX,EAAQje,OAC/D+iB,KAAK,QAAQlB,QAAQ,YAAY7b,MAAM,UACvC+b,QA1JY+P,KAClBtS,EAAS,CAACvwB,KAAM,MAAOwwB,QAAS,WACR,SAApB6Q,GACFQ,GAAO,IAuJmBiB,GAAI,CAACpD,aAAc,GAAGlQ,SACzC6R,MAIJY,EAQD,KAPA7mB,eAAC+hB,IAAI,CAACtS,MAAI,EAAC/I,GAAI,EAAGmR,WAAY,EAAEzD,SAC9BpU,eAACikB,GAAa,CAAClR,MAhHK,+HAgHwBqB,SAC1CpU,eAAC2nB,KAAU,CAAAvT,SACTpU,eAAC4nB,KAAgB,CAACF,GAAI,CAAEjU,SAAU,iBAY5CzT,eAACmU,IAAG,CAACpb,OAAQ,KACbiH,eAAC8Y,KAAO,IACR9Y,eAACmU,IAAG,CAACpb,OAAQ,KAEbiH,eAAC+kB,GAAgB,CAAMz2B,QAAO6mB,aAE7BqD,EACDtE,gBAAC8C,WAAQ,CAAA5C,SAAA,CACPpU,eAACmU,IAAG,CAACpb,OAAQ,KACXiH,eAAC8Y,KAAO,IACV9Y,eAACmU,IAAG,CAACpb,OAAQ,KACbiH,eAACmU,IAAG,CAAAC,SACJpU,eAAC0V,KAAW,CAACpB,UAAU,WAAWC,UAAWX,EAAQ2M,OAAOnM,SAC1DpU,eAACqU,KAAS,CAACC,UAAU,SAAQF,SAC3BpU,eAAA,OAAKE,MAAO,CAAE2nB,WAAY,WAAYzT,SACnCoE,aAKK,S,oBCxYpB,MAAM/G,GAAYC,aAAWxY,IAAK,CAC9BygB,KAAM,CACFtH,QAAS,OACT4J,SAAU,OACVsL,eAAgB,eAChBjV,SAAU,SACVP,gBAAiB7Y,EAAM8Y,QAAQC,WAAWE,OAE9CR,UAAW,CACPC,WAAY1Y,EAAM2Y,QAAQ,GAC1BC,cAAe5Y,EAAM2Y,QAAQ,GAC7BE,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,SAE9CC,MAAO,CACHC,QAASlZ,EAAM2Y,QAAQ,GACvBiW,UAAW,SACXnsB,MAAOzC,EAAM8Y,QAAQkB,KAAKG,WAE5B0U,SAAU,CACRjvB,MAAO,IACPC,OAAQ,SAShB,SAASivB,GAAWlpB,GAClB,IAAI,IAAEqa,EAAG,MAAE8O,EAAK,IAAEC,GAAQppB,EAC1B,MAAMqpB,EAEF,6FAAUF,SAAaC,UAAY/O,IACvC,OAAOnZ,eAAA,OAAK0B,IAAKymB,EAAUC,IAAI,KAGjC,SAASC,GAAcvpB,GACL2S,KAAd,IACI,KAAEmJ,GAAS9b,EAEf,OAAOkB,eAACsoB,KAAS,CAAAlU,SACRwG,EAAK/xB,KAAKswB,GACPnZ,eAACuoB,KAAa,CAAcC,KAAM,EAAEpU,SAChCpU,eAACgoB,GAAU,CAAC7O,IAAKA,EAAIyB,KAAK,GAAIqN,MAAM,MAAMC,IAAI,YAD9B/O,EAAIlK,QAOzB,SAASwZ,GAAa3pB,GACjC,IAAI8U,EAAUnC,KACVmJ,EAAoB,CACpB,MAAO,SACT/xB,KAAK8e,IAAG,CACNsH,GAAItH,EACJiT,KAAM,CAACjT,GACP6U,KAAM,SAGV,OAAOtI,gBAAA,OAAKK,UAAWX,EAAQ+F,KAAKvF,SAAA,CAChCpU,eAAA,OAAAoU,SACApU,eAACqoB,GAAa,CAACzN,KAAMA,MAErB5a,eAAA,OAAAoU,SACApU,eAACqoB,GAAa,CAACzN,KAAMA,S,IC5CxB8N,G,gIA1BoCrkC,IAApCskC,WAAmBC,eAEnBD,WAAmBC,aAAe,OAClCD,WAAmBE,aAAe,IAAM,QAuB7B,SAAXH,OAAW,SAAXA,IAAW,SAAXA,IAAW,SAAXA,IAAW,UAAXA,QAAW,KAGhB,MAAQI,EAAC,GAAEC,EAAE,IAAIL,GAYjB,IAAIM,GAAU,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,KACxD,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,MAC9DC,GAAQ,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KACrC,IAAK,KAAM,KAAM,KAAM,IAAK,MAC5BC,GAAgB,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,KAAM,IAAK,KAClE,IAAK,KAAM,MACPC,GAAU,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KACvC,IAAK,KAAM,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,MAC7CC,GAAU,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KACvC,IAAK,KAAM,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,MAC7CC,GAAa,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,KAC3D,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,MAC9DC,GAAc,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,KAC5D,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,KAC7C,IAAK,KAAM,KAAM,KAAM,IAAK,MAE5BC,GAAM,CAAC,IAAK,KAAM,KAAM,IAAK,KAAM,KAAM,IAAK,KAAM,MA8DxD,IA4FIC,GAAuBC,IAgChB,CACH/Q,KAhCU7wB,KAAK0K,IAAI,GAAI,GACb1K,KAAK0K,IAAI,GAAI,GAgCvBm3B,OA7BJ,SAAgB9wB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACF,IAAfqP,EAAK8H,GAAGnX,GACVogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GACG,IAAfqP,EAAK8H,GAAGnX,KACjBqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,IAGzB,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACjC,IAAK,IAAI1gC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAI0gC,EAAS,EAAJ1gC,EAAQqP,EAAKiI,GAAGtX,GAItC,OAAOsgC,EAAQ,KADC,MAAFC,EAAwB,IAAFC,EAAsB,GAALC,EAAUC,IAW7DC,cAPU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAOtE2nB,YACAU,QAPYnB,GAQZrkC,KAAM,SAIVylC,GAAmBZ,GAAoB,GAqJvCa,GAzIyBZ,KACzB,MAAMa,EAAQziC,KAAK0K,IAAI,GAAI,GACrBg4B,EAAQ1iC,KAAK0K,IAAI,GAAI,GAmC3B,MAAO,CACHmmB,KAlCS4R,EAAQC,EADP,EAoCVb,OAjCJ,SAAgB9wB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIxgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAGtC,MAAMihC,EAAc,GAANV,EAAYC,EAC1B,IAAIU,EAAK,EACT,IAAK,IAAIlhC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAKkI,GAAGvX,KAAO9D,EAAKK,IACrB2kC,EAAKlhC,GAIX,OAAOihC,GA3BK,EA2BID,GA3BJ,EA2BqBV,EADnBY,GAWZP,cAPU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAOtE2nB,YACAU,QANYb,GAQZ3kC,KAAM,OA6FW+lC,CAAsB,GAC3CC,GA1FyBlB,KACzB,MAAMa,EAAQziC,KAAK0K,IAAI,GAAI,GACrBg4B,EAAQ1iC,KAAK0K,IAAI,GAAI,GAmC3B,MAAO,CACHmmB,KAlCS4R,EAAQC,EADP,EAoCVb,OAjCJ,SAAgB9wB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIxgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAGtC,MAAMihC,EAAc,GAANV,EAAYC,EAC1B,IAAIU,EAAK,EACT,IAAK,IAAIlhC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAKkI,GAAGvX,KAAO9D,EAAKK,IACrB2kC,EAAKlhC,GAIX,OAAOihC,GA3BK,EA2BID,GA3BJ,EA2BqBV,EADnBY,GAWZP,cAPU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAOtE2nB,YACAU,QANYd,GAQZ1kC,KAAM,OA8CWimC,CAAsB,GAC3CC,IA3CqBpB,GA2Cc,EAb5B,CACH/Q,KA9BU7wB,KAAK0K,IAAI,GAAI,GACb1K,KAAK0K,IAAI,GAAI,GA8BvBm3B,OA3BJ,SAAgB9wB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAItC,OAAY,KADI,IAAFugC,EAAuB,GAANC,EAAYC,GAChBH,GAUzBK,cAPU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAOtE2nB,aACAU,QANYnB,GAQZrkC,KAAM,OArCW8kC,OA4CzB,IA8DIqB,GA8BO,CACHpS,KA9BU7wB,KAAK0K,IAAI,GAAI,GACb1K,KAAK0K,IAAI,GAAI,GA8BvBm3B,OA3BJ,SAAgB9wB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAKugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MACnC,KAAK,GAAKwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MACnC,KAAK,GAAKygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAIvC,OAAY,KADI,IAAFugC,EAAuB,GAANC,EAAYC,GAChBH,GAUzBK,cAPU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAOtE2nB,UAAW,EACXU,QANYlB,GAQZtkC,KAAM,WAyBVomC,GAAwBA,CAACC,EAAmBvB,KA8BrC,CACH/Q,KA9BU7wB,KAAK0K,IAAI,GAAI,GACb1K,KAAK0K,IAAI,GAAI,GA8BvBm3B,OA5BJ,SAAgB9wB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,GAAKwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MACnC,KAAK,GAAKygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAIvC,OAAY,KADI,IAAFugC,EAAuB,GAANC,EAAYC,GAChBH,GAWzBK,cARU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAQtE2nB,YACAU,QAPaa,EAAW7B,GAAUC,GAQlCzkC,KAAM,WAAaqmC,EAAW,YAAc,cAIhDC,GAA0BA,CAACD,EAAmBvB,KAkDvC,CACH/Q,KAlDU7wB,KAAK0K,IAAI,GAAI,GACb1K,KAAK0K,IAAI,GAAI,GAkDvBm3B,OAAQsB,EAhDZ,SAAkBpyB,GAChB,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,GAAKygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAIvC,OAAY,KADI,IAAFugC,EAAuB,GAANC,EAAYC,GAChBH,GAE7B,SAAkBjxB,GACd,IAAI+wB,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIrgC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAGogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MACjC,KAAK,EAAGqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAGnC,MAAMsgC,EAAa,GAALF,EAAUC,EACxB,IAAIE,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,GAAKygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAIvC,OAAY,KADI,IAAFugC,EAAuB,GAANC,EAAYC,GAChBH,GAW3BK,cARU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAQtE2nB,YACAU,QAPaa,EAAW7B,GAAUC,GAQlCzkC,KAAM,YAAcqmC,EAAW,YAAc,cAqPjDE,GA7F0BC,CAACC,EAAmB3B,KAE9CA,EAAYA,GAAa,EACzB,MAAMa,EAAQziC,KAAK0K,IAAI,GAAI,GACrBg4B,EAAQ1iC,KAAK0K,IAAI,GAAI,GACrBmmB,EAAO4R,EAAQC,EA8CrB,MACML,EADQ,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAKpEqoB,EAAUnB,GAEhB,MAAO,CACHQ,GAAoBC,GACpB,CACI/Q,OACAgR,OAAS0B,EAxDjB,SAAsBxyB,GACpB,IAAI+wB,EAAK,EAAGC,EAAK,EAAGyB,EAAK,EACzB,IAAK,IAAI9hC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAIogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MAClC,KAAK,EAAIqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MAClC,KAAK,EAAI8hC,EAAS,EAAJ9hC,EAAQqP,EAAK+H,GAAGpX,GAGpC,MAAMsgC,EAAU,IAAFF,EAAsB,GAALC,EAAUyB,EACzC,IAAIvB,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,GAAKygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAIvC,OAAOsgC,EAAQU,GADC,IAAFT,EAAsB,GAALC,EAAUC,IAI3C,SAAqBpxB,GACjB,IAAI+wB,EAAK,EAAGC,EAAK,EAAGyB,EAAK,EACzB,IAAK,IAAI9hC,EAAI,EAAGA,EAAI,EAAGA,IACrB,OAAQqP,EAAK8H,GAAGnX,IACZ,KAAK,EAAIogC,EAAS,EAAJpgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MAClC,KAAK,EAAIqgC,EAAS,EAAJrgC,EAAQqP,EAAK+H,GAAGpX,GAAI,MAClC,KAAK,EAAI8hC,EAAS,EAAJ9hC,EAAQqP,EAAK+H,GAAGpX,GAGpC,MAAMsgC,EAAU,IAAFF,EAAsB,GAALC,EAAUyB,EACzC,IAAIvB,EAAK,EAAGC,EAAK,EAAGC,EAAK,EACzB,IAAK,IAAIzgC,EAAI,EAAGA,EAAI,GAAIA,IACpB,OAAQqP,EAAKgI,GAAGrX,IACZ,KAAK,EAAIugC,EAAS,EAAJvgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,EAAIwgC,EAAS,EAAJxgC,EAAQqP,EAAKiI,GAAGtX,GAAI,MAClC,KAAK,GAAKygC,EAAS,EAAJzgC,EAAQqP,EAAKiI,GAAGtX,GAIvC,OAAOsgC,EAAQU,GADC,IAAFT,EAAsB,GAALC,EAAUC,IAiBrCE,gBACAT,YACAU,UACAxlC,KAAM,WAAaymC,EAAW,QAAU,WA4BhDE,GAAiC,WACjC,MAAM5S,EAAyB,EAAlB7wB,KAAK0K,IAAI,GAAI,GAAS,EAAI,EACjCg5B,EAAc,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAsB5D,MAAO,CACH7S,OACAgR,OAvBJ,SAAgB9wB,GACd,IAAI4yB,EAAM,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1B,IAAK,IAAIjiC,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,IAAI4T,EAAMouB,EAAY3yB,EAAKgI,GAAGrX,IAC1B4T,EAAM,IACNquB,EAAIruB,GAAwB,EAAjBouB,EAAYhiC,GAASqP,EAAKiI,GAAGtX,IAG9C,IAAIkiC,EAAW,EACf,IAAK,IAAIliC,EAAI,EAAGA,EAAI,EAAGA,IACrBkiC,EAAsB,GAAXA,EAAgBD,EAAIjiC,GAEjC,OAAkB,EAAXkiC,EAAe,EAAiB,EAAb7yB,EAAKkI,GAAG,GAASlI,EAAK8H,GAAG,IAYjDwpB,cATU,CAAChlB,GAAKS,IAAQ,IACA9c,KAAKzB,IAAK,IAAIgZ,IAAYiC,MAAMjb,KASxDqiC,UAPc,EAQdU,QAPY,CAAC,IAAK,KAAM,KAAM,KAAM,IAAK,MAQzCxlC,KAAM,OA9BuB,GAoFrC,IAAI+mC,GAAmC,WACnC,MAAMhT,EAAO,GAAQ7wB,KAAK0K,IAAI,EAAG,GAAK,EAEhCg5B,EAAc,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GACtDI,EAAW,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAoBzD,MAAO,CACHjT,OACAgR,OArBJ,SAAgB9wB,GACd,IAAIiI,EAAK,EAAGD,EAAK,EACjB,IAAK,IAAIrX,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,IAAI4T,EAAMouB,EAAY3yB,EAAKgI,GAAGrX,IAC1B4T,GAAO,IACP0D,EAAU,EAALA,EAASjI,EAAKiI,GAAGtX,IAEtB4T,EAAM,IACNyD,GAAM/Y,KAAK0K,IAAI,EAAG4K,EAAM,GAAKwuB,EAASpiC,IAI5C,OAAwB,GAAX,GAALsX,EAAUD,GAAUhI,EAAKkI,GAAG,IAUlCopB,cAPkB,CAAC,IAAI9pB,IAQvBqpB,UAPc,GAQdU,QAPY,CAAC,IAAK,KAAM,KAAM,KAAM,IAAK,MAQzCxlC,KAAM,QA9ByB,GAkCnCinC,GAQO,CACHlT,KARS,GASTgR,OALJ,SAAgB9wB,GACZ,OAAoB,EAAbA,EAAKkI,GAAG,GAASlI,EAAKkI,GAAG,IAKhCopB,cATkB,CAAC,IAAI9pB,IAUvBqpB,UATc,EAUdU,QATYZ,GAUZ5kC,KAAM,U,aCt9BP,SAASknC,GAAMv9B,GACpB,OAAOw9B,iBArBT,SAAqBx9B,GAYnB,MAAO,CACLoS,GAAIpS,EAAMoS,GACVC,GAAIrS,EAAMqS,GACVC,GAAItS,EAAMsS,GACVC,GAAIvS,EAAMuS,IAKUkrB,CAAYz9B,ICGpC,SAAS09B,GAAOnzB,GACZ,MAAMozB,EAAkB,IACxB,IAEIC,EACAzC,EACA0C,EAECC,GAND,QAAEjC,EAAO,UAAEzb,EAAS,QAAE2d,GAAYxzB,EAClCyzB,EAAc,EAAGC,EAAc,EAUnC,SAASC,EAAY5zB,EAAiB6zB,EAAoBC,EAAoBC,GAO1E,OANAT,EAAQS,EACRlD,EAAYiD,EACZP,EAAYM,EACZH,EAAc,EACdC,EAAc,EACdxkB,EAAOnP,EAAM,EAAG,IACTszB,GAZA,SAANE,OAAM,uBAANA,IAAM,gBAANA,MAAM,KAeX,IAAIQ,EAAwC31B,OAAOC,OAAO,IA6F1D,SAAS6Q,EAAOnP,EAAiBi0B,EAAeC,GAE5C,GADAR,IACIA,EAAcL,EACd,OAAOG,EAAOW,KAElB,GAAIre,EAAU9V,GACV,OA5BR,SAAkBk0B,EAAkBD,GAChC,GAAIA,EAAQV,EAAW,OAAOC,EAAOY,SACrC,GAAId,EAAM9nC,UAAU+D,OAAS+jC,EAAMe,SAAU,CACzC,IAAIC,GAAO,EACX,IAAK,IAAIC,KAAOjB,EAAM9nC,UAClB,GAAIuF,EAAWwjC,EAAI3qB,MAAOsqB,GAAW,CACjCI,GAAO,EACP,MAGJA,GACAhB,EAAM9nC,UAAU+T,KAAK,IAAIoK,GAAQ,IAAIuqB,KAI7C,OAAIZ,EAAM9nC,UAAU+D,SAAW+jC,EAAMe,SAC1Bb,EAAOW,KAEPX,EAAOY,SAUPI,CAASN,EAAUD,GAE1B,GAAIA,GAASpD,EAAW,OAAO2C,EAAOY,SAEtC,OADQnlC,KAAK4H,OAAO48B,EAAQxjC,KAAIuY,GAAKA,EAAEisB,MAAMz0B,MACrCi0B,EAAQpD,GACZ8C,IACOH,EAAOY,UAjE1B,SAAgBp0B,EAAiBi0B,EAAeC,GAC5C,MAAMQ,EAA0BR,EAAS3kC,OAAS,EAAIykC,EAAUE,EAASA,EAAS3kC,OAAS,GAAGxD,MAAQwlC,EACtG,IAAIoD,EAA6C,KAEjD,GADY10B,EAAO20B,mBAGf,GADAD,EAAiB,IAAI/lB,IACE,IAAnB6kB,EAAQlkC,OACRolC,EAAev9B,IAAIq8B,EAAQ,GAAG3C,OAAO9wB,QACnC,CACF,IAAI+P,EAAI8kB,OAAOpB,EAAQ,GAAG3C,OAAO9wB,IAAS60B,OAAOpB,EAAQ,GAAG3T,MAAQ+U,OAAOpB,EAAQ,GAAG3C,OAAO9wB,IAC7F20B,EAAev9B,IAAI2Y,GAG3B,IAAK,IAAI7G,KAAQwrB,EAAgB,CAC7B,IAAII,EAAW90B,EAAKiJ,UAAUC,GAC1B0pB,EAA0B,IAAnBa,EAAQlkC,OAAgBkkC,EAAQ,GAAG3C,OAAOgE,GACjDD,OAAOpB,EAAQ,GAAG3C,OAAOgE,IAAaD,OAAOpB,EAAQ,GAAG3T,MAAQ+U,OAAOpB,EAAQ,GAAG3C,OAAOgE,IAE7F,GAAsB,MAAlBH,IAA2BA,EAAe1pB,IAAI2nB,GAAM,CAAC,IAADmC,EACtC,QAAdA,EAAAJ,SAAc,IAAAI,GAAdA,EAAgB39B,IAAIw7B,GACpBsB,EAAS30B,KAAK2J,GACd,IAAI8rB,EAAc7lB,EAAO2lB,EAAUb,EAAQ,EAAGC,GAE9C,GADAA,EAASvkB,MACLqlB,IAAOxB,EAAOW,KACd,OAAOX,EAAOW,MAI1B,OAAOX,EAAOY,SAuCCa,CAAOj1B,EAAMi0B,EAAOC,GAuBvC,OAjIA,WACI,SAASgB,EAAiBnpC,GACtB,OAAQA,EAAK,IACT,IAAK,IAAK,OAAOwlC,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KACjE,IAAK,IAAK,OAAOwlC,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,KAC5C,IAAK,IAAK,OAAOwlC,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KACjE,IAAK,IAAK,CACN,IAAIopC,EAAO5D,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KAE3D,MAAa,MAATA,EAAqBopC,EAAKrhB,QAAO1F,GAAgB,OAAXA,EAAEriB,OAC/B,OAATA,EAAsBopC,EAAKrhB,QAAO1F,GAAgB,MAAXA,EAAEriB,OAChC,OAATA,EAAsBopC,EAAKrhB,QAAO1F,GAAgB,OAAXA,EAAEriB,OACtCopC,EAEX,IAAK,IACL,IAAK,IACL,IAAK,IAAK,OAAO5D,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KAE3G,IAAK,IAAK,OAAOwlC,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KACtF,IAAK,IAAK,CACN,MAAMopC,EAAO5D,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KAC7D,MAAa,OAATA,EAAsBopC,EAAKrhB,QAAO1F,GAAgB,MAAXA,EAAEriB,OAC3B,MAATA,EAAqBopC,EAAKrhB,QAAO1F,GAAgB,OAAXA,EAAEriB,OAC/B,OAATA,EAAsBopC,EAAKrhB,QAAO1F,GAAgB,OAAXA,EAAEriB,OACtCopC,EAEhB,IAAK,IAAK,OAAO5D,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KAC3G,IAAK,IAAK,OAAOwlC,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KAEjE,IAAK,IAAK,OAAOwlC,EAAQzd,QAAO1F,GAAmB,MAAdA,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,IAA4B,MAAdqiB,EAAEriB,KAAK,KACtF,QAAS,OAAOwlC,GAGxB,IAAK,IAAIroB,KAAQqoB,EACbyC,EAAU9qB,EAAKnd,MAAQmpC,EAAiBhsB,EAAKnd,MAGrDqpC,GA4FO,CAAEnC,MAlBT,SAAejzB,EAAiBq1B,EAAiBC,EAAiBjB,GAC9D,IAAIf,EAAsB,CACtB9nC,UAAW,GACX6oC,YAEJ,IAAK,IAAI1jC,EAAI0kC,EAAS1kC,GAAK2kC,IACvBhC,EAAQM,EAAY5zB,EAAMq1B,EAAS1kC,EAAG2iC,KAClCA,EAAM9nC,UAAU+D,SAAW+jC,EAAMe,UAAYX,GAAeL,IAFhC1iC,KAOpC,OAAO2iC,EAAM9nC,WAMDsqB,YAAWyf,WAH3B,WACI,OAAO9B,IAKf,SAAS+B,GAAcC,GACnB,IAAIC,EAASC,GAAaxqB,IAAIsqB,GAC9BC,EAAOE,OAYP,OADaxC,GAPA,CACTtd,UAHa9V,GAA2C,IAAvB01B,EAAOjB,MAAMz0B,GAI9CuxB,QAASkE,EAAalE,QAAQthC,KAAIvB,GAAK4d,GAAKS,IAAIre,KAChD+kC,QAAS,CAACiC,GACVd,oBAAoB,IAOrB,SAASiB,GAAeC,GAC3B,IAAIrC,EAAUqC,EAAc7lC,KAAIyY,GACrBitB,GAAaxqB,IAAIzC,KAE5B+qB,EAAQluB,SAAQiD,GAAKA,EAAEotB,SAWvB,OADaxC,GANe,CACxBtd,UAHa9V,GAAoByzB,EAAQvd,OAAM1N,GAAuB,IAAlBA,EAAEisB,MAAMz0B,KAI5DuxB,QAASuE,EAAc,GAAGvE,QAAQthC,KAAIvB,GAAK4d,GAAKS,IAAIre,KACpD+kC,UACAmB,oBAAoB,IAO5B,IAQImB,GAAYvD,GAAsBgD,GFmLhBhD,KAClB,MAAM1S,EAAO7wB,KAAK0K,IAAI,GAAI,GACpBo3B,EAAKyB,EAAW,EAAI,EACpBtB,EAAKsB,EAAW,GAAK,GAmB3B,MAAO,CACH1S,OACAgR,OAnBJ,SAAgB9wB,GACd,IAAIjG,EAAI,CAAC,EAAG,EAAG,GACf,IAAK,IAAIpJ,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAK8H,GAAGnX,KAAOogC,IAAIh3B,EAAE,GAAS,EAAJpJ,EAAQqP,EAAK+H,GAAGpX,IAEjD,IAAK,IAAIA,EAAI,EAAGA,EAAI,GAAIA,IAChBqP,EAAKgI,GAAGrX,KAAOugC,EAAIn3B,EAAE,GAAS,EAAJpJ,EAAQqP,EAAKiI,GAAGtX,GAPzC,IAQIqP,EAAKgI,GAAGrX,KAAWoJ,EAAE,GAAS,EAAJpJ,EAAQqP,EAAKiI,GAAGtX,IAEvD,OAAOoJ,EAAE,GAAY,GAAPA,EAAE,GAAiB,GAAPA,EAAE,GAAU,IAWpCu3B,cARU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAQtE2nB,UAPc,EAQdU,QAPYlB,GAQZtkC,KAAM,MAAQymC,EAAW,SAAW,WE/MQwD,CAAexD,IAE/DyD,GAAczD,GAAsBgD,GFiNhBhD,KACpB,MAAM1S,EAAO7wB,KAAK0K,IAAI,GAAI,GACpBo3B,EAAKyB,EAAW,EAAI,EAkB1B,MAAO,CACH1S,OACAgR,OAlBJ,SAAgB9wB,GACd,IAAIk2B,EAAK,EAAGC,EAAK,EACjB,IAAK,IAAIxlC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAK8H,GAAGnX,KAAOogC,IAAImF,EAAS,EAAJvlC,EAAQqP,EAAK+H,GAAGpX,IAE/C,IAAK,IAAIA,EAAI,EAAGA,EAAI,GAAIA,IANf,IAODqP,EAAKgI,GAAGrX,KAAWwlC,EAAS,EAAJxlC,EAAQqP,EAAKiI,GAAGtX,IAEhD,OAAOulC,EAAU,GAALC,GAWV7E,cARU,CAAC,GAAI,IAAK,KAAM,MACFrhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAQtE2nB,UAPc,EAQdU,QAPYjB,GAQZvkC,KAAM,QAAUymC,EAAW,SAAW,WE3OQ4D,CAAiB5D,IAGnE6D,GAAe7D,GAAsBqD,GAAevD,GAAkBE,IAEtE8D,GAAc9D,IAAsBqD,UF4YO,CAC3C1D,GADqBC,EE5YgDI,EF6YrC,GAChCH,GAAwBD,EAAU,KAFbA,OEzYrBmE,GAAY/D,GAAsBgD,GF8YhBhD,KAClB,MAAM1S,EAAO7wB,KAAK0K,IAAI,GAAI,GACpBo3B,EAAKyB,EAAW,EAAI,EACpBtB,EAAKsB,EAAW,EAAI,EAoB1B,MAAO,CACH1S,OACAgR,OApBJ,SAAgB9wB,GACd,IAAIk2B,EAAK,EAAGC,EAAK,EAAGK,EAAK,EACzB,IAAK,IAAI7lC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAK8H,GAAGnX,KAAOogC,IAAImF,EAAS,EAAJvlC,EAAQqP,EAAK+H,GAAGpX,IAE/C,IAAK,IAAIA,EAAI,EAAGA,EAAI,GAAIA,IAChBqP,EAAKgI,GAAGrX,KAAOugC,EAAIiF,EAAS,EAAJxlC,EAAQqP,EAAKiI,GAAGtX,GAPvC,IAQIqP,EAAKgI,GAAGrX,KAAW6lC,EAAS,EAAJ7lC,EAAQqP,EAAKiI,GAAGtX,IAErD,OAAOulC,EAAU,GAALC,EAAe,GAALK,EAAU,IAY9BlF,cATU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAStE2nB,UAPc,EAQdU,QAPYnB,GAQZrkC,KAAM,MAAQymC,EAAW,SAAW,WE3aQiE,CAAejE,IAC/DkE,GAAkBlE,GAAsBgD,GF8ahBhD,KACxB,MAAM1S,EAAO7wB,KAAK0K,IAAI,GAAI,GACpBo3B,EAAKyB,EAAW,EAAI,EACpBtB,EAAKsB,EAAW,EAAI,EAmB1B,MAAO,CACH1S,OACAgR,OAnBJ,SAAgB9wB,GACZ,IAAIk2B,EAAK,EAAGC,EAAK,EAAGK,EAAK,EACzB,IAAK,IAAI7lC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAK8H,GAAGnX,KAAOogC,IAAImF,EAAS,EAAJvlC,EAAQqP,EAAK+H,GAAGpX,IAE/C,IAAK,IAAIA,EAAI,EAAGA,EAAI,GAAIA,IAChBqP,EAAKgI,GAAGrX,KAAOugC,EAAIiF,EAAS,EAAJxlC,EAAQqP,EAAKiI,GAAGtX,GAPzC,IAQMqP,EAAKgI,GAAGrX,KAAW6lC,EAAS,EAAJ7lC,EAAQqP,EAAKiI,GAAGtX,IAErD,OAAOulC,EAAU,GAALC,EAAe,GAALK,EAAU,IAWhClF,eATckB,EAAW,CAAC,KAAO,CAAC,OACNviC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAS1E2nB,UAPc,EAQdU,QAPYnB,GAQZrkC,KAAM,aAAeymC,EAAW,SAAW,WE1cOmE,CAAqBnE,IAC3EoE,GAAkBpE,GAAsBgD,GF6chBhD,KACxB,MAAM1S,EAAO7wB,KAAK0K,IAAI,GAAI,GACpBo3B,EAAKyB,EAAW,EAAI,EAoB1B,MAAO,CACH1S,OACAgR,OAnBJ,SAAgB9wB,GACZ,IAAIk2B,EAAK,EAAGC,EAAK,EAAGK,EAAK,EACzB,IAAK,IAAI7lC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAK8H,GAAGnX,KAAOogC,IAAImF,EAAS,EAAJvlC,EAAQqP,EAAK+H,GAAGpX,IAE/C,IAAK,IAAIA,EAAI,EAAGA,EAAI,GAAIA,IAPjB,IAQCqP,EAAKgI,GAAGrX,GAAWwlC,EAAS,EAAJxlC,EAAQqP,EAAKiI,GAAGtX,GAPzC,IAQMqP,EAAKgI,GAAGrX,KAAW6lC,EAAS,EAAJ7lC,EAAQqP,EAAKiI,GAAGtX,IAErD,OAAOulC,EAAU,GAALC,EAAe,GAALK,EAAU,IAWhClF,eATckB,EAAW,CAAC,KAAO,CAAC,OACNviC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAS1E2nB,UAPc,EAQdU,QAPYnB,GAQZrkC,KAAM,UAAYymC,EAAW,SAAW,WEzeUqE,CAAqBrE,IAC3EsE,GAActE,GAAsBgD,GF4ehBhD,KACpB,MAAM1S,EAAO7wB,KAAK0K,IAAI,GAAI,GACpBo3B,EAAKyB,EAAW,EAAI,EACpBtB,EAAKsB,EAAW,EAAI,EAwB1B,MAAO,CACH1S,OACAgR,OAvBJ,SAAgB9wB,GACd,IAAIk2B,EAAK,EAAGC,EAAK,EAAGK,EAAK,EAAGO,EAAK,EACjC,IAAK,IAAIpmC,EAAI,EAAGA,EAAI,EAAGA,IAChBqP,EAAK8H,GAAGnX,KAAOogC,IAAImF,EAAS,EAAJvlC,EAAQqP,EAAK+H,GAAGpX,IAE/C,IAAK,IAAIA,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,MAAMqX,EAAKhI,EAAKgI,GAAGrX,GACbsX,EAAKjI,EAAKiI,GAAGtX,GACfqX,IAAOkpB,EAAIiF,EAAS,EAAJxlC,EAAQsX,EAVrB,IAWED,EAAWwuB,EAAS,EAAJ7lC,EAAQsX,EAV1B,IAWED,IAAW+uB,EAAS,EAAJpmC,EAAQsX,GAEnC,OAAOiuB,EAAU,GAALC,EAAY,IAAFK,EAAmB,MAAFO,GAYrCzF,cATU,CAAC,IACarhC,KAAMiZ,IAAkB,IAAI1B,IAAYiC,MAAMP,KAStE2nB,UAPc,EAQdU,QAPYnB,GAQZrkC,KAAM,MAAQymC,EAAW,SAAW,WE7gBUwE,CAAiBxE,IAInEyE,GAAaA,CAACC,EAAqBC,IACnC3B,GFspBJ,SAA0B0B,EAAqBC,GAC3C,MAAMrX,EAAO,GAAQ7wB,KAAK0K,IAAI,EAAG,GAAK,EAAI,EAEpCg5B,EAAc,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GACtDI,EAAW,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAgBnDqE,EAAW5nC,EAAkB,CAAC,KAAM,KAAM,CAAC,MAAO,CAAC,GAAI,IAAK,KAAM,OAAQS,KAAIa,GAAKA,EAAEsY,KAAK,OAC1FiuB,EAAW7nC,EAAkB,CAAC,MAAO,CAAC,IAAK,MAAO,CAAC,MAAO,CAAC,GAAI,IAAK,KAAM,OAAOS,KAAIa,GAAKA,EAAEsY,KAAK,OACvG,IAAIQ,EAAkB,GACJ,EAAdstB,IAAoBttB,EAAQA,EAAMxZ,OAAOgnC,IAC3B,GAAdF,IAAoBttB,EAAQA,EAAMxZ,OAAOinC,IAI7C,IAAIC,EAAuB,GAY3B,OAXkB,EAAdJ,IAAoBI,EAAaA,EAAWlnC,OAH1B,CAAC,IAAK,QAIV,GAAd8mC,IAAoBI,EAAaA,EAAWlnC,OAH1B,CAAC,MAAO,UAavB,CACH0vB,OACAgR,OArCJ,SAAgB9wB,GACd,IAAIiI,EAAK,EAAGD,EAAK,EACjB,IAAK,IAAIrX,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAC3B,IAAI4T,EAAMouB,EAAY3yB,EAAKgI,GAAGrX,IAC1B4T,GAAO,IACP0D,EAAU,EAALA,EAASjI,EAAKiI,GAAGtX,IAEtB4T,EAAM,IACNyD,GAAM/Y,KAAK0K,IAAI,EAAG4K,EAAM,GAAKwuB,EAASpiC,IAI5C,OAAwB,GAAX,GAALsX,EAAUD,GAAU,EAAyB,KAAlBhI,EAAKkI,GAAG,GAAK,GAASlI,EAAK8H,GAAG,IA0B/DwpB,eAX8B,WAAhB6F,EAA2BG,EACxB,SAAhBH,EAAyB,CAAC,MAAQvtB,GAEP3Z,KAAKzB,IAAK,IAAIgZ,IAAYiC,MAAMjb,KAS5DqiC,UAPc,GAQdU,QAPY,CAAC,IAAK,KAAM,KAAM,KAAM,IAAK,MAQzCxlC,KAAM,QAAUmrC,EAAc,IAAMC,GEpsB1BI,CAAiBL,EAAaC,ICpP5CK,GAAc,CAClB,OAAO,KAAM,WAAY,UAAW,WAAY,UAAW,YAC3D,aAAc,YACd,MAAO,SAAU,SAAU,OAAQ,WAAY,WAAY,SAAU,KAAM,QAEvE7B,GAAe,WACf,IAAI8B,EAA+B,IAAI1sB,IAWvC,MAAO,CAAEI,IAVT,SAAazC,GACT,IAAIgvB,EAAM/vB,KAAKQ,UAAUO,GACzB,GAAK+uB,EAAMxsB,IAAIysB,GAKX,OAAOD,EAAMtsB,IAAIusB,GALA,CACjB,IAAIhC,EHiDT,SAAgBz1B,GACnB,IAAI03B,GACA,KAAE7X,EAAI,OAAEgR,EAAM,cAAEQ,EAAa,UAAET,EAAWU,QAASqG,EAAW,KAAE7rC,GAAQkU,EACxEsxB,EAAUqG,EAAY3nC,KAAIa,GAAKwb,GAAKS,IAAIjc,KACxC+mC,GAAc,EACdC,EAAe,CAAC,IAAIxG,IA0CxB,MAAQ,CACJsE,KA1CJ,WACI,GAAIiC,EAAa,OACjBA,GAAc,EACdF,EAAO,IAAII,WAAWjY,GAAMrvB,KAAK,KACjC,IAAK,IAAIiF,KAAS47B,EACdqG,EAAK7G,EAAOp7B,IAAU,EAE1B,IAAIsiC,EAAW,IAAI1G,GACf2G,EAAiBD,EAASzoC,OAC9B,IAAK,IAAIoB,EAAI,EAAGA,EAAIkgC,EAAWlgC,IAAK,CAEhC,IAAIunC,EAAe,GACnB,IAAK,IAAIxiC,KAASsiC,EACd,IAAK,IAAI9uB,KAAQqoB,EAAS,CACtB,IAAI4G,EAAWziC,EAAM+T,MAAMP,GACvB3E,EAAMusB,EAAOqH,GACC,MAAdR,EAAKpzB,KACLozB,EAAKpzB,GAAO5T,EAAI,EAChBunC,EAAa34B,KAAK44B,IAI9BH,EAAWE,EACPj4B,EAAOm4B,kBAAoBznC,EAAI,GAAKsP,EAAOm4B,kBAC3CN,EAAav4B,KAAK,IAAIy4B,IAE1BC,GAAkBD,EAASzoC,OAG3B0Q,EAAOm4B,kBAcX3D,MAVJ,SAAez0B,GACX,IAAI1R,EAAIqpC,EAAK7G,EAAO9wB,IACpB,OAAU,MAAN1R,EAAkBuiC,EAAY,EAC3BviC,GAQP+pC,MANJ,SAAeziB,EAAkB0iB,GAC7B,OAAOxH,EAAOlb,KAAWkb,EAAOwH,IAMhCxH,SACAS,UACAV,YACA/Q,QGvGiByY,CAAO7vB,GAEpB,OADA+uB,EAAMjgC,IAAIkgC,EAAKhC,GACRA,KAPA,GAef8C,GAAe,WACf,IAAIf,EAA+B,IAAI1sB,IA0CvC,MAAO,CAACI,IAzCR,SAAazc,GACT,IAAK+oC,EAAMxsB,IAAIvc,GACX,OAAQA,GACJ,IAAK,OAAQ+oC,EAAMjgC,IAAI9I,EDuMhB8mC,GAAchE,KCvMoB,MACzC,IAAK,KAAMiG,EAAMjgC,IAAI9I,EDgMhB8mC,GAAcvD,KChMkB,MACrC,IAAK,QAASwF,EAAMjgC,IAAI9I,EDiMf8mC,GAAczD,KCjMqB,MAC5C,IAAK,QAAS0F,EAAMjgC,IAAI9I,EDkMf8mC,GAAc/D,KClMqB,MAC5C,IAAK,WAAYgG,EAAMjgC,IAAI9I,EAAG6nC,IAAS,IAAQ,MAC/C,IAAK,UAAWkB,EAAMjgC,IAAI9I,EAAG6nC,IAAS,IAAS,MAC/C,IAAK,kBAAmBkB,EAAMjgC,IAAI9I,EAAGgoC,IAAe,IAAQ,MAC5D,IAAK,iBAAkBe,EAAMjgC,IAAI9I,EAAGgoC,IAAe,IAAS,MAC5D,IAAK,iBAAkBe,EAAMjgC,IAAI9I,EAAGkoC,IAAe,IAAQ,MAC3D,IAAK,gBAAiBa,EAAMjgC,IAAI9I,EAAGkoC,IAAe,IAAS,MAC3D,IAAK,aAAca,EAAMjgC,IAAI9I,EAAGooC,IAAW,IAAQ,MACnD,IAAK,YAAaW,EAAMjgC,IAAI9I,EAAGooC,IAAW,IAAS,MACnD,IAAK,WAAYW,EAAMjgC,IAAI9I,EAAGqnC,IAAS,IAAQ,MAC/C,IAAK,UAAW0B,EAAMjgC,IAAI9I,EAAGqnC,IAAS,IAAS,MAC/C,IAAK,aAAc0B,EAAMjgC,IAAI9I,EAAGunC,IAAW,IAAQ,MACnD,IAAK,YAAawB,EAAMjgC,IAAI9I,EAAGunC,IAAW,IAAS,MACnD,IAAK,aAAcwB,EAAMjgC,IAAI9I,EAAG2nC,IAAW,IAAQ,MACnD,IAAK,YAAaoB,EAAMjgC,IAAI9I,EAAE2nC,IAAW,IAAS,MAClD,IAAK,aAAcoB,EAAMjgC,IAAI9I,EAAE4nC,IAAW,IAAQ,MAClD,IAAK,YAAamB,EAAMjgC,IAAI9I,EAAE4nC,IAAW,IAAS,MAClD,IAAK,KAAMmB,EAAMjgC,IAAI9I,ED6LhB8mC,GAActD,KC7LkB,MAErC,IAAK,YAAauF,EAAMjgC,IAAI9I,GD8MxC+pC,wBAcO,CACHxF,MAdJ,SAAejzB,EAAkB3R,EAAYD,EAAYulB,GACrDtiB,QAAQqnC,OAAO3nC,EAAWiP,EAAKkI,IAAI,IAAIV,IAAYU,IAAK,8BAAgClI,EAAKkI,IAC7F,MAAMywB,EAAmB34B,EAAKwL,kBAC9Bna,QAAQqnC,OAAQC,EAAiBltB,eAAgB,0BACjD,IAAIyoB,EAAW0E,GAAgBD,GAC/B,MAAO,CAAE,IAAIhvB,GAAQuqB,GAAUrnB,QAU/BiJ,UARJ,SAAmB9V,GACf,OAAO,GAQPu1B,WANJ,WACI,MAAO,OC1NoD,MACnD,IAAK,MAAOkC,EAAMjgC,IAAI9I,EDiMhB8mC,GAAc9C,KCjMmB,MACvC,IAAK,WAAY+E,EAAMjgC,IAAI9I,EAAGuoC,GAAW,EAAM,SAAU,MACzD,IAAK,SAAUQ,EAAMjgC,IAAI9I,EAAGuoC,GAAW,IAAQ,MAC/C,IAAK,SAAUQ,EAAMjgC,IAAI9I,EAAGuoC,GAAW,KAAQ,MAC/C,IAAK,OAAQQ,EAAMjgC,IAAI9I,EAAGuoC,GAAW,KAAQ,MAC7C,IAAK,WAAYQ,EAAMjgC,IAAI9I,EAAGuoC,GAAW,EAAM,WAAY,MAC3D,IAAK,WAAYQ,EAAMjgC,IAAI9I,EAAGuoC,GAAW,GAAM,WAAY,MAC3D,IAAK,SAAUQ,EAAMjgC,IAAI9I,EAAGuoC,GAAW,GAAM,WAAY,MACzD,IAAK,OAASQ,EAAMjgC,IAAI9I,ED8LjB8mC,GAAc1C,KC9LqB,MAE1C,IAAK,SAAU2E,EAAMjgC,IAAI9I,ED8LhB8mC,GAAcxC,KC3L/B,OAAOyE,EAAMtsB,IAAIzc,KAzCN,GCHnB,MAAMmqB,GAAYC,aAAWxY,IAAK,CAChCu4B,MAAO,CACL34B,MAAO,OACP6rB,SAAU,IACV5S,gBAAiB7Y,EAAM8Y,QAAQC,WAAWE,WA+B/B,SAASuf,GAAY5yB,GAClC,MAAM,MAACxQ,EAAK,SAAE6mB,GAAYrW,EACpB8U,EAAUnC,KACVkgB,EAAUrjC,EAAMqjC,QAAQjlB,QAAOH,GAAKA,EAAEtT,OAAS3K,EAAM2K,QASnD24B,EAAUC,GAAgB7yB,IAAM9a,UAAU,GAE5CmzB,EAAcA,IAAMwa,GAAa,GAEjCC,EAAgB5d,gBAAC6D,IAAM,CAACZ,KAAMya,GAAY,EAAG3Z,QAASZ,EAAYjD,SAAA,CACtEpU,eAACkY,KAAW,CAACjJ,GAAG,qBAAoBmF,SAAE,oCACtCF,gBAACkE,IAAa,CAAAhE,SAAA,CACZpU,eAACuX,IAAM,CAACG,QAASL,EAAa1b,MAAM,UAASyY,SAAC,OAG9CpU,eAACuX,IAAM,CAACG,QAPSqa,KANfH,GAAY,GAAKA,EAAWD,EAAQxpC,QACxCgtB,EAAS,CAAEvwB,KAAM,UAAWwwB,QAAS,CAAEuc,EAAQC,IAAaxK,OAAQ,WAK/ByK,GAAa,IAOjBl2B,MAAM,UAAUioB,WAAS,EAAAxP,SAAC,eAMrD4d,EAAeC,GAAqBjzB,IAAM9a,UAAS,IACnDguC,EAAWC,GAAiBnzB,IAAM9a,SAAS,IAE7CkuC,EAAiBA,IAAMH,GAAiB,GAWxCI,EAAYne,gBAAC6D,IAAM,CAACZ,KAAM6a,EAAe/Z,QAASma,EAAgB,kBAAgB,oBAAmBhe,SAAA,CACzGpU,eAACkY,KAAW,CAACjJ,GAAG,oBAAmBmF,SAAC,kBACpCF,gBAACiE,IAAa,CAAA/D,SAAA,CACZF,gBAACoe,KAAiB,CAAAle,SAAA,CAAC,yCACqBpU,eAAA,SAAS,uFAIjDA,eAACuY,KAAS,CACRqL,WAAS,EACTJ,WAAS,EACTvB,OAAO,QACPhT,GAAG,OACHwJ,WAAS,EACT/D,SAjBoBrgB,IACxB89B,EAAa99B,EAAM9J,OAAO0W,QAiBtBpT,UAAawG,IAAYA,EAAMiC,wBAGnC4d,gBAACkE,IAAa,CAAAhE,SAAA,CACZpU,eAACuX,IAAM,CAACG,QAAS0a,EAAgBz2B,MAAM,UAASyY,SAAC,WAGjDpU,eAACuX,IAAM,CAACG,QAhCa6a,KACvB,IAAK9oC,EAAK+oC,GAxDd,SAAwBlkC,EAAiBhH,GACvC,MAAMmC,EAAkB,GAElBgpC,EAAa,IAAIjrB,IAAI4oB,IAC3B,IAAK,MAAMsC,KAAQprC,EAAE6gB,MAAM,MAAO,CAChC,IAAIqgB,EAAOkK,EAAKvqB,MAAM,KACtB,GAAoB,IAAhBqgB,EAAKrgC,OAAc,SACvB,IAAIg/B,EAASqB,EAAK,GAAGxE,OAAO7b,MAAM,KAC9BsU,EAAQ+L,EAAK,GAAGxE,OAEpB,GAAImD,EAAOrY,OAAMplB,GAAK+oC,EAAW5uB,IAAIna,KAAK,CACxC,IAAIw9B,EAAkB,CACpBjuB,KAAM3K,EAAM2K,KACZkuB,SACA1K,SAEFhzB,EAAI0O,KAAK+uB,IAGb,OAAIz9B,EAAItB,OAAS,EAAU,CAACsB,GAAK,GACrB,CAAE,IAAI,GAoCIkpC,CAAerkC,EAAO4jC,GACtCM,GACFrd,EAAS,CAAEvwB,KAAM,UAAWwwB,QAAS3rB,EAAK29B,OAAQ,QAEpDgL,KA2BqCz2B,MAAM,UAASyY,SAAC,kBAOvD,OACEF,gBAAA,OAAAE,SAAA,CACC0d,EACAO,EACDryB,eAACgiB,KAAK,CAAA5N,SACJF,gBAAC0e,KAAK,CAACre,UAAWX,EAAQ6d,MAAO/Y,KAAK,QAAOtE,SAAA,CAC3CpU,eAAC6yB,KAAS,CAAAze,SACRF,gBAAC4e,KAAQ,CAAA1e,SAAA,CACPpU,eAAC+yB,KAAS,CAACC,MAAM,SAAQ5e,SAAC,eAC1BpU,eAAC+yB,KAAS,CAACC,MAAM,SAASC,QAAS,EAAE7e,SACnCpU,eAAC2nB,KAAU,CAAGjQ,QAnDRwb,IAAMjB,GAAiB,GAmDK3d,UAAU,OAAO6e,KAAK,MAAMza,KAAK,QAAQ/c,MAAM,UAASyY,SACxFpU,eAACozB,KAAO,aAShBpzB,eAACqzB,KAAS,CAAAjf,SACPud,EAAQ9oC,KAAI,CAACoY,EAAO1X,IAGjB2qB,gBAAC4e,KAAQ,CAAA1e,SAAA,CAIPpU,eAAC+yB,KAAS,CAACC,MAAM,SAAQ5e,SACvBnT,EAAMkmB,OAAOnlB,KAAK,KAAO,IAAMf,EAAMwb,QAEvCvI,gBAAC6e,KAAS,CAACC,MAAM,SAAQ5e,SAAA,CACvBpU,eAAC2nB,KAAU,CAAC9S,QAAUxtB,GAA0CA,EAAEkD,OAAOwqB,OAAS2C,QAASA,IAlG7FnuB,KACZ4rB,EAAS,CAAEvwB,KAAM,UAAWwwB,QAAS,CAAEuc,EAAQpoC,IAAM69B,OAAQ,YAiGkDkM,CAAK/pC,GACtG+qB,UAAU,OAAO6e,KAAK,MAAMza,KAAK,QAAQ/c,MAAM,UAASyY,SACtDpU,eAACuzB,KAAgB,MAGnBvzB,eAAC2nB,KAAU,CAAC9S,QAAUxtB,GAA0CA,EAAEkD,OAAOwqB,OAAS2C,QAASA,IAAMma,EAAYtoC,GAC7G+qB,UAAU,OAAO6e,KAAK,MAAMza,KAAK,QAAQ/c,MAAM,UAASyY,SACtDpU,eAACwzB,KAAiB,WAfTjqC,e,iGCnI7B,MAAMkoB,GAAYC,aAAWxY,IACzB,IAAIu6B,EAA2C,YAA/Bv6B,EAAM8Y,QAAQmB,QAAQ2G,KACtC,MAAQ,CACR4Z,KAAM,CACJ3hB,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,SAE5CP,UAAW,CACTU,QAAS,QAEXshB,KAAM,CACJhP,SAAU,GAEZhL,KAAM,CACJtH,QAAS,QAEXuhB,IAAK,CACH7hB,gBAAiB0hB,EAAYv6B,EAAM8Y,QAAQmB,QAAQ2G,KAAO,UAC1Dne,MAAOzC,EAAM8Y,QAAQC,WAAWE,MAEhCE,QAAS,OACT4J,SAAU,SACVsL,eAAgB,iBAElBtU,OAAQ,CACNlB,gBAAiB0hB,EAAY,UAAY,UACzC93B,MAAOzC,EAAM8Y,QAAQC,WAAWE,MAChCQ,YAAa,GACbmF,YAAa,EACbD,WAAY,GACZ9e,OAAQ,GACRsnB,WAAY,IACZ5M,SAAU,SACV7B,WAAY,EACZE,cAAe,EACf,CAAC5Y,EAAMoG,YAAYojB,KAAK,OAAQ,CAC9B/P,YAAa,GACbmF,aAAc,EACdD,WAAY,GACZpE,SAAU,UAEZ,CAACva,EAAMoG,YAAYojB,KAAK,MAAO,CAC7BpG,SAAU,UA6DHuX,IC5CVC,GD4CUD,GAtDf,SAAoB/0B,GAGhB,IAAI8U,EAAUnC,MACV,MAAExQ,EAAK,SAAEyT,EAAQ,UAAEqf,EAAS,aAAEC,EAAY,eAAEC,GAAmBn1B,EAC/Do1B,EAAYC,GAAUlzB,GAAO,IAAM,GAMvC,MAAMmzB,EAAQh1B,aAAclG,GAAMoG,YAAYojB,KAAK,OACnD,OACI1iB,eAAA,OAAAoU,SACIpU,eAACmU,IAAG,CAACkgB,UAAW,EAAEjgB,SAClBF,gBAACogB,KAAO,CAAC/f,UAAWX,EAAQggB,IAAIxf,SAAA,CAChCpU,eAAC4b,IAAU,CAAC1b,MAAO,CAACq0B,SAAU,aAAc9gB,SAAU,SAAUoU,WAAY,eAAezT,SACxFggB,EAAQ,oBAAY,iBAEvBp0B,eAACmU,IAAG,CAACK,SAAU4f,EAAQ,EAAG,KAC1Bp0B,eAACmU,IAAG,CAAAC,SACApU,eAACw0B,KAAM,CACF/b,WAAS,EACTxX,MAAOizB,EACP3f,UAAWX,EAAQX,OACnByB,SAnBGrgB,IAChB,IAAIogC,EAAUN,GAAUO,WAAUhrC,GAAKA,EAAE,KAAQ2K,EAAM9J,OAAO0W,QAC9DyT,EAAS+f,IAkBI5f,QAAUxtB,GAAMA,EAAEkD,OAAOwqB,OACzByC,QAAQ,WAAUpD,SAEjB+f,GAAUtrC,KAAK,CAACvB,EAAGiC,IACnByW,eAAC20B,KAAQ,CAAS1zB,MAAO3Z,EAAE,GAAIogC,GAAI,CAACkN,GAAI,KAAM10B,MAAO,CAACuT,SAAU,SAAU8H,aAAc,GAAGnH,SACxFggB,EAAQ9sC,EAAE,GAAKA,EAAE,IADLiC,SAMzByW,eAACmU,IAAG,CAACjU,MAAO,CAAC8S,SAAU,IAAIoB,SAAC,MAC5BF,gBAACC,IAAG,CAAAC,SAAA,CACFpU,eAAC2nB,KAAU,CAACjQ,QAASqc,EAAWrb,KAAM0b,EAAQ,QAAU,QAAQhgB,SAC5DpU,eAAC60B,KAAY,MAEjB70B,eAAC2nB,KAAU,CAACjQ,QAASsc,EAActb,KAAM0b,EAAQ,QAAU,QAAQhgB,SAC/DpU,eAAC80B,KAAe,MAEpB90B,eAAC2nB,KAAU,CAACjQ,QAASuc,EAAgBvb,KAAM0b,EAAQ,QAAU,QAAQhgB,SACjEpU,eAAC+0B,KAAQ,iB,UC9GpB,MAAeC,GAAU59B,cAAA,KAEnBzS,UAAI,GAEV,MAAMswC,WAAqBD,GAAU59B,cAAA,SAAA9O,WAAA,KACxC3D,KAAO,aACPod,sBAeI,OADc,IAAI4B,IAbc,CAC5B,CAAC,IAAK,IAAM,CAAC,KAAM,IAAM,CAAC,KAAM,GAChC,CAAC,IAAK,IAAM,CAAC,KAAM,IAAM,CAAC,KAAM,KAChC,CAAC,IAAK,GAAI,CAAC,KAAM,GAAI,CAAC,KAAM,KAC5B,CAAC,IAAK,GAAI,CAAC,KAAM,GAAI,CAAC,KAAM,KAC5B,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,KAChC,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,KAChC,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,GAChC,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,KAChC,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,KAChC,CAAC,IAAK,GAAM,CAAC,KAAM,KAAM,CAAC,KAAM,GAChC,CAAC,IAAK,KAAM,CAAC,KAAM,KAAM,CAAC,KAAM,OAOxCuxB,SAAS1yB,GACL,IAAIsL,EAAM,EACV,IAAK,IAAI1mB,KAAKob,EAAMA,MAAO,CAEvBsL,GADemnB,GAAaE,SAASpxB,IAAI3c,EAAEzC,OAAU,IAIzD,OAA4B,IAArB6d,EAAMA,MAAMra,OAAe2lB,GA5B7BmnB,GAmBFE,SAAWF,GAAaG,eAiC5B,MAAMC,WAAyBL,GAAU59B,cAAA,SAAA9O,WAAA,KAC5C3D,KAAO,WAEPuwC,SAASI,GACL,IAAIC,EAAQ,EACR/yB,EAAQ,CAAC,MAAO8yB,EAAY9yB,MAAM3Z,KAAIa,GAAKA,EAAE/E,OAAO,IACxD,IAAK,IAAI4E,EAAG,EAAGA,EAAIiZ,EAAMra,OAAS,EAAGoB,IAAK,CACtC,IAAIisC,EAAWhzB,EAAMjZ,GAAKiZ,EAAMjZ,EAAI,GAChCksC,EAAaC,OAAOC,WAAWN,GAAiBO,MAAMJ,IACtDE,OAAOG,MAAMJ,KACbA,EAAa,IAEjBF,GAASE,EAEb,OAAOF,GAdFF,GAEFO,MAAQE,GAiBR,SAANhC,OAAM,eAANA,IAAM,mBAANA,IAAM,qBAANA,IAAM,qBAANA,IAAM,wBAANA,QAAM,KAOJ,MAAMiC,WAAoBf,GAAU59B,cAAA,SAAA9O,WAAA,KACvC3D,KAAO,KAEPod,sBACI,MAAMi0B,EAAK,GAmCX,MAjCwC,CAWpC,EAAM,CAAC,EAAG,EAAGA,EAAIA,GACjB,KAAM,CAAC,EAAG,EAAG,EAAG,GAChB,GAAM,CAAC,IAAK,IAAK,IAAK,KACtB,EAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,KAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,GAAM,CAAC,IAAK,IAAK,IAAK,KACtB,EAAM,CAAC,IAAKA,EAAI,EAAGA,GACnB,KAAM,CAAC,EAAG,IAAK,EAAGA,GAClB,GAAM,CAACA,EAAI,EAAG,EAAGA,GACjB,EAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,KAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,GAAM,CAAC,IAAK,IAAK,IAAKA,GACtB,EAAM,CAACA,EAAI,EAAG,EAAGA,GACjB,KAAM,CAAC,EAAG,IAAK,EAAGA,GAClB,GAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,EAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,KAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,GAAM,CAAC,IAAKA,EAAI,IAAKA,GACrB,EAAM,CAAC,EAAG,EAAG,EAAGA,GAChB,KAAM,CAAC,EAAG,IAAK,IAAK,GACpB,GAAM,CAAC,IAAK,EAAG,EAAG,IAK1Bj0B,4BACI,IAAI,OAACk0B,EAAM,QAAEC,EAAO,KAAEh8B,EAAI,QAAEi8B,EAAO,SAAEC,GAAYtC,GACjD,MAAO,CAEH,EAAM,CAACmC,EAASC,EAASh8B,EAAUk8B,GACnC,KAAM,CAACD,EAASj8B,EAASk8B,EAAWH,GACpC,GAAM,CAACC,EAASC,EAAQF,EAAS/7B,GAEjC,EAAM,CAAC+7B,EAASC,EAASh8B,EAAUk8B,GACnC,KAAM,CAACD,EAASj8B,EAASk8B,EAAWH,GACpC,GAAM,CAACC,EAASC,EAAQF,EAAS/7B,IAKzC6H,wBAYI,MAVwB,CAEpB,CAAC,EAAG,EAAG,EAAG,GAEV,CAAC,IAAK,EAAG,EAAG,GAEZ,CAAC,IAAK,EAAG,EAPF,IASP,CAAC,EAAG,EATG,GASI,IAMnBmzB,SAASI,GACL,OAAOjrC,KAAKgsC,mBAAmBf,GAAagB,KAEhDD,mBAAmBf,GAEf,MAAMU,EAAK,IAELO,EAAMjB,EAAY9yB,MAAMra,OACxBquC,EAAKhuC,MAAM+tC,EAAM,GAAGltC,KAAK,MAAMR,KAAI,IAAM,CAACmtC,EAAIA,EAAIA,EAAIA,KACtDS,EAAUjuC,MAAM+tC,EAAM,GAAGltC,KAAK,MAAMR,KAAI,IAAML,MAAM,GAAGa,KAAK,MAAMR,KAAI,IAAM,EAAE,GAAI,OAElF6tC,EAAaX,GAAYW,WACzBvB,EAAWY,GAAYZ,SACvBwB,EAAiBZ,GAAYY,eAE/BH,EAAG,GAAK,CAAC,EAAG,EAAG,EAAGR,GAItB,IAAK,IAAIzsC,EAAI,EAAGA,EAAIgtC,EAAKhtC,IAAK,CAC1B,MAAMuY,EAAOwzB,EAAY9yB,MAAMjZ,GAAG5E,KAClC,IAAK,IAAIiyC,EAAY,EAAGA,EAAY,EAAGA,IACnC,IAAK,IAAIC,EAAe,EAAGA,EAAe,EAAGA,IAAgB,CACzD,MAAMC,EAAaN,EAAGjtC,GAAGqtC,GAAaF,EAAWE,GAAWC,GAAgB1B,EAASrzB,GAAM+0B,GACrFE,EAAWJ,EAAe70B,GAAQ60B,EAAe70B,GAAM+0B,GAAgBA,EACzEE,IAAajD,GAAOsC,WACpBU,EAAaN,EAAGjtC,EAAE,GAAGwtC,KACrBP,EAAGjtC,EAAE,GAAGwtC,GAAYD,EACpBL,EAAQltC,EAAE,GAAGwtC,GAAY,CAACH,EAAWC,MAOrD,IAAIG,EAAehB,EACfiB,GAAuB,EAC3B,IAAK,IAAIC,EAAO,EAAGA,EAAO,EAAGA,IACrBV,EAAGD,GAAKW,GAAQF,IAChBA,EAAeR,EAAGD,GAAKW,GACvBD,EAAsBC,GAG9B,IAAIC,EAAeF,EACfG,EAAmC,CAAC,CAACD,EAAcA,IACvD,IAAK,IAAI5tC,EAAIgtC,EAAKhtC,GAAK,EAAGA,IAAK,CAC3B,MAAO8tC,EAAeC,GAAyBb,EAAQltC,GAAG4tC,GAC1DC,EAAaj/B,KAAK,CAACk/B,EAAeC,IAClCH,EAAeE,EAEnBD,EAAa1uB,UAEb,IAAI6uB,EAAW,CACX,OAAQ,SAAU,UAAW,WAE7B3V,EAAO,cAAc2V,EAASH,EAAa,GAAG,MAC9CI,EAA6B,GACjC,IAAK,IAAIjuC,EAAI,EAAGA,EAAIgtC,EAAKhtC,IAAK,CAC1B,IAAKkuC,EAAIC,GAAMN,EAAa7tC,GACxBuY,EAAOwzB,EAAY9yB,MAAMjZ,GAAG5E,KAC5B8yC,IAAOC,EAAIF,EAAgBr/B,KAAK2J,IAEhC8f,GAAQ,QAAQ4V,EAAgBx1B,KAAK,mBAAmBu1B,EAASG,KACjEF,EAAkB,CAAC11B,IAK3B,OAFI01B,EAAgBrvC,SAAQy5B,GAAQ,QAAQ4V,EAAgBx1B,KAAK,QACjE4f,GAAQ,YAAY2V,EAASH,EAAab,GAAK,MACxC,CACHpd,IAAKmc,EAAY1xB,WACjB0yB,KAAMU,EAENpV,KAAMA,IAjJLmU,GAyCFZ,SAAWY,GAAYX,eAzCrBW,GAuDFY,eAAiBZ,GAAY4B,qBAvD3B5B,GAuEFW,WAAaX,GAAY6B,iBCzI7B,IAAIC,GAA+B,CACtCzyC,SAAU,GACV0yC,cAAe,GACfC,cAAe,GACf9P,MAAO,KACP+P,YAAa,MACbC,gBAAiB,GACjBC,aAAc,EACdC,SAAU,KACVC,UAAW,UACXC,gBAAgB,G,mDCcpB,MAAM5mB,GAAYC,aAAWxY,IAAK,CAC9ByY,UAAW,CACTC,WAAY1Y,EAAM2Y,QAAQ,GAC1BC,cAAe5Y,EAAM2Y,QAAQ,GAC7BE,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,QAC1CmK,WAAY,uBAEd1mB,OAAQ,CACNmD,MAAO,QAETqZ,MAAO,CACLC,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,SACfgJ,aAAc,EACd+I,aAAc,GAEhBgU,OAAQ,CACN3lB,YAAazZ,EAAM2Y,QAAQ,GAC3BD,WAAY1Y,EAAM2Y,QAAQ,GAC1BQ,QAAS,OACTC,SAAU,OACVC,cAAe,SACfgJ,aAAc,EACd+I,aAAc,GAEhB9R,YAAa,CACXJ,QAASlZ,EAAM2Y,QAAQ,GACvBQ,QAAS,OACTC,SAAU,OACVC,cAAe,UAEjBE,WAAY,CACV9W,MAAOzC,EAAM8Y,QAAQC,WAAWE,OAElCO,eAAgB,CACdC,YAAazZ,EAAM2Y,QAAQ,IAE7Be,WAAY,CAEV,CAAC1Z,EAAMoG,YAAYzQ,GAAG,OAAQ,CAC5BgkB,UAAW,MAGf4J,MAAO,CACL2F,WAAY,WACZ3O,SAAU,SACV4M,WAAW,IACX,CAACnnB,EAAMoG,YAAYojB,KAAK,OAAQ,CAChCjP,SAAU,SACV4M,WAAY,MAGdkE,QAAS,GAETC,KAAM,CACJC,WAAY,IAAKC,UAAW,SAAUC,SAAU,QAChD,CAACzrB,EAAMoG,YAAYojB,KAAK,OAAQ,CAC9BgC,UAAW,SACXC,SAAU,WAGd7R,YAAa,CACX/Z,OAAQ,KAEVga,MAAQ,CACJpX,MAAOzC,EAAM8Y,QAAQkB,KAAK+G,SAC1BoG,WAAY,IACZC,aAAc,aAElBiY,OAAS,CACPlY,WAAY,IACZgD,UAAW,EACXnH,OAAQ,YACRoI,aAAc,EACd7Q,SAAU,UAEZwU,MAAO,CACLrW,WAAY,EACZe,YAAa,GAEf6lB,WAAY,CACVC,aAAc,IAEhBC,UAAW,CACT/8B,MAAOzC,EAAM8Y,QAAQkB,KAAKC,QAC1BwlB,cAAe,QAEjB/T,WAAa,CACTjpB,MAAOzC,EAAM8Y,QAAQqB,UAAUyG,KAC/BrG,SAAU,GACVrB,QAAS,GAEbyS,eAAiB,GAIjBC,IAAK,CACH53B,SAAU,WACV6G,IAAKmF,EAAM2Y,QAAQ,GACnBhe,KAAMqF,EAAM2Y,QAAQ,IAEtB0O,OAAQ,CACN5kB,MAAOzC,EAAM8Y,QAAQkB,KAAKG,WAE5BulB,YAAa,CACX3W,OAAQ/oB,EAAM2Y,QAAQ,GACtB8S,SAAU,GACVrI,SAAU,KAEZuc,KAAM,CACF,sBAAuB,CACnBzW,WAAY,SACZ9P,SAAU,SACVwmB,aAAc,iBAKpBC,GAAczqC,IACX,IACFA,EACH0qC,aAAc,GACdjB,cAAe,GACf3yC,SAAU,GACV6iC,MAAO,OAGX,SAASgR,GAAan6B,GAClB,IAAI,MAAExQ,EAAK,SAAE4qC,GAAap6B,EACtB8U,EAAUnC,KACd,MAAMvY,EAAQmG,eACR85B,EAAgB/5B,aAAclG,EAAMoG,YAAYojB,KAAK,OAE3D,IAAMzhB,EAAO6hB,GAAa9jB,IAAM9a,SAASoK,EAAMlJ,UAiB/C,OACA8uB,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,QAAQ+B,SAAA,CAE5BpU,eAACmU,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQ2J,WAAY,SAAUhJ,SAAU,GAAGoB,SAC/DpU,eAACuY,KAAS,CACRG,KAAK,SACLD,WAAS,EACT+K,WAAS,EACTC,QAAS,EACT5P,MAAO,WACP5S,MAAOA,EACPyT,SA1BkBrgB,IACtByuB,EAAc,OAALzuB,QAAK,IAALA,OAAK,EAALA,EAAO9J,OAAO0W,QA0BnBuW,QAAQ,SACR4hB,WAAY,CACV1R,GAAI,CAACjU,SAAU,SAAU4M,WAAY,UAI3CrgB,eAACmU,IAAG,CAACjU,MAAO,GAAIqU,UAAWX,EAAQ4Q,OACnCtQ,gBAACC,IAAG,CAACuT,GAAI,CAAErV,QAAS,OAAQE,cAAe4mB,EAAgB,SAAW,MAAOE,IAAqB,GAAWrd,WAAY,WAAY5H,SAAA,CACnIpU,eAACuX,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAAS2C,QA3BlC4hB,KACd,IAAI1gC,EAAOwT,GAASmB,qBAAqB+C,GAAKa,YAC1C/rB,EAAWgsC,GAAartB,IAAI,aAAa8nB,MAAMjzB,EAAK,EAAE,EAAE,GAAG,GAAG6M,MAAM7B,WACxEs1B,EAAS,IAAIH,GAAWzqC,GAAQlJ,aAChC09B,EAAS19B,IAwBDszB,KAAK,SAASlB,QAAQ,YAAY7b,MAAM,UAASyY,SAAE,QAGzDpU,eAACuX,IAAM,CAAC1C,QAAUC,GAAQA,EAAIvqB,OAAOwqB,OAAS2C,QAnChC6hB,KAEhBL,EAAS,IAAIH,GAAWzqC,GAAQlJ,SAAU6b,KAkClCyX,KAAK,SAASlB,QAAQ,YAAY7b,MAAM,UAASyY,SAAE,aAOjE,SAASolB,GAAW16B,GAClB,IAAI,MAAExQ,EAAK,SAAE4qC,GAAap6B,EACtB8U,EAAUnC,KAEd,MAAMgoB,EAAY,CAChBC,WAAY,CACRx5B,MAAO,CACHoc,SAAU,MAGlB/H,UAAWX,EAAQilB,MAGfc,EAAW,CAAElmB,SAAU,UAE7B,IAAImmB,EAAatrC,EAAM0pC,YAAc,IAAM1pC,EAAM2pC,gBAK7C4B,EAAmBvrC,EAAM8pC,UAiB7B,OACAlkB,gBAACC,IAAG,CAAC9B,QAAQ,OAAO4J,SAAS,OAAOod,IAAK,EAAG3R,GAAI,CAAEoS,OAAQ,GAAG1lB,SAAA,CAC3DpU,eAACmU,IAAG,CAACI,UAAWX,EAAQ4kB,WAAWpkB,SACjCF,gBAACwB,KAAW,CAACnB,UAAWX,EAAQglB,YAAYxkB,SAAA,CAC1CpU,eAAC+5B,KAAU,CAAC9qB,GAAG,kCAAiCmF,SAAC,mBACjDF,gBAACsgB,KAAM,CACLwF,QAAQ,kCACR/qB,GAAG,4BACHhO,MAAO24B,EACPllB,SA9BWrgB,IACjB,IAAI4M,EAAkB5M,EAAM9J,OAAO0W,MAAOkH,MAAM,KAChD+wB,EAAS,IAAI5qC,EAAO0pC,YAAa/2B,EAAM,GAAIg3B,gBAAiBh3B,EAAM,MA6B5Dg5B,UAAWR,EACX/R,GAAIiS,EAASvlB,SAAA,CAEbpU,eAAC20B,KAAQ,CAAC1zB,MAAO,OAAOmT,SAAC,eACzBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,QAAQmT,SAAC,eAC1BpU,eAAC20B,KAAQ,CAAC1zB,MAAO,QAAQmT,SAAC,eAC1BpU,eAAC20B,KAAQ,CAAC1zB,MAAO,MAAMmT,SAAC,qBAE1BpU,eAACk6B,KAAc,SAGnBl6B,eAACmU,IAAG,CAACI,UAAWX,EAAQ4kB,WAAWpkB,SACjCF,gBAACwB,KAAW,CAACnB,UAAWX,EAAQglB,YAAYxkB,SAAA,CAC5CpU,eAAC+5B,KAAU,CAAC9qB,GAAG,kCAAiCmF,SAAC,aACjDF,gBAACsgB,KAAM,CACLwF,QAAQ,kCACR/qB,GAAG,4BACHhO,MAAO44B,EACPnlB,SA5CqBrgB,IACzB,IAAI4M,EAAS5M,EAAM9J,OAAO0W,MAC1Bi4B,EAAS,IAAI5qC,EAAO8pC,UAAWn3B,KA2C3Bg5B,UAAWR,EACX/R,GAAIiS,EAASvlB,SAAA,CAEbpU,eAAC20B,KAAQ,CAAC1zB,MAAO,UAAUmT,SAAC,UAC5BpU,eAAC20B,KAAQ,CAAC1zB,MAAO,WAAWmT,SAAC,iBAE/BpU,eAACk6B,KAAc,SAGjBl6B,eAACmU,IAAG,CAAEI,UAAWX,EAAQ4kB,WAAWpkB,SACpCF,gBAACwB,KAAW,CAACnB,UAAWX,EAAQglB,YAAYxkB,SAAA,CAC1CpU,eAAC+5B,KAAU,CAAC9qB,GAAG,kCAAiCmF,SAAC,gBACjDF,gBAACsgB,KAAM,CACLwF,QAAQ,kCACR/qB,GAAG,4BACHhO,MAAO3S,EAAM4pC,aACbxjB,SAzDqBrgB,IACzB,IAAI4M,EAAQy0B,OAAOyE,SAAS9lC,EAAM9J,OAAO0W,OACzCi4B,EAAS,IAAI5qC,EAAO4pC,aAAcj3B,GAAS3S,EAAM4pC,gBAwD7C+B,UAAWR,EACX/R,GAAIiS,EAASvlB,SAAA,CAEbpU,eAAC20B,KAAQ,CAAC1zB,MAAO,EAAEmT,SAAC,MACpBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,EAAEmT,SAAC,OACpBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,EAAEmT,SAAC,MACpBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,GAAGmT,SAAC,QACrBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,GAAGmT,SAAC,WAEvBpU,eAACk6B,KAAc,SAGjBl6B,eAACmU,IAAG,CAAEI,UAAWX,EAAQ4kB,WAAWpkB,SACpCF,gBAACwB,KAAW,CAACnB,UAAWX,EAAQglB,YAAYxkB,SAAA,CAC1CpU,eAAC+5B,KAAU,CAAC9qB,GAAG,kCAAiCmF,SAAC,aACjDF,gBAACsgB,KAAM,CACLwF,QAAQ,kCACR/qB,GAAG,4BACHhO,MAAO3S,EAAM6pC,SACbzjB,SAzEiBrgB,IACrB,IAAI4M,EAAS5M,EAAM9J,OAAO0W,MAC1Bi4B,EAAS,IAAI5qC,EAAO6pC,SAAUl3B,KAwE1Bg5B,UAAWR,EACX/R,GAAIiS,EAASvlB,SAAA,CAEbpU,eAAC20B,KAAQ,CAAC1zB,MAAO,KAAKmT,SAAC,OACvBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,KAAKmT,SAAC,OACvBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,YAAYmT,SAAC,cAC9BpU,eAAC20B,KAAQ,CAAC1zB,MAAO,WAAWmT,SAAC,aAC7BpU,eAAC20B,KAAQ,CAAC1zB,MAAO,WAAWmT,SAAC,eAE/BpU,eAACk6B,KAAc,SAGjBl6B,eAACmU,IAAG,CAACI,UAAWX,EAAQ4kB,WAAWpkB,SACjCF,gBAACwB,KAAW,CAACnB,UAAWX,EAAQglB,YAAYxkB,SAAA,CAC1CpU,eAAC+5B,KAAU,CAAC9qB,GAAG,uBAAsBmF,SAAC,WACtCF,gBAACsgB,KAAM,CACLwF,QAAQ,uBACR/qB,GAAG,wBACHhO,MAAO3S,EAAM+pC,eAAez0B,WAC5B8Q,SAzFqBrgB,IAC3B,IAAI4M,EAAS5M,EAAM9J,OAAO0W,MAC1Bi4B,EAAS,IAAI5qC,EAAO+pC,eAA0B,SAAVp3B,KAwF9Bg5B,UAAWR,EACX/R,GAAIiS,EAASvlB,SAAA,CAEbpU,eAAC20B,KAAQ,CAAC1zB,MAAO,OAAOmT,SAAC,QACzBpU,eAAC20B,KAAQ,CAAC1zB,MAAO,QAAQmT,SAAC,UAE5BpU,eAACk6B,KAAc,YA0EvB,SAASE,GAAcC,GACnB,MAAMhK,EAAQ,IAAI1sB,IAElB,OAAQwB,IACJ,MAAMzF,EAAM46B,OAAOn1B,GACnB,GAAIkrB,EAAMxsB,IAAInE,GACV,OAAO2wB,EAAMtsB,IAAIrE,GAGrB,MAAM5W,EAASuxC,EAAGl1B,GAElB,OADAkrB,EAAMjgC,IAAIsP,EAAK5W,GACRA,GAaR,MAAMyxC,GAAyBH,IARtC,SAA2BI,GACvB,MAAMC,EAAe,IAAIl4B,GAAQi4B,GAAU/0B,MACrC7M,GAAO,IAAIwH,IAAYiC,MAAMo4B,GAEnC,OADiBrJ,GAAartB,IAAI,UAAU8nB,MAAMjzB,EAAM,EAAG,EAAG,GAAG,GACjDgL,cAOd82B,GAAuCtrB,GAAYc,eAWzD,SAASyqB,GAAS91B,GAAoC,IAAnC,OAAEiL,GAA8BjL,EACjD,OACE7E,eAACmU,IAAG,CAACuT,GAAI,CAAErV,QAAS,cAAe2J,WAAY,SAAUqd,IAAK,IAAKjlB,SAChEtE,EAAOjnB,KAAI,CAAC8S,EAAOpS,IAClByW,eAACmU,IAAG,CAEFuT,GAAI,CACF5uB,MAAO,SACPC,OAAQ,SACRgZ,gBAAiB2oB,GAAS/+B,GAC1BugB,OAAQ,4BACR7J,QAAS,iBANN9oB,OAsBR,MAAMqxC,GAA4BR,IAPzC,SAAgCpC,GAC5B,MAAMp/B,GAAO,IAAIwH,IAAYiC,MAAM21B,GAC7B6C,EAAO9xB,GAAYiB,iBAAiBpR,EAAM,CAAC,EAAG,EAAG5S,EAAIE,IACrD40C,EAAO/xB,GAAYiB,iBAAiBpR,EAAM,CAAC,EAAG,EAAG5S,EAAIE,IACrD60C,EAAe,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,KAC/C,MAAO,CAACA,EAAaF,GAAOE,EAAaD,OAI7C,SAASE,GAAkBl8B,GACzB,IAAI,SAAEguB,EAAQ,MAAE7E,EAAK,QAAE1Z,EAAO,YAAEypB,EAAW,OAAEiD,GAAWn8B,EAAMguB,SAS1DoO,EARUC,MACZ,GAAc,OAAVlT,EAAgB,CAClB,MAAMnY,EAAS8qB,GAA0B5C,GAAe,IACxD,MAAO,CAACh4B,eAAC26B,GAAS,CAAc7qB,OAAQA,GAAjB,UAA6BmrB,GAAQvuB,OAAO0uB,SAC9D,MAAc,aAAVnT,GAAkC,YAAVA,EAC1B,CAAEA,GACG,IAELkT,GACX,MAAME,OAAsCh3C,IAAzBya,EAAMw8B,gBAAgCxO,EAAStqB,MAAMra,SAAW2W,EAAMw8B,eACnFC,EAAqBhB,GAAuBvC,EAAc,IAAMzpB,GAEtE,OACE2F,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQkJ,aAAc,MAAOS,WAAY,UAAU5H,SAAA,CACtE8mB,EAAKxuB,QAAOhjB,GAAGA,IAAGb,KAAK,CAAC2yC,EAAGjyC,IAC1ByW,eAACy7B,KAAI,CAACjkB,QAAQ,WAAWkB,KAAK,QAAQ/c,MAAM,UAAUkY,MAAO2nB,EAC3D9T,GAAI,CAAE,mBAAoB,CAAEjU,SAAU,SAAU4M,WAAY,IAAKjO,QAAS,QAC9CuS,SAAU,MAAOmD,UAAW,SAC5BzV,QAAS,OACT2J,WAAY,SAAUuL,eAAgB,YAJCh+B,KAOvEyW,eAACmU,IAAG,CAACjU,MAAO,CAACpH,MAAO,UACpBkH,eAACmU,IAAG,CAACjU,MAAO,CAAC2X,WAAY,GAAGzD,SAC1BF,gBAAC0H,IAAU,CAAC8L,GAAI,CAACjU,SAAU,UAAUW,SAAA,CAClCmnB,EAAqB,IAAMzO,EAAStqB,MAAM3Z,KAAIzB,GAAKA,EAAEzC,OAAMqd,KAAK,KAChEq5B,GAAc,eAQzB,SAASK,GAAsB58B,GAC7B,IAAI,UAAE1a,EAAS,eAAEu3C,EAAc,MAAErtC,GAAUwQ,EAC3C,MAAO88B,EAAYC,GAAiB78B,IAAM9a,UAAUoK,EAAM+pC,gBAG1Dr5B,IAAM9Z,WAAU,KACd22C,GAAevtC,EAAM+pC,kBACpB,CAAC/pC,EAAM+pC,eAAgBj0C,IAG1B,MAAM03C,EAAmB13C,EAAU+D,OAAS,EAC1C/D,EAAUsE,QAAO,CAACqzC,EAAUl8B,IAC1BA,EAAQitB,SAAStqB,MAAMra,OAAS4zC,EAASjP,SAAStqB,MAAMra,OAAS0X,EAAUk8B,IACzE,KAWAC,GAAkC,OAAhBF,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkBhP,SAAStqB,MAAMra,SAAU,EAC7D8zC,EAAqB73C,EAAUsoB,QAAOplB,GAAKA,EAAEwlC,SAAStqB,MAAMra,SAAW6zC,IAEvEE,EAAyC,CAC7C,GAAM,KACN,GAAM,KACN,GAAM,YACN,KAAQ,eAGJC,EAD8BF,EAAmBpzC,KAAIvB,IAAC,CAAM80C,IAAKF,EAAc50C,EAAE2zC,QAAU,MAAOoB,QAASzB,GAA0BtzC,EAAE0wC,aAAe,QACrGtvC,QAAO,CAAC4zC,EAAKC,KAC7DD,EAAIC,EAAKH,OAAQE,EAAIC,EAAKH,KAAO,IAAI50B,KAC1C80B,EAAIC,EAAKH,KAAKpsC,IAAIusC,EAAKF,QAAQr6B,KAAK,MAC7Bs6B,IACN,IACGE,EAAyBvlC,OAAOrO,QAAQuzC,GAAoBtzC,KAAI6hB,IAAsB,IAApB0xB,EAAKK,GAAS/xB,EACpF,MAAMgyB,EAAa,IAAID,GAAU5zC,KAAIlE,IACnC,MAAOg4C,EAAQC,GAAUj4C,EAAKwjB,MAAM,KACpC,OAAOnI,eAAC26B,GAAS,CAAY7qB,OAAQ,CAAC6sB,EAAQC,IAAvBj4C,MAGzB,OACEuvB,gBAAClV,IAAMgY,SAAQ,CAAA5C,SAAA,CACbpU,eAACmU,IAAG,CAACuT,GAAI,CAAE5uB,MAAO,OAAQ+jC,GAAI,GAAIzoB,SAChCpU,eAAC4b,IAAU,CAACpE,QAAQ,QAAQ7b,MAAM,eAAe+rB,GAAI,CAAEjU,SAAU,SAAUqU,UAAW,UAAW1T,SAC9F,gBAAgB4nB,SAAuBI,GAAO,sBAGnDp8B,eAACmU,IAAG,CAACuT,GAAI,CAAErV,QAAS,OAAQ4J,SAAU,OAAQod,IAAK,EAAK9R,eAAgB,SAAUsV,GAAI,GAAIzoB,SACvFsoB,MAPgBN,MAazB,OACEp8B,eAACmU,IAAG,CAACgO,WAAY,EAAE/N,SAChBhwB,EAAU+D,OAAS,GAClB6X,eAACmU,IAAG,CAACuD,QAAUkkB,OAA2Bv3C,EA1C5Bs0B,KAClBkjB,GAAc,IAyC2CnU,GAAI,CAAEoV,OAASlB,EAAyB,UAAZ,WAAwBxnB,SACrGwnB,EAQA57B,eAACmU,IAAG,CAAAC,SACDhwB,EAAUshB,MAAM,EAAGi2B,GAAgB9yC,KAAI,CAACvB,EAAGiC,IAC1CyW,eAACg7B,GAAiB,CAChBlO,SAAUxlC,EAEVg0C,eAAgC,OAAhBQ,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkBhP,SAAStqB,MAAMra,QAD5CoB,OAXX2qB,gBAACC,IAAG,CAACuT,GAAI,CAAE5uB,MAAO,QAASsb,SAAA,CACxBooB,EACDx8B,eAAC4b,IAAU,CAACpE,QAAQ,QAAQ7b,MAAM,iBAAiB+rB,GAAI,CAAEqV,GAAI,EAAGtpB,SAAU,SAAUqU,UAAW,UAAW1T,SAAC,6BAmL1G4oB,OApHf,SAAsBl+B,GAClB,IAAMxQ,MAAO2uC,GAAan+B,EAE1B,MAAM5F,EAAQmG,eACd,IAAM/Q,EAAO4qC,GAAal6B,IAAM9a,SAAS2zC,IAErCjkB,EAAUnC,KAEVlH,EAAO+F,GAAKgB,YACZ4rB,GAAY,IAAI98B,IAAYiC,MAAM/T,EAAMlJ,UAAUid,MAAM/T,EAAMwpC,eAC9DhtB,EAAc/B,GAAYuB,WAAW4yB,EAAW3yB,GAEpD,MAAM4yB,EAAer5C,aAAYwK,GAEjC,IAAI8uC,EAAuBD,EAAah5C,UAAY,GAAMg5C,EAAa/4C,WAAa,GAChFi5C,EAA2BD,EAAqBj1C,OAE5B,aAApBmG,EAAM8pC,YACRgF,EAAuBA,EAAqBE,MAAM,CAAC5zC,EAAGkL,IAAMlL,EAAE6rC,MAAQ3gC,EAAE2gC,QACxE8H,EAA2B/uC,EAAM4pC,cAKnC,MAAMqF,EAAQn+B,aAAclG,EAAMoG,YAAYzQ,GAAG,OAC3CysB,EAAQlc,aAAclG,EAAMoG,YAAYzQ,GAAG,OAC3CsqC,EAAgB/5B,aAAclG,EAAMoG,YAAYojB,KAAK,OAC3Dz4B,QAAQ6hB,IAAI,gBAAiBqtB,EAAejgC,EAAMoG,aAClD,MAAMqnB,EAAa4W,GAAuBjiB,EAAd,CAAC,IAAK,KAA8B,CAAC,IAAK,KAEhEkiB,EACJx9B,eAACgiB,KAAK,CAACzN,UAAWX,EAAQzB,MAAO+P,UAAW,EAAE9N,SAC5CpU,eAACw5B,GAAU,CAAClrC,MAAOA,EAAO4qC,SAAUA,MAuBxC,OAnBGlX,KAAiBpO,EAAQ0kB,OACzBnkB,IAEG7lB,EAAMypC,cAAc5vC,QAAU,IAAIg7B,YAC/BhP,IACEA,IAAeP,EAAQb,MAIzBoB,IAA0BP,EAAQ4Q,MAW3CtQ,gBAACC,IAAG,CAACI,UAAWX,EAAQjC,UAAUyC,SAAA,CAChCpU,eAACgiB,KAAK,CAACzN,UAAWX,EAAQzB,MAAO+P,UAAW,EAAE9N,SAC5CpU,eAACi5B,GAAY,CAAC3qC,MAAOA,EAAO4qC,SAAUA,OAGtCC,GAAiBqE,EAGnBx9B,eAACgiB,KAAK,CAACzN,UAAYX,EAAQzB,MAAMiC,SACjCF,gBAAC6N,IAAI,CAACpQ,WAAS,EAAAyC,SAAA,CACbpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC6S,GAAI,EAAGD,GAAI,GAAI3b,GAAI,GAAI6N,UAAWX,EAAQ2Q,QAAQnQ,SAC3DF,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,QAAS+B,SAAA,CAC7BpU,eAACmU,IAAG,CAAC9B,QAAQ,OAAM+B,SACfF,gBAACC,IAAG,CAACjU,MAAO,CAACmS,QAAS,OAAQE,cAAe,SAAU+U,UAAW,cAAclT,SAAA,CAC9EpU,eAACmU,IAAG,CAACI,UAAWX,EAAQb,MAAO7S,MAAO,GAAGkU,SAAC,cAG1CpU,eAACmU,IAAG,CAAAC,SACJpU,eAACuX,IAAM,CAAChD,UAAWX,EAAQ2kB,OAAQ7f,KAAK,QAAQlB,QAAQ,WAAW7b,MAAM,UAASyY,SAC9E9lB,EAAM25B,eAKhBjoB,eAACmU,IAAG,CAACjU,MAAO,GAAIqU,UAAWX,EAAQ4Q,OACnCxkB,eAACmU,IAAG,CAACjU,MAAO,CAAC8S,SAAU,GAAGoB,SACxBpU,eAAC07B,GAAqB,CAACt3C,UAAWg5C,EAAsBzB,eAAgB0B,EAA0B/uC,MAAOA,EAAO4qC,SAAUA,WAKhIl5B,eAAC+hB,IAAI,CAACtS,MAAI,EAAC6S,GAAI,EAAG5b,GAAI,GAAIxG,MAAO,CAACmS,QAAS,OAAQkV,eAAgB,UAAUnT,SAC3EpU,eAACmU,IAAG,CAACjU,MAAO,CAAC6R,gBAAiB,oBAAoBqC,SAChDpU,eAACnB,GAAO,CACN/F,MAAO6tB,EAAU,GACjB5tB,OAAQ4tB,EAAU,GAClB/tB,KAAMkS,EACN9R,YAAaikC,EAASjkC,YAAYmX,gBAAgB,MAClD/W,aAAe,EACfF,MAAO+jC,EAASpkC,OAAOK,MAAM6nB,gBAE7BznB,cAAgB,CAAC7T,EAAKK,EAAGL,EAAKI,EAAGJ,EAAKE,cAW7CwzC,GAAiBqE,M,UCruBxB,SAASC,GAAS3+B,GAChB,MAAM,SAAEsV,EAAQ,MAAEnT,EAAK,MAAEy8B,KAAUC,GAAU7+B,EAE7C,OACEkB,eAAC4b,IAAU,CACTtH,UAAU,MACVspB,KAAK,WACLC,OAAQ58B,IAAUy8B,EAClBzuB,GAAI,mBAAmByuB,IACvB,kBAAiB,cAAcA,OAC3BC,EAAKvpB,SAERnT,IAAUy8B,GAAS19B,eAACmU,IAAG,CAAC/S,EAAG,EAAEgT,SAAEA,MAItC,MAAM3C,GAAYC,aAAWxY,IAAK,CAChCw6B,KAAM,CACJ3hB,gBAAiB7Y,EAAM8Y,QAAQC,WAAWC,SAE5CP,UAAW,CACTU,QAAS,QAEXshB,KAAM,CACJhP,SAAU,GAEZhL,KAAM,CACJtH,QAAS,QAEXuhB,IAAK,CACH7hB,gBAAiB7Y,EAAM8Y,QAAQmB,QAAQ2G,KACvCne,MAAOzC,EAAM8Y,QAAQC,WAAWE,OAGlCc,OAAQ,CACNlB,gBAAiB7Y,EAAM8Y,QAAQmB,QAAQ2G,KACvCne,MAAOzC,EAAM8Y,QAAQC,WAAWE,MAChCmS,aAAc,EACdpI,OAAQ,aAAehjB,EAAM8Y,QAAQC,WAAWC,aAIvCiiB,GAAuC,CAClD,CAAC,KAAM,sBAAuB,cAC9B,CAAC,WAAY,kCAAmC,0BAChD,CAAC,KAAM,qBAAsB,aAC7B,CAAC,OAAQ,+BAAgC,kBACzC,CAAC,OAAQ,oCAAqC,sBAC9C,CAAC,OAAQ,wCAAyC,qBAClD,CAAC,KAAM,sBAAuB,aAC9B,CAAC,OAAQ,OAAQ,QAEjB,CAAC,KAAM,SAAU,UACjB,CAAC,SAAU,eAAgB,YAI7B,SAAS2J,KACP,MAAMC,EAAc5J,GAAUO,WAAUhrC,GAAc,SAATA,EAAE,KAC/C,GAAIgM,OAAOsoC,SAASC,KAAM,CACxB,IAAI9gC,EAAMg3B,GAAUO,WAAUhrC,GAAKA,EAAE,KAAOgM,OAAOsoC,SAASC,KAAKv4B,MAAM,KACvE,OAAa,IAATvI,GACFzH,OAAOsoC,SAASC,KAAO,GAChBF,GAEA5gC,EAGT,OAAO4gC,EA4DX,SAASG,KACP,OAAOl+B,eAACm+B,KAAQ,CAAA/pB,SAzDA,syGAwKHgqB,OA3Gf,SAAiBt/B,GAEf,IAAI,MAAExQ,EAAK,SAAE6mB,GAAarW,EACtB8U,EAAUnC,KAEd,MAAMkD,EAAe3V,IAAMq/B,aAAczpB,IACvC,GAAIA,EAAWuf,GAAUhsC,OAAQ,CAC/B26B,EAASlO,GACT,IAAI3b,EAAOk7B,GAAUvf,GAAU,GAC/BO,EAAS,CAACvwB,KAAM,OAAQwwB,QAASnc,OAElC,CAACkc,KAEIgC,EAAMC,GAAYpY,IAAM9a,UAAS,IAElC+c,EAAO6hB,GAAY9jB,IAAM9a,SAAS45C,MACzC9+B,IAAM9Z,WAAW,KACfiwB,EAAS,CAACvwB,KAAM,OAAQwwB,QAAS+e,GAAU2J,MAA2B,OACrE,CAAC3oB,IAEJ,MACMmpB,EAAkBA,KAAQlnB,GAAQ,KAchCmnB,EAAS9X,GAAWznB,IAAM9a,UAAS,GAQ3C,OACEgwB,gBAAA,QAAAE,SAAA,CACEF,gBAAC6D,IAAM,CAACZ,KAAMA,EAAMc,QAASqmB,EAAgBlqB,SAAA,CAC7CpU,eAACmY,IAAa,CAACqmB,UAAQ,EAAApqB,SACrBpU,eAACk+B,GAAK,MAERl+B,eAACoY,IAAa,CAAAhE,SACZpU,eAACuX,IAAM,CAAC5b,MAAM,UAAU+b,QAAS4mB,EAAgBlqB,SAAC,iBAMpDpU,eAAC6zB,GAAU,CAACnf,SAAUC,EAAc1T,MAAOA,EACzCgzB,eArCiBA,KAAQ7c,GAAQ,IAqCD4c,aAlCjBA,KACnB,MAAMyK,EAAa,IAAInwC,EAAMuK,OAAOK,MAAMuc,OAC1CgpB,EAAW,GAAK,EAAIA,EAAW,GAC/BA,EAAW,GAAK,EAAIA,EAAW,GAC/BtpB,EAAS,CAAEvwB,KAAM,SAAUwwB,QAAS,CAClClc,MAAO5K,EAAMuK,OAAOK,MAAM2c,SAAS4oB,OA6B2B1K,UA1BhDA,KAChBtN,GAAQ8X,MA4BNv+B,eAACmU,IAAG,CAACuqB,SAAU,EAAGlqB,SAAU,EAAEJ,SAC9BpU,eAAC2+B,IAAS,CAACriB,SAAUiiB,EAAU,KAAO,KAAMnqB,UAGjC,IAAXnT,EAEAjB,eAAC+hB,IAAI,CAACpQ,WAAS,EAAC4C,UAAWX,EAAQjC,UAAWE,QAAS,EAAEuC,SACvDpU,eAAC+hB,IAAI,CAACtS,MAAI,EAAC6S,GAAI,GAAID,GAAI,GAAI3b,GAAI,GAAG0N,SAClCpU,eAACy9B,GAAQ,CAACx8B,MAAOA,EAAOy8B,MAAO,EAAGnpB,UAAWX,EAAQ8f,KAAKtf,SACxDpU,eAACyoB,GAAY,CAAMn6B,QAAO6mB,mBAO9BjB,gBAAC6N,IAAI,CAACpQ,WAAS,EAAC4C,UAAWX,EAAQjC,UAAWE,QAAU,EAAEuC,SAAA,CACxDpU,eAAC+hB,IAAI,CAACtS,MAAI,EAACouB,QAASU,EAASjc,GAAI,EAAGD,GAAI,EAAG3b,GAAI,GAAG0N,SAClDpU,eAAC0xB,GAAW,CAAMpjC,QAAO6mB,eAGzBnV,eAAC+hB,IAAI,CAACtS,MAAI,EAAC6S,GAAIic,EAAU,EAAI,GAAIlc,GAAIkc,EAAU,EAAI,GAAI73B,GAAI,GAAG0N,UA7C3CwqB,EA+CD,CACd5+B,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAACg9B,GAAY,CAAM1uC,QAAO6mB,aAC1BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAAC2gB,GAAe,CAAMryB,QAAO6mB,aAC7BnV,eAACwiB,GAAgB,CAAMl0B,QAAO6mB,aAC9BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,aAC9BnV,eAACylB,GAAgB,CAAMn3B,QAAO6mB,cAzD/BnV,eAAChB,IAAMgY,SAAQ,CAAA5C,SAEpBwqB,EAAS/1C,KAAK,CAACg2C,EAAIt1C,IAAMyW,eAACy9B,GAAQ,CAASx8B,MAAOA,EAAOy8B,MAAOn0C,EAAGgrB,UAAWX,EAAQ8f,KAAKtf,SAAEyqB,GAArDt1C,oBAHnBq1C,OCrM3B,MAAME,GAAU,MCAD,MAAMC,GAOjB3nC,YAAYyB,GAAiG,KAN7G2c,WAAK,OACLC,WAAK,OACL+G,UAAI,OACJ3I,WAAK,OACLmrB,gBAAU,EAGN,MAAM,MAAExpB,EAAK,MAAEC,EAAK,KAAE+G,EAAI,MAAE3I,EAAK,WAAEmrB,GAAenmC,EAClDxO,KAAKmrB,MAAQA,EACbnrB,KAAKorB,MAAQA,EACbprB,KAAKmyB,KAAOA,EACZnyB,KAAKwpB,MAAQA,EACbxpB,KAAK20C,WAAaA,EAGtBphB,iBACI,IAAIqhB,EAAM,GACV,IAAK,IAAI11C,EAAI,EAAGA,EAAIc,KAAKorB,MAAMttB,OAAQoB,IACb,IAAlBc,KAAKorB,MAAMlsB,IACX01C,EAAI9mC,KAAK9N,KAAKmrB,MAAMjsB,IAG5B,OAAO01C,EAGXle,gBACI,IAAK,IAAIx3B,EAAI,EAAGA,EAAIc,KAAKorB,MAAMttB,OAAQoB,IACnC,GAAsB,IAAlBc,KAAKorB,MAAMlsB,GACX,OAAQc,KAAKmrB,MAAMjsB,GAG3B,MAAO,GAGXssB,SAASuF,GACL,MAAM,MAAE5F,EAAK,KAAEgH,EAAI,MAAE3I,GAAUxpB,KAC/B,OAAO,IAAI00C,GAAS,CAACvpB,QAAOC,MAAO2F,EAAUoB,OAAM3I,WC/BpD,MAAMqrB,GAA6B,GAoDpCC,GAAiBxiB,GAAc9zB,KAAIa,GAAKA,EAAE,KAC1C01C,GAAkBziB,GAAc9zB,KAAIa,GAAKA,EAAE,KAEpC21C,GACW,0CADXA,GAEQ,sCAFRA,GAGC,WAHDA,GAIA,yBAJAA,GAKG,6BASVC,GAAgB,CAClBC,kBAAoB,CAChBt4C,EAAG,EAAGD,EAAG,EAAG6sB,MAAO,aAAc5S,MAAO,EAAGgT,UAAU,GAEzDurB,kBAAoB,CAChBv4C,EAAG,EAAGD,EAAG,EAAG6sB,MAAO,aAAc5S,MAAO,GAE5Cw+B,gBAAkB,CACdx4C,EAAG,EAAGD,EAAG,EAAG6sB,MAAO,WAAY5S,MAAO,GAE1Cy+B,gBAAkB,CACdz4C,EAAG,EAAGD,EAAG,EAAG6sB,MAAO,WAAY5S,MAAO,EAAGgT,UAAU,GAEvD0rB,gBAAkB,CACd14C,EAAG,EAAGD,EAAG,GAAI6sB,MAAO,WAAY5S,MAAO,IASlC2+B,GAAyB,MAClC,IAAIC,EAAer3C,MAAM,IAAIa,KAAK,GAElC,OADAw2C,EAAa,GAAK,EACX,CACHrY,SAAU,IAAIuX,GAAS,CACnBlrB,MAAO,eACP2B,MAAM,CAAC,OAAQ,QACfC,MAAO,CAAC,EAAE,GACV+G,KAAM,iBAEVtjB,MAAO,IAAI6lC,GAAS,CAChBvpB,MAAO,CAAC,SAAU,QAClBC,MAAO,CAAC,EAAE,GACV+G,KAAM,UAEVsjB,UAAW,IAAIf,GAAS,CACpBlrB,MAAO,2BACP2B,MAAO,CAAC,UAAW,OACnBC,MAAO,CAAC,EAAG,GACX+G,KAAM,cAEV2J,cAAe,IAAI4Y,GAAS,CACxBlrB,MAAO,sBACP2B,MAAO,CAAC,OAAQ,QAChBC,MAAO,CAAC,EAAG,GACX+G,KAAM,mBAEVujB,aAAc,IAAIhB,GAAS,CACvBvpB,MAAO,CAAC,IAAK,IAAK,KAAM,IAAK,IAAK,IAAK,KAAM,KAC7CC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC7B+G,KAAM,SAEVwjB,cAAe,IAAIjB,GAAS,CACxBvpB,MAAO,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQ,OAAQ,OAAQ,MAAO,MAAO,MACzE,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAAQ,OAAQ,OAAQ,MAAO,MAAO,OACxFC,MAAOjtB,MAAM,IAAIa,KAAK,GACtBmzB,KAAM,UAEVyjB,iBAAkB,IAAIlB,GAAS,CAC3BvpB,MAAO2pB,GACP1pB,MAAOjtB,MAAM22C,GAAeh3C,QAAQkB,KAAK,GACzCmzB,KAAM,cAEV0jB,gBAAiB,IAAInB,GAAS,CAC1BvpB,MAAO,CAAC,OAAQ,IAAK,KAAM,MAC3BC,MAAO,CAAC,EAAG,EAAG,EAAG,GACjB+G,KAAM,UAGVsE,qBAAsB,IAAIie,GAAS,CAC/BvpB,MAAO,CAAC,OAAQ,OAAQ,YACxBC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,cAEVyE,iBAAkB,IAAI8d,GAAS,CAC3BvpB,MAAO,CAAC,KAAM,MACdC,MAAO,CAAC,EAAG,GACX+G,KAAM,kBAEV2E,iBAAkB,IAAI4d,GAAS,CAC3BvpB,MAAO,CAAC,MAAO,MACfC,MAAO,CAAC,EAAG,GACX+G,KAAM,mBAEV2jB,gBAAiB,IAAIpB,GAAS,CAC1BvpB,MAAO,CAAC,OAAQ,QAAS,QAAS,OAAQ,QAAS,SACnDC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GACvB+G,KAAM,YAEV6E,iBAAkB,IAAI0d,GAAS,CAC3BvpB,MAAO,CAAC,MAAO,MAAO,OACtBC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,aAEV4jB,kBAAmB,IAAIrB,GAAS,CAC5BvpB,MAAO4pB,GACP3pB,MAAOjtB,MAAM42C,GAAgBj3C,QAAQkB,KAAK,GAC1CmzB,KAAM,eAEV6jB,oBAAqB,IAAItB,GAAS,CAC9BlrB,MAAO,qBACP2B,MAAO,CACH,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,KAClB,KAAM,KAAM,KAAM,MAEtBC,MAAOoqB,EACPrjB,KAAM,gBAQV8jB,gBAAiB,IAAIvB,GAAS,CAC1BlrB,MAAO,sEACP2B,MAAO,CAAC,UAAW,KAAM,MACzBC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,aAEV+jB,aAAc,IAAIxB,GAAS,CACvBlrB,MAAO,qBACP2B,MAAO,CAAC,aAAc,cAAe,UACrCC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,SAEVgkB,qBAAsB,IAAIzB,GAAS,CAC/BlrB,MAAO,mBACP2B,MAAO,CAAC,sCAAuC,yDAC/CC,MAAO,CAAC,EAAG,GACX+G,KAAM,kBAEVikB,eAAgB,IAAI1B,GAAS,CACzBlrB,MAAO,kBACP2B,MAAO,CAAC,oBAAqB,qBAC7BC,MAAO,CAAC,EAAG,GACX+G,KAAM,YAEVkkB,qBAAsB,IAAI3B,GAAS,CAC/BlrB,MAAO,oBACP2B,MAAO,CAAC,SAAU,UAClBC,MAAO,CAAC,EAAG,GACX+G,KAAM,mBAEVmkB,iBAAkB,IAAI5B,GAAS,CAC3BlrB,MAAO,sBACP2B,MAAO,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,MACtCC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3D+G,KAAM,oBAEVokB,iBAAkB,IAAI7B,GAAS,CAC3BlrB,MAAO,sBACP2B,MAAO,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,MACtCC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3D+G,KAAM,oBAEVqkB,iBAAkB,IAAI9B,GAAS,CAC3BlrB,MAAO,iBACP2B,MAAO,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,MACtCC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3D+G,KAAM,oBAGVkJ,WAAY,IAAIqZ,GAAS,CACrBlrB,MAAO,qBACP2B,MAAO,CAAC,WAAY,UAAW,QAC/BC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,OAEVqJ,WAAY,IAAIkZ,GAAS,CACrBlrB,MAAO,kBACP2B,MAAO,CAAC,WAAY,UAAW,QAC/BC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,OAEVskB,aAAc,IAAI/B,GAAS,CACvBlrB,MAAO,oBACP2B,MAAO,CAAC,WAAY,cAAe,UACnCC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,mBAEVukB,cAAe,IAAIhC,GAAS,CACxBlrB,MAAO,iBACP2B,MAAO,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,MACtCC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3D+G,KAAM,gBAEVuJ,mBAAoB,IAAIgZ,GAAS,CAC7BlrB,MAAO,kBACP2B,MAAO,CAAC,KAAM,YACdC,MAAO,CAAC,EAAG,GACX+G,KAAM,iBAEVwkB,oBAAqB,IAAIjC,GAAS,CAC9BlrB,MAAO,sBACP2B,MAAO,CAAC,IAAK,IAAK,IAAK,KAAM,KAAM,OACnCC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GACvB+G,KAAM,iBAEVykB,sBAAuB,IAAIlC,GAAS,CAChClrB,MAAO,aACP2B,MAAO,CAAC,SAAU,YAAa,YAAa,OAAQ,iCACpDwpB,WA3NoB,iRA4NpBvpB,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,GACpB+G,KAAM,oBAEV0kB,eAAgB,IAAInC,GAAS,CACzBlrB,MAAO,gBACP2B,MAAO,CAAC,aAAc,aACtBC,MAAO,CAAC,EAAG,GACX+G,KAAM,YAEVoJ,eAAgB,IAAImZ,GAAS,CACzBlrB,MAAO,cACP2B,MAAO,CAAC,WAAY,UAAY,QAChCC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,YAEV2kB,cAAe,IAAIpC,GAAS,CACxBlrB,MAAO,SACP2B,MAAO,CAAC,UAAW,cACnBC,MAAO,CAAC,EAAG,GACX+G,KAAM,WAEV4kB,eAAgB,IAAIrC,GAAS,CACzBlrB,MAAO,UACP2B,MAAO,CAAC,OAAQ,QAChBC,MAAO,CAAC,EAAG,GACX+G,KAAM,YAEV6kB,iBAAkB,IAAItC,GAAS,CAC3BlrB,MAAO,QACP2B,MAAO,CAAC,kCAAmC,WAAY,MACvDC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,cAEV8kB,cAAe,IAAIvC,GAAS,CACxBlrB,MAAO,KACP2B,MAAO,CAAC,SAAU,QAAS,MAAO,OAAQ,OAAQ,MAAO,QAAS,OAAQ,MAAO,QACjFC,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACnC+G,KAAM,WAEV+kB,kBAAmB,IAAIxC,GAAS,CAC5BlrB,MAAO,kBACP2B,MAAO,CAAC6pB,GAAqBA,GAAkBA,GAAmBA,GAA6BA,IAC/F5pB,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,GACpB+G,KAAM,eAEVglB,kBAAmB,IAAIzC,GAAS,CAC5BlrB,MAAO,eACP2B,MAAO,CAAC,OAAQ,QAAS,QACzBC,MAAO,CAAC,EAAG,EAAG,GACd+G,KAAM,eAEVilB,wBAAyB,IAAI1C,GAAS,CAClClrB,MAAO,mBACP2B,MAAO,CAAC,QAAS,gBACjBC,MAAO,CAAC,EAAG,GACX+G,KAAM,yBAEP8iB,KAxP2B,GC5FtC,IAAIoC,GAAiB,WAEjB,IAAIrR,EAA2B,KAa/B,MAAO,CACHsR,WAbaA,KACb,GAAItR,EAAO,OAAOA,EAClB,MAAM5gB,EAAO/Z,OAAO4Z,aAAaI,QAJzB,OAOR,OAF+BD,EAAOlP,KAAKC,MAAMiP,GAAQyvB,IACzBr2C,KAAKgc,IAAA,IAAC,KAAC5L,EAAI,MAAEwjB,EAAK,OAAE0K,GAAOtiB,EAAA,MAAM,CAAC5L,OAAMwjB,QAAO0K,OAAQA,EAAOnD,OAAO7b,MAAM,UAU3Gy5B,WAPcnyB,IACd,MAAMoyB,EAAyBpyB,EAAK5mB,KAAI6hB,IAAA,IAAC,KAACzR,EAAI,MAAEwjB,EAAK,OAAE0K,GAAOzc,EAAA,MAAM,CAACzR,OAAMwjB,QAAO0K,OAAQA,EAAOnlB,KAAK,SACtGtM,OAAO4Z,aAAaC,QAXZ,MAWyBhP,KAAKQ,UAAU8gC,IAChDxR,EAAQ5gB,IAbK,GAqBjBqyB,GAAmBjpC,GACZ0H,KAAKQ,UAAUlI,GAGtBkpC,GAAqBz6C,IACrB,MAAMgZ,EAAMC,KAAKC,MAAMlZ,GACvB,OAAO2P,OAAO2N,YAAY3N,OAAOrO,QAAQ0X,GAAKzX,KAC1CylB,IAAa,IAAXtH,EAAGrU,GAAE2b,EACH,MAAI,UAAY3b,EACL,CAACqU,EAAG,IAAI+3B,GAASpsC,IAEjB,CAACqU,EAAGrU,QAKvBqvC,GAAgB,WAChB,MAAMtiC,EAAM,SACNuiC,EAAa,UACnB,IAAI5R,EAAwB,KAexB6R,EAAYA,KACZ,GAAI7R,EACA,OAAOA,EAEX,MAAM5gB,EAAO/Z,OAAO4Z,aAAaI,QAAQhQ,GACnCyiC,EAAOzsC,OAAO4Z,aAAaI,QAAQuyB,GAEnCJ,EAA0BpyB,EAAOsyB,GAAkBtyB,GAAQmwB,GAEjE,GAAKuC,IAASrD,GAAS,CAGnB,IAAIjmC,EAAS+mC,GAUb,OATIiC,EAAMxB,sBACNxnC,EAAS,IAAI+mC,GAAeS,oBAAqB,IAAItB,GAAS8C,EAAMxB,uBAEpEwB,EAAM3oC,QACNL,EAAS,IAAIA,EAAQK,MAAO,IAAI6lC,GAAS8C,EAAM3oC,SAEnDxD,OAAO4Z,aAAaC,QAAQ7P,EAAKoiC,GAAgBjpC,IACjDnD,OAAO4Z,aAAaC,QAAQ0yB,EAAYnD,IAEjCjmC,EAIX,GAAgB,OAAVgpC,QAA8Bx9C,IAAVw9C,GAAsD,IAA9B5qC,OAAOlL,KAAK81C,GAAO15C,OAEjE,OADAuN,OAAO4Z,aAAaC,QAAQ7P,EAAKoiC,GAAgBlC,KAC1CA,GAGX,GAAI3oC,OAAOlL,KAAK81C,GAAO15C,OAAS8O,OAAOlL,KAAK6zC,IAAez3C,OAAQ,CAC/D,MAAMi6C,EAAQ,IAAIxC,MAAkBiC,GAEpC,OADAnsC,OAAO4Z,aAAaC,QAAQ7P,EAAKoiC,GAAgBM,IAC1CA,EAKX,OADA/R,EAAQwR,EACDxR,GASX,MAAO,CACH6R,YACAG,UARaC,IACb,IAAIC,EAAqBtrC,OAAOurC,OAAON,IAAaI,GACpD5sC,OAAO4Z,aAAaC,QAAQ7P,EAAKoiC,GAAgBS,IACjDlS,EAAQkS,GAMRE,YAhEcA,KACd,MAAMhzB,EAAO/Z,OAAO4Z,aAAaI,QAAQhQ,GACnCmiC,EAA0BpyB,EAAOsyB,GAAkBtyB,GAAQmwB,GAEjE,IAAI/mC,EAAS+mC,GAOb,OANIiC,EAAMxB,sBACNxnC,EAAS,IAAI+mC,GAAeS,oBAAqB,IAAItB,GAAS8C,EAAMxB,uBAExE3qC,OAAO4Z,aAAaC,QAAQ7P,EAAKoiC,GAAgBjpC,IACjDnD,OAAO4Z,aAAaC,QAAQ0yB,EAAYnD,IAEjCjmC,IAhBK,IAyEfqpC,UAAS,GAAEG,UAAS,GAAEI,YAAW,IAAIT,GACtCL,GAAaD,GAAeC,WAC5BC,GAAaF,GAAeE,WC7GzB,MAAec,GAElBtrC,YAAY9I,GAAkB,KAD9BA,WAAK,EAEDjE,KAAKiE,MAAQA,EASjBq0C,SAASzb,GACL,OAAO78B,KAAKiE,OAIb,MAAMs0C,OACF1rC,OAAU5I,GACO,ECXrB,MAAeu0C,WAA2BH,GAa7CI,mBACI,OAAO,KAEXC,qBAAqBp6B,GAEjB,IAAIgL,EAAStpB,KAAKy4C,mBAClB,OAAKnvB,IAGKA,EAAO1S,QAAU0S,EAAO1sB,EAAI,GAC5B0sB,EAAO1S,QAAU0H,GACjBgL,EAAO1S,QAAU0S,EAAO3sB,GAAK2sB,EAAO1S,MAAQ0H,KAAQgL,EAAOM,UAC3DN,EAAO1S,QAAU0S,EAAO1sB,GAAK0sB,EAAO1S,MAAQ0H,KAAQgL,EAAOK,UAGzEgvB,kCAAkC77C,GAE9B,IAAIwsB,EAAStpB,KAAKy4C,mBAClB,OAAKnvB,IAGKA,EAAO1S,QAAU0S,EAAO1sB,EAAI,GAC5B0sB,EAAO1S,OAAS9Z,GAChBwsB,EAAO1S,QAAU0S,EAAO3sB,KAAQ2sB,EAAOM,UAGrDgvB,YACI,IAAK,IAAI15C,EAAI,EAAGA,EAAIc,KAAK64C,gBAAiB35C,IAAK,CAC3C,IAAI,KAACqP,EAAI,QAAEuqC,EAAO,QAAEC,GAAW/4C,KAAKg5C,oBACpC,MAAMC,EAAWj5C,KAAKi5C,UAAY,CAAC,IACnC,IAAIC,EAAQ17C,KAAK2H,OAAO2zC,EAAQt6C,KAAIs+B,GAAUmc,EAASz6C,KAAI26C,GACnDpS,GAAartB,IAAIojB,GAAQgH,aAAa,GAAGd,MAAMz0B,EAAKyJ,MAAMmhC,QAAQhnC,QAE1E,IAAKnS,KAAK24C,kCAAkCO,GACxC,SAEJ,IAAIE,EAAQ57C,KAAK2H,OAAO2zC,EAAQt6C,KAAIs+B,GAAUmc,EAASz6C,KAAI26C,GACnDpS,GAAartB,IAAIojB,GAAQ0E,MAAMjzB,EAAKyJ,MAAMmhC,GAAK,EAAGn5C,KAAKq5C,QAAS,GAAG,GAAGlhC,MAAMra,WAASqU,QAC7F,GAAInS,KAAK04C,qBAAqBU,GAG1B,OADAx5C,QAAQ05C,MAAM,gCAAgCp6C,EAAE,YACzC,CAACqP,OAAMuqC,UAASC,WAI/B,OADAn5C,QAAQ6hB,IAAI,yCAAyCzhB,KAAK64C,yBACnD,IAAI74C,KAAKg5C,oBAAqBO,QAAQ,GAGjDxsC,YAAY9I,GACRuhB,MAAMvhB,GAGN,KAhEKu1C,aAAO,OACPH,aAAO,OAChBI,eAAyB,EAAE,KAC3BC,cAAwB,EAAE,KAC1BC,qBAA+B,GAAG,KAClCC,gBAAkB,EAAE,KACpBX,SAAqB,CAAC,IAAI,KAC1BY,aAAyB,CAAC,IAAI,KAC9BpE,eAAS,OACToD,gBAAkB,IAwDd74C,KAAKy1C,UAAY,IAAI7K,GAEzBkP,oBAAoBvrC,EAAiBwrC,GACjC,MAAM91C,EAAQjE,KAAKiE,MACb+1C,EAAmB,IAAO/1C,EAAMuK,OAAOmoC,oBAAoBjgB,iBAAmB,GAAK12B,KAAK45C,gBACxFK,IAAwBh2C,EAAMuK,OAAOmoC,oBAAoBjgB,iBAAmB,GAoBlF,OAAOqjB,EAAYv7C,KAnBJ07C,IACX,MAAMpd,EAASiK,GAAartB,IAAIwgC,GAEhC,IAAIngD,GADaiG,KAAKi5C,UAAY,CAAC,KACVz6C,KAAI26C,GACzBrc,EACC0E,MAAMjzB,EAAKyJ,MAAMmhC,GAAK,EAAGn5C,KAAKq5C,QAASW,GACvCx7C,KAAIskC,IAAG,CAAMqX,IAAKhB,EAAIrW,IAAKA,EAAKoI,MAAOlrC,KAAKy1C,UAAU5K,SAAS/H,SAAU3wB,OAC9EpY,EAAUk5C,MAAK,CAAChxB,EAAGnlB,IAAMmlB,EAAEipB,MAAQpuC,EAAEouC,QAUrC,MALwB,CACpBtmB,GAAI,GAAGs1B,IACP3pB,KAHSx2B,EAAUshB,MAAM,EAAG4+B,GAAqBz7C,KAHnCskC,IACD,KAAZA,EAAIqX,IAAa,GAAK,IAAMrX,EAAIqX,IAAM,MACvCrX,EAAIA,IAAIvpB,SAASvZ,KAAK25C,wBAKtBxnB,KAAM,GAAG+nB,QAOrBE,OAAO7rC,EAAiBwrC,EAAuBhuB,GAI3C,MAAM9nB,EAAQjE,KAAKiE,MACnB8nB,EAAUA,GAAW,GACrB,IACIqG,EADAioB,EAAWr6C,KAAK85C,oBAAoBvrC,EAAMwrC,GAE9C,GAAIhuB,EAAQhxB,SACRq3B,EAAQrG,EAAQhxB,cACb,GAAIgxB,EAAQuuB,mBACfloB,EAAQpyB,KAAKiE,MAAMqzB,KAAKC,KAAK,GAAInF,UAC9B,CACH,MAAMr3B,EAAsC,cAA3BgxB,EAAQwuB,eACzBxT,GAAartB,IAAI,aAAa8nB,MAAMjzB,EAAK,EAAE,EAAE,GAAG,GAAG6M,MACnD,CAACo/B,IACG,MAAMC,EAAiB,IAAIviC,GAAQmiC,EAAS,GAAG9pB,KAAK,IAAItT,eAAe9E,MAAMra,OAW7E,OAL+C,QAHrC08C,EAAG58C,EACTmpC,GAAartB,IAAIqS,EAAQwuB,gBAAkBR,EAAY,IACtDvY,MAAMjzB,EAAM/Q,KAAK2H,IAAInF,KAAKq5C,QAAS77C,KAAK4H,IAAIpF,KAAKw5C,QAASiB,EAAiBz6C,KAAKy5C,iBAC7Ez5C,KAAKq5C,QAASr5C,KAAK05C,eAAiB,WAAG,IAAAc,OAAA,EAHlCA,EAGoCp/B,OAPrD,GAcAgX,EAAQr3B,EAASwe,WAEG,IAApB8gC,EAASv8C,OACTu8C,EAAW,CAAC,CACRz1B,GAAI,YACJ2L,KAAM,GACN6B,QACAD,KAAM,cAIVkoB,EAASvmC,SAAQ4mC,GAAWA,EAAQtoB,MAAQA,IAGhD,MAAMxa,EAAOmU,EAAQuuB,mBAAsBt6C,KAAKiE,MAAMsK,KAAKqJ,IAAMwb,GAAyBnvB,EAAMuK,OAAOwnC,oBAAtC5iB,GAA6DxO,GACxHtqB,EAAOyxB,EAAQuuB,mBAAqBt6C,KAAKiE,MAAM3J,KAAO,SAE5D,MAAO,IACA2J,EACH3J,KAAMA,EACNiU,KAAM,IACCtK,EAAMsK,KACTtK,MAAOsK,EACPqJ,OAEJ0f,KAAM,CACFrzB,OAAO,IAAI8R,IAAYiC,MAAMoa,GAC7BmF,KAAM8iB,IAIlBM,cACI,IACIC,GADA,KAACrsC,EAAMuqC,QAASiB,EAAahB,QAASwB,EAAc,OAAEhB,GAAUv5C,KAAK44C,YAErE54C,KAAKiE,MAAM04B,cAAc7+B,OAAS,IAClC88C,EAAgB56C,KAAKiE,MAAM04B,cAAc,GACzCpuB,GAAO,IAAIwH,IAAYiC,MAAM4iC,IAEjC,IAAI32C,EAAQjE,KAAKo6C,OAAO7rC,EAAMwrC,EAAa,CACvCO,oBAAoB,EACpBC,iBACAx/C,SAAU6/C,IAQd,OANIA,IACA32C,EAAQ,IAAIA,EACR04B,cAAe14B,EAAM04B,cAActhB,MAAM,KAGjDpX,EAAQ,IAAIA,EAAOsK,KAAM,IAAItK,EAAMsK,KAAMkuB,cAAe8c,IACjDt1C,EAEX42C,aACI,MAAM52C,EAAQjE,KAAKiE,MACnB,GAA+B,IAA3BA,EAAMqzB,KAAKC,KAAKz5B,OAChB,OAAOmG,EAEX,MAAOsK,EAAMwrC,GAAe,CAAC91C,EAAMsK,KAAKtK,MAAOA,EAAMqzB,KAAKC,KAAM/4B,KAAIa,GAAKA,EAAE8yB,QAC3E,OAAOnyB,KAAKo6C,OAAO7rC,EAAMwrC,EAAa,CAClCO,oBAAmB,IAG3BhC,SAASzb,GACL,MAAMtuB,GAAO,IAAIwH,IAAYiC,MAAM6kB,EAAMzK,OAEzC,MAAO,IADQpyB,KAAKo6C,OAAO7rC,EAAMsuB,EAAMC,OAAQ,CAAC/hC,SAAU8hC,EAAMzK,QAG5DxjB,KAAMiuB,EAAMjuB,MAGpBksC,UAAU79C,GACN,IAAIgH,EAAQjE,KAAKiE,MACjB,MAAU,WAANhH,EACmB,aAAfgH,EAAM3J,KACC0F,KAAK26C,cAGL,IACA12C,EACH3J,KAAM,YAIH,WAAN2C,EACE,IACAgH,EACHsK,KAAM,IACCtK,EAAMsK,KACTtK,MAAOA,EAAMqzB,KAAKrzB,QAKnBA,EAGf82C,OAAOC,GACH,IAAI/2C,EAAQjE,KAAKiE,MACbwT,EAAO,IAAIS,GAAQ8iC,GACnBzsC,EAAOtK,EAAMsK,KAAKtK,MAAM+T,MAAMP,GAClC,MAAO,IACAxT,EACHsK,KAAM,IACCtK,EAAMsK,KACTtK,MAAOsK,IAInB0sC,SAASC,GAGL,OADe57C,EAAWU,KAAKiE,MAAMuK,OAAOmoC,oBAAoBvrB,MAAO8vB,EAAKvE,oBAAoBvrB,OAEpFmtB,GAAa1rC,OAAO,IAAK7M,KAAKiE,MAAOuK,OAAQ0sC,IAA+BL,aAG7E76C,KAAKiE,OAKjB,MAAMk3C,WAAmB3C,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC/Cu7C,QAAU,EAAE,KACZH,QAAU,GAAG,KA0Eb+B,gBAAuC,CACnC,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,IAAK,CAAC,EAAG,IACb,CAAC,EAAG,IAAK,CAAC,EAAG,KAChB,KACDC,cAAqC,GAAE,KACvCC,WAAkC,GArFlCC,yBACI,IAAKllC,EAAIC,EAAIC,EAAIC,GAAM5Y,EAAYR,GAI/BmR,EAAOwT,GAASmB,qBAAqB+C,GAAKC,cAC9C,IAAK,IAAIhnB,EAAI,EAAGA,EAAI,EAAGA,IACA,IAAfqP,EAAK8H,GAAGnX,KACRqP,EAAK8H,GAAGnX,GAAKqP,EAAK8H,GAAGA,GACrB9H,EAAK+H,GAAGpX,GAAKqP,EAAK+H,GAAGD,GACrB9H,EAAK8H,GAAGA,GAAM,EACd9H,EAAK+H,GAAGD,GAAMC,GAGtB,IAAK,IAAIpX,EAAI,EAAGA,EAAI,GAAIA,IACD,IAAfqP,EAAKgI,GAAGrX,KACRqP,EAAKgI,GAAGrX,GAAKqP,EAAKgI,GAAGA,GACrBhI,EAAKiI,GAAGtX,GAAKqP,EAAKiI,GAAGD,GACrBhI,EAAKgI,GAAGA,GAAM,EACdhI,EAAKiI,GAAGD,GAAMC,GAGtB,OAAOjI,EAEXitC,wBACI,IAAKnlC,EAAIC,EAAIC,EAAIC,GAAM5Y,EAAYP,GAE/BkR,EAAOwT,GAASmB,qBAAqB+C,GAAKE,eAC9C,IAAK,IAAIjnB,EAAI,EAAGA,EAAI,EAAGA,IACA,IAAfqP,EAAK8H,GAAGnX,KACRqP,EAAK8H,GAAGnX,GAAKqP,EAAK8H,GAAGA,GACrB9H,EAAK+H,GAAGpX,GAAKqP,EAAK+H,GAAGD,GACrB9H,EAAK8H,GAAGA,GAAM,EACd9H,EAAK+H,GAAGD,GAAMC,GAGtB,IAAK,IAAIpX,EAAI,EAAGA,EAAI,GAAIA,IACD,IAAfqP,EAAKgI,GAAGrX,KACRqP,EAAKgI,GAAGrX,GAAKqP,EAAKgI,GAAGA,GACrBhI,EAAKiI,GAAGtX,GAAKqP,EAAKiI,GAAGD,GACrBhI,EAAKgI,GAAGA,GAAM,EACdhI,EAAKiI,GAAGD,GAAMC,GAItB,OAAOjI,EAEXktC,uBAAuBltC,EAAiBuE,EAAaZ,GACjD,IAAIwpC,EAAQntC,EAAKgI,GAAGrD,QAAQJ,GACxB6oC,EAAQptC,EAAKiI,GAAGklC,GAEpB,OADYxpC,EAAQ0pC,MAAMphC,IAAA,IAAEhE,EAAID,GAAGiE,EAAA,OAAMhE,IAAOmlC,GAAWplC,IAAOmlC,KAGtEG,sBACI,IAAIttC,EAAOwT,GAASmB,qBAAqB+C,GAAKC,cAC9C,IAAK,IAAIhnB,EAAI,EAAGA,EAAI,OACZc,KAAKy7C,uBAAuBltC,EAAM,EAAGvO,KAAKs7C,cAC1Ct7C,KAAKy7C,uBAAuBltC,EAAM,EAAGvO,KAAKq7C,gBAFxBn8C,IAGtBqP,EAAOwT,GAASmB,qBAAqB+C,GAAKC,cAE9C,OAAO3X,EAGXutC,uBACI,IAAIvtC,EAAOwT,GAASmB,qBAAqB+C,GAAKE,eAC9C,IAAK,IAAIjnB,EAAI,EAAGA,EAAI,OACZc,KAAKy7C,uBAAuBltC,EAAM,EAAGvO,KAAKs7C,cAC1Ct7C,KAAKy7C,uBAAuBltC,EAAM,EAAGvO,KAAKq7C,gBAFxBn8C,IAGtBqP,EAAOwT,GAASmB,qBAAqB+C,GAAKE,eAE9C,OAAO5X,EAgBXkqC,mBAAoB,OAAOz4C,KAAKiE,MAAMuK,OAAO0mC,kBAC7C8D,oBACI,MAAM+C,EAA8D,sBAArD/7C,KAAKiE,MAAMuK,OAAO4nC,eAAe1f,gBAC1CslB,EAAwE,WAA3Dh8C,KAAKiE,MAAMuK,OAAO6nC,qBAAqB3f,gBAGpDoiB,EAAU,CAACiD,EAAS,KAAO,QAC3BhD,IAHe/4C,KAAKiE,MAAMuK,OAAO2nC,qBAAqBzf,iBAAmB,SACpC4E,WAAW,SAEf,YAAcwd,EAAQ,GAC7D,IAYIvqC,EAZA0tC,EAASj8C,KAAKiE,MAAMuK,OAAO0nC,aAAa3iB,iBAAiB,GAwB7D,OAtBAvzB,KAAKq7C,cAAgBr7C,KAAKiE,MAAMuK,OAAO8nC,iBAAiBlrB,MAAM5sB,KAAK,CAACoY,EAAO1X,IAAM,CAAC0X,EAAO1X,KACpFmjB,QAAQhC,IAAA,IAAEzJ,EAAO1X,GAAEmhB,EAAA,OAAKzJ,KAAQpY,KAAKylB,IAAA,IAAErN,EAAO1X,GAAE+kB,EAAA,OAAKjkB,KAAKo7C,gBAAgBl8C,MAC/Ec,KAAKs7C,WAAat7C,KAAKiE,MAAMuK,OAAOgoC,iBAAiBprB,MAAM5sB,KAAK,CAACoY,EAAO1X,IAAM,CAAC0X,EAAO1X,KACjFmjB,QAAQc,IAAA,IAAEvM,EAAO1X,GAAEikB,EAAA,OAAKvM,KAAQpY,KAAK09C,IAAA,IAAEtlC,EAAO1X,GAAEg9C,EAAA,OAAKl8C,KAAKo7C,gBAAgBl8C,MAE/Ec,KAAKw5C,QAAWwC,EAAeD,EAAS,EAAI,EAAMA,EAAS,EAAI,EAO3DxtC,EADW,eAAX0tC,EACQD,EAAch8C,KAAKu7C,yBAA2Bv7C,KAAK67C,sBAE3C,gBAAXI,EACGD,EAAch8C,KAAKw7C,wBAA0Bx7C,KAAK87C,uBAGlDE,EACDp+C,EAAY,CAAE,IAAMoC,KAAKu7C,yBAA0B,IAAMv7C,KAAKw7C,yBAA9D59C,GACEA,EAAY,CAAE,IAAMoC,KAAK67C,sBAAuB,IAAM77C,KAAK87C,wBAA3Dl+C,GAEN,CAAC2Q,OAAMuqC,UAASC,YAGxB,MAAMoD,WAAiB3D,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC7Cu7C,QAAkB,EAAE,KACpBH,QAAkB,GAAG,KAErBJ,SAAW,CAAC,GAAI,IAAK,KAAM,MAAM,KACjCJ,gBAAkB,IAMlBuD,6BAA6B7tC,EAAiB8tC,GAC1C,IAAIC,EAAUD,EAAY,CAAEjhD,EAAKK,GAAM,CAAEL,EAAKG,EAAGH,EAAKI,EAAGJ,EAAKK,EAAGL,EAAKM,GAGtE,OAFYqmB,GAASV,SAASgB,QAAOH,GAAKA,EAAE,KAAOvmB,EAAIE,GAAKygD,EAAQh7B,SAASY,EAAE,KACxExD,GAAYiB,iBAAiBpR,EAAM,CAAC2T,EAAE,GAAIA,EAAE,GAAIA,EAAE,OAASA,EAAE,KAGxEq6B,cACI,IACIr8B,EADA+7B,EAASj8C,KAAKiE,MAAMuK,OAAOooC,sBAAsBlgB,gBAGjDxW,EADW,WAAX+7B,EACOh2B,GAAKa,WACI,cAAXm1B,EACEh2B,GAAKc,eACI,cAAXk1B,EACEh2B,GAAKe,eAGI,qBAAXi1B,EACEh2B,GAAKiB,cAELjB,GAAKa,WAChB,IAAIvY,EAAOwT,GAASmB,qBAAqBhD,GACrCs8B,EAAQx8C,KAAKiE,MAAMuK,OAAOynC,gBAAgBvf,gBAC9CnoB,EAAkB,YAAViuC,EAAuBjuC,EACZ,OAAViuC,EAAkBz6B,GAAS8C,eAAetW,EAAM,GAAG,GACpDwT,GAAS8C,eAAetW,EAAM,GAAG,GAEzC,IAAIuuB,EAAoB,YAAV0f,EAAuB,KACX,OAAVA,EAAkB,QACnB,QAGXx8C,KAAKi5C,SADK,YAAVuD,EACgB,CAAC,GAAI,IAAK,KAAM,MAEhB,CAAC,IAOrB,MAAMC,EAAW,OACXC,EAAa,gCAInB,GAHIT,IAAWS,IACX5f,EAAS,aAETmf,IAAWQ,GAAYR,IAAWS,EAClC,MAAO,CAACnuC,EAAMuuB,GAElB,IACIuf,EAAYJ,IAAWQ,EAC3B,OAAa,CACT,IAAIE,EAAQ56B,GAASI,WAAW5T,GAC5BquC,EAAW58C,KAAKo8C,6BAA6B7tC,EAAM8tC,GAEvD,GAAqB,IAAjBM,EAAM7+C,QAAoC,IAApB8+C,EAAS9+C,OAE/B,MAAO,CAACyQ,EAAMuuB,GAElBvuB,EAAOwT,GAASmB,qBAAqB+C,GAAKa,aAGlD2xB,mBAAoB,OAAOz4C,KAAKiE,MAAMuK,OAAO6mC,gBAC7C2D,oBACI,IAAKzqC,EAAMuuB,GAAU98B,KAAKu8C,cAC1B,MAAO,CAAChuC,OAAMuqC,QAAoB,cAAXhc,EAAyB,GAAK,CAACA,GAASic,QAASjc,IAKzE,MAAM+f,WAAiBrE,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC7Cu7C,QAAU,EAAE,KACZH,QAAU,GAAG,KACbJ,SAAW,CAAC,GAAI,IAAK,KAAM,MAAM,KACjCJ,gBAAkB,IAElBJ,mBAAoB,OAAOz4C,KAAKiE,MAAMuK,OAAO4mC,gBAC7C4D,oBACI,IAAIzqC,EAAOwT,GAASmB,qBAAqB+C,GAAKa,YAC1CxsB,EAAO0F,KAAKiE,MAAMuK,OAAO6sB,WAAW3E,gBACxC,MAAa,aAATp8B,EACO,CAACiU,OAAMuqC,QAAS,CAAC,YAAaC,QAAS,MAC9B,YAATz+C,EACA,CAACiU,OAAMuqC,QAAS,CAAC,WAAYC,QAAS,MAEtC,CAACxqC,OAAMuqC,QAAS,CAAC,WAAY,WAAYC,QAAS,OAK9D,MAAM+D,WAAmBtE,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC/Cu7C,QAAU,EAAE,KACZH,QAAU,GAAG,KACbJ,SAAW,CAAC,GAAI,IAAK,KAAM,MAAM,KACjCJ,gBAAkB,IAElBJ,mBAAoB,OAAOz4C,KAAKiE,MAAMuK,OAAO4mC,gBAC7C4D,oBACI,IAAIzqC,EAAOwT,GAASmB,qBAAqB+C,GAAKa,YAC1CxsB,EAAO0F,KAAKiE,MAAMuK,OAAO6sB,WAAW3E,gBACxC,MAAa,aAATp8B,EACO,CAACiU,OAAMuqC,QAAS,CAAC,cAAeC,QAAS,QAChC,YAATz+C,EACA,CAACiU,OAAMuqC,QAAS,CAAC,aAAcC,QAAS,QAExC,CAACxqC,OAAMuqC,QAAS,CAAC,aAAc,aAAcC,QAAS,SAMlE,MAAMgE,WAAmBvE,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC/Cu7C,QAAU,EAAE,KACZH,QAAU,GAAG,KACbO,gBAAkB,EAAE,KACpBf,gBAAkB,IAElBJ,mBAAoB,OAAOz4C,KAAKiE,MAAMuK,OAAO2mC,kBAC7CyD,YACI,IAAIj9B,EAAK3b,KAAKy4C,mBAEd,OADAz4C,KAAK64C,gBAAmBl9B,EAAG/E,OAAS,EAAK,KAAO,IACzC4O,MAAMozB,YAEjBI,oBACI,IAEIzqC,EAAMuqC,EAASC,EAFfiE,EAAYh9C,KAAKiE,MAAMuK,OAAOqoC,eAAengB,gBAC7CumB,EAAYj9C,KAAKiE,MAAMuK,OAAO+sB,eAAe7E,gBAG7CwmB,EAA6B,eAAdF,EACfG,EAAaD,EAAcj3B,GAAKC,aAAeD,GAAKE,cAaxD,OAZA5X,EAAOwT,GAASmB,qBAAqBi6B,GAEnB,aAAdF,GACAnE,EAAU,CAAC,cACXC,EAAU,cACW,YAAdkE,GACPnE,EAAU,CAAC,aACXC,EAAU,cAEVD,EAAU,CAAC,aAAc,aACzBC,EAAUmE,EAAc,aAAe,aAEpC,CAAC3uC,OAAMuqC,UAASC,YCrhBxB,MAAMqE,WAAiB5E,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC7Cw7C,eAAiB,EAAE,KACnBD,QAAU,EAAE,KACZH,QAAU,GAAG,KACbR,gBAAkB,IAElBwE,eAAeC,GACX,IAEI/uC,EAFA0tC,EAASj8C,KAAKiE,MAAMuK,OAAOktB,mBAAmBhF,gBAC9CxW,EAAmB,aAAX+7B,EAAyBh2B,GAAKG,UAAYH,GAAKI,QAE3D,KACI9X,EAAOwT,GAASmB,qBAAqBhD,GACtB,aAAX+7B,GAFK,CAIT,IAAI1lC,EAAKhI,EAAKgI,GAAGrD,QAAQ,GACrBsD,EAAKjI,EAAKiI,GAAGD,GACjB,GAAI+mC,EAAiB1B,MAAKphC,IAAA,IAAE+J,EAAKg5B,GAAI/iC,EAAA,OAAMhE,IAAO+N,GAAShO,IAAOgnC,KAC9D,MAGR,OAAOhvC,EAEXkqC,mBAAqB,OAAOz4C,KAAKiE,MAAMuK,OAAO8mC,gBAC9C0D,oBACI,IAAIiD,EAASj8C,KAAKiE,MAAMuK,OAAOgtB,WAAWjI,iBAAiB,GAC3D,MAAMiqB,EAAsC,CACxC,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,GAAI,CAAC,EAAG,GACZ,CAAC,EAAG,IAAK,CAAC,EAAG,IACb,CAAC,EAAG,IAAK,CAAC,EAAG,KAIjB,IAGI1E,EAASC,EAHT0E,EAA4Bz9C,KAAKiE,MAAMuK,OAAOkoC,cAActrB,MAAM5sB,KAAI,CAACoY,EAAO1X,IAAM,CAAC0X,EAAO1X,KAC3FmjB,QAAOhC,IAAA,IAAEzJ,EAAO1X,GAAEmhB,EAAA,OAAKzJ,KAAOpY,KAAIylB,IAAA,IAAErN,EAAO1X,GAAE+kB,EAAA,OAAKu5B,EAAgBt+C,MACnEqP,EAAOvO,KAAKq9C,eAAeI,GAG3BtD,EAAqB,gBADRn6C,KAAKiE,MAAMuK,OAAOktB,mBAAmBhF,gBACb,OAAS,KAalD,MAZe,aAAXulB,GACAlD,EAAUoB,EAAM,SAChBrB,EAAU,CAACC,IAEK,YAAXkD,GACLlD,EAAUoB,EAAM,QAChBrB,EAAU,CAACC,KAGXD,EAAU,CAACqB,EAAM,SAAUA,EAAM,SACjCpB,EAAU,MAEP,CAAExqC,OAAMuqC,UAASC,YCpDzB,MAAM2E,WAAkBlF,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC9Cu7C,QAAU,EAAE,KACZH,QAAU,GAAG,KACbK,cAAgB,EAAE,KAClBC,qBAAuB,MACvBX,oBAOI,IAAI2E,EAAO39C,KAAKiE,MAAMuK,OAAOuoC,eAAergB,gBAExCnoB,EAAOwT,GAASmB,qBAAqB+C,GAAKkB,aAE1C1P,GAAO,IAAIoD,IAAOG,UAAUzM,EAAM,IAGlCA,EADS,SAATovC,GACO,IAAI5nC,IAAYiC,MAAMpa,EAAY,CAAC,IAAK,OAAOoa,MAAMP,IAErD,IAAI1B,IAAYiC,MAAMP,GAGjC,IACImmC,EAD4D,eAApD59C,KAAKiE,MAAMuK,OAAOsoC,cAAcpgB,gBAClB,CAAC7b,GAAKS,IAAO,EAAGT,GAAKS,IAAI,OAAS,CAAE,GAAIT,GAAKS,IAAQ,IAC/E/M,EAAOA,EAAKyJ,MAAMpa,EAAYggD,IAE9B,IAAIhgB,EAAQ59B,KAAKiE,MAAMuK,OAAOwoC,iBAAiBtgB,gBAC3CoiB,EAAU,CAAC,OACXC,EAAU,MACd,MAAc,aAAVnb,GACArvB,EAAOA,EAAKyJ,MAAMpa,EAAY,CAAC,OAAQ,WAAWoa,MAAMpa,EAAY,CAAC,IAAK,KAAM,KAAM,QAC/E,CAAC2Q,OAAMuqC,UAASC,YAChBnb,EAAMtC,WAAW,cACxB/sB,EAAOA,EAAKyJ,MAAMpa,EAAY,CAAC,OAAQ,WAAWoa,MAAMpa,EAAY,CAAC,IAAK,KAAM,KAAM,QACtF2Q,EAAOA,EAAKyJ,MAAMpa,EAAY,CAAC,IAAK,QACpC2Q,EAAOA,EAAKyJ,MAAMpa,EAAY,CAAC,IAAK,KAAM,KAAM,QACzC,CAAC2Q,OAAMuqC,UAASC,YAEhB,CAACxqC,OAAMuqC,UAASC,YAKnC,MAAM8E,GAAW,CACb,CAAC1rB,KAAM,SAAU3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAChC,CAAC2b,KAAM,QAAS3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC/B,CAAC2b,KAAM,QAAS3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC/B,CAAC2b,KAAM,MAAO3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC7B,CAAC2b,KAAM,OAAQ3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC9B,CAAC2b,KAAM,OAAQ3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC9B,CAAC2b,KAAM,MAAO3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC7B,CAAC2b,KAAM,MAAO3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC7B,CAAC2b,KAAM,QAAS3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC/B,CAAC2b,KAAM,OAAQ3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC9B,CAAC2b,KAAM,MAAO3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,IAC7B,CAAC2b,KAAM,OAAQ3b,GAAI,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,KAE5BsnC,GAAiB,WACnB,IAAIt/C,EAAMoO,OAAOurC,OAAO,IAIxB,OAHA0F,GAAS/pC,SAAUiqC,IACfv/C,EAAIu/C,EAAIvnC,GAAG+C,YAAcwkC,EAAI5rB,QAE1B3zB,EALY,GAQhB,MAAMw/C,WAAmBxF,GAAmBzrC,cAAA,SAAA9O,WAAA,KAC/Cu7C,QAAU,EAAE,KACZH,QAAU,GAAG,KACbK,cAAgB,EAAE,KAClBC,qBAAuB,MAEvBsE,WAAW1vC,GACP,IAAK,IAAIrP,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,IAAIg/C,EAAS3vC,EAAKiI,GAAG6E,MAAM,EAAG,GAC9B6iC,EAAOpwC,KAAKS,EAAKiI,GAAG,IACpB,IAAIA,EAAMsnC,GAAeI,EAAO3kC,YAChC,GAAI/C,EAGA,OADA5W,QAAQ6hB,IAAIjL,EAAI0nC,GACT1nC,EAEXjI,EAAOA,EAAKyJ,MAAM,KAEtB,MAAO,QAGXghC,oBAOI,IAEIzqC,EAFA4vC,EAAWvgD,EAAYoC,KAAKiE,MAAMuK,OAAOyoC,cAAc1jB,kBAGvDxS,EAAQ,EACRq9B,EAAap+C,KAAKiE,MAAMuK,OAAO0oC,kBAAkBxgB,gBACjD2nB,EAAUD,IAAepJ,IAA+BoJ,IAAepJ,GACvEsJ,EAAoE,UAAxDt+C,KAAKiE,MAAMuK,OAAO2oC,kBAAkBzgB,gBAChD6nB,EAAmE,SAAxDv+C,KAAKiE,MAAMuK,OAAO2oC,kBAAkBzgB,gBAC/C8nB,EAAgF,iBAA9Dx+C,KAAKiE,MAAMuK,OAAO4oC,wBAAwB1gB,gBAEhE,OAAa,CAKT,GAJAnoB,EAAOwT,GAASmB,qBAAqB+C,GAAKnE,UAC1CvT,EAAOA,EAAKyJ,MAAMpa,EAAY,CAAC,KAAM,QACrCgC,QAAQ6hB,IAAI,WAAY08B,GAEpBp9B,IAAU,IAAM,CAChBnhB,QAAQ6hB,IAAI,mBACZ,MAIJ,GAAIzhB,KAAKi+C,WAAW1vC,KAAU4vC,EAA9B,CAEA,GAAIE,EAAS,CACT,IAAII,EAAWH,EAAY,WAAa,SACpCI,EAAWJ,EAAY,WAAa,SACpCK,EAAW5X,GAAartB,IAAI+kC,GAAUjd,MAAMjzB,EAAM,EAAG,GAAI,GAAG,GAAG4J,MAAMra,OACrE8gD,EAAW7X,GAAartB,IAAIglC,GAAUld,MAAMjzB,EAAM,EAAG,GAAI,GAAG,GAAG4J,MAAMra,OACzE,GAAKsgD,IAAepJ,IAA+B2J,EAAWC,EAAW,SACzE,GAAKR,IAAepJ,IAA4B4J,EAAWD,EAAW,SAE1E,OAGJ,MAAM5F,EAAWyF,GAAmBD,EAAY,MAAQ,WACxD,IAAIzhB,EACJ,OAAQshB,GACJ,KAAKpJ,GAAqBlY,EAASwhB,EAAY,WAAa,SAAU,MACtE,KAAKtJ,GAAkBlY,EAASwhB,EAAY,WAAa,SAAU,MACnE,KAAKtJ,GACL,KAAKA,GACL,KAAKA,GAA0BlY,EAASwhB,EAAY,SAAW,OAAQ,MACvE,QAASxhB,EAAS,OAQtB,OAJIyhB,IACAzhB,EAAS,QAGN,CAACvuB,OAAMuqC,QAAS,CAAChc,GAASic,YChJlC,MAAe8F,WAAmBxG,GACrCyG,mBAAmBvwC,GAGf,IAAIwwC,GAAU,EACK,IAAfxwC,EAAKkI,GAAG,KACRsoC,GAAU,EACVxwC,EAAOA,EAAKyJ,MAAM,OAEtBpY,QAAQqnC,OAAO3nC,EAAWiP,EAAKkI,IAAI,IAAIV,IAAYU,KAEnD,MAAMywB,EAAmB34B,EAAKwL,kBAC9Bna,QAAQqnC,OAAQC,EAAiBltB,eAAgB,0BACjDgtB,wBACA,IAAIvE,EAAW0E,GAAgBD,GAC3B6X,IACAtc,GAAY,OAEhB,MAAMiY,EAAoBxoB,GAAU,WAAYuQ,EAAU,YAE1D,OADA7iC,QAAQ6hB,IAAIghB,GACLiY,EAEXsE,gBACI,IAAI/6C,EAAQjE,KAAKiE,OACb,OAAEuK,GAAWvK,GACb,iBAAE2xC,EAAgB,gBAAEE,EAAe,gBAAED,EAAe,oBAAEG,EAAmB,cAAEL,EAAa,iBAAE3e,GAAqBxoB,EAEnH,MAAMywC,EAAkD,QAArCjoB,EAAiBN,gBAC9BwoB,EAAoD,QAArCloB,EAAiBN,gBACtC,IAqBIyoB,EArBAC,EACKH,EzBoUsBI,EAACltB,EAAcuB,KAClD,IAAIC,EAAiB,IAAIxW,IAAIuW,GAC7B9zB,QAAQ6hB,IAAI,8BAA+BkS,GAC3C,IAAIpD,EAAO4C,GAAchB,GAAM9P,QAAOH,GAAKwR,EAAY4rB,MAAKhlD,GAAQ4nB,EAAE0C,GAAGtD,SAAShnB,OAQlF,MAPWk5B,IACa,IAAhBjD,EAAKzyB,OACEu0B,GAEAz0B,EAAY2yB,IyBzUR8uB,CAAiC1J,EAAcxjB,KAAMwjB,EAAcpiB,iBAAiB/0B,KAAIa,GAAK,SAASA,OAFtGkgD,GAAyB3J,EAAiBzjB,KAAMyjB,EAAiBriB,kBAK5EisB,EAAiBpsB,GAAyB0iB,GAC1C2J,EAAiBrsB,GAAyByiB,GAC1C6J,EAAgBtsB,GAAyB4iB,GAKzC2J,EAAwBH,IACxBI,EAAqBR,IACrBS,EAAsBJ,IACtBK,EALOliD,EADUshD,EAAgB,CAAC,IAAK,MAAQ,CAAC,GAAI,OAOpDa,EAAUJ,EAAYpvB,KAAO,IAAMsvB,EAAUtvB,KAAO,IAAMqvB,EAASrvB,KAAOuvB,EAC1E3nC,EAAgB,IAAID,GAAQ6nC,GAAS3kC,MAAMjD,MAG/C,KACIgnC,EAAWp9B,GAAS2C,iBAAiB1M,MAAMG,IACvCgnC,EAASnlC,iBAIjB,IAAIyoB,EAAWziC,KAAK8+C,mBAAmBK,GAEnCvnC,EAAc8nC,IAAgB96B,GAElC,MAAQ,IACD3gB,EACH3J,KAAM,UACNiU,KAAM,CACFtK,MAAOk7C,EACPvnC,MACAooC,QAAS,GACTvjB,cAAc,GAElBnF,KAAM,CACFrzB,MAAOk7C,EACP5nB,KAAM,CAACooB,EAAaE,EAAWD,EAAUnd,KAIrDqY,UAAU79C,GACN,IAAIgH,EAAQjE,KAAKiE,MACjB,GAAU,WAANhH,EAGA,OAAO+C,KAAKg/C,gBAEX,GAAU,WAAN/hD,EAEL,MAAQ,IACDgH,EACH3J,KAAM,UACNiU,KAAM,IACCtK,EAAMsK,KACTtK,MAAOA,EAAMqzB,KAAKrzB,MAClB+7C,QAAS,IAEb1oB,KAAM,IACCrzB,EAAMqzB,OAKjB,MAAM,IAAI1X,MAAM,6BAGxBq7B,SAASC,GACL,OAAOl7C,KAAKiE,OAGb,MAAMg8C,WAA0BpB,GACnC9D,OAAOtjC,GACH,IAAIxT,EAAQjE,KAAKiE,MACbkU,EAAQ,IAAID,GAAQT,GAAMU,MAC9B,GAAIA,EAAMra,OAAS,EAAG,CAClB,IAAI2Z,EAAOU,EAAM,GACb5J,EAAOtK,EAAMsK,KAAKtK,MAAM+T,MAAMP,GAE9BivB,EADc3kB,GAASgC,eAAexV,GACL,SAAW,UAChD,MAAQ,IACDtK,EACHsK,KAAM,IACCtK,EAAMsK,KACTtK,MAAOA,EAAMsK,KAAKtK,MAAM+T,MAAMP,GAC9BuoC,QAAS,IAAI/7C,EAAMsK,KAAKyxC,QAASvoC,IAErCnd,KAAMosC,GAKV,OAAOziC,GAIZ,MAAMi8C,WAAyBrB,GAClC9D,OAAOtjC,GACH,OAAOzX,KAAKiE,OCtIpBs0C,GAAa1rC,OAAS,SAAS5I,GAEvB,OADiBA,EAAM2K,MAEnB,IAAK,OACD,OAAO,IAAIusC,GAAWl3C,GAC1B,IAAK,KACD,OAAO,IAAIm5C,GAASn5C,GACxB,IAAK,OACD,OAAO,IAAI84C,GAAW94C,GAC1B,IAAK,KACD,OAAO,IAAI44C,GAAS54C,GACxB,IAAK,OACD,OAAO,IAAI64C,GAAW74C,GAC1B,IAAK,KACD,OAAO,IAAIk4C,GAASl4C,GACxB,IAAK,OACD,OAAQA,EAAM3J,MACV,IAAK,UAAW,OAAO,IAAI2lD,GAAkBh8C,GAC7C,IAAK,SAAU,OAAO,IAAIi8C,GAAiBj8C,GAC3C,QAAS,MAAM,IAAI2b,MAAM,cAGjC,IAAK,YACD,OAAQ3b,EAAM3J,MACV,IAAK,UAAW,OAAO,IAAI2lD,GAAkBh8C,GAC7C,IAAK,SAAU,OAAO,IAAIi8C,GAAiBj8C,GAC3C,QAAS,MAAM,IAAI2b,MAAM,cAGjC,IAAK,KACD,OAAO,IAAI89B,GAAUz5C,GACzB,IAAK,SACD,OAAO,IAAI+5C,GAAW/5C,GAC1B,IAAK,eAEL,IAAK,WAEL,IAAK,WACD,OAAO,IAAIk4C,GAASl4C,KC3CpC,MAAMk8C,GAAgD,CAClD,EAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,IAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,EAAK,KACL,EAAK,IACL,EAAK,IACL,EAAK,IACL,EAAK,KACL,EAAK,KACL,IAAK,KACL,EAAK,KACL,EAAK,IACL,EAAK,IACL,EAAK,IACL,EAAK,KACL,EAAK,IACL,EAAK,KACL,IAAK,IACL,IAAK,KACL,MAAS,SACT,IAAK,UAIHC,GAA4C,CAC9C,EAAK,KACL,EAAK,KACL,EAAK,IACL,EAAK,IACL,EAAK,IACL,EAAK,KACL,EAAK,KACL,EAAK,IACL,MAAS,SACT,IAAK,UAQF,MAAMC,WAJN,QAKHhpB,OAAO5M,EAAoBK,GAEvB,GAAIL,EAAI61B,QAAU71B,EAAIjf,SAAWif,EAAIhf,QAAS,OAC9C,IAAI4J,EAAMoV,EAAIpV,IAAIoc,cACd0uB,GAAkBr/B,eAAezL,IACjCyV,EAAS,CACPvwB,KAAM,MAAOwwB,QAASo1B,GAAkB9qC,MAM/C,MAAMkrC,GACTlpB,OAAO5M,EAAoBK,GAEvB,GAAIL,EAAI61B,QAAU71B,EAAIjf,SAAWif,EAAIhf,QAAS,OAC9C,IAAI4J,EAAMoV,EAAIpV,IAAIoc,cACd2uB,GAAct/B,eAAezL,IAC7ByV,EAAS,CACPvwB,KAAM,MAAOwwB,QAASq1B,GAAc/qC,MCxE3C,MAAMmrC,GAAmB5xC,IAC5BA,EAAOA,GAAQ,OACf,IAAI6xC,EAA2B,WAC3B,OAAQ7xC,GACJ,IAAK,OACL,IAAK,YACD,MAAO,SACX,IAAK,OACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,SACL,IAAK,OACL,IAAK,KACL,IAAK,OAEL,IAAK,eAEL,IAAK,WACL,IAAK,WACD,MAAO,YAlBY,GAqB3BgJ,EAAMigC,KAAY7B,oBAAoBtf,iBAAmB,KAC7D,MAAO,CACHp8B,KAAMmmD,EACN7xC,OACA+tB,cAAe,GACfpuB,KAAM,CACFtK,MAAO,IAAI8R,GACX6B,MACAooC,QAAS,GACTvjB,cAAc,GAElBnF,KAAM,CACFrzB,MAAO,IAAI8R,GACXwhB,KAAM,IAEVmpB,KAAM,KACNlyC,OAAQqpC,KACRvQ,QAASgQ,KACTlgB,WAAsB,OAATxoB,GAA0B,WAATA,EAAqB,IAAI2xC,GAAkB,IAAIF,GAC7E1xC,YAAa,IAAIoW,K,aCVlB,SAAS47B,GAAQ18C,EAAiB84B,GAGrC,OAAQA,EAAOxiC,MACX,IAAK,MAAO,CACR,IAAImsC,EAgDhB,SAAqBziC,EAAiB28C,GAClC,GAAa,KAATA,EAAa,OAAO38C,EAExB,MAAM48C,EAAStI,GAAa1rC,OAAO5I,GAEnC,MAAgB,MAAZ28C,EAAK,GACEC,EAAO/F,UAAU8F,GAEjBC,EAAO9F,OAAO6F,GAxDFE,CAAY78C,EAAO84B,EAAOhS,SACzC,OAAO2b,EAEX,IAAK,SAAU,CAEX,IAAIwR,EAAY,IAAIj0C,EAAMuK,UAAWuuB,EAAOhS,SAM5CitB,GAAUE,GACV,IAAIxR,EA+ChB,SAAwBziC,EAAiBi3C,GAGrC,OAFe3C,GAAa1rC,OAAO5I,GAErBg3C,SAASC,GAlDA6F,CAAe98C,EAAOi0C,GACrC,MAAO,IACAxR,EACHl4B,OAAQ0pC,GAGhB,IAAK,OAAQ,CACT,IAAItpC,EAAOmuB,EAAOhS,QAOlB,OANI1f,OAAOsoC,SAASC,OAAShlC,GACzBoyC,KAAQC,SAASryC,GAErBvD,OAAOsoC,SAASC,KAAOhlC,EAEvB3K,EAAQu8C,GAAgB5xC,GAG5B,IAAK,gBACD,MAAO,IACA3K,EACH04B,cAAeI,EAAOhS,SAE9B,IAAK,UACD,OAlEZ,SAAyB9mB,EAAiB84B,GACtC,IAAIuK,EAAUrjC,EAAMqjC,QAEpB,OAAQvK,EAAOA,QACX,IAAK,MACDuK,EAAU,IAAIvK,EAAOhS,WAAYuc,GACjCiQ,GAAWjQ,GACX,MACJ,IAAK,SAAU,CAEX,MAAM4Z,EAAMnkB,EAAOhS,QAAQ,GAC3Buc,EAAUA,EAAQjlB,QAAQzL,KACbA,EAAMhI,OAASsyC,EAAItyC,MAAQgI,EAAMwb,QAAU8uB,EAAI9uB,OAAS9yB,EAAWsX,EAAMkmB,OAAQokB,EAAIpkB,WAElGya,GAAWjQ,GACX,MAEJ,IAAK,SACD,OAAOiR,GAAa1rC,OAAO5I,GAAOq0C,SAASvb,EAAOhS,QAAQ,IAGlE,MAAO,IACA9mB,EACHqjC,WA2CW6Z,CAAgBl9C,EAAO84B,GAClC,IAAK,cACD,MAAO,IACA94B,EACH0K,YAAa1K,EAAM0K,YAAY5I,IAAIg3B,EAAOhS,UAElD,IAAK,SACD,OAAOgS,EAAOhS,QAAQ9mB,GAC1B,QACI,OAAOA,G,gDCrEnBoH,OAAO9H,iBAAiB,YAAY,SAASvG,GAC1B,KAAdA,EAAEoP,SAAkBpP,EAAEkD,SAAWJ,SAASshD,MAC3CpkD,EAAEmO,iBAEAnO,EAAEsjD,QAAUtjD,EAAEwO,SAAqB,MAAVxO,EAAEqY,MAC7B+iC,KACAx4C,QAAQ6hB,IAAI,oBAkBD4/B,OAdf,SAAa5sC,GACX,MAAOxQ,EAAO6mB,GAAYnW,IAAM2sC,WAAYX,GAASH,MAE/Ce,EAAkD,WAAvCt9C,EAAMuK,OAAOK,MAAM6nB,gBAA+B7nB,GAAQghB,GAC3E,OACEla,eAAC6rC,KAAoB,CAACC,aAAW,EAAA13B,SAC/BF,gBAAC63B,KAAa,CAAC7yC,MAAO0yC,EAASx3B,SAAA,CAE7BpU,eAACgsC,KAAW,IACZhsC,eAACo+B,GAAO,CAAC9vC,MAAOA,EAAO6mB,SAAUA,UCxBrBimB,QACW,cAA7B1lC,OAAOsoC,SAASiO,UAEe,UAA7Bv2C,OAAOsoC,SAASiO,UAEhBv2C,OAAOsoC,SAASiO,SAASh/B,MACvB,2DCVJo+B,KAAQa,WAAW,kBAKrBC,IAASzuC,OACLsC,eAAC0rC,GAAG,IACJvhD,SAASiiD,eAAe,SDkHtB,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMjnD,MAAKknD,IACjCA,EAAaC,iB,iBElInB,SAASC,EAAYvkD,GACpB,MAAMD,EAAMM,MAAML,GAClB,IAAK,IAAIoB,EAAE,EAAGA,EAAEpB,EAAQoB,IACvBrB,EAAIqB,GAAK,EAEV,OAAOrB,EAsBR,SAASykD,EAASpjD,GAGjB,OADAA,GAAS,WADTA,GAAUA,IAAM,EAAK,cACIA,IAAM,EAAK,aACvBA,IAAM,IAAMA,IAAM,GAAM,GAatC,SAASqjD,EAAWzvC,GAEnB,IADA,IAAIiE,EAAI,EACC7X,EAAE,EAAGA,GAAG,EAAGA,IACnB6X,GAAKjE,GAAO,EAAE5T,GACd4T,KAASA,GAAO,EAAE5T,IAGnB,OADA6X,GAAK,EAIN,SAASyrC,EAAY1vC,GAEpB,IADA,IAAIiE,EAAI,EACC7X,EAAE,GAAIA,GAAG,EAAGA,IACpB6X,GAAKjE,GAAO,GAAG5T,GACf4T,KAASA,GAAO,GAAG5T,IAGpB,OADA6X,GAAK,EAKN,SAAS0rC,EAAa5kD,EAAKwX,GAC1B,IAAIvX,EAASD,EAAIC,OACjB,GAAIuX,GAAOxX,EAAIC,EAAO,GAGrB,IAFA,IAAIlB,EAAI,EACJD,EAAImB,EAAO,EACRlB,GAAKD,GAAG,CACd,IAAI+lD,EAAO9lD,EAAED,IAAK,EACdgmD,EAAM9kD,EAAI6kD,GACd,GAAIrtC,EAAMstC,EACT/lD,EAAI8lD,EAAM,MACJ,MAAIrtC,EAAMstC,GAGhB,OAAQD,EAFR/lD,EAAI+lD,EAAM,GAMb,OAAO,MAeR,IAZA,IAAIE,EAAO,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,IAAK,IAAK,KAAM,MAAO,OAAQ,QAAS,SAAU,WAC1EC,EAAQ,CAAC,CAAC,GAAI,GAAI,GAAI,CAAC,GAAI,GAAI,GAAI,CAAC,GAAI,EAAG,IAAK,CAAC,EAAG,GAAI,IAAK,CAAC,GAAI,EAAG,IAAK,CAAC,EAAG,GAAI,KAClFC,EAAS,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,IACxCC,EAASV,EAAY,IACrBW,EAhFJ,SAAsBC,EAASC,GAC9B,MAAMrlD,EAAMM,MAAM8kD,GAClB,IAAK,IAAI/jD,EAAE,EAAGA,EAAE+jD,EAAS/jD,IAAK,CAC7BrB,EAAIqB,GAAKf,MAAM+kD,GACf,IAAK,IAAIvqC,EAAE,EAAGA,EAAEuqC,EAASvqC,IACxB9a,EAAIqB,GAAGyZ,GAAK,EAGd,OAAO9a,EAwEEslD,CAAa,GAAI,IACvBC,EAAW,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAClHC,EAAU,CAAC,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IACvD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAG,IACnD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,IACnD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAAG,GAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,IACnD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAI,EAAE,GAAG,GAAG,IACnD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAI,IACtDnkD,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxB8jD,EAAI9jD,GAAG,GAAK,EACZ8jD,EAAI9jD,GAAGA,GAAK,EACZ8jD,EAAI9jD,GAAGA,EAAE,GAAK,EACd,IAAK,IAAIyZ,EAAE,EAAGA,EAAEzZ,EAAGyZ,IAClBqqC,EAAI9jD,GAAGyZ,GAAMqqC,EAAI9jD,EAAE,GAAGyZ,EAAE,GAAKqqC,EAAI9jD,EAAE,GAAGyZ,GAGxC,IAASzZ,EAAE,EAAGA,EAAE,GAAIA,IACnB6jD,EAAOD,EAAO5jD,IAAMA,EAGrB,IAAIokD,EAAOnlD,MAAM,IACbolD,EAAQplD,MAAM,IAClBmlD,EAAK,IAAMnlD,MAAM,IACjBolD,EAAM,IAAMplD,MAAM,IAClB,IAASe,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxBokD,EAAKpkD,GAAKf,MAAM,IAChB,IAASwa,EAAE,EAAGA,EAAE,GAAIA,IACnB2qC,EAAKpkD,GAAGyZ,MAASzZ,EAAE,OAASyZ,EAAE,OAAYzZ,EAAE,GAAG,MAAQyZ,EAAE,GAAG,GAAOzZ,GAAGyZ,EAEvE2qC,EAAK,IAAIpkD,IAAK,EAEf,IAASA,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxBqkD,EAAMrkD,GAAKf,MAAM,IACjB,IAASwa,EAAE,EAAGA,EAAE,GAAIA,IACnB4qC,EAAMrkD,GAAGyZ,GAAK2qC,EAAKR,EAAO5jD,IAAI4jD,EAAOnqC,IAEtC4qC,EAAM,IAAIrkD,IAAK,EAMhB,SAAS6W,IACR/V,KAAKqW,GAAK,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAChCrW,KAAKsW,GAAK,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAChCtW,KAAKuW,GAAK,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,IAC7CvW,KAAKwW,GAAK,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC5CxW,KAAKwjD,QAAU,WAEd,IADA,IAAI1wC,EAAM,EACD5T,EAAE,EAAGA,EAAE,GAAIA,IACnB4T,GAAO9S,KAAKwW,GAAGtX,IAAMA,EAEtB,OAAO4T,GAGR9S,KAAKyjD,WAAa,WACjB,GAAe,GAAXC,EACH,OAAOA,EAAQ1jD,KAAKwjD,WAErB,IAAK,IAAI7mC,EAAE,EAAGA,EAAE,GAAIA,GAAG,EAAG,CACzBgnC,EAAc3jD,KAAM4jD,EAAOjnC,GAAIknC,GAC/B,IAAI/wC,EAAM2vC,EAAaqB,EAASD,EAAML,WACtC,GAAW,OAAP1wC,EACH,OAASA,GAAO,EAAM6J,IAAM,EAG9B,OAAO,GAGR3c,KAAK+jD,QAAU,SAAiBjxC,GAC/B9S,KAAKwW,GAAG,IA3IV,SAAgBtX,GAKf,OAJAA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EACXA,GAAKA,IAAM,EAEA,GADXA,EAAKA,IAAM,GAuII8kD,CAAOlxC,GACrB,IAAK,IAAI5T,EAAE,EAAGA,EAAE,GAAIA,IACnBc,KAAKwW,GAAGtX,GAAW,EAAN4T,EACbA,KAAS,GAIX9S,KAAKikD,SAAW,WAEf,IADA,IAAInxC,EAAM,EACD5T,EAAE,EAAGA,EAAE,EAAGA,IAClB4T,GAAO,EACPA,GAAO9S,KAAKsW,GAAGpX,GAEhB,OAAO4T,GAGR9S,KAAKkkD,YAAc,WAClB,GAAgB,MAAZC,EACH,OAAOA,EAASnkD,KAAKikD,YAEtB,IAAK,IAAItnC,EAAE,EAAGA,EAAE,GAAIA,GAAG,EAAG,CACzBynC,EAAcpkD,KAAM4jD,EAAOjnC,GAAIknC,GAC/B,IAAI/wC,EAAM2vC,EAAa4B,EAAUR,EAAMI,YACvC,GAAW,OAAPnxC,EACH,OAASA,GAAO,EAAM6J,IAAM,EAG9B,OAAO,GAIR3c,KAAKskD,SAAW,SAAkBxxC,GAEjC,IADA,IAAIyxC,EAAO,EACFrlD,EAAE,EAAGA,GAAG,EAAGA,IACnBqlD,GAAQvkD,KAAKsW,GAAGpX,GAAK4T,EAAM,EAC3BA,KAASA,EAAI,GAEd9S,KAAKsW,GAAG,IAAM,GAAKiuC,GAAQ,GAG5BvkD,KAAKwkD,WAAa,WAGjB,IAFA,IAAI1xC,EAAM,EACNnW,EAAI,EACCuC,EAAE,EAAGA,EAAE,GAAIA,IACfc,KAAKuW,GAAGrX,IAAM,IACjB4T,GAAOkwC,EAAI,GAAG9jD,GAAGvC,GACjBA,KAGF,OAAOmW,GAGR9S,KAAKykD,WAAa,SAAoB3xC,GAErC,IADA,IAAInW,EAAI,EACCuC,EAAE,EAAGA,EAAE,GAAIA,IACf4T,GAAOkwC,EAAI,GAAG9jD,GAAGvC,IACpBmW,GAAOkwC,EAAI,GAAG9jD,GAAGvC,GACjBA,IACAqD,KAAKuW,GAAGrX,GAAM,GAAGvC,GAEjBqD,KAAKuW,GAAGrX,GAAMA,EAAEvC,EAAE,GAIrBqD,KAAK0kD,SAAW,WAGf,IAFA,IAAI3nD,EAAK,GAAKiD,KAAKuW,GAAG,IAClBzD,EAAM,EACD5T,EAAE,GAAIA,GAAG,IAAKA,EAAG,CACzB,IAAIiyC,EAAI,GAAKnxC,KAAKuW,GAAGrX,GACrB4T,GAAOwvC,EAASvlD,EAAKo0C,EAAI,GAAMyR,EAAK,GAAG1jD,GACvCnC,GAAKo0C,EAEN,OAAOr+B,GAER9S,KAAK2kD,SAAW,SAAkB7xC,GACjC9S,KAAKuW,GAAG,IAAM,EACd,IAAK,IAAIrX,EAAE,GAAIA,GAAG,EAAGA,IAAK,CACzBc,KAAKuW,GAAGrX,GAAM4T,GAAO,GAAG5T,GAAK,EAC7B4T,KAASA,GAAO,GAAG5T,IACnB,IAAK,IAAIyZ,EAAEzZ,EAAE,EAAGyZ,EAAE,GAAIA,IACjB3Y,KAAKuW,GAAGoC,IAAM3Y,KAAKuW,GAAGrX,IACzBc,KAAKuW,GAAGoC,OAKZ3Y,KAAK4kD,QAAU,WAKd,IAJA,IAAIC,EAAO,EACPC,EAAO,EACP5kC,EAAO,EACPvjB,EAAI,EACCuC,EAAE,GAAIA,GAAG,EAAGA,IACpB,GAAIc,KAAKuW,GAAGrX,IAAM,EAAG,CACpB2lD,GAAQ7B,EAAI9jD,GAAGvC,KACf,IAAIw0C,EAAI,GAAKnxC,KAAKuW,GAAGrX,GACrB4lD,GAAQxC,EAASpiC,EAAQixB,EAAI,GAAMyR,EAAK,EAAEjmD,GAC1CujB,GAAQixB,EAGV,OAAe,EAAP0T,EAAWC,GAGpB9kD,KAAK+kD,QAAU,SAAiBF,GAC/B,IAAI/b,EAAO+Z,EAAMgC,EAAO,GACxBA,KAAUA,EAAO,GAEjB,IADA,IAAIloD,EAAI,EACCuC,EAAE,GAAIA,GAAG,EAAGA,IAChB2lD,GAAQ7B,EAAI9jD,GAAGvC,IAClBkoD,GAAQ7B,EAAI9jD,GAAGvC,KACfqD,KAAKuW,GAAGrX,GAAK4pC,EAAK,EAAEnsC,IAEpBqD,KAAKuW,GAAGrX,GAAM,EAAEA,EAAEvC,GAKrBqD,KAAKglD,UAAY,WAKhB,IAJA,IAAIH,EAAO,EACPC,EAAO,EACP5kC,EAAO,EACPvjB,EAAI,EACCuC,EAAE,GAAIA,GAAG,EAAGA,IACpB,GAAIc,KAAKuW,GAAGrX,IAAM,EAAG,CACpB2lD,GAAQ7B,EAAI9jD,GAAGvC,KACf,IAAIw0C,EAAI,GAAKnxC,KAAKuW,GAAGrX,GACrB4lD,GAAQxC,EAASpiC,EAAQixB,EAAI,GAAMyR,EAAK,EAAEjmD,GAC1CujB,GAAQixB,EAGV,OAAe,EAAP0T,EAAWC,GAGpB9kD,KAAKilD,UAAY,WAKhB,IAJA,IAAIJ,EAAO,EACPC,EAAO,EACP5kC,EAAO,EACPvjB,EAAI,EACCuC,EAAE,GAAIA,GAAG,EAAGA,IACpB,GAAI,GAAKc,KAAKuW,GAAGrX,IAAMc,KAAKuW,GAAGrX,IAAM,EAAG,CACvC2lD,GAAQ7B,EAAI9jD,GAAGvC,KACf,IAAIw0C,EAAI,GAAKnxC,KAAKuW,GAAGrX,GACrB4lD,GAAQxC,EAASpiC,EAAQixB,EAAI,GAAMyR,EAAK,EAAEjmD,GAC1CujB,GAAQixB,EAGV,OAAe,EAAP0T,EAAWC,GAGpB9kD,KAAKklD,YAAc,SAAqBpyC,GACvC9S,KAAKuW,GAAG,IAAM,EACd,IAAK,IAAIrX,EAAE,GAAIA,GAAG,EAAGA,IAAK,CACzBc,KAAKuW,GAAGrX,GAAM4T,GAAO,GAAG5T,GACxB4T,KAASA,GAAK,GAAG5T,IACjB,IAAK,IAAIyZ,EAAEzZ,EAAE,EAAGyZ,EAAE,GAAIA,IACjB3Y,KAAKuW,GAAGoC,IAAM3Y,KAAKuW,GAAGrX,IACzBc,KAAKuW,GAAGoC,OAKZ3Y,KAAKmlD,YAAc,WAGlB,IAFA,IAAIpoD,EAAK,GAAKiD,KAAKuW,GAAG,IAClBzD,EAAM,EACD5T,EAAE,GAAIA,GAAG,IAAKA,EAAG,CACzB,IAAIiyC,EAAI,GAAKnxC,KAAKuW,GAAGrX,GACrB4T,GAAOwvC,EAASvlD,EAAKo0C,EAAI,GAAMyR,EAAK,GAAG1jD,GACvCnC,GAAKo0C,EAEN,OAAOr+B,GAGR9S,KAAKolD,YAAc,WAClB,GAAgB,MAAZC,EAAkB,CACrB,IAAIvyC,EAAMuyC,EAASC,EAAStlD,KAAKqW,KAEjC,OADAvD,GAAOyyC,EAAQ,GAAJzyC,GAGZ,IAAK,IAAI6J,EAAE,EAAGA,EAAE,GAAIA,IAAK,CAGxB,GAFAynC,EAAcpkD,KAAM4jD,EAAOjnC,GAAIknC,GAEpB,QADP/wC,EAAM2vC,EAAa+C,EAAUF,EAASzB,EAAMxtC,MAE/C,OAASvD,GAAO,EAAK6J,EAGvB,OAAO,GAGR3c,KAAKylD,YAAc,WAClB,GAAgB,MAAZJ,EACH,OAAOA,EAASC,EAAStlD,KAAKuW,KAE/B,IAAK,IAAIoG,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxBgnC,EAAc3jD,KAAM4jD,EAAOjnC,GAAIknC,GAC/B,IAAI/wC,EAAM2vC,EAAaiD,EAAUJ,EAASzB,EAAMttC,KAChD,GAAW,OAAPzD,EACH,OAASA,GAAO,EAAK6J,EAGvB,OAAO,GAGR3c,KAAK2lD,aAAe,WACnBC,EAASC,EAAM7lD,KAAM6jD,GACrB+B,EAAS/B,EAAOiC,EAAM9lD,MACtB+lD,EAASF,EAAM7lD,KAAM6jD,GACrBkC,EAASlC,EAAOiC,EAAM9lD,OAGvBA,KAAKgmD,aAAe,WACnB,IAAK,IAAIld,EAAK,EAAGA,EAAK,GAAIA,IACzB+a,EAAMttC,GAAGvW,KAAKuW,GAAGuyB,IAASA,EAC3B,IAASA,EAAK,EAAGA,EAAK,GAAIA,IACzB+a,EAAMrtC,GAAGsyB,GAAQ9oC,KAAKwW,GAAGqtC,EAAMttC,GAAGuyB,IACnC,IAAK,IAAImd,EAAK,EAAGA,EAAK,EAAGA,IACxBpC,EAAMxtC,GAAGrW,KAAKqW,GAAG4vC,IAASA,EAC3B,IAASA,EAAK,EAAGA,EAAK,EAAGA,IAAQ,CAChC,IAAIruC,EAAM5X,KAAKsW,GAAGutC,EAAMxtC,GAAG4vC,IAC3BpC,EAAMvtC,GAAG2vC,IAASruC,EACdisC,EAAMvtC,GAAG2vC,GAAQ,IACpBpC,EAAMvtC,GAAG2vC,IAAS,GAEpBjmD,KAAK2D,KAAKkgD,IAIX7jD,KAAKmkC,KAAO,SAAc+hB,EAAOC,EAAOC,EAAOC,GAC9CC,EAAStmD,KAAKqW,GAAI6vC,GAClBlmD,KAAKskD,SAAS6B,GACdnmD,KAAKklD,YAAYkB,GACjBpmD,KAAK+jD,QAAQsC,IAGdrmD,KAAK2D,KAAO,SAAcue,GACzB,IAAK,IAAIhjB,EAAE,EAAGA,EAAE,EAAGA,IAClBc,KAAKqW,GAAGnX,GAAKgjB,EAAE7L,GAAGnX,GAClBc,KAAKsW,GAAGpX,GAAKgjB,EAAE5L,GAAGpX,GAEnB,IAASA,EAAI,EAAGA,EAAI,GAAIA,IACvBc,KAAKuW,GAAGrX,GAAKgjB,EAAE3L,GAAGrX,GAClBc,KAAKwW,GAAGtX,GAAKgjB,EAAE1L,GAAGtX,IAKrB,MAAMqnD,EAAS,IAAIxwC,EACb8tC,EAAQ,IAAI9tC,EAElB,SAASuwC,EAASzoD,EAAKiV,GAEtB,IADA,IAAI6vC,EAAM,WACDzjD,EAAE,EAAGA,EAAE,EAAGA,IAAK,CACvB,IAAI6X,EAAI6rC,EAAK,EAAE1jD,GACXoJ,KAAOwK,EAAMiE,GACjBjE,GAAOiE,EACPzO,IAAM,EACNzK,EAAIqB,GAAOyjD,GAAOr6C,EAAK,EACvB,IAAIvL,GAAK,GAAKuL,GAAK,EACnBq6C,GAAOA,EAAM5lD,IAAO4lD,GAAO,GAAM5lD,GAElCc,EAAI,GAAK8kD,EAGV,SAAS2C,EAASznD,GAGjB,IAFA,IAAIiV,EAAM,EACN6vC,EAAM,WACDzjD,EAAE,EAAGA,EAAE,EAAGA,IAAK,CACvB,IAAIoJ,EAAIzK,EAAIqB,IAAM,EAClB4T,GAAO,EAAI5T,GAAK4T,GAAQ6vC,GAAOr6C,EAAK,GACpCq6C,GAAO,WAAcr6C,EAEtB,OAAOwK,EAGR,SAAS8yC,EAAS3jC,EAAGnlB,EAAG0pD,GACvB,IAAK,IAAIP,EAAK,EAAGA,EAAK,EAAGA,IAAQ,CAChCO,EAAKnwC,GAAG4vC,GAAQhkC,EAAE5L,GAAGvZ,EAAEuZ,GAAG4vC,IAC1B,IAAIQ,EAAOxkC,EAAE3L,GAAGxZ,EAAEuZ,GAAG4vC,IACjBS,EAAO5pD,EAAEwZ,GAAG2vC,GACZruC,EAAM6uC,EACV7uC,GAAQ6uC,EAAK,EAAKC,EAAO,EAAEA,EAC3B9uC,GAAO,EACH6uC,EAAO,EAAIC,EAAO,IACrB9uC,GAAO,GAER4uC,EAAKlwC,GAAG2vC,GAAQruC,GAIlB,SAASmuC,EAAS9jC,EAAGnlB,EAAG0pD,GACvB,IAAK,IAAIG,EAAG,EAAGA,EAAG,GAAIA,IACrBH,EAAKjwC,GAAGowC,GAAM1kC,EAAE1L,GAAGzZ,EAAEyZ,GAAGowC,IACxBH,EAAKhwC,GAAGmwC,GAAO7pD,EAAE0Z,GAAGmwC,GAAM1kC,EAAEzL,GAAG1Z,EAAEyZ,GAAGowC,IAItC,SAASvC,EAAcniC,EAAGnP,EAAKhW,GAC9B8oD,EAASgB,EAAQhD,EAAO9wC,IAAOmP,EAAGskC,GAClCX,EAASW,EAAQK,EAAQ9zC,GAAMhW,GAGhC,SAAS6mD,EAAc1hC,EAAGnP,EAAKhW,GAC9BipD,EAASa,EAAQhD,EAAO9wC,IAAOmP,EAAGskC,GAClCR,EAASQ,EAAQK,EAAQ9zC,GAAMhW,GAGhC,IAAI8pD,EAAUzoD,MAAM,IAChB0oD,EAAW1oD,MAAM,IACjBylD,EAASzlD,MAAM,IACf2oD,EAAU3oD,MAAM,IAChB4oD,EAAU5oD,MAAM,IAChB6oD,EAAW7oD,MAAM,GACjB8oD,EAAW9oD,MAAM,GACjB+oD,EAAc/oD,MAAM,GACpBgpD,EAAYhpD,MAAM,IAClB2lD,EAAU3lD,MAAM,KAChBkmD,EAAWlmD,MAAM,KACjBqnD,EAAWrnD,MAAM,MACjBunD,EAAWF,EACX9B,EAAUvlD,MAAM,MAChBgmD,EAAWhmD,MAAM,MACjBknD,EAAWhD,EAAY,OAC3B,IAASnjD,EAAE,EAAGA,EAAE,MAAOA,IACtBmmD,EAASnmD,GAAK,EAEf,IAAIkoD,EAAWjpD,MAAM,OACjBkpD,EAAQlpD,MAAM,IACdonD,EAAM,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACxD,MAAMO,EAAO,IAAI/vC,EACjB+vC,EAAK3hB,KAAK,KAAM,KAAM,SAAU,MAChC,MAAM0hB,EAAO,IAAI9vC,EACjB8vC,EAAK1hB,KAAK,KAAM,KAAM,UAAW,KA+LjC,IAAImjB,EAAcnpD,MAAM,KACpBopD,EAAYppD,MAAM,KAClBqpD,EAAWrpD,MAAM,KACjBspD,EAActpD,MAAM,KACpBupD,EAAmBvpD,MAAM,QACzBwpD,EAAkBxpD,MAAM,QAExBypD,GAAgBzpD,MAAM,QAGtB0pD,GAAW1pD,MAAM,MACjB2pD,GAAa3pD,MAAM,IACnB4pD,GAAU5pD,MAAM,IAGhB6pD,GAAY7pD,MAAM,MAClB8pD,GAAY9pD,MAAM,MAClB+pD,GAAY/pD,MAAM,IAClBgqD,GAAYhqD,MAAM,IAClBiqD,GAAajqD,MAAM,OACnBkqD,GAAalqD,MAAM,OAoYvB,IAOImqD,GAPA7wC,GAAOtZ,MAAM,IAEb8nD,GAAO9nD,MAAM,IACboqD,GAAOpqD,MAAM,IACbqqD,GAAOrqD,MAAM,IACbshC,GAAKthC,MAAM,IACXuhC,GAAKvhC,MAAM,IAGXgoD,GAAQhoD,MAAM,GACdsqD,GAAOtqD,MAAM,GACbkoD,GAAOloD,MAAM,GACbuqD,GAAOvqD,MAAM,GACbkd,GAAQld,MAAM,GACdwqD,GAAQxqD,MAAM,GACdyqD,GAAQzqD,MAAM,GACd0qD,GAAQ1qD,MAAM,GACd2qD,GAAM3qD,MAAM,GACZ4qD,GAAM5qD,MAAM,GACZ6qD,GAAO7qD,MAAM,GAEb8kD,GAAU,EACVgG,GAAa,EACbnmB,GAAM,IACNomB,GAAS,EACTC,GAAS,EACT1mB,GAAW,GAmDf,SAAS2mB,GAAOjD,EAAOsC,EAAMpC,EAAMqC,EAAMrtC,EAAOguC,EAAMC,GACrD,GAAW,GAAPnD,GAAkB,GAANE,GAAkB,GAAPhrC,GAAYguC,EAAO,EAC7C,OAAe,GAARA,GA8BT,WAICF,GAAS3rD,KAAK2H,IAAIgkD,GAAQD,IAC1B,IAAK,IAAIhqD,EAAEgqD,GAAQhqD,EAAE+jD,GAAS/jD,IAAK,CAClC,IAAInC,EAAI0a,GAAKvY,GACb+mD,GAAK/mD,EAAE,GAAK8oD,GAAU/B,GAAK/mD,IAAI6nD,EAAQwB,GAAKrpD,IAAInC,IAChDwrD,GAAKrpD,EAAE,GAAK4nD,EAAoB,GAAZb,GAAK/mD,EAAE,IAASqpD,GAAKrpD,IACzC+mD,GAAK/mD,EAAE,MAAQ,EACfspD,GAAKtpD,EAAE,GAAK2oD,GAASW,GAAKtpD,IAAInC,GAE/BmsD,GAASjG,GACT,IAAIP,EAAMoF,GAAWU,GAAKvF,IAAW,IACjC+F,EAAOZ,GAA2B,GAAhBnC,GAAKhD,IAAgBkF,GAAUzF,GAAK6F,GAAKtF,MAC/D,GAAI+F,GAAQC,GACX,OAAO,EAER,IAAS/pD,EAAEiqD,GAAQjqD,EAAE+jD,GAAS/jD,IAC7BugC,GAAGvgC,EAAE,GAAK2oD,GAASpoB,GAAGvgC,IAAIuY,GAAKvY,IAC/BwgC,GAAGxgC,EAAE,GAAK2oD,GAASnoB,GAAGxgC,IAAIuY,GAAKvY,IAEhCiqD,GAASlG,GACT,IAAIsG,EAAQtD,GAAKhD,IACbuG,EAAmD,KAA9CnC,KAAS5nB,GAAGwjB,IAAS,OAAOvjB,GAAGujB,IAAS,IAC7B,GAAdxjB,GAAGwjB,IAAgBvjB,GAAGujB,IAAW,EAAI,GAAO8E,GAAQwB,IAAQ,MAAY,EAANA,GAAU,EAnqCnF,SAAoBz2C,GAEnB,IADA,IAAIiE,EAAI,EACC7X,EAAE,EAAGA,GAAG,EAAGA,IACnB6X,GAAKjE,GAAO,EAAE5T,GACd4T,KAASA,GAAO,EAAE5T,IAGnB,OADK,EAAL6X,EA6pCuF0yC,CAAW/G,IAC9F5Z,EAAOse,EAASoC,GAChBE,EAAc,GAAP5gB,EAGX,GAFAA,KAAU,GACTkgB,EAAOxrD,KAAK4H,IAAIijD,GAAkB,GAAPvf,EAAYqf,GAAUzF,GAAKgH,IAAQV,KACnDC,GACX,OAAO,EAEP,IAAIK,EAAc,GAATrG,GAAa,GAAKF,EAA6B,KAAnBtrC,GAAKwrC,GAAQ,GAAG,GAAK,GAC3D,IAAS/jD,EAAE8pD,EAAM9pD,EAAE+pD,GAAY/pD,IAC9B,GAAIyqD,GAAO7gB,EAAM4gB,EAAMzD,GAAKhD,IAAUsF,GAAKtF,IAAUP,EAAKxjD,EAAG+jD,GAASqG,GAAK,CAC1ExmB,GAAMmgB,GAAU/jD,EAChB,IAAI0qD,EAAK,GACLC,EAAMvB,GAIV,IAFCuB,GAAOA,EAAM,GAAK,GAET,EAAG,CACZ,IAAK,IAAI5sD,EAAE,EAAGA,EAAEgmD,GAAShmD,IACxB2sD,GAAMxG,EAASC,EAAQwG,GAAKpyC,GAAKxa,KAAO,IAEzC,IAASA,EAAEgmD,GAAShmD,EAAE6lC,GAAK7lC,IAC1B2sD,GAAMxG,EAASC,EAAQwG,GAAKpyC,GAAKxa,KAAO,QAEnC,CACN,IAASA,EAAE6lC,GAAI,EAAG7lC,GAAGgmD,GAAShmD,IAC7B2sD,GAAMxG,EAASC,EAAQwG,GAAKpyC,GAAKxa,KAAO,IAEzC,IAASA,EAAEgmD,GAAQ,EAAGhmD,GAAG,EAAGA,IAC3B2sD,GAAMxG,EAASC,EAAQwG,GAAKpyC,GAAKxa,KAAO,IAK1C,OADAwlC,GAAWmnB,GACJ,EAGT,OAAO,EA5FcE,GAErB,IAAK,IAAI/sD,EAAE,EAAGA,EAAE,GAAIA,IACnB,GAAIumD,EAAKgG,GAAIvsD,GACZA,GAAG,MADJ,CAIA,IAAIgtD,EAASzC,EAAYjsC,GAAOte,GAC5BitD,EAASzC,EAAUpB,GAAOc,EAASwB,GAAM1rD,IACzCktD,EAAQjD,EAAkB,EAATgD,GAAYvB,GAEjC,KAAIf,EAA0B,KAD9BsC,KAAY,GACwBvC,EAAYsC,GAAQE,KAAWZ,GAAnE,CAGA,IAAIa,EAAQ1C,EAASnB,GAAMY,EAASyB,GAAM3rD,IACtCotD,EAAQnD,EAAiB,EAARkD,GAAWxB,GAEhC,KAAId,GAAuB,KAAToC,IADlBE,KAAW,IACiC,EAAIhD,EAAYiD,GAAOF,MAAYZ,GAC3E1B,EAAwB,IAARuC,EAAczC,EAAYsC,GAAQI,KAAWd,KAGjE5xC,GAAKwrC,GAAQoG,GAAQtsD,EACrBmsD,GAAS1rD,KAAK2H,IAAI+jD,GAAQjG,GAAQoG,GAC9BD,GAAOY,EAAQC,EAAOC,EAAOC,EAAOJ,EAAQV,EAAK,EAAGtsD,IACvD,OAAO,GAGT,OAAO,EAoER,SAAS4sD,GAAO7gB,EAAM4gB,EAAMzD,EAAMsC,EAAM7F,EAAK2G,EAAM7mB,EAAO8mB,GACzD,GAAU,GAANxgB,GAAiB,GAANmd,GAAgB,GAALvD,EACzB,OAAO,EAER,IAAK,IAAI3lD,EAAE,EAAGA,EAAE,GAAIA,IACnB,IAAIwmD,EAAM+F,GAAIvsD,GAAd,CAGA,IAAIqtD,EAAOlC,GAAUxF,GAAK3lD,GACtBstD,EAAQpC,GAAUnf,GAAMqe,EAAUuC,GAAM3sD,IACxCutD,EAAQxD,EAAgB,GAARuD,GAAYX,GAEhC,KAAIrB,GAAmB,IADvBgC,KAAW,GACiBlC,GAAUiC,GAAME,KAAWjB,GAAvD,CAGA,IAAIE,EAAQvB,GAAU/B,GAAMc,EAAQwB,GAAMzF,EAAO/lD,KAC7CwtD,EAAQzD,EAAgB,GAARyC,GAAYhB,GAEhC,KAAIH,GAAmB,IADvBmB,KAAW,GACiBpB,GAAUiC,GAAMG,KAAWlB,KAGvD5xC,GAAK+qB,GAASsgB,EAAO/lD,GACjB4sD,GAAOU,EAAOC,EAAOf,EAAOgB,EAAOH,EAAMf,EAAK,EAAG7mB,EAAM,EAAGzlC,IAC7D,OAAO,GAGT,OAAO,EAGR,IAAIqpC,IAAc,EAElB,SAASyb,KACJzb,MAlyBL,WACC,IAAIokB,EAAKrsD,MAAM,GACfqsD,EAAG,GAAK,IAAIz0C,EACZy0C,EAAG,GAAGrmB,KAAK,MAAO,EAAG,UAAW,GAChCqmB,EAAG,GAAK,IAAIz0C,EACZy0C,EAAG,GAAGrmB,KAAK,MAAO,KAAM,UAAW,GACnCqmB,EAAG,GAAK,IAAIz0C,EACZy0C,EAAG,GAAGrmB,KAAK,KAAM,KAAM,SAAU,KACjCqmB,EAAG,GAAK,IAAIz0C,EACZy0C,EAAG,GAAGrmB,KAAK,EAAG,EAAG,KAAM,GACvBqmB,EAAG,GAAK,IAAIz0C,EACZy0C,EAAG,GAAGrmB,KAAK,KAAM,IAAK,QAAS,GAC/BqmB,EAAG,GAAK,IAAIz0C,EACZy0C,EAAG,GAAGrmB,KAAK,IAAK,IAAK,OAAQ,MAC7B,IAAK,IAAIpnC,EAAE,EAAGA,EAAE,EAAGA,IAAK,CACvB8pD,EAAW,EAAF9pD,GAAOytD,EAAGztD,GACnB,IAAK,IAAIga,EAAE,EAAGA,EAAE,EAAGA,IAClB8vC,EAAW,EAAF9pD,EAAIga,EAAE,GAAK,IAAIhB,EACxBgwC,EAASc,EAAW,EAAF9pD,EAAIga,GAAIyzC,EAAGztD,GAAI8pD,EAAW,EAAF9pD,EAAIga,EAAE,IAChD6uC,EAASiB,EAAW,EAAF9pD,EAAIga,GAAIyzC,EAAGztD,GAAI8pD,EAAW,EAAF9pD,EAAIga,EAAE,IAGlD,IAEI0zC,EAFAvoC,EAAI,IAAInM,EACRlZ,EAAI,IAAIkZ,EAER20C,EAAK,IAAI30C,EACb20C,EAAGvmB,KAAK,MAAO,EAAG,UAAW,GAC7B,IAAIwmB,EAAK,IAAI50C,EACb40C,EAAGxmB,KAAK,MAAO,EAAG,UAAW,MAC7B,IAAIymB,EAAM,IAAI70C,EACd60C,EAAIzmB,KAAK,KAAM,EAAG,SAAU,GAC5BymB,EAAIt0C,GAAK,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAChC,IAAK,IAAIpX,EAAE,EAAGA,EAAE,GAAIA,IACnB4nD,EAAQ5nD,GAAKf,MAAM,IACnB4oD,EAAQ7nD,GAAKf,MAAM,IACnBgpD,EAAUjoD,GAAKf,MAAM,IACrByoD,EAAQ1nD,GAAK,IAAI6W,EACjB6wC,EAAQ1nD,GAAGyE,KAAKue,GAChB0jC,EAAS1jC,EAAGyoC,EAAI9tD,GAChBkpD,EAAS7jC,EAAGyoC,EAAI9tD,GAChB4tD,EAAO5tD,EAAGA,EAAIqlB,EAAGA,EAAIuoC,EACjBvrD,EAAI,GAAK,IACZ0mD,EAAS1jC,EAAG0oC,EAAK/tD,GACjBkpD,EAAS7jC,EAAG0oC,EAAK/tD,GACjB4tD,EAAO5tD,EAAGA,EAAIqlB,EAAGA,EAAIuoC,GAElBvrD,EAAI,GAAK,IACZ0mD,EAAS1jC,EAAGwoC,EAAI7tD,GAChBkpD,EAAS7jC,EAAGwoC,EAAI7tD,GAChB4tD,EAAO5tD,EAAGA,EAAIqlB,EAAGA,EAAIuoC,GAIvB,IAAK,IAAI9xC,EAAE,EAAGA,EAAE,GAAIA,IACnB,IAAK,IAAIgE,EAAE,EAAGA,EAAE,GAAIA,IAEnB,GADAipC,EAASgB,EAAQjuC,GAAIiuC,EAAQjqC,GAAIuF,GAClB,GAAXA,EAAE7L,GAAG,IAAsB,GAAX6L,EAAE7L,GAAG,IAAsB,GAAX6L,EAAE7L,GAAG,GAAS,CACjDutC,EAAOjrC,GAAKgE,EACZ,MAIH,IAASzd,EAAE,EAAGA,EAAE,GAAIA,IACnB,IAASyZ,EAAE,EAAGA,EAAE,GAAIA,IAEnB,IADAitC,EAASgB,EAAQ1nD,GAAI0nD,EAAQjuC,GAAIuJ,GACxBvF,EAAE,EAAGA,EAAE,GAAIA,IACnB,GAAIiqC,EAAQjqC,GAAGtG,GAAG,IAAM6L,EAAE7L,GAAG,IAAMuwC,EAAQjqC,GAAGtG,GAAG,IAAM6L,EAAE7L,GAAG,IAAMuwC,EAAQjqC,GAAGtG,GAAG,IAAM6L,EAAE7L,GAAG,GAAI,CAC9FywC,EAAQ5nD,GAAGyZ,GAAKgE,EAChB,MAKJ,IAAShE,EAAE,EAAGA,EAAE,GAAIA,IACnB,IAAK,IAAI1b,EAAE,EAAGA,EAAE,GAAIA,IAEnB,IADAmnD,EAAcyC,EAASluC,GAAIirC,EAAO3mD,GAAIilB,GAC7BnlB,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxB,IAAI4kB,EAAQ,EACZ,IAASziB,EAAE,EAAGA,EAAE,EAAGA,IAClB,GAAIgjB,EAAE7L,GAAGnX,IAAM2nD,EAAS9pD,GAAGsZ,GAAGnX,IAAMgjB,EAAE5L,GAAGpX,IAAM2nD,EAAS9pD,GAAGuZ,GAAGpX,GAAI,CACjEyiB,EAAQ,EACR,MAGEA,IACHolC,EAAQ9pD,GAAG0b,GAAK5b,GAKpB,IAAS4b,EAAE,EAAGA,EAAE,GAAIA,IACnB,IAAS1b,EAAE,EAAGA,EAAE,GAAIA,IACnBkqD,EAAUlqD,GAAG0b,GAAKoqC,EAAOgE,EAAQ9pD,GAAG6lD,EAAOnqC,KAG7C,IAASA,EAAE,EAAGA,EAAE,EAAGA,IAIlB,IAHAquC,EAASruC,GAAKxa,MAAM,GACpB8oD,EAAStuC,GAAKxa,MAAM,IACpB+oD,EAAYvuC,GAAKxa,MAAM,GACdlB,EAAE,EAAGA,EAAE,EAAGA,IAClB+pD,EAASruC,GAAG1b,GAAM6pD,EAAQnuC,GAAG,GAAG1b,GAAG,KAAK,EAG1C,IAAS0b,EAAE,EAAGA,EAAE,GAAIA,IACnB,IAAS1b,EAAE,EAAGA,EAAE,EAAGA,IAClBgqD,EAAShqD,GAAG0b,GAAKouC,EAAQ9pD,GAAG,GAAG0b,GAGjC,IAASA,EAAE,EAAGA,EAAE,EAAGA,IAClB,IAAS1b,EAAE,EAAGA,EAAE,EAAGA,IAClBiqD,EAAYvuC,GAAG1b,GAAK+pD,EAASruC,GAAGirC,EAAO3mD,GAAG,IAAI,GAIhD,MAAM4tD,EAAM,IAAI1sD,MAAM,MAEtB,IAAI4iB,EAAQ,EACZ,IAAS7hB,EAAE,EAAGA,EAAE,GAAI2rD,EAAI3rD,KAAO,GAE/B,IAASA,EAAE,EAAGA,EAAE,KAAMA,IACrB,GAAkC,IAA7B2rD,EAAI3rD,IAAI,GAAI,IAAM,GAAFA,IAAgB,CAEpC,IADAgjB,EAAE6hC,QAAQ7kD,GACDjC,EAAE,EAAGA,EAAE,GAAIA,GAAG,EACtB0mD,EAAczhC,EAAGjlB,EAAGJ,GAEpBguD,GADI/3C,EAAMjW,EAAE2mD,aACF,IAAM,IAAQ,GAAJ1wC,GACpB4wC,EAAQ5wC,GAASiO,GAAS,EAAM9jB,IAAM,EAEvC6mD,EAAQ/iC,KAAW7hB,EAKrB,IADA6hB,EAAQ,EACC7hB,EAAE,EAAGA,EAAE,GAAI2rD,EAAI3rD,KAAO,GAC/B,IAASA,EAAE,EAAGA,EAAE,KAAMA,IACrB,GAAkC,IAA7B2rD,EAAI3rD,IAAI,GAAI,IAAM,GAAFA,IAAgB,CAEpC,IADAgjB,EAAEoiC,SAASplD,GACFjC,EAAE,EAAGA,EAAE,GAAIA,GAAG,EACtBmnD,EAAcliC,EAAGjlB,EAAGJ,GAEpBguD,GADI/3C,EAAMjW,EAAEonD,cACF,IAAM,IAAQ,GAAJnxC,GACpBqxC,EAASrxC,GAAUiO,GAAS,EAAM9jB,IAAM,EAEzConD,EAAStjC,KAAW7hB,EAKtB,IAAIghB,EAAO/hB,MAAM,IACjB,IAASe,EAAE,EAAGA,EAAE,GAAIA,IACnBghB,EAAKhhB,GAAKf,MAAM,GAChBkpD,EAAMnoD,GAAKf,MAAM,IAElB,IAASe,EAAE,EAAGA,EAAE,MAAOA,IAAK,CAC3BonD,EAASpkC,EAAE3L,GAAIrX,GACf,IAAI+iB,KAAOC,EAAE8iC,YAAc,GACvBloD,KAAOolB,EAAE+iC,YAAc,GAC3B/kC,EAAK+B,GAAGnlB,IAAI,IAAM,IAAQ,GAAFA,GAGzB,IAASoC,EAAE,EAAGA,EAAE,GAAIA,IAEnB,IADA6hB,EAAQ,EACCpI,EAAE,EAAGA,EAAE,GAAIA,IACmB,IAAjCuH,EAAKhhB,GAAGyZ,IAAI,GAAI,IAAM,GAAFA,MACxB0uC,EAAMnoD,GAAGyZ,GAAKoI,KAKjB,IADAA,EAAQ,EACC7hB,EAAE,EAAGA,EAAE,KAAM2rD,EAAI3rD,KAAO,GACjC,IAASA,EAAE,EAAGA,EAAE,MAAOA,IACtB,GAAkC,IAA7B2rD,EAAI3rD,IAAI,GAAI,IAAM,GAAFA,IAAgB,CAEpC,IADAonD,EAASpkC,EAAE3L,GAAIrX,GACNjC,EAAE,EAAGA,EAAE,GAAIA,IAAK,CAExB,IAAI6V,EADJ6wC,EAAczhC,EAAGjlB,EAAGJ,GAEpBguD,GADI/3C,EAAMwyC,EAASzoD,EAAE0Z,OACX,IAAM,IAAQ,GAAJzD,GAChBmP,EAAIplB,EAAEmoD,YACNloD,EAAID,EAAEooD,YACNloD,EAA+B,KAA1BsqD,KAASplC,EAAE,OAAOnlB,EAAE,IAAiB,GAAJmlB,EAASnlB,EAAI,EAAI,EAAIylD,EAAWzvC,GAC1Es0C,EAASrqD,GAAMgkB,GAAS,EAAI9jB,EAC5BooD,EAASvyC,GAAQiO,GAAS,EAAI9jB,EAE/ByoD,EAAS3kC,KAAW7hB,GA8mBtB4rD,GAllBD,WACC,IAEI5rD,EAFAgjB,EAAI,IAAInM,EACRlZ,EAAI,IAAIkZ,EAEZ,IAAK7W,EAAE,EAAGA,EAAE,KAAMA,IAGjB,IAFA8oD,GAAU9oD,GAAKf,MAAM,IACrBmoD,EAASpkC,EAAE7L,GAAImvC,EAAStmD,IACnByZ,EAAE,EAAGA,EAAE,GAAIA,IACfitC,EAAS1jC,EAAG2kC,EAASluC,GAAI9b,GACzBmrD,GAAU9oD,GAAGyZ,GAAK9b,EAAEuoD,cAGtB,IAAKlmD,EAAE,EAAGA,EAAE,KAAMA,IAGjB,IAFA+oD,GAAU/oD,GAAKf,MAAM,IACrBmoD,EAASpkC,EAAE3L,GAAImvC,EAASxmD,IACnByZ,EAAE,EAAGA,EAAE,GAAIA,IACfotC,EAAS7jC,EAAG2kC,EAAS/D,EAAOnqC,IAAK9b,GACjCorD,GAAU/oD,GAAGyZ,GAAK9b,EAAE4oD,cAGtB,IAAKvmD,EAAE,EAAGA,EAAE,IAAKA,IAGhB,IAFAsoD,EAAStoD,GAAKf,MAAM,IACpB+jB,EAAE6hC,QAAQD,EAAQ5kD,IACbyZ,EAAE,EAAGA,EAAE,GAAIA,IACfotC,EAAS7jC,EAAG2kC,EAASluC,GAAI9b,GACzB2qD,EAAStoD,GAAGyZ,GAAK9b,EAAE4mD,aAGrB,IAAKvkD,EAAE,EAAGA,EAAE,IAAKA,IAGhB,IAFAqoD,EAAUroD,GAAKf,MAAM,IACrB+jB,EAAEoiC,SAASD,EAASnlD,IACfyZ,EAAE,EAAGA,EAAE,GAAIA,IACfitC,EAAS1jC,EAAG2kC,EAASluC,GAAI9b,GACzB0qD,EAAUroD,GAAGyZ,GAAK9b,EAAEqnD,cAGtB,IAAKhlD,EAAE,EAAGA,EAAE,IAAKA,IAGhB,IAFAooD,EAAYpoD,GAAKf,MAAM,IACvB+jB,EAAEuiC,WAAWvlD,GACRyZ,EAAE,EAAGA,EAAE,GAAIA,IACfotC,EAAS7jC,EAAG2kC,EAASluC,GAAI9b,GACzByqD,EAAYpoD,GAAGyZ,GAAK9b,EAAE2nD,aAGxB,IAAKtlD,EAAE,EAAGA,EAAE,IAAKA,IAGhB,IAFAuoD,EAAYvoD,GAAKf,MAAM,GACvB+jB,EAAEuiC,WAAWvlD,GACRyZ,EAAE,EAAGA,EAAE,GAAIA,GAAG,EAClBgrC,EAAczhC,EAAG0hC,EAAOjrC,GAAI9b,GAC5B4qD,EAAYvoD,GAAGyZ,IAAI,GAAK9b,EAAE2nD,aAG5B,IAAKtlD,EAAE,EAAGA,EAAE,KAAMA,IAGjB,IAFA2oD,GAAS3oD,GAAKf,MAAM,IACpB+jB,EAAE6iC,QAAQ7lD,GACLyZ,EAAE,EAAGA,EAAE,GAAIA,IACfotC,EAAS7jC,EAAG2kC,EAASluC,GAAI9b,GACzBgrD,GAAS3oD,GAAGyZ,GAAK9b,EAAE+nD,UAGrB,IAAK1lD,EAAE,EAAGA,EAAE,GAAIA,IACfgjB,EAAEyiC,SAASzlD,GACX4oD,GAAW5lC,EAAE0iC,UAAY,IAAM1lD,EAEhC,IAAKA,EAAE,EAAGA,EAAE,KAAMA,IACjB6oD,GAAQ7oD,IAAI,IAAOqjD,EAAWiD,EAAStmD,MAAa,EAAJA,GAEjD,IAAKA,EAAE,EAAGA,EAAE,GAAIA,IAGf,IAFAgpD,GAAUhpD,GAAKf,MAAM,IACrB+jB,EAAEyiC,SAASzlD,GACNyZ,EAAE,EAAGA,EAAE,GAAIA,IACfotC,EAAS7jC,EAAG2kC,EAAS/D,EAAOnqC,IAAK9b,GACjCqrD,GAAUhpD,GAAGyZ,GAAK9b,EAAE6nD,WAGtB,IAAKxlD,EAAE,EAAGA,EAAE,GAAIA,IAGf,IAFAipD,GAAUjpD,GAAKf,MAAM,IACrB+jB,EAAEyiC,SAASzlD,GACNyZ,EAAE,EAAGA,EAAE,GAAIA,IACfgrC,EAAczhC,EAAG0hC,EAAOjrC,GAAI9b,GAC5BsrD,GAAUjpD,GAAGyZ,GAAK9b,EAAE6nD,WAItB,IAAIqG,EAAW5sD,MAAM,KACrB,IAAKe,EAAE,EAAGA,EAAE,IAAKA,IAAK,CACrBgjB,EAAEoiC,SAASD,EAASnlD,IACpB,IAAK,IAAIyZ,EAAE,EAAGA,EAAE,EAAGA,IAClByrC,EAAcliC,EAAGvJ,GAAG,EAAG9b,GACqB,OAAxC4lD,EAAa4B,EAAUxnD,EAAEonD,cAC5B8G,EAAS7rD,IAAO,GAAKyZ,GAIxB,IAAIqyC,EAAY7sD,MAAM,KACtB,IAAKe,EAAE,EAAGA,EAAE,IAAKA,IAEhB,IADAgjB,EAAE6hC,QAAQD,EAAQ5kD,IACTyZ,EAAE,EAAGA,EAAE,EAAGA,IAClBgrC,EAAczhC,EAAGvJ,GAAG,EAAG9b,GACmB,OAAtC4lD,EAAaqB,EAASjnD,EAAE2mD,aAC3BwH,EAAU9rD,IAAO,GAAKyZ,GAIzB,IAAKzZ,EAAE,EAAGA,EAAE,OAAWA,IACtB0oD,GAAc1oD,IAAM,EAErB,IAAKA,EAAE,EAAGA,EAAE,EAAGA,IACd0oD,GAAc1oD,GAAK,EAQpB,IANA,IAEIkc,EACAwN,EACAqiC,EAJAzoB,EAAQ,EACR0oB,EAAO,EAKJA,EAAO,QAKb,IAHAtiC,GADAxN,EAAMonB,EAAQ,IACE,EAAIA,EACpByoB,EAAQ7vC,EAAMonB,GAAS,EACvBA,IACKtjC,EAAE,EAAGA,EAAE,OAAWA,IACtB,GAAI0oD,GAAc1oD,IAAM0pB,EAAxB,CAEA,IAAIu9B,KAAWjnD,EAAI,MACfmnD,EAAOnnD,EAAI,KACXwpD,EAAW,EAAJxpD,EACXmnD,KAAU,EACV,IAAK,IAAItpD,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxB,IACIktD,EAAiB,GADjBD,EAASzC,EAAUpB,GAAOppD,IAE9BitD,KAAY,EACZ,IAAIE,EAAQ1C,EAASnB,GAAMY,EAASyB,GAAM3rD,IACtCotD,EAAQjD,EAAYF,EAAiB,EAARkD,GAAWxB,IAAOuB,GAGnD,GAAIrC,GADA90C,GAAe,KAATk3C,IADVE,KAAW,IACyB,EAAIC,KACdc,EAAO,CAEhC,GADAC,IACI9vC,EAAK,CACRwsC,GAAc1oD,GAAKsjC,EACnB,MAEAolB,GAAc90C,IAAO0vB,EACrB,IAAI2oB,EAAMJ,EAASf,GACfoB,EAAOJ,EAAUd,GACrB,GAAW,GAAPiB,GAAoB,GAARC,EACf,IAASzyC,EAAE,EAAGA,EAAE,EAAGA,IAAKyyC,IAAS,EAChC,GAAkB,IAAN,EAAPA,GAEJ,IADA,IAAIC,EAASnE,EAAYiD,GAAOxxC,GACvBgE,EAAE,EAAGA,EAAE,EAAGA,IAClB,GAAwB,IAAnBwuC,EAAO,GAAKxuC,GAAU,CAC1B,IAAI2uC,EAAgB,KAATtB,GAAiBE,GAAS,EAAIhD,EAAYmE,GAAQ1uC,KACjC,GAAxBirC,GAAc0D,KACjB1D,GAAc0D,GAAQ9oB,EACtB0oB,QAaX,IAAKhsD,EAAE,EAAGA,EAAE,OAASA,IACpBwoD,EAAiBxoD,IAAM,EAKxB,IAHAwoD,EAAiB,GAAK,EACtBllB,EAAQ,EACR0oB,EAAO,EACAA,EAAO,QAKb,IAHAtiC,GADAxN,EAAMonB,EAAQ,IACE,EAAIA,EACpByoB,EAAQ7vC,EAAMonB,GAAS,EACvBA,IACKtjC,EAAE,EAAGA,EAAE,OAASA,IACpB,GAAIwoD,EAAiBxoD,IAAM0pB,EAC1B,KAAIvN,EAAQnc,EAAI,IAEhB,IADIinD,KAAWjnD,EAAI,KACVnC,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxB,IAAIitD,EACAuB,EAAgB,GADhBvB,EAASzC,EAAUpB,GAAOppD,IAE1BgtD,EAAStC,EAAYH,EAAYjsC,GAAOte,IAAIwuD,GAGhD,GAAI7D,EADA50C,GAAe,KADnBk3C,KAAY,GACaD,IACIkB,EAAO,CAEnC,GADAC,IACI9vC,EAAK,CACRssC,EAAiBxoD,GAAKsjC,EACtB,MAIA,GAFAklB,EAAiB50C,IAAO0vB,EAEb,IADP2oB,EAAMJ,EAASf,IAElB,IAASrxC,EAAE,EAAGA,EAAE,EAAGA,IAED,IAAN,GADXwyC,IAAQ,MAEHG,EAAgB,IAATtB,EAAevC,EAAYsC,GAAQpxC,IACf,GAA3B+uC,EAAiB4D,KACpB5D,EAAiB4D,GAAQ9oB,EACzB0oB,QAaV,IAAKhsD,EAAE,EAAGA,EAAE,OAASA,IACpByoD,EAAgBzoD,IAAM,EAKvB,IAHAyoD,EAAgB,GAAK,EACrBnlB,EAAQ,EACR0oB,EAAO,EACAA,EAAO,QAKb,IAHAtiC,GADAxN,EAAMonB,EAAQ,IACE,EAAIA,EACpByoB,EAAQ7vC,EAAMonB,GAAS,EACvBA,IACKtjC,EAAE,EAAGA,EAAE,OAASA,IACpB,GAAIyoD,EAAgBzoD,IAAM0pB,EAGzB,IAFIvN,EAAQnc,EAAI,IACZmnD,KAAUnnD,EAAI,KACTnC,EAAE,EAAGA,EAAE,GAAIA,IAMnB,GAJIwuD,EAAe,GADfrB,EAAQ1C,EAASnB,GAAMtpD,IAEvBgtD,EAAStC,EAAYH,EAAYjsC,GAAOte,IAAIwuD,GAG5C5D,EADA70C,GAAc,KADlBo3C,KAAW,GACaH,IACIkB,EAAO,CAElC,GADAC,IACI9vC,EAAK,CACRusC,EAAgBzoD,GAAKsjC,EACrB,MAIA,GAFAmlB,EAAgB70C,IAAO0vB,EAEZ,IADP2oB,EAAMH,EAAUd,IAEnB,IAASvxC,EAAE,EAAGA,EAAE,EAAGA,IAED,IAAN,GADXwyC,IAAQ,MAEHG,EAAe,IAARpB,EAAczC,EAAYsC,GAAQpxC,IACf,GAA1BgvC,EAAgB2D,KACnB3D,EAAgB2D,GAAQ9oB,EACxB0oB,MAeV,IADAH,EAAW5sD,MAAM,MACZe,EAAE,EAAGA,EAAE,KAAMA,IAEjB,IADAonD,EAASpkC,EAAE3L,GAAImvC,EAASxmD,IACnByZ,EAAE,EAAGA,EAAE,GAAIA,IACfgrC,EAAczhC,EAAGvJ,EAAG9b,GAC0B,OAA1C4lD,EAAaiD,EAAUJ,EAASzoD,EAAE0Z,OACrCw0C,EAAS7rD,IAAO,GAAKyZ,GAIxB,IAAKzZ,EAAE,EAAGA,EAAE,MAASA,IACpBmpD,GAAWnpD,IAAM,EAGlB,IADAmpD,GAAW,GAAK,EACT6C,EAAO,OAKb,IAHAtiC,GADAxN,EAAMonB,EAAQ,IACE,EAAIA,EACpByoB,EAAQ7vC,EAAMonB,GAAS,EACvBA,IACKtjC,EAAE,EAAGA,EAAE,MAASA,IACpB,GAAImpD,GAAWnpD,IAAM0pB,EACpB,KAAI85B,EAAMxjD,EAAI,GACV4pC,MAAU5pC,EAAI,IAClB,IAASnC,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxB,IAAIstD,GAAQpC,GAAUnf,IAAM/rC,GAExBqtD,IADAmB,EAAe,GAARlB,GACAlC,GAAUD,GAAUxF,GAAK3lD,IAAIwuD,IAGxC,GAAIlD,GADAv1C,GAAc,IADlBu3C,MAAW,GACYD,KACAa,EAAO,CAE7B,GADAC,IACI9vC,EAAK,CACRitC,GAAWnpD,GAAKsjC,EAChB,MAIA,GAFA6lB,GAAWv1C,IAAO0vB,EAEP,IADP2oB,EAAMJ,EAASV,KAElB,IAAK1xC,EAAE,EAAGA,EAAE,GAAIA,IAEE,IAAN,GADXwyC,IAAQ,MAEHG,EAAe,GAARjB,GAAalC,GAAUiC,IAAMzxC,IACf,GAArB0vC,GAAWiD,KACdjD,GAAWiD,GAAQ9oB,EACnB0oB,QAaV,IAAKhsD,EAAE,EAAGA,EAAE,MAASA,IACpBkpD,GAAWlpD,IAAM,EAKlB,IAHAkpD,GAAW,GAAK,EAChB5lB,EAAQ,EACR0oB,EAAO,EACAA,EAAO,OAKb,IAHAtiC,GADAxN,EAAMonB,EAAQ,IACE,EAAIA,EACpByoB,EAAQ7vC,EAAMonB,GAAS,EACvBA,IACKtjC,EAAE,EAAGA,EAAE,MAASA,IACpB,GAAIkpD,GAAWlpD,IAAM0pB,EACpB,CAAI85B,EAAMxjD,EAAI,GAAd,IACI+mD,MAAU/mD,EAAI,IAClB,IAASnC,EAAE,EAAGA,EAAE,GAAIA,IAAK,CACxB,IAII+V,GAJAy2C,GAAQvB,GAAU/B,IAAMnD,EAAO/lD,IAKnC,GAJIwuD,EAAgB,GAARhC,GACRa,GAAOjC,GAAUD,GAAUxF,GAAK3lD,IAAIwuD,GAGpCnD,GADAt1C,GAAc,IADlBy2C,MAAW,GACYa,KACAa,EAAO,CAE7B,GADAC,IACI9vC,EAAK,CACRgtC,GAAWlpD,GAAKsjC,EAChB,MAIA,GAFA4lB,GAAWt1C,IAAO0vB,EAEP,IADP2oB,EAAMJ,EAASxB,KAElB,IAAK5wC,EAAE,EAAGA,EAAE,GAAIA,IAEE,IAAN,GADXwyC,IAAQ,MAEHG,EAAe,GAAR/B,GAAapB,GAAUiC,IAAMzxC,EAAI4sC,EAAI5sC,KACvB,GAArByvC,GAAWkD,KACdlD,GAAWkD,GAAQ9oB,EACnB0oB,SA4OVM,GACAplB,IAAc,GAaflrC,EAAOC,QAAQ0mD,WAAaA,GAC5B3mD,EAAOC,QAAQqmC,MAXf,SAAetf,GACd2/B,KACA,MAAM4J,EAAK,IAAI11C,EAKf,OAJA01C,EAAGp1C,GAAK6L,EAAE7L,GACVo1C,EAAGn1C,GAAK4L,EAAE5L,GACVm1C,EAAGl1C,GAAK2L,EAAE3L,GACVk1C,EAAGj1C,GAAK0L,EAAE1L,GA/LX,SAAe0L,GACdA,EAAE2hC,MAAQ,IAAI9tC,EACd,IAAK,IAAI7W,EAAE,EAAGA,EAAE,EAAGA,IAClBinD,GAAMjnD,GAAKgjB,EAAEgiC,cACbuE,GAAKvpD,GAAgB,EAAXinD,GAAMjnD,GAChBinD,GAAMjnD,MAAQ,EACdmnD,GAAKnnD,GAAKgjB,EAAEuhC,aACZiF,GAAKxpD,GAAe,EAAVmnD,GAAKnnD,GACfmnD,GAAKnnD,MAAQ,EACbmc,GAAMnc,GAAKgjB,EAAEsiC,aACbmE,GAAMzpD,GAAKgjB,EAAEkjC,cACbwD,GAAM1pD,GAAgB,GAAXypD,GAAMzpD,GACjBypD,GAAMzpD,MAAQ,EACd2pD,GAAM3pD,GAAKgjB,EAAE0iC,UACbkE,GAAI5pD,GAAKgjB,EAAE8iC,YACX+D,GAAI7pD,GAAKgjB,EAAE+iC,YACX+D,GAAK9pD,GAAK1B,KAAK4H,IAAI5H,KAAK4H,IAAIsiD,EAA4B,IAAXvB,GAAMjnD,GAAWuoD,EAAYpsC,GAAMnc,IAAIupD,GAAKvpD,KACrFyoD,EAA0B,IAAVtB,GAAKnnD,GAAWuoD,EAAYpsC,GAAMnc,IAAIwpD,GAAKxpD,MAC3D0oD,GAAyB,KAAXzB,GAAMjnD,IAAamnD,GAAKnnD,IAAM,EAAIgoD,EAAYwB,GAAKxpD,IAAIupD,GAAKvpD,OAC9EgjB,EAAEyjC,eACK,GAAHzmD,GACHgjB,EAAE8jC,eAKJ,IAFAvjB,GAAW,KACXK,GAAM,GACDmgB,GAAQ,EAAGA,GAAQngB,GAAKmgB,KAE5B,IADAgG,GAAazrD,KAAK2H,IAAI29B,GAAI,EAAE,EAAGA,GAAImgB,IAC9BqF,GAAO,EAAGA,GAAO,EAAGA,KAMxB,GALArC,GAAK,GAAK0C,GAAML,IAChBC,GAAK,GAAKK,GAAMN,IAChBE,GAAK,GAAKK,GAAMP,IAChB7oB,GAAG,GAAKqpB,GAAIR,IACZ5oB,GAAG,GAAKqpB,GAAIT,IACPU,GAAKV,KAAWrF,IAChBmG,GAAOjD,GAAMmC,IAASG,GAAKH,IAASjC,GAAKiC,IAASI,GAAKJ,IACvDjtC,GAAMitC,IAASrF,GAAS,IAC5B,OAAgB,MAAZxgB,GACI,UAEAA,GAKX,MAAO,UAmJAipB,CAAMD,IAKdvwD,EAAOC,QAAQwwD,WA9Of,WACC,IAAIvF,EACAF,EACJ,GACCE,KAA2B,UAAhB5oD,KAAKE,UAChBwoD,KAA2B,MAAhB1oD,KAAKE,gBACsC,IAA5C6kD,EAAW2D,GAAS1D,EAAY4D,KAC3C,IAAIlkC,EAAI,IAAInM,EAEZ,OADAmM,EAAEiiB,KAAK+hB,KAA0B,KAAhB1oD,KAAKE,UAAkB0oD,KAA0B,KAAhB5oD,KAAKE,WAChDwkB,K","file":"static/js/main.28a44d17.chunk.js","sourcesContent":["import { wrap, releaseProxy } from \"comlink\";\nimport { useEffect, useState, useMemo } from \"react\";\nimport { AnalyzerState, SolutionDesc } from \"./Analyzer\";\n\nexport function useAnalyzer(analyzerState: AnalyzerState) {\n    const [data, setData] = useState({\n        isRunning: false,\n        solutions: undefined as SolutionDesc[] | undefined\n    })\n    const { workerApi } = useWorker()\n\n    useEffect(() => {\n        setData({ isRunning: true, solutions: undefined})\n        if (analyzerState.scramble !== \"\") {\n            workerApi.analyze(analyzerState).then(solutions => setData({ isRunning: false, solutions})); \n        }\n    }, [workerApi, setData, analyzerState])\n\n    return data\n}\n\n// write a wrapper so that cleanup is taken care of for us\nfunction useWorker() {\n    // memoise a worker so it can be reused; create one worker up front\n    // and then reuse it subsequently; no creating new workers each time\n    const workerApiAndCleanup = useMemo(() => makeWorkerApiAndCleanup(), []);\n  \n    useEffect(() => {\n      const { cleanup } = workerApiAndCleanup;\n  \n      // cleanup our worker when we're done with it\n      return () => {\n        cleanup();\n      };\n    }, [workerApiAndCleanup]);\n  \n    return workerApiAndCleanup;\n}\n\nfunction makeWorkerApiAndCleanup() {\n    // Here we create our worker and wrap it with comlink so we can interact with it\n    const worker = new Worker(\"../worker/index\", {\n      name: \"analyzer-worker\",\n      type: \"module\"\n    });\n    const workerApi = wrap<import(\"../worker/index\").AnalyzerWorker>(worker);\n  \n    // A cleanup function that releases the comlink proxy and terminates the worker\n    const cleanup = () => {\n      workerApi[releaseProxy]();\n      worker.terminate();\n    };\n  \n    const workerApiAndCleanup = { workerApi, cleanup };\n  \n    return workerApiAndCleanup;\n}\n","module.exports = __webpack_public_path__ + \"static/js/analyzer-worker.ca439f15.chunk.worker.js\"","export enum Face {\n    U = 0, D, F, B, L, R, X\n}\n\nconst U = Face.U;\nconst D = Face.D;\nconst F = Face.F;\nconst B = Face.B;\nconst L = Face.L;\nconst R = Face.R;\nexport {U, D, F, B, L, R};\n\nexport enum Typ {\n    C = 0, E, T\n}\nconst C = Typ.C;\nconst E = Typ.E;\nconst T = Typ.T;\nexport {C, E, T}\n\nexport type CubieT = {\n    co: Array<number>,\n    cp: Array<number>,\n    eo: Array<number>,\n    ep: Array<number>,\n    tp: Array<number>\n}\n\nexport type FaceletCube = Array<string>\n\nexport type CornerCoord = [Face, Face, Face]\nlet corners_coord : Array<CornerCoord> = [\n    [U,F,L], [U,L,B], [U,B,R], [U,R,F],\n    [D,L,F], [D,B,L], [D,R,B], [D,F,R]\n]\n\nexport type EdgeCoord = [Face, Face]\nlet edges_coord : Array<EdgeCoord> = [\n    [U,F], [U,L], [U,B], [U,R],\n    [D,F], [D,L], [D,B], [D,R],\n    [F,L], [B,L], [B,R], [F,R],\n]\nexport type CenterCoord = [Face]\nlet centers_coord : Array<CenterCoord> = [\n    [U], [D], [F], [B], [L], [R]\n]\n\nlet cstimer_corners_coord : Array<CornerCoord> = [\n    [U,R,F],[U,F,L], [U,L,B], [U,B,R],\n    [D,F,R],[D,L,F], [D,B,L], [D,R,B]\n]\n\nlet cstimer_edges_coord : Array<EdgeCoord> = [\n    [U, R], [U,F], [U,L], [U,B],\n    [D, R], [D,F], [D,L], [D,B],\n    [F, R], [F,L], [B,L], [B,R]\n]\n\nexport {corners_coord, edges_coord, centers_coord, cstimer_corners_coord, cstimer_edges_coord }\n\nexport type FaceletMapping = [Face[], Face[]][]\n\nexport type PermChg = [number, number]\nexport type OriChg = number\n\nexport type MoveT = {\n    cpc: Array<PermChg>,\n    coc: Array<OriChg>,\n    epc: Array<PermChg>,\n    eoc: Array<OriChg>,\n    tpc: Array<PermChg>,\n    name: string\n}\n\nlet u : MoveT = {\n    cpc: [[0, 1], [1, 2], [2, 3], [3, 0]],\n    coc: [0, 0, 0, 0],\n    epc: [[0, 1], [1, 2], [2, 3], [3, 0]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"U\"\n}\n\nlet f : MoveT = {\n    cpc: [[0, 3], [3, 7], [7, 4], [4, 0]],\n    coc: [1, 2, 1, 2],\n    epc: [[0, 11], [11, 4], [4, 8], [8, 0]],\n    eoc: [1, 1, 1, 1],\n    tpc: [],\n    name: \"F\",\n}\n\nlet r : MoveT = {\n    cpc: [[3, 2], [2, 6], [6, 7], [7, 3]],\n    coc: [1, 2, 1, 2],\n    epc: [[3, 10], [10, 7], [7, 11], [11, 3]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"R\",\n}\n\nlet l : MoveT = {\n    cpc: [[0, 4], [4, 5], [5, 1], [1, 0]],\n    coc: [2, 1, 2, 1],\n    epc: [[1, 8], [8, 5], [5, 9], [9, 1]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"L\",\n}\n\nlet d : MoveT = {\n    cpc: [[4, 7], [7, 6], [6, 5], [5, 4]],\n    coc: [0, 0, 0, 0],\n    epc: [[4, 7], [7, 6], [6, 5], [5, 4]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"D\",\n}\n\nlet b : MoveT = {\n    cpc: [[1, 5], [5, 6], [6, 2], [2, 1]],\n    coc: [2, 1, 2, 1],\n    epc: [[2, 9], [9, 6], [6, 10], [10, 2]],\n    eoc: [1, 1, 1, 1],\n    tpc: [],\n    name: \"B\",\n}\n\nlet m : MoveT = {\n    cpc: [],\n    coc: [],\n    epc: [[0, 4], [4, 6], [6, 2], [2, 0]],\n    eoc: [1, 1, 1, 1],\n    tpc: [[0, 2], [2, 1], [1, 3], [3, 0]],\n    name: \"M\",\n}\n\nlet e : MoveT = {\n    cpc: [],\n    coc: [],\n    epc: [[8, 9], [9, 10], [10, 11], [11, 8]],\n    eoc: [1, 1, 1, 1],\n    tpc: [[2, 4], [4, 3], [3, 5], [5, 2]],\n    name: \"E\",\n}\n\nlet s : MoveT = {\n    cpc: [],\n    coc: [],\n    epc: [[1, 3], [3, 7], [7, 5], [5, 1]],\n    eoc: [1, 1, 1, 1],\n    tpc: [[0, 5], [5, 1], [1, 4], [4, 0] ],\n    name: \"S\",\n}\n\nexport {u, d, f, b, l, r, m, e, s}\n\nexport type StickerT = [number, number, Typ]\nexport type StickerExtT = [number, number, Typ, Face]\nexport type FaceletT = Array<StickerT>\n\nlet u_face : FaceletT = [\n    [1, 0, C], [2, 0, E], [2, 0, C],\n    [1, 0, E], [0, 0, T], [3, 0, E],\n    [0, 0, C], [0, 0, E], [3, 0, C]\n  ]\n\nlet f_face : FaceletT = [\n    [0, 1, C], [0, 1, E], [3, 2, C],\n    [8, 0, E], [2, 0, T], [11,0, E],\n    [4, 2, C], [4, 1, E], [7, 1, C]\n]\n\nexport {u_face, f_face}\n\n// for solved back-FS, ignore CP=5 and C=(1,0)\n// for solved front-FS, ignore CP=4 and C=(0,0)\nconst FBpairPosBackFS : [number, number, number, number][] = [\n    [0, 0, 8, 1], [0, 1, 1, 0], [ 0, 2 , 0, 1],\n    // [1, 0, 9, 1],\n    [1, 1, 2, 0], [1, 2, 1, 1],\n    [2, 0, 10, 1], [2, 1, 3, 0], [2, 2, 2, 1],\n    [3, 0, 11, 0], [3, 1, 0, 0], [3, 2, 3, 1],\n    //[4, 0, 8, 0], \n    [4, 1, 4, 0],\n    // [5, 0, 9, 0], [5, 2, 6, 0],\n    [6, 0, 10, 0], [6, 1, 6, 0], [6, 2, 7, 1],\n    [7, 0, 11, 1], [7, 1, 7, 0], [7, 2, 4, 1]\n]\n// Reason for failing: sampling the solved state would crash our solver, which refuses to expand solution on solved state\nconst FBpairPosFrontFS : [number, number, number, number][] = [\n    //[0, 0, 8, 0], \n    [0, 1, 1, 1], [0, 2, 0, 0],\n    [1, 0, 9, 1], [1, 1, 2, 1], [1, 2, 1, 0],\n    [2, 0, 10, 0], [2, 1, 3, 1], [2, 2, 2, 0],\n    [3, 0, 11, 1], [3, 1, 0, 1], [3, 2, 3, 0],\n    //[4, 0, 8, 1], [4, 1, 4, 1],\n    //[5, 0, 9, 0], \n    [5, 2, 6, 0],\n    [6, 0, 10, 1], [6, 1, 6, 1], [6, 2, 7, 0],\n    [7, 0, 11, 0], [7, 1, 7, 1], [7, 2, 4, 0]\n]\n\nexport {FBpairPosBackFS, FBpairPosFrontFS}\n\nexport type FaceletCubeT = Array<Array<Face>>\n\n// A Cube can be in two representations: cubieCube or faceletCube\n\nlet color_map =`\\\n   UUU\n   UUU\n   UUU\nLLLFFFRRRBBB\nLLLFFFRRRBBB\nLLLFFFRRRBBB\n   DDD\n   DDD\n   DDD`\n\nexport {color_map}\n","let rand_int = (r: number) => {\n    return Math.floor(Math.random() * r)\n}\n\nlet rand_incl = (l: number, r: number) => {\n    return rand_int(r - l + 1) + l;\n}\nlet rand_choice = function<T>(arr: T[]) {\n    return arr[rand_int(arr.length)]\n}\n\nlet rand_shuffle = function<T>(arr: T[]) {\n    for (let i = 0, l = arr.length; i < l - 1; i++) {\n        let j = rand_incl(i, l - 1)\n        let tmp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = tmp\n    }\n    return arr\n}\n\nfunction cartesianProduct<T>(...allEntries: T[][]): T[][] {\n    return allEntries.reduce<T[][]>(\n      (results, entries) =>\n        results\n          .map(result => entries.map(entry => result.concat([entry])))\n          .reduce((subResults, result) => subResults.concat(result), []),\n      [[]]\n    )\n  }\n\nlet getParity = (perm: number[]) => {\n    let visited = Array(perm.length).fill(false)\n    let follow = (i: number, cnt: number) : number => {\n        if (visited[i]) {\n            return 0\n        } else {\n            visited[i] = 1\n            if (visited[perm[i]]) {\n                return cnt;\n            } else\n                return follow(perm[i], cnt + 1)\n        }\n    }\n    let res = 0\n    for (let x of perm) {\n        res += follow(x, 0)\n    }\n    return res\n}\n\nlet arrayEqual = function<T>(arr1: T[], arr2: T[]) {\n    if (arr1.length !== arr2.length) return false;\n    for (let i = 0; i < arr1.length; i++) {\n        if (arr1[i] !== arr2[i]) return false;\n    }\n    return true;\n}\n\nlet encodeArr = function(base: number, rarr: number[]) {\n    let int = 0\n    for (let i = rarr.length - 1; i >= 0; i--)\n        int = rarr[i] + int * base\n    return int\n}\n\nexport {rand_int, rand_choice, rand_shuffle, getParity, arrayEqual, encodeArr, cartesianProduct}","import {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from 'three';\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.05;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t// Touch fingers\n\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t// the target DOM element for key events\n\tthis._domElementKeyEvents = null;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.listenToKeyEvents = function ( domElement ) {\n\n\t\tdomElement.addEventListener( 'keydown', onKeyDown );\n\t\tthis._domElementKeyEvents = domElement;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().invert();\n\n\t\tvar lastPosition = new Vector3();\n\t\tvar lastQuaternion = new Quaternion();\n\n\t\tvar twoPI = 2 * Math.PI;\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t} else {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t}\n\n\t\t\t// restrict theta to be between desired limits\n\n\t\t\tvar min = scope.minAzimuthAngle;\n\t\t\tvar max = scope.maxAzimuthAngle;\n\n\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\n\n\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\n\n\t\t\t\tif ( min <= max ) {\n\n\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\t\tMath.max( min, spherical.theta ) :\n\t\t\t\t\t\tMath.min( max, spherical.theta );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t}\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\n\n\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove );\n\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\n\t\tif ( scope._domElementKeyEvents !== null ) {\n\n\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\n\n\t\t}\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: - 1,\n\t\tROTATE: 0,\n\t\tDOLLY: 1,\n\t\tPAN: 2,\n\t\tTOUCH_ROTATE: 3,\n\t\tTOUCH_PAN: 4,\n\t\tTOUCH_DOLLY_PAN: 5,\n\t\tTOUCH_DOLLY_ROTATE: 6\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new Spherical();\n\tvar sphericalDelta = new Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new Vector2();\n\tvar rotateEnd = new Vector2();\n\tvar rotateDelta = new Vector2();\n\n\tvar panStart = new Vector2();\n\tvar panEnd = new Vector2();\n\tvar panDelta = new Vector2();\n\n\tvar dollyStart = new Vector2();\n\tvar dollyEnd = new Vector2();\n\tvar dollyDelta = new Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\tvar needsUpdate = false;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.update();\n\n\t\t}\n\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchStartPan( event );\n\n\t}\n\n\tfunction handleTouchStartDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchStartRotate( event );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateEnd.set( x, y );\n\n\t\t}\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanEnd.set( x, y );\n\n\t\t}\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyOut( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t}\n\n\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t}\n\n\tfunction handleTouchEnd( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onPointerDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tonMouseDown( event );\n\t\t\t\tbreak;\n\n\t\t\t// TODO touch\n\n\t\t}\n\n\t}\n\n\tfunction onPointerMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tonMouseMove( event );\n\t\t\t\tbreak;\n\n\t\t\t// TODO touch\n\n\t\t}\n\n\t}\n\n\tfunction onPointerUp( event ) {\n\n\t\tswitch ( event.pointerType ) {\n\n\t\t\tcase 'mouse':\n\t\t\tcase 'pen':\n\t\t\t\tonMouseUp( event );\n\t\t\t\tbreak;\n\n\t\t\t// TODO touch\n\n\t\t}\n\n\t}\n\n\tfunction onMouseDown( event ) {\n\n\t\t// Prevent the browser from scrolling.\n\t\tevent.preventDefault();\n\n\t\t// Manually set the focus since calling preventDefault above\n\t\t// prevents the browser from setting it automatically.\n\n\t\tscope.domElement.focus ? scope.domElement.focus() : window.focus();\n\n\t\tvar mouseAction;\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0:\n\n\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\n\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tmouseAction = - 1;\n\n\t\t}\n\n\t\tswitch ( mouseAction ) {\n\n\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase MOUSE.PAN:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\n\t\t\tscope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\t\tscope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault(); // prevent scrolling\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault(); // prevent scrolling\n\t\tevent.stopPropagation();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\n\n\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove );\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( EventDispatcher.prototype );\nOrbitControls.prototype.constructor = OrbitControls;\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nvar MapControls = function ( object, domElement ) {\n\n\tOrbitControls.call( this, object, domElement );\n\n\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\n\n\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\tthis.touches.ONE = TOUCH.PAN;\n\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n};\n\nMapControls.prototype = Object.create( EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nexport { OrbitControls, MapControls };\n","import React, { useEffect } from 'react'\n\nimport { FaceletCubeT, Face } from \"../lib/Defs\";\nimport * as THREE from 'three';\nimport { arrayEqual } from '../lib/Math';\nimport * as chroma from 'chroma-js';\nimport useMediaQuery from '@mui/material/useMediaQuery';\nimport { useTheme } from '@mui/material/styles';\nimport { OrbitControls } from '../lib/three/OrbitControls';\n\ntype Config = {\n    cube: FaceletCubeT, width: number, height: number, colorScheme: Array<string>, facesToReveal: Face[],\n    theme: string,\n    hintDistance?: number,\n    enableControl? : boolean\n}\nlet { Vector3 } = THREE\n\n/*\nHow to propagate control of keypress ..? maybe not here, in the app.\n\nLet's look at click analogy: if a user click on sub-component,\nthat message should be propagated upwards to the parent.\n\nThat is, \"keydown\" should transform to some kind of message, e.g. the resulting cube state\nto be passed to the App, which then decides whether to trigger state change or let the cube keep being solved\n\n*/\n\ntype AxesInfo = [THREE.Vector3, THREE.Euler]\nconst TAU = Math.PI * 2;\nconst axesInfo: [THREE.Vector3, THREE.Euler][] = [\n    // UDFBLR\n    [new THREE.Vector3(0, 1, 0), new THREE.Euler(-TAU / 4, 0, 0)],\n    [new THREE.Vector3(0, -1, 0), new THREE.Euler(TAU / 4, 0, 0)],\n    [new THREE.Vector3(0, 0, 1), new THREE.Euler(0, 0, 0)],\n    [new THREE.Vector3(0, 0, -1), new THREE.Euler(0, TAU / 2, 0)],\n    [new THREE.Vector3(-1, 0, 0), new THREE.Euler(0, -TAU / 4, 0)],\n    [new THREE.Vector3(1, 0, 0), new THREE.Euler(0, TAU / 4, 0)],\n];\n\n\nenum CameraState {\n    HOME,\n    PEEK_UFL,\n    PEEK_DFL,\n    PEEK_DFR,\n    PEEK_UBR,\n    PEEK_UBL\n}\ntype ConfigT = {width: number, height: number, colorScheme: Array<string>, mode?: string,\n    faces?: Face[], theme?: string, hintDistance?: number,     enableControl? : boolean,\n    cameraState?: CameraState\n}\n\nconst roundedFace = ((rounded?: number[], cornerRadius?: number, ) => {\n    cornerRadius = cornerRadius || 0.1\n    rounded = rounded || [1, 1, 1, 1]\n    let geo = new THREE.BufferGeometry()\n    let cornerVertices = []\n    let cornerCenter = new THREE.Vector3(1 - cornerRadius, 1 - cornerRadius, 0)\n    let squareCorner = new THREE.Vector3(1, 1, 0)\n    for (let i = 0; i <= 90; i += 10) {\n        let degree = (i * Math.PI) / 180\n        cornerVertices.push( \n            cornerCenter.clone().add(new THREE.Vector3(Math.cos(degree), Math.sin(degree), 0).multiplyScalar(cornerRadius))\n        )\n    }\n    let vertices = []\n    for (let i = 0; i < 4; i++) {\n        if (rounded[i]) {\n            vertices.push(...cornerVertices)\n        } else {\n            vertices.push(squareCorner.clone())\n        }\n        cornerVertices = cornerVertices.map(x => x.clone().applyAxisAngle(new Vector3(0, 0, 1), 0.5 * Math.PI))\n        squareCorner.applyAxisAngle(new Vector3(0, 0, 1), 0.5 * Math.PI)\n    }\n    //vertices.push(new Vector3(0, 0, 0))\n\n    //let vertices_float32 = new Float32Array( vertices.length * 3)\n    //let vertices_attr = new THREE.BufferAttribute(vertices_float32, 3).copyVector3sArray( vertices)\n    // console.log(vertices_attr)\n    let faces = []\n    for (let i = 0; i< vertices.length; i++) {\n        let i1 = (i + 1) % vertices.length;\n        faces.push(vertices[vertices.length - 1])\n        faces.push(vertices[i])\n        faces.push(vertices[i1])\n    }\n    geo.setFromPoints(faces)\n\n    return geo\n})\n\nconst getCameraPosFromState = function (cstate: CameraState) : [number[], THREE.Vector3]{\n    const cameraPosUFR = [2.5, 3.5, 3]\n    const cameraPosUFL = [-2, 3.5, 3]\n    const cameraPosDFL = [-2, -3.5, 3]\n    const cameraPosDFR = [2, -3.5, 3]\n    const cameraPosUBR = [2.5, 3.5, -3]\n    const cameraPosUBL = [-2, 3.5, -3]\n\n    const upVecLookingDownUB = new THREE.Vector3(0, 0, -1)\n    const upVecLookingDownUBL = new THREE.Vector3(0, 0.1, -1)\n    const upVecDefault = new THREE.Vector3(0, 1, 0)\n    switch (cstate) {\n        case CameraState.HOME: return [cameraPosUFR, upVecDefault]\n        case CameraState.PEEK_DFL: return [cameraPosDFL, upVecDefault]\n        case CameraState.PEEK_DFR: return [cameraPosDFR, upVecDefault]\n        case CameraState.PEEK_UFL: return [cameraPosUFL, upVecDefault]\n        case CameraState.PEEK_UBL: return [cameraPosUBL, upVecLookingDownUBL]\n        default: return [cameraPosUBR, upVecLookingDownUB]\n    }\n}\nconst redraw_cube = function (cube: FaceletCubeT, config: ConfigT ) {\n    let { width, height, colorScheme, mode, faces, theme, enableControl} = config\n    let hintDistance = config.hintDistance || 3\n    const bgColor = theme === \"bright\" ? \"#eeeeef\" : '#252525' \n\n    mode = mode || \"FRU\"\n    let facesToReveal = faces || [Face.L, Face.B, Face.D]\n    //facesToReveal = [Face.L]\n\n    const scene = new THREE.Scene()\n    const angle = 50\n    const camera = new THREE.PerspectiveCamera(angle, width / height, 0.1, 1000)\n\n    const mag = 1.0\n    const alpha = 0.5\n    const enableBorder = true\n\n    const renderer = new THREE.WebGLRenderer({ antialias: true })\n    renderer.setSize(width, height, true);\n    //renderer.setViewport( 0, 0, width * window.devicePixelRatio, height * window.devicePixelRatio);\n    renderer.setClearColor(bgColor) // #70788a') //#5a606e') // '#373B43') // '#eeeeee')\n    renderer.setPixelRatio(window.devicePixelRatio)\n    let controls = new OrbitControls( camera, renderer.domElement );\n    controls.enabled = !!config.enableControl\n\n    const angleScale = Math.sin(70 / 180 * Math.PI)  /  Math.sin(angle / 180 * Math.PI)\n    const scale = (hintDistance > 5) ? .96 * angleScale : .9 * angleScale\n\n    const cameraState = config.cameraState || CameraState.HOME\n    const [cameraPositionRaw, cameraUp] = getCameraPosFromState(cameraState)\n    const cameraPosition = (mode === \"FRU\") ?\n        new THREE.Vector3(cameraPositionRaw[0] * scale, \n                          cameraPositionRaw[1] * scale,\n                          cameraPositionRaw[2] * scale) :\n        new THREE.Vector3(0 / 1.1, 3 / 1.1, 3 / 1.1)\n\n    //console.log(\"Setting camera up \", cameraUp, \" camera pos\", cameraPosition)\n    camera.up.copy(cameraUp)\n    camera.position.copy(cameraPosition)\n    camera.aspect = width / height;\n    camera.lookAt(new THREE.Vector3(0, 0, 0))\n\n    let stickers_tmpl: THREE.Mesh[], stickerwrap_tmpl: THREE.Mesh\n\n    const geos : THREE.BufferGeometry[] = []; // new THREE.PlaneGeometry(0.89 * mag * 2, 0.89 * mag * 2)\n    const geo_border = new THREE.PlaneGeometry(2.0, 2.0)//1.0 * mag * 2, 1.0 * mag * 2)\n\n    let materials_border = new THREE.MeshBasicMaterial({ color: 0x000000, side: THREE.FrontSide })\n    stickerwrap_tmpl = (() => {\n        let mesh = new THREE.Mesh(geo_border, materials_border)\n        mesh.setRotationFromEuler(axesInfo[0][1])\n        return mesh\n    })()\n\n    const sticker_scale = 0.88\n    const corner_radius = 0.4\n    const hint_scale = 0.95\n    const rounded_patterns = [\n        [0, 0, 0, 1],\n        [0, 0, 1, 1],\n        [0, 0, 1, 0],\n        [1, 0, 0, 1],\n        [1, 1, 1, 1],\n        [0, 1, 1, 0],\n        [1, 0, 0, 0],\n        [1, 1, 0, 0],\n        [0, 1, 0, 0]\n    ];\n\n    function drawCube(faces: FaceletCubeT, colorScheme: Array<string>): THREE.Group {\n        //console.log(\"update color scheme \", colorScheme_)\n        let materials = Array(7).fill(0).map((_, i) => {\n            let mat = new THREE.MeshBasicMaterial({ color: colorScheme[i], side: THREE.DoubleSide });\n            mat.alphaTest = alpha;\n            return mat\n        })\n\n        stickers_tmpl = materials.map((mat) => {\n            return rounded_patterns.map(pattern => {\n                let geo = roundedFace(pattern, corner_radius)\n                geos.push(geo)\n                let mesh = new THREE.Mesh(geo, mat)\n                mesh.scale.set(sticker_scale, sticker_scale, sticker_scale)\n                mesh.setRotationFromEuler(axesInfo[0][1])\n                return mesh\n            })\n        }).flat()\n\n        let hint_mesh = Array(7).fill(0).map((_, i) => {\n            let color = (theme === \"bright\") \n                ? chroma.mix(colorScheme[i], 'white', 0.18).hex()\n               :  chroma.mix(colorScheme[i], 'black', 0.35).hex()\n \n               // \n            //chroma.default(colorScheme[i]).brighten(0.7).hex()\n                  //desaturate(2).hex() //darken(0.5).hex()\n            let mat = new THREE.MeshBasicMaterial({ color, side: THREE.DoubleSide });\n\n            let geo = roundedFace([1,1,1,1], corner_radius)\n            geos.push(geo)\n            let mesh = new THREE.Mesh(geo, mat)\n            mesh.scale.set(hint_scale, hint_scale, hint_scale)\n            mesh.setRotationFromEuler(axesInfo[0][1])\n            return mesh\n        })\n\n\n        const cube = new THREE.Group();\n        for (let i = 0; i < 6; i++) {\n            const cubie = new THREE.Group();\n            const rot = new THREE.Matrix4().makeRotationFromEuler(axesInfo[i][1]);\n            const rot1 = new THREE.Matrix4().makeRotationFromEuler(axesInfo[1][1]);\n            cubie.setRotationFromMatrix(rot.multiply(rot1))\n            for (let z = -1; z <= 1; z++) {\n                for (let x = -1; x <= 1; x++) {\n                    let idx = (z + 1) * 3 + (x + 1)\n\n                    const curr_tmpl = stickers_tmpl[faces[i][idx] * 9 + idx]\n                    const sticker = curr_tmpl.clone()\n                    const stickerwrap = stickerwrap_tmpl.clone()\n\n                    const eps = 0.05\n                    sticker.position.copy(new THREE.Vector3(x * 2, 3, z * 2))\n                    stickerwrap.position.copy(new THREE.Vector3(x * 2, 3 - eps, z * 2))\n\n                    if (facesToReveal.indexOf(i) > -1) { // (i === 5 && mode === \"UF\")) {\n                        const stickerhint = hint_mesh[faces[i][idx]].clone()\n                        stickerhint.position.copy(new THREE.Vector3(x * 2, 3 + hintDistance, z * 2))\n                        cubie.add(stickerhint)\n                    }\n                    if (enableBorder)\n                        cubie.add(stickerwrap)\n\n                    cubie.add(sticker)\n                }\n\n            }\n            cube.add(cubie)\n        }\n        cube.scale.set(1 / 3, 1 / 3, 1 / 3)\n        return cube\n    }\n\n    let cubeG = drawCube(cube, colorScheme)\n    scene.add(cubeG)\n\n    const render = () => {\n        controls.update();\n        renderer.render(scene, camera)\n    }\n    render()\n\n    let frameID = -1\n    const animate = () => {\n        frameID = requestAnimationFrame(animate)\n        renderer.render(scene, camera)\n    }\n    animate()\n\n    const updateCubeAndColor = (cube: FaceletCubeT, colorScheme: Array<string>) => {\n        scene.remove(cubeG)\n        cubeG.clear()\n        cubeG = drawCube(cube, colorScheme)\n        scene.add(cubeG)\n        renderer.render(scene, camera)\n        return renderer\n    }\n\n    const cleanup = () => {\n        geos.forEach(g => g.dispose())\n        materials_border.dispose()\n        geo_border.dispose()\n        scene.remove(cubeG)\n        cancelAnimationFrame(frameID)\n    }\n    return {\n        updateCubeAndColor,\n        getRenderer: () => renderer,\n        cleanupFunc: cleanup,\n        renderControls: render\n    }\n    //let defaultColorScheme = [ 0x00ff00, 0x0000ff, 0xff0000,0xff8800,0xffff00, 0xffffff]\n}\n\nlet drawCube = (function(){\n    let config_cache : ConfigT | null = null\n    let painter : Painter | null = null\n    let func = (cube: FaceletCubeT, config: ConfigT) => {\n        if (config_cache === null) {\n            painter?.cleanupFunc()\n\n            painter = redraw_cube(cube, config)\n            config_cache = config\n            return painter\n        }\n        else if (config.width === config_cache.width && config.height === config_cache.height &&\n            arrayEqual(config.faces || [], config_cache.faces || []) && config.theme === config_cache.theme &&\n            config.hintDistance === config_cache.hintDistance && config.enableControl === config_cache.enableControl\n            && config.cameraState === config_cache.cameraState) {\n\n            painter?.updateCubeAndColor(cube, config.colorScheme)\n            config_cache = config\n            return painter!\n        } else {\n            painter?.cleanupFunc()\n            painter = redraw_cube(cube, config)\n            config_cache = config\n            return painter!\n        }\n    }\n    return func\n})\n\ntype Painter = {\n    updateCubeAndColor: (cube: FaceletCubeT, scheme: Array<string>) => THREE.WebGLRenderer,\n    getRenderer: () => THREE.WebGLRenderer,\n    cleanupFunc: () => void,\n    renderControls: () => void\n\n}\n\nfunction CubeSim(props: Config) {\n    const mount = React.useRef<HTMLDivElement | null>(null)\n    const [cameraState, setCameraState] = React.useState<CameraState>(CameraState.HOME);\n    let { width, height, colorScheme, facesToReveal, hintDistance, theme} = props\n    let cubePainter = React.useMemo(drawCube, [])\n\n    const gt_xs = useMediaQuery(useTheme().breakpoints.up('sm'));\n    const enableControl = gt_xs\n\n    let painter = cubePainter(props.cube, {\n            width, height, colorScheme, faces: facesToReveal, theme, hintDistance, enableControl,\n            cameraState})\n\n    useEffect( () => {\n        let dom = window //painter.getRenderer().domElement\n        function downHandler ( event: KeyboardEvent){\n            let suppressLogging = 0\n            // intercept keyboard event for local control\n            if (event.key === \"1\") {\n                setCameraState(CameraState.PEEK_DFL);\n            }\n            if (event.key === \"2\") {\n                setCameraState(CameraState.PEEK_DFR);\n            }\n            if (event.key === \"3\") {\n                setCameraState(CameraState.PEEK_UFL);\n            }\n            if (event.key === \"9\") {\n                setCameraState(CameraState.PEEK_UBL);\n            }\n            if (event.key === \"0\") {\n                setCameraState(CameraState.PEEK_UBR);\n            }\n            else {\n                suppressLogging = 1\n            }\n            if (~suppressLogging) {\n                //console.log(\"CubeSim camera rotateion with key \", event.key)\n            }\n        }\n        function upHandler (event: KeyboardEvent) {\n            setCameraState(CameraState.HOME);\n        }\n        dom.addEventListener('keydown', downHandler);\n        dom.addEventListener('keyup', upHandler);\n        return () => {\n            dom.removeEventListener('keydown', downHandler);\n            dom.addEventListener('keyup', upHandler);\n        };\n    });\n\n    useEffect( () => {\n        let dom = mount.current!\n        dom.appendChild(painter.getRenderer().domElement) //renderer.domElement)\n        return () => {\n            dom.removeChild(painter.getRenderer().domElement)\n        }\n    })\n\n    return <div\n        ref={mount}\n        style={{ width: props.width, height: props.height, zIndex: 1 }}\n    />;\n}\n\nexport default CubeSim","import { MoveT, OriChg, PermChg, StickerT, StickerExtT, CornerCoord, EdgeCoord, cstimer_corners_coord, cstimer_edges_coord, CenterCoord, centers_coord } from \"./Defs\";\nimport { u, d, f, b, l, r, m, e, s} from \"./Defs\";\nimport { FaceletT, FaceletCubeT, corners_coord, edges_coord, u_face, f_face, color_map } from \"./Defs\";\nimport { Typ, Face, C, E, T, U, D, F, B, L, R } from \"./Defs\";\nimport { rand_int, rand_shuffle, getParity, rand_choice, arrayEqual } from \"./Math\";\n\nconst C_MOD = 3;\nconst E_MOD = 2;\nconst T_MOD = 1;\n\nexport class CubieCube {\n    cp: number[] = [];\n    co: number[] = [];\n    ep: number[] = [];\n    eo: number[] = [];\n    tp: number[] = [];\n    // The addition of tp is not necessary, but helps us deal with slice moves in Roux during search and simcube.\n    deserialize(s: string) {\n        let obj = JSON.parse(s)\n        this.set(obj);\n        return this\n    }\n    serialize() {\n        let {cp, co, ep, eo, tp} = this\n        return JSON.stringify({cp, co, ep, eo, tp});\n    }\n\n    Id() : CubieCube {\n        this.set({\n            cp: [0, 1, 2, 3, 4, 5, 6, 7],\n            co: [0, 0, 0, 0, 0, 0, 0, 0],\n            ep: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],\n            eo: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            tp: [0, 1, 2, 3, 4, 5]\n        })\n        return this\n    }\n    clone() : CubieCube {\n        return new CubieCube({\n            cp: [...this.cp],\n            co: [...this.co],\n            ep: [...this.ep],\n            eo: [...this.eo],\n            tp: [...this.tp]\n        })\n    }\n    constructor(value?: {cp: number[], co: number[], ep: number[], eo: number[], tp?: number[]} | CubieCube) {\n        if (value instanceof CubieCube) {\n            this.set({\n                cp: value.cp, co: value.co, ep: value.ep, eo: value.eo, tp: value.tp\n            })\n        }\n        else if (value) {\n            this.cp = value.cp\n            this.co = value.co\n            this.ep = value.ep\n            this.eo = value.eo\n            this.tp = value.tp || [0, 1, 2, 3, 4, 5] // UD FB LR\n        } else {\n            this.Id()\n        }\n    }\n    set(value: {cp?: number[], co?: number[], ep?: number[], eo?: number[], tp?: number[]} | CubieCube) {\n        this.cp = value.cp || this.cp\n        this.co = value.co || this.co\n        this.ep = value.ep || this.ep\n        this.eo = value.eo || this.eo\n        this.tp = value.tp || this.tp\n    }\n    _apply_partial(o: Array<number>, p: Array<number>, oc: Array<OriChg>, pc: Array<PermChg>, mod: number) {\n        let o_new = [...o];\n        let p_new = [...p];\n\n        for (let i = 0; i < oc.length; i++) {\n            //let [src, dst] = pc[i];\n            let src = pc[i][0], dst = pc[i][1];\n            p_new[dst] = p[src];\n            o_new[dst] = (o[src] + oc[i]) % mod;\n        }\n        return [o_new, p_new]\n    }\n    _apply_partial_perm(p: Array<number>, pc: Array<PermChg>, mod: number) {\n        let p_new = [...p];\n\n        for (let i = 0; i < pc.length; i++) {\n            //let [src, dst] = pc[i];\n            let src = pc[i][0], dst = pc[i][1];\n            p_new[dst] = p[src];\n        }\n        return p_new\n    }\n\n    // all side-effect-less\n    apply_one(move: Move) {\n        let [co, cp] = this._apply_partial(this.co, this.cp, move.coc, move.cpc, C_MOD)\n        let [eo, ep] = this._apply_partial(this.eo, this.ep, move.eoc, move.epc, E_MOD)\n        let tp = this._apply_partial_perm(this.tp, move.tpc, T_MOD)\n        return new CubieCube({ co, cp, eo, ep, tp })\n    }\n\n    static generate_apply_partial_func_perm(pc: Array<PermChg>, mod: number, p: string) {\n        return `\n        let ${p}_new = [...${p}];\n        src = 0, dst = 0;\n        ${Array(pc.length).fill(0).map( (_, i) => {\n            let src = pc[i][0], dst = pc[i][1];\n            return `\n                ${p}_new[${dst}] =  ${p}[${src}];\n            `\n        }).join(\"\\n\")}\n        // return [ ${p}_new]\n        `\n    }\n    static generate_apply_partial_func(oc: Array<OriChg>, pc: Array<PermChg>, mod: number, o: string, p: string) {\n        return `\n        let ${o}_new = [...${o}];\n        let ${p}_new = [...${p}];\n        src = 0, dst = 0;\n        ${Array(oc.length).fill(0).map( (_, i) => {\n            let src = pc[i][0], dst = pc[i][1], ori = oc[i];\n            return `\n                ${p}_new[${dst}] =  ${p}[${src}];\n                ${o}_new[${dst}] = (${o}[${src}] + ${ori}) % ${mod};\n            `\n        }).join(\"\\n\")}\n        // return [${o}_new, ${p}_new]\n        `\n    }\n    static generate_apply_func(move: Move) : (c: CubieCube) => CubieCube {\n        // eslint-disable-next-line no-new-func\n        return new Function(\"cube\", `\n        let {co, cp, eo, ep, tp} = cube;\n        ${CubieCube.generate_apply_partial_func(move.coc, move.cpc, C_MOD, \"co\", \"cp\")}\n        ${CubieCube.generate_apply_partial_func(move.eoc, move.epc, E_MOD, \"eo\", \"ep\")}\n        ${CubieCube.generate_apply_partial_func_perm(move.tpc, T_MOD, \"tp\")}\n        return ({ co: co_new, cp: cp_new, eo: eo_new,\n            ep: ep_new, tp: tp_new })\n        `) as (c: CubieCube) => CubieCube\n    }\n\n    apply(move: Move | Array<Move> | MoveSeq | string): CubieCube {\n        if (Array.isArray(move) || move instanceof MoveSeq) {\n            let moves = Array.isArray(move) ? move : move.moves\n            let cube = this.clone()\n            for (let i = 0; i < moves.length; i++) {\n                cube = cube.apply_one(moves[i])\n            }\n            return cube\n        } else if (typeof move === \"string\") {\n            return this.apply(new MoveSeq(move))\n        }\n        else {\n            return this.apply_one(move)\n        }\n    }\n\n    static _rotate_coord(fs: Face[]) {\n        let faces = [...fs] as Face[]\n        let last_face = faces[faces.length - 1];\n        for (let i = faces.length - 1; i > 0; i--) {\n            faces[i] = faces[i - 1];\n        }\n        faces[0] = last_face\n        return faces\n    }\n    static _backward_rotate_coord(fs: Face[]){\n        let faces = [...fs] as Face[]\n        let first_face = faces[0]\n        for (let i = 0; i < faces.length - 1; i++) {\n            faces[i] = faces[i + 1];\n        }\n        faces[faces.length - 1] = first_face\n        return faces\n    }\n\n    // facelet mapping: from position to piece\n    _to_facelet_mapping(corners_coord: CornerCoord[], edges_coord: EdgeCoord[], centers_coord: CenterCoord[]) {\n        let facelet_mapping : [Face[], Face[]][]= []\n\n        for (let i = 0; i < 8; i++) {\n            let pos = corners_coord[i] as Face[]\n            let piece = corners_coord[this.cp[i]] as Face[]\n\n            for (let j = 0; j < this.co[i];j++) {\n                piece = CubieCube._rotate_coord(piece)\n            }\n            facelet_mapping.push([pos, piece])\n        }\n        for (let i = 0; i < 12; i++) {\n            let pos = edges_coord[i] as Face[]\n            let piece = edges_coord[this.ep[i]] as Face[]\n            for (let j = 0; j < this.eo[i];j++) {\n                piece = CubieCube._rotate_coord(piece)\n            }\n            facelet_mapping.push([pos, piece])\n        }\n        for (let i = 0; i<6;i++) {\n            let pos = centers_coord[i]\n            let piece = centers_coord[this.tp[i]] as Face[]\n            facelet_mapping.push([ pos, piece])\n        }\n        return facelet_mapping\n    }\n\n    _from_facelet_mapping (fm: [Face[], Face[]][], custom_corners_coord: CornerCoord[], custom_edges_coord: EdgeCoord[], custom_centers_coord: CenterCoord[] ) {\n        let cube = new CubieCube()\n\n        let match_pos_piece = (pos: Face[], piece: Face[], coord: Face[][], parity: number) : [number, number, number]=> {\n            let expected = new Map(coord.map( (x, i) => [x.toString(), i]))\n            let ori = 0\n            while (!expected.has(pos.toString())) {\n                pos = CubieCube._backward_rotate_coord(pos)\n                ori--;\n                if (ori <= -parity) break;\n            }\n            while (!expected.has(piece.toString())) {\n                piece = CubieCube._backward_rotate_coord(piece)\n\n                ori++;\n                if (ori >= 10) {\n                    console.warn(\"can't match piece\", piece, expected)\n                    break\n                }\n            }\n\n            ori = (ori + parity) % parity;\n            return [ori, expected.get(pos.toString())!, expected.get(piece.toString())! ]\n        }\n\n        for (let coord_pair of fm) {\n            let pos = coord_pair[0], piece = coord_pair[1]\n            let coord : Face[][] = (pos.length === 2) ? custom_edges_coord :\n                        (pos.length === 3) ? custom_corners_coord :\n                         custom_centers_coord ;\n            let [newOri,newpos,newPerm] = match_pos_piece(pos, piece, coord, pos.length);\n\n            //console.log( pp([pos, piece]), [newOri, newpos,newPerm])\n            if (pos.length === 2) {\n                cube.eo[newpos] = newOri;\n                cube.ep[newpos] = newPerm;\n            } else if (pos.length === 3){\n                cube.co[newpos] = newOri;\n                cube.cp[newpos] = newPerm;\n            } else {\n                cube.tp[newpos] = newPerm;\n            }\n        }\n        return cube\n    }\n\n    to_cstimer_cube() {\n        let facelet_mapping = this._to_facelet_mapping(corners_coord, edges_coord, centers_coord)\n        let cube = this._from_facelet_mapping(facelet_mapping, cstimer_corners_coord, cstimer_edges_coord, centers_coord)\n        return cube\n    }\n\n    is_solveable() {\n        if (this.tp[0] !== 0) {\n            this.apply(new MoveSeq(\"M2\")) // assuming lse\n        }\n        let perm_correct = (getParity(this.cp) + getParity(this.ep)) % 2 === 0\n        let ori_correct = (this.co.reduce((x, y) => x + y, 0) % 3 === 0) && (this.eo.reduce((x, y) => x + y, 0) % 2 === 0)\n        return perm_correct && ori_correct\n    }\n\n    changeBasis(s: MoveSeq) {\n        // only take x and y for now\n        let facelet_mapping = this._to_facelet_mapping(corners_coord, edges_coord, centers_coord)\n\n        let transformed_mapping = s.moves.reduce( (mapping, move) : [Face[], Face[]][] => {\n            let face_mapping = Object.fromEntries(move.tpc)\n            //console.log(\"applying face mapping for \", move.name, face_mapping)\n            //console.log(\"before\", pp(mapping))\n            let result = mapping.map( ([face_pos, face_target]) =>\n                [face_pos.map(f => face_mapping[f] ?? f ),\n                 face_target.map(f => face_mapping[f] ?? f) ]\n            )\n            //console.log('after', pp(result))\n            return result as any\n        } , facelet_mapping)\n        //console.log(s.toString(), facelet_mapping, transformed_mapping)\n        let cube = this._from_facelet_mapping(transformed_mapping, corners_coord, edges_coord, centers_coord)\n        return cube\n        //let cube = this._from_facelet_mapping(facelet_mapping, corners_coord, edges_coord, centers_coord)\n    }\n}\n\n\n/* Moves */\n/* We will generate all the moves based on the base moves and rotations, and return them in an array */\nexport class Move {\n    cpc: Array<PermChg> = [];\n    coc: Array<OriChg> = [];\n    epc: Array<PermChg> = [];\n    eoc: Array<OriChg> = [];\n    tpc: Array<PermChg> = [];\n    name: string = \"\";\n    constructor(arg?: Array<Move> | CubieCube | Move | MoveT, name?: string) {\n        if (Array.isArray(arg)) {\n            this.from_moves(arg, name!)\n        } else if (arg instanceof Move){\n            this.cpc = [...arg.cpc]\n            this.coc = [...arg.coc]\n            this.epc = [...arg.epc]\n            this.eoc = [...arg.eoc]\n            this.tpc = [...arg.tpc]\n            this.name = name!\n        } else if (arg instanceof CubieCube) {\n            this.from_cube(arg, name!)\n        } else if (arg) {\n            this.set(arg)\n        }\n    }\n    set(move: Move | MoveT) {\n        this.cpc = move.cpc\n        this.coc = move.coc\n        this.epc = move.epc\n        this.eoc = move.eoc\n        this.tpc = move.tpc\n        this.name = move.name\n    }\n    from_cube(cube: CubieCube, name: string) {\n        let get_change = (p: Array<number>, o: Array<number>, acc_p: Array<PermChg>, acc_o: Array<OriChg>) => {\n            for (let i = 0; i < p.length; i++) {\n                if (i === p[i] && o[i] === 0) {\n                } else {\n                    acc_p.push([p[i], i]);\n                    acc_o.push(o[i]);\n                }\n            }\n        }\n        get_change(cube.cp, cube.co, this.cpc, this.coc);\n        get_change(cube.ep, cube.eo, this.epc, this.eoc);\n        get_change(cube.tp, [0, 0, 0, 0, 0, 0], this.tpc, []);\n        this.name = name\n        return this\n    }\n    from_moves (moves: Move[], name: string) {\n        this.from_cube(new CubieCube().apply(moves), name)\n        return this\n    }\n    clone() {\n        return new Move(this, this.name)\n    }\n    static make_rot_set(move: Move): Array<Move> {\n        return [move,\n            new Move().from_moves([move, move], move.name + \"2\"),\n            new Move().from_moves([move, move, move], move.name + \"'\"),\n        ]\n    }\n\n    static generate_base_moves = () => {\n        let make_rot_set = Move.make_rot_set\n        let us = make_rot_set(new Move(u));\n        let fs = make_rot_set(new Move(f));\n        let rs = make_rot_set(new Move(r));\n        let ls = make_rot_set(new Move(l));\n        let ds = make_rot_set(new Move(d));\n        let bs = make_rot_set(new Move(b));\n        let ms = make_rot_set(new Move(m));\n        let es = make_rot_set(new Move(e));\n        let ss = make_rot_set(new Move(s));\n\n        let rw = new Move([new Move(r), ms[2]], \"r\")\n        let rws = make_rot_set(rw)\n        let lw = new Move([new Move(l), new Move(m)], \"l\")\n        let lws = make_rot_set(lw)\n        let uw = new Move([new Move(u), new Move(e)], \"u\")\n        let uws = make_rot_set(uw)\n        let fw = new Move([new Move(f), new Move(s)], \"f\")\n        let fws = make_rot_set(fw)\n\n        let x = new Move([new Move(r), ls[2], ms[2]], \"x\")\n        let xs = make_rot_set(x)\n        let y = new Move([new Move(u), new Move(e), ds[2]], \"y\")\n        let ys = make_rot_set(y)\n        let z = new Move([x, y, x, x, x], \"z\")\n        let zs = make_rot_set(z)\n\n        let id = new Move(new CubieCube(), \"id\")\n        let moves = [\n            id,\n            us, fs, rs, ls, ds, bs, ms, es, ss,\n            xs, ys, zs,\n            rws, lws, uws, fws\n        ].flat()\n        let moves_dict: { [key: string]: Move } = Object.create({})\n        moves.forEach(m => moves_dict[m.name] = m)\n        return moves_dict\n    }\n    static all: {[key: string]: Move} = Move.generate_base_moves();\n\n    inv(): Move {\n        let name: string\n        switch (this.name[this.name.length - 1]) {\n            case \"'\": name = this.name.slice(0, this.name.length - 1); break\n            case \"2\": name = this.name; break\n            default: name = this.name + \"'\"\n        }\n        return Move.all[name]\n    }\n\n    toString() {\n        return this.name\n    }\n}\n\n\nexport class MoveSeq {\n    moves: Move[] = [];\n\n    constructor(moves: Move[] | string) {\n        if (typeof moves === \"string\") {\n            this.parse(moves);\n        } else {\n            this.moves = moves\n        }\n    }\n\n    static quarterMap : {[key: string]: string} = ({\n        \"U2\": \"U'\",\n        \"R2\": \"R'\",\n        \"r2\": \"r'\",\n        \"M2\": \"M'\",\n        \"L2\": \"L\",\n    });\n    toQuarter() {\n        let nm : Move[] = []\n        for (let i = 0 ; i < this.moves.length; i++) {\n            let m = this.moves[i]\n            if (m.name[1] === \"2\") {\n                let k = MoveSeq.quarterMap[m.name] || m.name[0]\n                nm.push(Move.all[ k ])\n                nm.push(Move.all[ k ])\n            } else {\n                nm.push(m)\n            }\n        }\n        return new MoveSeq(nm)\n    }\n\n    static _combine(move1: Move, move2: Move) : MoveSeq {\n        const getCnt = (name : string) => {\n            if (name.length === 1) return 1\n            return name[1] === \"2\" ? 2 : 3\n        }\n        const getStr = (cnt : number) => {\n            return (cnt === 1) ? \"\" : (cnt === 2 ? \"2\" : \"'\")\n        }\n        if (move1.name[0] === move2.name[0]) {\n            let cnt = (getCnt(move1.name) + getCnt(move2.name)) % 4\n            if (cnt === 0) return new MoveSeq([])\n            else return new MoveSeq([ Move.all[move1.name[0] + getStr(cnt)] ])\n        } else {\n            return new MoveSeq([move1, move2])\n        }\n    }\n\n    remove_setup() {\n        let rotset = new Set([\"x\", \"x'\", \"x2\", \"y\", \"y'\", \"y2\", \"z\", \"z'\", \"z2\"]);\n        while (this.moves.length > 0 && rotset.has(this.moves[0].name)) {\n            this.moves.shift()\n        }\n        return this\n    }\n\n    parse_line(str: string) {\n        let tokens = []\n        let token = \"\"\n        let comment_idx = str.search(/\\/\\//)\n        if (comment_idx > -1) str = str.slice(0, comment_idx)\n        for (let i = 0; i < str.length; i++) {\n            let ch = str[i]\n            if (ch === '2' || ch === '\\'') {\n                if (token.length === 1) {\n                    token += str[i];\n                    tokens.push(token)\n                    token = \"\"\n                }\n            } else if (ch === ' ') {\n                if (token.length > 0) {\n                    tokens.push(token); token = \"\";\n                }\n            } else {\n                const ord = ch.charCodeAt(0)\n                if ( (65 <= ord && ord < 65 + 26) || (97 <= ord && ord < 97 + 26)) {\n                    if (token.length > 0) {\n                        tokens.push(token)\n                        token = \"\"\n                    }\n                    token += str[i]\n                }\n            }\n        }\n        let moves = []\n        if (token.length > 0) tokens.push(token);\n        for (let token of tokens) {\n            let move = Move.all[token]\n            if (move) {\n                moves.push(move)\n            }\n        }\n        return moves\n    }\n    parse(str: string) {\n        this.moves = str.split(\"\\n\").map(x => this.parse_line(x)).flat()\n        return this\n    }\n\n    collapse() : MoveSeq {\n        let newMoves : Move[] = []\n        let moves = this.moves\n        while (moves.length > 0) {\n            const nextMove = moves.shift()!\n            if (newMoves.length === 0) {\n                newMoves.push(nextMove)\n            } else {\n                const move = newMoves.pop()!\n                const combined = MoveSeq._combine(move, nextMove)\n                for (let m of combined.moves)\n                    newMoves.push(m)\n            }\n        }\n        return new MoveSeq(newMoves);\n    }\n\n    inv() {\n        let moves: Move[] = this.moves.slice(0).reverse().map(x => x.inv()).flat()\n        return new MoveSeq(moves)\n    }\n\n    slice(n: number) {\n        let moves: Move[] = this.moves.slice(0, n)\n        return new MoveSeq(moves)\n    }\n\n    length() {\n        return this.moves.length\n    }\n\n    static add_auf(moves: Array<Move>, auf_moves?: Array<Move | MoveSeq>) {\n        auf_moves = auf_moves || [ Move.all[\"id\"], Move.all[\"U\"], Move.all[\"U'\"], Move.all[\"U2\"]]\n        let auf_move = rand_choice(auf_moves)\n        if (auf_move instanceof MoveSeq) {\n            moves.concat(auf_move.moves)\n        } else {\n            moves.push(auf_move)\n        }\n    }\n\n    toString(useMetric?: string) {\n        return this.moves.map(m => m.toString()).join(\" \") + \" \" + (useMetric ? \"(\" + this.moves.length + \")\" : \"\")\n    }\n}\n\n/* Faces */\nlet FaceletCube = function () {\n    let mult_move = (face: FaceletT, move: Move): FaceletT => {\n        let face_new: FaceletT = [...face]\n        let mod_for_typ = (typ: Typ) => {\n            switch (typ) {\n                case C: return 3;\n                case E: return 2;\n                case T: return 1\n            }\n        }\n        let work = (p: PermChg, o: number, typ: Typ) => {\n            let mod = mod_for_typ(typ)\n            let [p1, p2] = p\n            for (let i = 0; i < face.length; i++) {\n                let [p_curr, o_curr, typ_curr] = face[i];\n                if (typ_curr === typ && p_curr === p1) {\n                    face_new[i] = [p2, (o_curr + o) % mod, typ]\n                }\n            }\n        }\n        for (let i = 0; i < move.cpc.length; i++) {\n            work(move.cpc[i], move.coc[i], C)\n        }\n        for (let i = 0; i < move.epc.length; i++) {\n            work(move.epc[i], move.eoc[i], E)\n        }\n        for (let i = 0; i < move.tpc.length; i++) {\n            work(move.tpc[i], 0, T)\n        }\n        return face_new\n    }\n    let color_of_c = (p: number, o1: number, o2: number) =>\n    corners_coord[p][(3 - o1 + o2) % 3];\n    let color_of_e = (p: number, o1: number, o2: number) =>\n        edges_coord[p][(2 - o1 + o2) % 2];\n    let color_of_t = (p: number) => [U, D, F, B, L, R][p]\n\n    let color_of_sticker = (cube: CubieCube, sticker: StickerT) => {\n        let [p, o, typ] = sticker\n        if (typ === C) {\n            return color_of_c(cube.cp[p], cube.co[p], o)\n        } else if (typ === E) {\n            return color_of_e(cube.ep[p], cube.eo[p], o)\n        } else if (typ === T) {\n            return color_of_t(cube.tp[p])\n        } else {\n            throw Error(\"unidentified type \" + typ)\n        }\n    }\n\n    let from_cubie_partial = (cube: CubieCube, facelet: FaceletT) => {\n        return facelet.map(s => color_of_sticker(cube, s))\n    }\n    let from_cubie_partial_masked = (cube: CubieCube, facelet: FaceletT, mask: Mask) => {\n        return facelet.map(([p, o, typ]) => {\n            if (typ === C) {\n                if (mask.cp[cube.cp[p]] === 1)\n                    return color_of_c(cube.cp[p], cube.co[p], o)\n                else\n                    return Face.X\n            } else if (typ === E) {\n                if (mask.ep[cube.ep[p]] === 1)\n                    return color_of_e(cube.ep[p], cube.eo[p], o)\n                else\n                    return Face.X\n            } else if (typ === T) {\n                if (mask.tp && mask.tp[cube.tp[p]] === 0)\n                    return Face.X\n                else\n                    return color_of_t(cube.tp[p])\n            } else {\n                throw Error(\"unidentified type \" + typ)\n            }\n        })\n    }\n\n    let moves = Move.all\n    let generate_base_facelets = () => {\n        let d_face = mult_move(f_face, moves[\"x'\"])\n        let l_face = mult_move(f_face, moves[\"y\"])\n        let r_face = mult_move(f_face, moves[\"y'\"])\n        let b_face = mult_move(f_face, moves[\"y2\"])\n        return {\n            d_face, l_face, r_face, b_face\n        }\n    }\n    let { d_face, l_face, r_face, b_face } = generate_base_facelets()\n\n    let from_cubie = (cube: CubieCube, mask?: Mask): FaceletCubeT => {\n        //console.log(\"converting from cube\", cube)\n        let faces = [u_face, d_face, f_face, b_face, l_face, r_face]\n        if (mask)\n            return faces.map((facelet) => from_cubie_partial_masked(cube, facelet, mask))\n        else\n            return faces.map((facelet) => from_cubie_partial(cube, facelet))\n    }\n\n    let as_actrm = (fcube: FaceletCubeT, faces: 'lr' | 'fb', uu_only: boolean): FaceletCubeT => {\n        // U_face index 0\n        // algorithm: for U face and 0..2 of FBLR face, filter by lr|fb + u sticker\n        // additionally, if uu_only == 1, filter 0..2 of FBLR face by lr|fb only.\n        const U_IDX = 0\n        const F_IDX = 2\n        const nmcll_faces = (faces === 'lr') ? [Face.L, Face.R] : [Face.F, Face.B]\n        const u_or_nmcll_faces = [Face.U, ...nmcll_faces]\n        return fcube.map((stickers, idx) => {\n            if (idx === U_IDX) {\n                return stickers.map(s => u_or_nmcll_faces.includes(s) ? s : Face.X)\n            }\n            if (idx >= F_IDX) {\n                return stickers.map((s, fidx) =>\n                    ((uu_only ? nmcll_faces : u_or_nmcll_faces).includes(s) || fidx > 2)\n                   ? s\n                   : Face.X)\n            }\n            return [...stickers]\n        })\n    }\n\n    let as_kata = (fcube: FaceletCubeT) => {\n        // find out where are the recog stickers and grey out the rest\n        console.log(fcube)\n        let {F,B,L,R,U} = Face\n        const shape_maps = [\n            // prioritize all recog stickers on U (Pi, H)\n            [[U, 0], [U, 2], [U, 6], [U, 8]],\n            // next, find recog stickers in T shape\n            [[U, 0], [U, 2], [L, 2], [R, 0]],\n            [[U, 2], [U, 8], [B, 2], [F, 0]],\n            [[U, 6], [U, 8], [L, 0], [R, 2]],\n            [[U, 0], [U, 6], [B, 0], [F, 2]],\n            // default: recog stickers for L\n            [[U, 2], [U, 6], [F, 2], [B, 2]],\n            [[U, 0], [U, 8], [L, 2], [R, 2]],\n            // default: recog stickers for O (solved)\n            [[F, 0], [F, 2], [R, 0], [R, 2]],\n        ]\n        let found = false;\n        for (let map of shape_maps) {\n            let match_count = 0;\n            for (let [f, i] of map) {\n                match_count += (fcube[f][i] !== Face.U) ? 1 : 0;\n            }\n            if (match_count === map.length) {\n                // found recog shape, now make all non-U pieces X\n                for (let f of [Face.L, Face.R, Face.F, Face.B, Face.U]) {\n                    for (let i = 0; i < ((f === Face.U) ? 9 : 3); i++) {\n                        if (fcube[f][i] !== Face.U) {\n                            let is_recog = Array(4).fill(0).map((_, j) => (map[j][0] === f && map[j][1] === i)).includes(true)\n                            if (!is_recog) {\n                                fcube[f][i] = Face.X;\n                            }\n                        }\n                    }\n                }\n                found = true;\n                break;\n            }\n        }\n        //console.log(fcube)\n        if (!found) {\n            alert(\"recog shape not found\")\n        }\n        return fcube;\n    }\n\n    let to_unfolded_cube_str = (faceletCube: FaceletCubeT): String => {\n        let face_count = [0, 0, 0, 0, 0, 0];\n        let str_face_map: { [key: string]: Face } = {\n            \"U\": U, \"D\": D, \"F\": F, \"B\": B, \"L\": L, \"R\": R\n        }\n        let face_str_map = \"UDFBLR\"\n        let color_cube = \"\"\n        for (let i = 0; i < color_map.length; i++) {\n            let face_char = color_map[i];\n            if (str_face_map.hasOwnProperty(face_char)) {\n                let face: number = str_face_map[face_char] as number;\n                let count = face_count[face];\n                let color = faceletCube[face][count]\n                color_cube += face_str_map[color]\n                face_count[face] += 1;\n            } else {\n                color_cube += color_map[i];\n            }\n        }\n        return color_cube;\n    }\n\n\n    return {\n        from_cubie,\n        to_unfolded_cube_str,\n        color_of_sticker,\n        color_of_e,\n        as_actrm,\n        as_kata,\n        faces: {\n            u_face, d_face, l_face, r_face, f_face, b_face\n        }\n    }\n}()\n\ntype Mask = {\n    co?: number[],\n    eo?: number[],\n    tp?: number[],\n    cp: number[],\n    ep: number[],\n}\nexport type MaskT = Mask;\nfunction mask_copy (m: Mask) {\n    return {\n        co: m.co && [...m.co],\n        eo: m.eo && [...m.eo],\n        tp: m.tp && [...m.tp],\n        cp: [...m.cp],\n        ep: [...m.ep]\n    }\n}\n\nconst lse_mask: Mask = {\n    cp: [1, 1, 1, 1, 1, 1, 1, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1],\n}\n\nconst lse_4c_mask: Mask = {\n    cp: [1, 1, 1, 1, 1, 1, 1, 1],\n    ep: [0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1],\n    eo: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n}\n\nconst solved_mask : Mask = {\n    cp: [1, 1, 1, 1,  1, 1, 1, 1],\n    ep:[1, 1, 1, 1,  1, 1, 1, 1, 1, 1, 1, 1],\n}\nconst empty_mask : Mask = {\n    cp: [0, 0, 0, 0, 0, 0, 0, 0],\n    ep: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n}\nconst dl_solved_mask : Mask = {\n    cp: [0, 0, 0, 0, 0, 0, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]\n}\nconst bl_solved_mask : Mask = {\n    cp: [0, 0, 0, 0, 0, 0, 0, 0],\n    ep: [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]\n}\nconst fs_back_mask: Mask = {\n    cp: [0, 0, 0, 0, 0, 1, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nconst fs_front_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 0, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nconst fb_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nconst f2b_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 1, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nconst zhouheng_mask: Mask = {\n    cp: [0, 0, 0, 0, 0, 0, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst fbdr_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst ss_front_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 0, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst ss_back_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 1, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst ssdp_front_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 0, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst ssdp_back_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 1, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst ssdp_both_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 1, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nconst sb_mask : Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 1, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1],\n    tp: [0, 0, 0, 0, 1, 1]\n}\nconst cmll_mask : Mask = {\n    cp: [1, 1, 1, 1, 1, 1, 1, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nlet CubeUtil = (() => {\n    let is_cube_solved = (cube: CubieCube) => {\n        let id = new CubieCube()\n        return arrayEqual(cube.co, id.co) &&\n               arrayEqual(cube.eo, id.eo) &&\n               arrayEqual(cube.cp, id.cp) &&\n               arrayEqual(cube.ep, id.ep)\n    }\n\n    let is_solved = (cube: CubieCube, mask: Mask) => {\n        let {co: co_, cp, eo: eo_, ep, tp: tp_} = mask\n        let co = co_ || cp\n        let eo = eo_ || ep\n        let tp = tp_ || Array(6).fill(1)\n        let c_true = co.every( (_, i) =>  (cp[i] === 0 || cube.cp[i] === i)\n                        && (co[i] === 0 || cube.co[i] === 0) )\n        if (!c_true) return false\n        let e_true = eo.every( (_, i) =>  (ep[i] === 0 || cube.ep[i] === i)\n        && (eo[i] === 0 || cube.eo[i] === 0) )\n        if (!e_true) return false\n        let t_true = tp.every( (_, i) =>  (tp[i] === 0 || cube.tp[i] === i) )\n        return t_true\n    }\n\n    function ext(stickers: StickerT[], f: Face) : StickerExtT[] {\n        return stickers.map(x => {\n            let [a, b, c] = x;\n            return [a,b,c,f]\n        })\n    }\n\n    let { u_face, d_face, l_face, r_face, f_face, b_face } = FaceletCube.faces\n    let stickers = [ ...ext(u_face, U), ...ext(d_face, D),\n        ...ext(l_face, L), ...ext(r_face, R), ...ext(f_face,F),  ...ext(b_face, B)]\n\n    let find_pairs = function() {\n        // enumerate each sticker\n        let edge_stickers = stickers.filter(s => s[2] === Typ.E)\n        let corner_stickers = stickers.filter(s => s[2] === Typ.C)\n\n        let ep_stickers : StickerExtT[][] = Array(12).fill(0).map(_ => Array(0))\n        edge_stickers.map(s => ep_stickers[s[0]].push(s) )\n\n        let cp_stickers : StickerExtT[][] = Array(8).fill(0).map(_ => Array(0))\n        corner_stickers.map(s => cp_stickers[s[0]].push(s))\n\n        const epcp_pairs : [number, number][] = []\n        for (let e = 0; e < 12; e++) {\n            for (let c = 0; c < 8; c++) {\n                let efs = ep_stickers[e]\n                let cfs = cp_stickers[c]\n\n                let match = 0;\n                efs.forEach( (e) => {\n                    cfs.forEach( (c) => { if (e[3] === c[3]) match++ })\n                })\n                if (match === 2) {\n                    epcp_pairs.push( [e, c] )\n                }\n            }\n        }\n\n\n        let get_color = (cube: CubieCube, s: StickerExtT) => {\n            return FaceletCube.color_of_sticker(cube, [s[0], s[1], s[2]] )\n        }\n        let func = (cube: CubieCube) => {\n            // now we process the cube\n            let connected_pairs : [number, number][]= []\n            //console.log(\"All neighboring pairs \", epcp_pairs)\n            for (let [ep, cp] of epcp_pairs) {\n                let efs = ep_stickers[ep]\n                let cfs = cp_stickers[cp]\n                let cnt = 0;\n                efs.forEach( (e) => {\n                    const c = cfs.filter( (c) => e[3] === c[3])[0]\n                    if (get_color(cube, e) === get_color(cube, c)) cnt++;\n                })\n                if (cnt === 2) {\n                    connected_pairs.push([ep, cp])\n                }\n            }\n            return connected_pairs\n        }\n        return func\n    }()\n\n    let is_mask_solved2 = (cube: CubieCube, { co, eo, cp, ep }: Mask, premove: (Move | Move[])[]) => {\n        //let moves = [ [], Move.all[\"U\"], Move.all[\"U'\"], Move.all[\"U2\"] ]\n        co = co || cp\n        eo = eo || ep\n        for (let move of premove) {\n            let cube1 = cube.apply(move)\n            let solved = true\n            for (let i = 0; i < 8 && solved; i++) {\n                if ((co[i] && cube1.co[i] !== 0)\n                    || (cp[i] && cube1.cp[i] !== i)) {\n                    solved = false;\n                }\n            }\n            for (let i = 0; i < 12 && solved; i++) {\n                if ((eo[i] && cube1.eo[i] !== 0)\n                    || (ep[i] && cube1.ep[i] !== i)) {\n                    solved = false;\n                }\n            }\n            if (solved) return true;\n        }\n        return false;\n    }\n\n    const u_premove = [[], Move.all[\"U\"], Move.all[\"U'\"], Move.all[\"U2\"]]\n    const m2_premove = [[], Move.all[\"M2\"]]\n\n    let is_cmll_solved = (cube: CubieCube) => {\n        return is_mask_solved2(cube, lse_mask, u_premove)\n    }\n\n    const oris = [\"\", \"y\", \"y'\", \"y2\", \"x2\", \"x2y\", \"x2y'\", \"x2y2\",\n        \"x\", \"xy\", \"xy'\", \"xy2\", \"x'\", \"x'y\", \"x'y'\", \"x'y2\",\n        \"z\", \"zy\", \"zy'\", \"zy2\", \"z'\", \"z'y\", \"z'y'\", \"z'y2\"];\n    let rebase_to_edge = (cube: CubieCube, ep: number): [CubieCube, string] => {\n        for (let ori of oris) {\n            const cube_rebased = cube.apply(ori)\n            if ((cube_rebased.ep[ep] === ep)) {\n                return [cube_rebased, ori]\n            }\n        }\n        return [cube, \"\"]\n    }\n\n    let get_random_with_mask = ({ co, eo, cp, ep }: Mask): CubieCube => {\n        co = co || cp\n        eo = eo || ep\n        // get_random -- figure out which masks are 0, and assign random to these\n        let random_ori = (ori_mask: number[], typ: Typ) => {\n            let ori = Array(ori_mask.length).fill(0)\n            let mod = (typ === C) ? 3 : 2\n            let sum: number\n            do {\n                sum = 0\n                for (let i in ori_mask) {\n                    if (ori_mask[i] === 0) {\n                        ori[i] = rand_int(mod)\n                        sum += ori[i]\n                    }\n                }\n            } while (sum % mod > 0)\n            return ori\n        }\n        let random_perm = (perm_mask: number[]) => {\n            let perm: number[] = Array(perm_mask.length).fill(0)\n            let undecided: number[] = []\n            for (let i = 0; i < perm_mask.length; i++) {\n                if (perm_mask[i] === 0) {\n                    undecided.push(i)\n                } else {\n                    perm[i] = i\n                }\n            }\n            rand_shuffle(undecided)\n            for (let i = 0, cnt = 0; i < perm_mask.length; i++) {\n                if (perm_mask[i] === 0) {\n                    perm[i] = undecided[cnt]\n                    cnt += 1\n                }\n            }\n            return perm\n        }\n        let cp_rand, ep_rand, par\n        do {\n            [cp_rand, ep_rand] = [random_perm(cp), random_perm(ep)]\n            par = (getParity(cp_rand) + getParity(ep_rand)) & 1\n        } while (par > 0)\n\n        return new CubieCube({\n            co: random_ori(co, C),\n            cp: cp_rand,\n            eo: random_ori(eo, E),\n            ep: ep_rand,\n        })\n    }\n\n    let get_random_lse = (): CubieCube => {\n        let cube = get_random_with_mask(lse_mask)\n        return cube.apply(rand_choice(m2_premove))\n    }\n\n\n\n    return {\n        is_cmll_solved,\n        is_solved,\n        get_random_lse,\n        get_random_with_mask,\n        is_cube_solved,\n        find_pairs,\n        stickers,\n        rebase_to_edge\n    }\n})()\n\nexport abstract class Storage {\n    abstract name: string;\n    abstract serialize(): string;\n    abstract deserialize(x: string): void;\n    abstract _setDefault(): void;\n    save() {\n        window.localStorage.setItem(this.name, this.serialize());\n    }\n    load() {\n        const item = window.localStorage.getItem(this.name)\n        if (item) this.deserialize(item);\n        else this._setDefault();\n    }\n}\n\nexport class ColorScheme extends Storage {\n    // UDFBLR\n    // specify the colors for uf\n    // how to do this?\n    static default_colors = {\n        \"G\": \"#00b500\",\n        \"B\": \"#0000ff\",\n        \"R\": \"#ff0000\",\n        \"O\": \"#ff8800\",\n        \"Y\": \"#ffff00\",\n        \"W\": \"#ffffff\",\n        \"X\": \"#bfbfbf\"\n    }\n    name = \"colorscheme\";\n    colors: {[key:string]:string} = {};\n    // UDFBLR from UF\n    // INFERR UFR from UF?\n    static valid_schemes = [\n        \"WYGBOR\",\n        \"WYBGRO\",\n        \"WYROGB\",\n        \"WYORBG\",\n        \"YWGBRO\",\n        \"YWBGOR\",\n        \"YWROBG\",\n        \"YWORGB\",\n\n        \"GBWYRO\",\n        \"GBYWOR\",\n        \"GBROYW\",\n        \"GBORWY\",\n        \"BGWYOR\",\n        \"BGYWRO\",\n        \"BGROWY\",\n        \"BGORYW\",\n\n        \"ORWYGB\",\n        \"ORYWBG\",\n        \"ORGBYW\",\n        \"ORBGWY\",\n        \"ROWYBG\",\n        \"ROYWGB\",\n        \"ROGBWY\",\n        \"ROBGYW\",\n    ]\n    static valid_schemes_map = function() {\n        return new Map(ColorScheme.valid_schemes.map(x => [ x[0] + x[2], x]))\n    }();\n    constructor(suppressLoad?: boolean) {\n        super();\n        if (!suppressLoad) {\n            this.load();\n        }\n    }\n    toUserInput() {\n        return \"GBROYWX\".split('').map(x => this.colors[x])\n    }\n    set( colors:{[key:string]:string} | string[]) {\n        let newScheme = new ColorScheme(true);\n        if (Array.isArray(colors)) {\n            colors.forEach( (color, i) => newScheme.colors[\"GBROYWX\"[i]] = color )\n        } else {\n            newScheme.colors = {...this.colors, ...colors};\n        }\n        newScheme.save();\n        return newScheme\n    }\n    setWithDefault() {\n        let newScheme = new ColorScheme(true);\n        newScheme._setDefault();\n        newScheme.save();\n        return newScheme\n    }\n    _setDefault() { this.colors = ColorScheme.default_colors; };\n    serialize() {\n        return JSON.stringify(this.colors)\n    }\n    deserialize(s: string) {\n        this.colors = JSON.parse(s)\n    }\n    getColorsForOri(s: string) {\n        let faces = (ColorScheme.valid_schemes_map.get(s) || ColorScheme.valid_schemes_map.get(\"WG\")) + \"X\";\n        let arr : string[] = []\n        for (let i = 0; i < faces.length; i++) {\n            arr.push(this.colors[faces[i]]!)\n        }\n        return arr\n    }\n}\n\nlet Mask = {\n    lse_mask, fs_back_mask, fs_front_mask, fbdr_mask, fb_mask, f2b_mask, sb_mask, cmll_mask, ss_front_mask, ss_back_mask,\n    ssdp_front_mask, ssdp_back_mask, ssdp_both_mask, empty_mask, dl_solved_mask, bl_solved_mask, solved_mask, zhouheng_mask, lse_4c_mask,\n    copy: mask_copy\n}\n\nexport { FaceletCube, CubeUtil, Mask }\n","import React from 'react'\n\nimport {\n  FormControlLabel,\n  FormGroup,\n  Button,\n  Box,\n  FormControl,\n  FormLabel,\n  RadioGroup,\n  Checkbox,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n} from '@mui/material';\n\nimport makeStyles from '@mui/styles/makeStyles';\n\nimport { styled } from '@mui/material/styles';\n\nimport SettingsIcon from '@mui/icons-material/Settings';\n\nimport Radio from '@mui/material/Radio';\n\nimport { AppState, Action, SliderOpt } from '../Types';\nimport Selector from '../lib/Selector';\nimport Slider, { SliderThumb } from '@mui/material/Slider';\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      paddingTop: theme.spacing(0),\n      paddingBottom: theme.spacing(2),\n      backgroundColor: theme.palette.background.default\n    },\n    button: {\n      width: \"100%\",\n    },\n    paper: {\n      padding: theme.spacing(3),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    canvasPaper: {\n      padding: theme.spacing(0),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    infoColumn: {\n      color: theme.palette.background.paper\n    },\n    scrambleColumn: {\n      paddingLeft: theme.spacing(3)\n    },\n    textColumn: {\n      // color: \"black\",\n      [theme.breakpoints.up('sm')]: {\n        minHeight: 138\n      },\n    },\n    fixedHeight: {\n      height: 250,\n    },\n    title : {\n        flexGrow: 1,\n    },\n    select: {\n      color: theme.palette.text.primary\n    },\n    selectLabel: {\n      color: theme.palette.text.secondary\n    }\n\n}))\n\nfunction SliderThumbComponent(props: any) {\n  const { children, ...other } = props;\n  return (\n    <SliderThumb {...other}>\n      {children}\n      <span className=\"airbnb-bar\" />\n      <span className=\"airbnb-bar\" />\n      <span className=\"airbnb-bar\" />\n    </SliderThumb>\n  );\n}\n\nconst LevelSlider = styled(Slider)({\n  '& .MuiSlider-markLabel': {\n    fontSize: \"1rem\"\n  }\n})\n\nfunction SliderView(props: {\n  slider: SliderOpt, onChange: (n: number) => void}) {\n  let { slider } = props\n  let classes = useStyles()\n  const handleChange = (_: any, newValue: number|number[]) => {\n      let v = Array.isArray(newValue) ? newValue[0] : newValue\n      if ((slider.l - 1<= v && v <= slider.r))\n        props.onChange(v)\n  }\n  let label = slider.label\n  let marks = React.useMemo(() => {\n    let obj = [{value: slider.l - 1, label: \"Any\"}]\n    for (let i = slider.l; i <= slider.r; i++) {\n      let suffix = \"\"\n      if (i === slider.l && slider.extend_l) suffix = \"-\";\n      if (i === slider.r && slider.extend_r) suffix = \"+\";\n      obj.push({value: i, label: i.toString() + suffix})\n    }\n    return obj\n  }, [slider.l, slider.r, slider.extend_l, slider.extend_r])\n  return (\n  <Box>\n    <FormLabel component=\"legend\" className={classes.selectLabel} >Level</FormLabel>\n    <Box paddingX={5}>\n      <LevelSlider\n      marks={marks}\n      track={false}\n      min={slider.l - 1}\n      max={slider.r}\n      value={slider.value}\n      onChange={handleChange}\n      onFocus={(evt) => evt.target.blur()}\n      style={{fontSize: \"1.2rem\"}}\n      />\n    </Box>\n  </Box>)\n}\n\nfunction SliderSelect(props: {state: AppState, dispatch: React.Dispatch<Action>,\n  select: string}) {\n    let sliderName = props.select\n    let sliderOpt = (props.state.config as any)[sliderName] as SliderOpt\n    return <SliderView\n      slider={(props.state.config as any)[sliderName] as SliderOpt}\n      onChange={(n: number) => {\n        props.dispatch( { type: \"config\",\n         content: { [sliderName]: ({...sliderOpt, value:n }) }\n        } )\n      }}\n    />\n}\n\n\nfunction SingleSelect(props: {state: AppState, dispatch: React.Dispatch<Action>,\n    select: string, label?: string}) {\n  let { state, dispatch, select } = props\n  let { config } = state\n  let sel = (config as any)[select] as Selector\n  let classes = useStyles()\n\n  const handleChange = (evt: { target: { value: string; }; }) => {\n    let { names } = sel\n    let n = names.length\n    let new_flags = Array(n).fill(0)\n\n    for (let i = 0; i < names.length; i++) {\n      if (names[i] === evt.target.value) {\n        new_flags[i] = 1\n      }\n    }\n    dispatch( { type: \"config\", content: {[select]: sel.setFlags(new_flags) } } )\n  }\n\n  let radioValue = function() {\n    let { names, flags } = sel\n    for (let i = 0; i < flags.length; i++) {\n      if (flags[i] === 1) return names[i]\n    }\n    return \"\"\n  }()\n\n\n  let label = sel.label || props.label || \"\"\n  return (\n  <FormControl component=\"fieldset\" className={classes.select}>\n    <FormLabel component=\"legend\" className={classes.selectLabel} >\n      {label}\n    </FormLabel>\n    {/* {sel.annotation ? <Box> <CustomTooltip title={sel.annotation}>\n        <IconButton>\n          <HelpOutlineIcon sx={{ fontSize: 30 }}/>\n        </IconButton>\n      </CustomTooltip> </Box> : null} */}\n    <RadioGroup aria-label=\"position\" name=\"position\" value={radioValue} onChange={handleChange} row>\n      {\n        sel.names.map(name => (\n          <FormControlLabel\n            key={name}\n            value={name}\n            control={<Radio color=\"primary\" />}\n            label={name}\n            labelPlacement=\"end\"\n          />\n        ))\n      }\n    </RadioGroup>\n  </FormControl>)\n}\n\n\n\ntype MultiSelectOptions = {\n  label?: string, noDialog?: boolean,\n  manipulators?: {name: string, enableIdx: number[]}[]\n}\n\n\nfunction MultiSelectContent(props: {state: AppState, dispatch: React.Dispatch<Action>, select: string, options?: MultiSelectOptions }) {\n  let { state, dispatch, select, options } = props\n  options = options || {}\n  let { config } = state\n\n  let sel = (config as any)[select] as Selector\n  const handleChange = (evt: { target: { value: string; checked: boolean }; }) => {\n    let { names, flags } = sel\n    let new_flags = [...flags]\n\n    for (let i = 0; i < names.length; i++) {\n      if (names[i] === evt.target.value) {\n        new_flags[i] = (evt.target.checked)? 1 : 0\n      }\n    }\n    dispatch( { type: \"config\", content: {[select]: sel.setFlags(new_flags) } } )\n  }\n\n  let makeBox = (name: string, checked: boolean) => {\n    return (\n    <FormControlLabel\n        control={\n        <Checkbox color=\"primary\" checked={checked} onChange={handleChange} />\n        }\n        label={name}\n        key={name}\n        value={name}\n    />)\n  }\n\n  const [manipChecked, setManipChecked] = React.useState< { [ name: string ]: boolean } >({})\n  let label = sel.label || options.label || \"\"\n  let makeManipulator = (manip: {name: string, enableIdx: number[]}) => {\n    let {name, enableIdx} = manip\n    let handleChange = (evt: { target: { value: string; checked: boolean }; }) => {\n      setManipChecked( {...manipChecked, [name] : evt.target.checked } )\n      let fillValue = (evt.target.checked);\n      let { flags } = sel\n      let new_flags = [...flags]\n      for (let i of enableIdx) {\n        new_flags[i] = fillValue ? 1 : 0;\n      }\n      dispatch( { type: \"config\", content: {[select]: sel.setFlags(new_flags) } } )\n    }\n    return (\n      <FormControlLabel\n      control={\n      <Checkbox color=\"primary\" checked={manipChecked[name]} onChange={handleChange} />\n      }\n      label={name}\n      key={name}\n      value={name}\n      />)\n  }\n  let manipulator_row = options.manipulators ?\n    (<FormGroup row>\n    {options.manipulators.map(x => makeManipulator(x)) }\n    </FormGroup>) : null;\n  const content = (\n    <React.Fragment>\n      {manipulator_row}\n      <FormGroup row>\n      {sel.names.map( (name, i) => makeBox(name, !!sel.flags[i]))}\n      </FormGroup>\n    </React.Fragment>\n  )\n  return {label, content}\n}\n\nfunction MultiSelect(props: {state: AppState, dispatch: React.Dispatch<Action>, select: string, options?: MultiSelectOptions }) {\n  let { state, dispatch, select, options } = props\n  let {label, content} = MultiSelectContent({state, dispatch, select, options})\n  options = options || {}\n\n  const [open, setOpen] = React.useState(false);\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n  const handleClose = () => {\n    setOpen(false);\n  }\n  let classes = useStyles()\n\n  if (options.noDialog)\n  return (\n    <FormControl component=\"fieldset\" className={classes.select}>\n      <FormLabel component=\"legend\"className={classes.selectLabel} >{label}</FormLabel>\n      {content}\n    </FormControl>\n  )\n\n  return (\n  <Box>\n    <FormLabel component=\"legend\">{label}</FormLabel>\n    <Box height={8}/>\n    <Button color=\"primary\" variant=\"outlined\" style={{borderWidth: 2}} onClick={handleClickOpen}>\n    <SettingsIcon fontSize=\"small\" color=\"primary\" style={{marginLeft: -6, marginRight: 3}}></SettingsIcon>\n      Edit\n    </Button>\n    <Box height={8}/>\n    <Dialog disableEscapeKeyDown open={open} onClose={handleClose}>\n      <DialogTitle> {label} </DialogTitle>\n      <DialogContent>\n        {content}\n      </DialogContent>\n      <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            Ok\n          </Button>\n      </DialogActions>\n    </Dialog>\n  </Box>\n  )\n}\n\n\nexport { SingleSelect, MultiSelectContent, MultiSelect, SliderSelect }","import React, { Fragment } from 'react'\n\nimport {\n    TextField,\n    Divider,\n    Button, Box,\n    FormLabel, Dialog, DialogTitle, DialogContent, DialogActions\n} from '@mui/material';\n\nimport SettingsIcon from '@mui/icons-material/Settings';\n\nimport { AppState, Action } from '../Types';\nimport { Config } from '../Config';\nimport { ColorScheme } from '../lib/CubeLib';\n\nimport { MultiSelectContent } from './SelectorViews';\n\nexport function ColorSetter(props: {state: AppState, dispatch: React.Dispatch<Action>}) {\n    const [text, setText] = React.useState(props.state.colorScheme.toUserInput().join(\",\"))\n    const handleChange = (event: any) => setText(event.target.value);\n    const handleClick = () => {\n        let arr = text.split(\",\")\n        props.dispatch({\n            type: \"colorScheme\",\n            content: arr.length === 7? arr : ColorScheme.default_colors\n        })\n    }\n    return (\n        <Fragment>\n        <Box>\n        <TextField\n            label=\"Color\"\n            helperText=\"G,B,R,O,Y,W,Gray\"\n            onChange={handleChange}\n            fullWidth\n            value={text}\n        /></Box>\n\n        <Box>\n        <Button variant=\"outlined\" size=\"medium\" color=\"primary\" onClick={handleClick} >\n            Set color\n        </Button>\n        </Box>\n        </Fragment>\n    )\n}\n\nexport function ColorPanel(props: {state: AppState, dispatch: React.Dispatch<Action>}) {\n    let { state, dispatch } = props\n    let select = \"orientationSelector\"\n    let {content} = MultiSelectContent({state, dispatch, select})\n\n    const [open, setOpen] = React.useState(false);\n    const handleClickOpen = () => {\n      setOpen(true);\n    };\n    const handleClose = (e: any, reason: string) => {\n      if (reason === \"backdropClick\") \n        setOpen(false);\n    }\n    return (\n        <div>\n        <FormLabel component=\"legend\">Orientation and Color Scheme</FormLabel>\n        <Box height={8}/>\n        <Button color=\"primary\" variant=\"outlined\" style={{borderWidth: 2}} onClick={handleClickOpen}>\n        <SettingsIcon fontSize=\"small\" color=\"primary\" style={{marginLeft: -6, marginRight: 3}}></SettingsIcon>\n          Edit\n        </Button>\n        <Box height={8}/>\n        <Dialog disableEscapeKeyDown open={open} onClose={handleClose}>\n          <DialogTitle> Set Orientation (U-F) and Color Scheme  </DialogTitle>\n          <DialogContent>\n            {content}\n            <Box height={20}/>\n                <Divider />\n            <Box height={20}/>\n            <ColorSetter {...{state, dispatch}}/>\n\n          </DialogContent>\n          <DialogActions>\n              <Button onClick={() => setOpen(false)} color=\"primary\">\n                  Close\n              </Button>\n          </DialogActions>\n        </Dialog>\n      </div>\n    )\n}","import React, { useEffect } from 'react'\nimport * as SRVisualizer from 'sr-visualizer'\nimport { MoveSeq } from '../lib/CubeLib'\nimport {Face as VFace} from 'sr-visualizer'\n\n\nfunction CaseVisualizer(props: {name: string, alg: string,size: number, mask?: string, color?: string[], cubeOptions: Partial<SRVisualizer.CubeOptions>}) {\n  const mount = React.useRef<HTMLDivElement | null>(null)\n  useEffect( () => {\n    let dom = mount.current\n    if (dom) {\n      const args = {\n        width: props.size,\n\t      height: props.size,\n        view: 'plan',\n\t      algorithm: new MoveSeq(props.alg).inv().toString(),\n        mask: props.mask as SRVisualizer.Masking,\n        ...props.cubeOptions\n      }\n      const color = props.color\n      if (color) {\n        // map our scheme (UDFBLR) to theirs (URFDLB)\n        args.colorScheme = [\n          color[0],\n          color[5],\n          color[2],\n          color[1],\n          color[4],\n          color[3],\n        ]\n      }\n      SRVisualizer.cubeSVG(dom, args)\n    }\n    return () => {\n      if (dom) dom.innerHTML = \"\"\n    }\n  })\n  return (<div ref={mount}>\n  </div>)\n}\n\nexport default CaseVisualizer;","import React from 'react';\nimport { FormLabel, Box, Button, Dialog, DialogTitle, DialogContent, DialogActions, FormControl } from '@mui/material';\nimport SettingsIcon from '@mui/icons-material/Settings';\n\nexport interface DialogProps {\n  label: string,\n  title?: string,\n}\nexport interface DialogOptions {\n  fullWidth? : boolean\n}\nconst defaultOptions = {\n  fullWidth: false\n}\n\nconst makeDialog = <P extends object>(\n  Component: React.ComponentType<P>, options?: DialogOptions\n) => (function DialogView(props: P & DialogProps) {\n  options = options || defaultOptions\n  const title = props.title || props.label\n  const [open, setOpen] = React.useState(false);\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n  const handleClose = () => {\n    setOpen(false);\n  }\n\n  return (\n  <Box>\n    <FormLabel component=\"legend\">{props.label}</FormLabel>\n    <Box height={8}/>\n    <Button color=\"primary\" variant=\"outlined\" style={{borderWidth: 2}} onClick={handleClickOpen}>\n      <SettingsIcon fontSize=\"small\" color=\"primary\" style={{marginLeft: -6, marginRight: 3}}></SettingsIcon>\n        {\"SELECT\"}\n    </Button>\n    <Box height={8}/>\n\n\n    <Dialog disableEscapeKeyDown open={open} onClose={handleClose} maxWidth=\"md\" style={{marginLeft: 10,marginRight: 10}}>\n      <DialogTitle> {title} </DialogTitle>\n      <DialogContent >\n        <Box paddingLeft={1}>\n          <Component {...props}/>\n        </Box>\n      </DialogContent>\n      <DialogActions>\n          <Button onClick={handleClose} color=\"primary\" size=\"large\" >\n            {\"CLOSE\" }\n          </Button>\n      </DialogActions>\n    </Dialog>\n    </Box>\n  )\n\n})\n\nexport {makeDialog}","import { red } from '@mui/material/colors';\nimport { createTheme, adaptV4Theme } from '@mui/material/styles';\n\n// A custom theme for this app\nconst components = {\n  components: {\n    MuiSlider: {\n      styleOverrides: {\n        root: {\n          height: 100\n        },\n        track: {\n          height: 100\n        }\n      }\n      \n    }\n  }\n}\nconst theme = createTheme(adaptV4Theme({\n  name: \"bright\",\n  palette: {\n    primary: {\n      main: '#556cd6',// '#e0e8ff'//b0c4ee', //\n    },\n    secondary: {\n      main: '#d32f2f',\n    },\n    error: {\n      main: red.A400,\n    },\n    background: {\n      default: '#eeeeef',\n      paper: '#fff'\n    },\n    text: {\n      primary: '#000',\n      secondary: '#888',\n      disabled: '#556cd6'\n    }\n  },\n  ...components\n  /*\n  typography: {\n    \"fontFamily\": `\"Public Sans\", \"Roboto\", \"Helvetica\", \"Arial\", sans-serif`,\n    \"fontSize\": 14,\n    \"fontWeightLight\": 400,\n    \"fontWeightRegular\": 500,\n    \"fontWeightMedium\": 600\n  }\n  */\n\n}));\nconst themeDark = createTheme(adaptV4Theme({\n  name: \"dark\",\n  palette: {\n    primary: {\n      main: '#9FA4C2', // '#757575',\n    },\n    secondary: {\n      main: '#ffffff', //f55057',\n    },\n    error: {\n      main: red.A400,\n    },\n    background: {\n      default: '#121212',\n      paper: '#252525' //#424242'\n    },\n    text: {\n      primary: '#fff',\n      secondary: '#ddd',\n      disabled: '#eee'\n    }\n  },\n  overrides: {\n    // Style sheet name ⚛️\n    MuiDivider: {\n      // Name of the rule\n      // Some CSS\n      root: {\n        backgroundColor: 'rgba(255, 255 ,255, 0.3)',\n      }\n    },\n  },\n  ...components\n\n}));\n\nexport { theme, themeDark };","import Grid from '@mui/material/Grid'\nimport Box from '@mui/material/Box'\nimport React from 'react'\nimport CaseVisualizer from './CaseVisualizer'\n\nimport { AppState, Action } from \"../Types\";\nimport { makeDialog } from './Dialog';\nimport SRVisualizer from 'sr-visualizer';\n\nimport { Button, ButtonGroup, Divider, Typography, useMediaQuery } from '@mui/material';\nimport makeStyles from '@mui/styles/makeStyles';\nimport Selector from '../lib/Selector';\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\nimport CancelIcon from '@mui/icons-material/Cancel';\nimport { theme } from '../theme';\n\ntype CaseSelectSettings = {\n  selector: string,\n  algs: [string, string][],\n  groups: string[],\n  cubeOptions?: Partial<SRVisualizer.CubeOptions>,\n  visualizeMask: string\n}\n\nfunction splitAlgIntoGroups(algs: [string, string][], groups: string[], flags: number[]) {\n  const algGroups : { [k: string] : [[string, string], number][] }= Object.fromEntries(groups.map(g => [g, []]))\n  algs.forEach((alg, i) => {\n    const prefix = alg[0].split(\"_\", 1)[0]\n    if (prefix in algGroups)\n      algGroups[prefix].push([alg, i])\n  })\n  return algGroups\n}\n\nconst useStyles = makeStyles(theme => {\n  let is_bright = theme.palette.primary.main === '#556cd6'\n  return ({\n    caseBoxOn: {\n      backgroundColor: is_bright ? '#bdedff' : theme.palette.primary.main,\n    },\n    groupBox: {\n    }\n  })\n})\n\nfunction CaseSelectContent(props: { state: AppState, dispatch: React.Dispatch<Action>, settings: CaseSelectSettings }) {\n  let { selector, groups, algs, visualizeMask } = props.settings\n  const sel = (props.state.config as any)[selector] as Selector\n  const algGroups = splitAlgIntoGroups(algs, groups, sel.flags)\n  const handleSelectGroup = (groupname: string, value: number) => () => {\n    const newFlags = [...sel.flags]\n    algGroups[groupname].forEach( ([alg, i]) => {\n      newFlags[i] = value\n    })\n    props.dispatch({ type: \"config\", content: {[selector]: sel.setFlags(newFlags) } } )\n  }\n  const handleSelectCase = (caseIdx: number) => () => {\n    const newFlags = [...sel.flags]\n    newFlags[caseIdx] = (newFlags[caseIdx] === 0) ? 1 : 0\n    props.dispatch({ type: \"config\", content: {[selector]: sel.setFlags(newFlags) } } )\n  }\n  const handleSelectAll = (value: number) => () => {\n    const newFlags = Array(sel.flags.length).fill(value)\n    props.dispatch({ type: \"config\", content: {[selector]: sel.setFlags(newFlags)}})\n  }\n  const classes = useStyles()\n  const gt_sm = useMediaQuery(theme.breakpoints.up('sm'));\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" marginRight={10}>\n      <Box marginBottom={3}>\n        <ButtonGroup color=\"primary\" style={{height: \"2rem\"}}>\n          <Button onClick={handleSelectAll(1)}\n            startIcon={<CheckCircleIcon/>}>Select All</Button>\n          <Button onClick={handleSelectAll(0)}\n            startIcon={<CancelIcon/>}>Deselect All</Button>\n        </ButtonGroup>\n      </Box>\n      {groups.map((groupname, i) => (\n        <Box display=\"flex\" flexDirection={gt_sm ? \"row\" : \"column\"} key={i} className={classes.groupBox} marginBottom={2}>\n          <Box display=\"flex\" flexDirection={gt_sm ? \"column\" : \"row\"} marginRight={4} >\n\n            <Box marginRight={2}>\n            <Typography variant=\"h5\" gutterBottom>\n              {groupname[0].toUpperCase() + groupname.substr(1)}\n            </Typography>\n            </Box>\n            <Box display=\"flex\" alignItems=\"center\">\n              <ButtonGroup color=\"primary\" variant=\"contained\" aria-label=\"outlined primary button group\" style={{height: \"3.7rem\"}}>\n                <Button onClick={handleSelectGroup(groupname, 1)}\n                  startIcon={<CheckCircleIcon/>}></Button>\n                <Button  variant=\"outlined\" onClick={handleSelectGroup(groupname, 0)}\n                  startIcon={<CancelIcon/>}></Button>\n              </ButtonGroup>\n            </Box>\n          </Box>\n          <Box display=\"flex\" flexDirection=\"row\" flexWrap=\"wrap\">\n          {\n            algGroups[groupname].map( ([[name, alg], idx]) =>\n              <Box border={1} borderColor=\"primary.main\"\n                key={name}\n                onClick={handleSelectCase(idx)}\n                style={{transition: \"all .3s ease\" }}\n                className={sel.flags[idx] ? classes.caseBoxOn : \"\"}>\n                <CaseVisualizer\n                  name={name}\n                  size={100}\n                  alg={alg}\n                  mask={visualizeMask}\n                  cubeOptions={props.settings.cubeOptions || {}}\n                />\n              </Box>\n            )\n          }\n          </Box>\n          <Divider></Divider>\n        </Box>\n      ))}\n    </Box>\n  )\n}\n\nconst CaseSelectDialog = makeDialog(CaseSelectContent) // {fullWidth: true})\n\nexport default CaseSelectDialog;","import { Cases } from \"@mui/icons-material\";\nimport Selector from \"../lib/Selector\";\nimport { rand_choice } from \"./Math\";\n\nconst get_active_names = (sel : Selector) => {\n    let res = []\n    for (let i = 0; i < sel.names.length; i++) {\n        if (sel.flags[i]) {\n            res.push(sel.names[i]);\n        }\n    }\n    return res\n}\n\nexport type CaseDesc = {\n    id: string,\n    algs: string[],\n    setup?: string,\n    kind: string\n}\n\nexport let createAlg = (id: string, alg: string | string[], kind:string, setup?: string) : CaseDesc => ({\n    id, algs:Array.isArray(alg) ? alg : [alg], kind, setup\n})\n\nconst empty_alg = createAlg(\"empty\", \"\", \"any\")\n\nexport const cmll_algs_raw : [string,string][] = [\n    [\"o_adjacent_swap\", \"R U R' F' R U R' U' R' F R2 U' R'\"],\n    [\"o_diagonal_swap\", \"F R U' R' U' R U R' F' R U R' U' R' F R F'\"],\n    [\"h_columns\", \"U' R U R' U R U' R' U R U2 R'\"],\n    [\"h_rows\", \"F R U R' U' R U R' U' R U R' U' F'\"],\n    [\"h_column\", \"U' R U2' R2' F R F' U2 R' F R F'\"],\n    [\"h_row\", \"r U' r2' D' r U' r' D r2 U r'\"],\n    [\"pi_right_bar\", \"F R U R' U' R U R' U' F'\"],\n    [\"pi_back_slash\", \"U F R' F' R U2 R U' R' U R U2' R'\"],\n    [\"pi_x_checkerboard\", \"U' R' F R U F U' R U R' U' F'\"],\n    [\"pi_forward_slash\", \"R U2 R' U' R U R' U2' R' F R F'\"],\n    [\"pi_columns\", \"U' r U' r2' D' r U r' D r2 U r'\"],\n    [\"pi_left_bar\", \"U' R' U' R' F R F' R U' R' U2 R\"],\n    [\"u_forward_slash\", \"U2 R2 D R' U2 R D' R' U2 R'\"],\n    [\"u_back_slash\", \"R2' D' R U2 R' D R U2 R\"],\n    [\"u_front_row\", \"R' U' R U' R' U2 R2 U R' U R U2 R'\"],\n    [\"u_rows\", \"U' F R2 D R' U R D' R2' U' F'\"],\n    [\"u_x_checkerboard\", \"U2 r U' r' U r' D' r U' r' D r\"],\n    [\"u_back_row\", \"U' F R U R' U' F'\"],\n    [\"t_left_bar\", \"U' R U R' U' R' F R F'\"],\n    [\"t_right_bar\", \"U L' U' L U L F' L' F\"],\n    [\"t_rows\", \"R U2 R' U' R U' R2' U2' R U R' U R\"],\n    [\"t_front_row\", \"r' U r U2' R2' F R F' R\"],\n    [\"t_back_row\", \"r' D' r U r' D r U' r U r'\"],\n    [\"t_columns\", \"U2 r2' D' r U r' D r2 U' r' U' r\"],\n    [\"s_left_bar\", \"R U R' U R U2 R'\"],\n    [\"s_x_checkerboard\", \"L' U2 L U2' L F' L' F\"],\n    [\"s_forward_slash\", \"F R' F' R U2 R U2' R'\"],\n    [\"s_columns\", \"R U R' U' R' F R F' R U R' U R U2' R'\"],\n    [\"s_right_bar\", \"U2' R U R' U R' F R F' R U2' R'\"],\n    [\"s_back_slash\", \"R U' L' U R' U' L\"],\n    [\"as_right_bar\", \"U' R U2' R' U' R U' R'\"],\n    [\"as_columns\", \"R2 D R' U R D' R' U R' U' R U' R'\"],\n    [\"as_back_slash\", \"F' r U r' U2' r' F2 r\"],\n    [\"as_x_checkerboard\", \"R U2' R' U2' R' F R F'\"],\n    [\"as_forward_slash\", \"L' U R U' L U R'\"],\n    [\"as_left_bar\", \"U2' R U2' R' F R' F' R U' R U' R'\"],\n    [\"l_mirror\", \"F R U' R' U' R U R' F'\"],\n    [\"l_inverse\", \"F R' F' R U R U' R'\"],\n    [\"l_pure\", \"U2 R U R' U R U' R' U R U' R' U R U2' R'\"],\n    [\"l_front_commutator\", \"R U2 R D R' U2 R D' R2'\"],\n    [\"l_diag\", \"U2 R' U' R U R' F' R U R' U' R' F R2\"],\n    [\"l_back_commutator\", \"U' R' U2 R' D' R U2 R' D R2\"],\n    //[\"solved\", \"\"] // commenting out as it's unclear why we're ever interested in a solved state\n]\n\nexport const ollcp_algs_raw : [string,string][] = [\n    [\"34_T_1\" , \"R' U' R U' R' U F R U' R' U2 R U R' F' R\"],\n    [\"34_T_2\" , \"R' U' R' F R F' R U' R' U R U' R' U2 R\"],\n    [\"34_T_3\" , \"F R F' r U r' U R' U' r U' r'\"],\n    [\"34_T_4\" , \"F' U' F U r U R' U' M\"],\n    [\"34_T_5\" , \"R U' R' F R U R' U' R U R' U' F' U R U' R'\"],\n    [\"34_T_6\" , \"R U R2 U' R' F R U R U' F'\"],\n    [\"39_L_1\" , \"R U R' U R U2' R2 U' F U R U' R' F' R\"],\n    [\"39_L_2\" , \"F R U R' U' F' R' U' R U' R' U2 R\"],\n    [\"39_L_3\" , \"R U' r' U' F' U F r R'\"],\n    [\"39_L_4\" , \"r U R U' r' F U R' U' F'\"],\n    [\"39_L_5\" , \"R U2 R' U' R U R' F2 r U r' F\"],\n    [\"39_L_6\" , \"R' U' R U' R U R' U' R' U2 F R F'\"],\n    [\"45_U_1\" , \"R U R' U' R' F R2 U' R' U' R U2 R' U' F'\"],\n    [\"45_U_2\" , \"F R U R' U' F'\"],\n    [\"45_U_3\" , \"R' U' R F R' U R U' R U R' U' F'\"],\n    [\"45_U_4\" , \"R' F R U R' U' F' U R2 U2 R' U' R U' R'  \"],\n    [\"45_U_5\" , \"R' U' R U' R' U2 R r U R' U R U2 r'\"],\n    [\"45_U_6\" , \"R' U2 R U2 F R U R' U' R' U R U' F'\"],\n    [\"51_Pi_1\", \"R' U2 R U2 R U R' U' R' F R F' R' U R\"],\n    [\"51_Pi_2\", \"R' U' R' F R F' R U' R' U2 R\"],\n    [\"51_Pi_3\", \"R U2 R' U2 R' F R2 U R' U' F'\"],\n    [\"51_Pi_4\", \"R U R' U R U' R' F' U F R U R' U' R U' R'\"],\n    [\"51_Pi_5\", \"f R U R' U' R U R' U' f'\"],\n    [\"51_Pi_6\", \"R' U2 R U2 F R U R' U' F' R' U R\"],\n    [\"56_H_1\" , \"F R U R' U' R F' r U R' U' r'\"],\n    [\"56_H_2\" , \"f U R U' R' U R U' R' S' U R U' R' F'\"],\n    [\"56_H_3\" , \"r U R' U R U r' U' r U r' F' U F\"],\n    [\"56_H_4\" , \"r' U' r U' R' U R U' R' U R r' U r\"],\n    [\"13_S_1\" , \"F U R U2 R' U' R U R' F'\"],\n    [\"13_S_2\" , \"R' U2 R U R' U R U' f R U R' U' f'\"],\n    [\"13_S_3\" , \"R U R' U' R' F R F' R U R' U R U2 R'\"],\n    [\"13_S_4\" , \"r U' r' U' r U r' F' U F\"],\n    [\"13_S_5\" , \"R' U' r U' R' U' R U r' U' R U' R' U' R\"],\n    [\"13_S_6\" , \"F U R U' R2 F' R U R U' R'\"],\n    [\"14_AS_1\", \"U F R U' R' U R U R' F' R U2 R' U' R U' R'\"],\n    [\"14_AS_2\", \"R U R' U R U' R' U R' F R F' R U2 R'\"],\n    [\"14_AS_3\", \"U2 R' U' R F U R U' R' F' U' R' U R\"],\n    [\"14_AS_4\", \"U R' U R U' M' F U R' U' R F' M\"],\n    [\"14_AS_5\", \"U' R U R' U r' U' R2 U' R2 U2 r\"],\n    [\"14_AS_6\", \"U' R U2 R' U2 R U' R' F' U' F R U R'\"],\n]\n\nexport const nmcll_to_cmll_mapping : [string, [string, string][]][] = [\n    [\"o_1\",\n       [[\"h_rows\", \"\"],\n        [\"pi_columns\", \"\"],\n        [\"h_columns\", \"\"],\n       ]\n    ],\n    [\"o_2\",\n        [[\"pi_x_checkerboard\", \"U\"]],\n    ],\n    [\"s_1\", [\n        [\"as_right_bar\", \"U\"],\n        [\"t_right_bar\", \"U\"],\n        [\"l_diag\",\"U\"],\n        [\"as_forward_slash\", \"U\"]\n    ]],\n    [\"s_2\", [\n        [\"u_forward_slash\", \"U\"],\n        [\"as_left_bar\", \"U\"],\n        [\"l_pure\", \"\"],\n        [\"as_x_checkerboard\", \"U\"]\n    ]],\n    [\"s_3\", [\n        [\"u_back_slash\", \"U\"],\n        [\"t_left_bar\", \"\"],\n        [\"as_back_slash\", \"U\"],\n        [\"as_columns\", \"\"]\n    ]],\n    [\"as_1\", [\n        [\"t_left_bar\", \"U\"],\n        [\"s_left_bar\", \"\"],\n        [\"l_diag\", \"\"],\n        [\"s_back_slash\", \"U\"]\n    ]],\n    [\"as_2\", [\n        [\"u_back_slash\", \"\"],\n        [\"s_right_bar\", \"U\"],\n        [\"l_pure\", \"U\"],\n        [\"s_x_checkerboard\", \"U\"]\n    ]],\n    [\"as_3\", [\n        [\"s_forward_slash\", \"U\"],\n        [\"t_right_bar\", \"\"],\n        [\"u_forward_slash\", \"\"],\n        [\"s_columns\", \"\"]\n    ]],\n    [\"t_1\", [\n        [\"u_back_row\", \"U\"],\n        [\"t_back_row\", \"\"],\n        [\"h_row\", \"\"],\n        [\"pi_right_bar\", \"U\"],\n    ]],\n    [\"t_2\", [\n        [\"u_front_row\", \"U\"],\n        [\"as_back_slash\", \"\"],\n        [\"s_forward_slash\", \"\"],\n        [\"pi_left_bar\", \"U\"]\n    ]],\n    [\"t_3\", [\n        [\"t_front_row\", \"U\"],\n        [\"as_forward_slash\", \"\"],\n        [\"s_back_slash\", \"\"],\n        [\"h_row\", \"U\"]\n    ]],\n    [\"u_1\", [\n        [\"u_rows\", \"\"],\n        [\"t_rows\", \"\"],\n        [\"pi_left_bar\", \"\"],\n        [\"h_column\", \"U\"],\n    ]],\n    [\"u_2\", [\n        [\"t_columns\", \"\"],\n        [\"s_columns\", \"U\"],\n        [\"as_columns\", \"U\"],\n        [\"pi_right_bar\", \"\"],\n    ]],\n    [\"u_3\", [\n        [\"u_x_checkerboard\", \"U\"],\n        [\"s_x_checkerboard\", \"\"],\n        [\"as_x_checkerboard\", \"\"],\n        [\"h_column\", \"\"],\n    ]],\n    [\"l_1\", [\n        [\"l_inverse\", \"\"],\n        [\"as_right_bar\", \"\"],\n        [\"s_right_bar\", \"\"],\n        [\"pi_forward_slash\", \"U\"],\n    ]],\n    [\"l_2\", [\n        [\"l_mirror\", \"\"],\n        [\"as_left_bar\", \"\"],\n        [\"s_left_bar\", \"U\"],\n        [\"pi_back_slash\", \"\"],\n    ]],\n    [\"l_3\", [\n        [\"l_back_commutator\", \"\"],\n        [\"l_front_commutator\", \"\"],\n        [\"pi_forward_slash\", \"\"],\n        [\"pi_back_slash\", \"U\"],\n    ]],\n    [\"pi_1\", [\n        [\"o_adjacent_swap\", \"\"],\n        [\"u_front_row\", \"\"],\n        [\"t_columns\", \"U\"],\n        [\"pi_x_checkerboard\", \"\"],\n    ]],\n    [\"pi_2\", [\n        [\"u_back_row\", \"\"],\n        [\"l_front_commutator\", \"U\"],\n        [\"l_back_commutator\", \"U\"],\n        [\"t_rows\", \"U\"],\n    ]],\n    [\"pi_3\", [\n        [\"o_adjacent_swap\", \"U\"],\n        [\"l_mirror\", \"U\"],\n        [\"l_inverse\", \"U\"],\n        [\"pi_columns\", \"U\"],\n    ]],\n    [\"h_1\", [\n        [\"solved\", \"U\"],\n        [\"t_front_row\", \"\"],\n        [\"h_rows\", \"U\"]\n    ]],\n    [\"h_2\", [\n        [\"o_diagonal_swap\", \"U\"],\n        [\"u_x_checkerboard\", \"\"],\n        [\"h_columns\", \"U\"]\n    ]],\n    [\"h_3\", [\n        [\"u_rows\", \"U\"],\n        [\"t_back_row\", \"U\"]\n    ]]\n]\n\nconst cmll_algs_raw_lookup = Object.fromEntries(cmll_algs_raw)\nconst nmcll_algs: CaseDesc[] = nmcll_to_cmll_mapping.map(([group_name, cases]) => {\n        return cases.map(([cmll_name, parity]) =>\n        [`nmcll-${group_name}-${cmll_name}`, cmll_algs_raw_lookup[cmll_name] + \" \" + parity])\n    }).flat().map( ([x, y]) => createAlg(x, y, \"nmcll\"))\n\nexport const nmcll_display_parity : [string, string, string][] = [\n [\"o_1\", \"U\", \"\"],\n [\"o_2\", \"\", \"\"],\n [\"s_1\", \"\", \"U\"],\n [\"s_2\", \"U\", \"U\"],\n [\"s_3\", \"\", \"U\"],\n [\"as_1\",\"\", \"U2\"],\n [\"as_2\",\"U\", \"U'\"],\n [\"as_3\",\"\", \"\"],\n [\"t_1\", \"\", \"U2\"],\n [\"t_2\", \"\", \"U2\"],\n [\"t_3\", \"\", \"U2\"],\n [\"u_1\", \"U\", \"U2\"],\n [\"u_2\", \"U\", \"U2\"],\n [\"u_3\", \"\", \"U2\"],\n [\"l_1\", \"U\", \"\"],\n [\"l_2\", \"U\", \"U2\"],\n [\"h_3\", \"\", \"\"],\n [\"pi_1\",\"\", \"U2\"],\n [\"pi_2\",\"U\", \"U'\"],\n [\"pi_3\",\"\", \"U2\"],\n [\"l_3\", \"U\", \"\"],\n [\"h_1\", \"\", \"\"],\n [\"h_2\", \"\", \"\"],\n]\nconst cmll_algs : CaseDesc[] = cmll_algs_raw.map( ([x, y]) => createAlg(x, y, \"cmll\"))\n\nlet trigger_algs: CaseDesc[] = [\n    createAlg(\"RUR'_1\", \"R U R'\", \"trigger\"),\n    createAlg(\"RUR'_2\", \"r U r'\", \"trigger\"),\n    createAlg(\"RU'R'_1\", \"R U' R'\", \"trigger\"),\n    createAlg(\"RU'R'_2\", \"r U' r'\", \"trigger\"),\n    createAlg(\"R'U'R_1\", \"R' U' R\", \"trigger\"),\n    createAlg(\"R'U'R_2\", \"r' U' r\", \"trigger\"),\n    createAlg(\"R'UR_1\", \"R' U R\", \"trigger\"),\n    createAlg(\"R'UR_2\", \"r' U r\", \"trigger\"),\n    createAlg(\"RU2R'_1\", \"R U2 R'\", \"trigger\"),\n    createAlg(\"RU2R'_2\", \"r U2 r'\", \"trigger\"),\n    createAlg(\"R'U2R_1\", \"R' U2 R\", \"trigger\"),\n    createAlg(\"R'U2R_2\", \"r' U2 r\", \"trigger\"),\n]\n\nlet u_auf_algs: CaseDesc[] = [\n    createAlg(\"U\", \"U\", \"u_auf\"),\n    createAlg(\"U'\", \"U'\", \"u_auf\"),\n    createAlg(\"U2\", \"U2\", \"u_auf\"),\n    createAlg(\"None\", \"\", \"u_auf\"),\n]\n\nlet ori_algs: CaseDesc[] =\n    [\"WG\", \"WB\", \"WO\", \"WR\",\n    \"YG\", \"YB\", \"YO\", \"YR\",\n    \"BW\", \"BY\", \"BO\", \"BR\",\n    \"GW\", \"GY\", \"GO\", \"GR\",\n    \"OW\", \"OY\", \"OB\", \"OG\",\n    \"RW\", \"RY\", \"RB\", \"RG\"].map(s => createAlg(s, \"\", \"orientation\"))\n\nlet lookup_algset = (kind : string) => {\n    switch (kind) {\n        case \"cmll\":\n        case \"cmll_case\": return cmll_algs;\n        case \"nmcll\": return nmcll_algs;\n        case \"trigger\": return trigger_algs;\n        case \"orientation\": return ori_algs;\n        case \"u_auf\": return u_auf_algs;\n        default: return []\n    }\n}\n\nlet alg_generator_from_group = (selector: Selector) => {\n    let algSet = lookup_algset(selector.kind)\n    let lookup = new Set(selector.getActiveNames())\n    let get_prefix = (id: string) => {\n        return id.split(\"_\", 1)[0]\n    }\n    let algs : CaseDesc[] = (() => {\n        return algSet.filter(alg => {\n            let prefix = get_prefix(alg.id);\n            return lookup.has(prefix)\n        })\n    })()\n\n    let next = () => {\n        if (algs.length === 0) {\n            return empty_alg\n        } else {\n            return rand_choice(algs)\n        }\n    }\n    return next\n}\n\nlet alg_generator_from_cases_exact = (kind: string, activeNames: string[]) => {\n    let activeNamesSet = new Set(activeNames)\n    console.log(\"generating from active caes\", activeNamesSet)\n    let algs = lookup_algset(kind).filter(c => activeNamesSet.has(c.id) )\n    let next = () => {\n        if (algs.length === 0) {\n            return empty_alg\n        } else {\n            return rand_choice(algs)\n        }\n    }\n    return next\n}\n\nlet alg_generator_from_cases_contain = (kind: string, activeNames: string[]) => {\n    let activeNamesSet = new Set(activeNames)\n    console.log(\"generating from active caes\", activeNamesSet)\n    let algs = lookup_algset(kind).filter(c => activeNames.some(name => c.id.includes(name)) )\n    let next = () => {\n        if (algs.length === 0) {\n            return empty_alg\n        } else {\n            return rand_choice(algs)\n        }\n    }\n    return next\n}\n\nexport { alg_generator_from_group , alg_generator_from_cases_exact as alg_generator_from_cases, lookup_algset,\nalg_generator_from_cases_contain }","import React, { useEffect } from 'react'\n\nimport { FaceletCubeT } from \"../lib/Defs\";\n\ntype Config = {\n    cube: FaceletCubeT, width: number, height: number, colorScheme: Array<string>,\n    theme: string\n}\n\nfunction draw(ctx: CanvasRenderingContext2D, props: Config) {\n    let { width, height, colorScheme} = props\n\n    ctx.clearRect(0, 0, width, height)\n    // size = size of cube\n    let size = Math.min(width, height)\n    let uSize = size * 0.5;\n    let uStickerSize = uSize / 3; // 0.2\n    const uStrokeWidth = uStickerSize * 0.10;\n    const sideStrokeWidth = uStickerSize * 0.10;\n    ctx.lineWidth = uStrokeWidth;\n\n    ctx.resetTransform()\n    let ratio = window.devicePixelRatio || 1;\n    ctx.scale(ratio, ratio)\n    ctx.translate((width - uSize) / 2, (size - uSize) / 2)\n    let sStickerHeight = uStickerSize * 0.33;\n    let sStickerOuterShift = uStickerSize * 0.1;\n    let sStickerInnerShift = uStickerSize * 0.038;\n    function drawSideSticker(idx: number, angle: number, sticker: number) {\n        ctx.save()\n        ctx.translate(uSize / 2, uSize / 2)\n        ctx.rotate(angle)\n        ctx.translate(-uSize / 2, -uSize / 2)\n        ctx.beginPath()\n\n        const leftShift  = (idx === 0) ? sStickerOuterShift : (idx === 1) ? sStickerInnerShift : -sStickerInnerShift;\n        const rightShift = (idx === 0) ? sStickerInnerShift : (idx === 1) ? -sStickerInnerShift : -sStickerOuterShift;\n        const topLeftX = idx * uStickerSize + leftShift\n        const topRightX = (idx + 1) * uStickerSize + rightShift\n        const topY = -sStickerHeight\n        const bottomLeftX = idx * uStickerSize\n        const bottomRightX = bottomLeftX + uStickerSize\n        const bottomY = 0\n\n        ctx.moveTo(topLeftX, topY)\n        ctx.lineTo(topRightX, topY)\n        ctx.lineTo(bottomRightX, bottomY)\n        ctx.lineTo(bottomLeftX, bottomY)\n        ctx.lineTo(topLeftX, topY)\n        ctx.closePath()\n        ctx.fillStyle = colorScheme[sticker]\n        ctx.fill()\n        ctx.stroke()\n        ctx.restore()\n    }\n    function drawUSticker(x: number, y:number, sticker:number) {\n        ctx.fillStyle = colorScheme[sticker]\n        ctx.fillRect(x, y, uStickerSize, uStickerSize)\n        ctx.strokeStyle = 'black'\n        ctx.strokeRect(x, y, uStickerSize, uStickerSize)\n    }\n\n    for (let i = 0 ;i < 3; i++) {\n        for (let j = 0; j < 3; j++) {\n            const sticker = props.cube[0][i * 3 + j]\n            drawUSticker(j * uStickerSize, i * uStickerSize, sticker)\n        }\n    }\n    // F=2,B=3,L=4,R=5\n    ctx.lineWidth = sideStrokeWidth;\n    for (let i = 0; i < 3; i++) {\n        drawSideSticker(2-i, Math.PI, props.cube[2][i])\n        drawSideSticker(2-i, 0, props.cube[3][i])\n        drawSideSticker(2-i, Math.PI * 1.5, props.cube[4][i])\n        drawSideSticker(2-i, Math.PI * 0.5, props.cube[5][i])\n    }\n\n}\nfunction CubeSim2D(props: Config) {\n    const canvasRef = React.useRef<HTMLCanvasElement | null>(null)\n    useEffect( () => {\n        const canvas = canvasRef.current!\n        let ratio = window.devicePixelRatio || 1;\n        canvas.height = props.height * ratio\n        canvas.width = props.width * ratio\n        const ctx = canvas.getContext('2d')\n        draw(ctx!, props)\n    })\n\n    return <canvas\n        ref={canvasRef}\n        style={{ width: props.width, height: props.height, zIndex: 1 }}\n    />;\n}\n\nexport default CubeSim2D","import React, { Fragment } from 'react'\n\nimport CubeSim from './CubeSim'\nimport { useTheme, FormControl, FormLabel, Typography, Button } from '@mui/material';\n\nimport makeStyles from '@mui/styles/makeStyles';\n\nimport Divider from '@mui/material/Divider';\nimport Grid from '@mui/material/Grid';\nimport Paper from '@mui/material/Paper';\nimport Box from '@mui/material/Box';\nimport { FaceletCube, Mask, MoveSeq } from '../lib/CubeLib';\n\nimport { AppState, Action } from \"../Types\";\nimport clsx from 'clsx';\nimport { MultiSelect, SingleSelect } from './SelectorViews';\nimport { ColorPanel } from './Input';\nimport CaseSelectDialog from './CaseSelectView';\nimport { cmll_algs_raw, nmcll_display_parity, nmcll_to_cmll_mapping, ollcp_algs_raw } from '../lib/Algs';\n\nimport CaseVisualizer from './CaseVisualizer';\nimport CubeSim2D from './CubeSim2D';\nimport { Face } from '../lib/Defs';\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      paddingTop: theme.spacing(0),\n      paddingBottom: theme.spacing(2),\n      backgroundColor: theme.palette.background.default\n    },\n    paper: {\n      padding: theme.spacing(3),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    fixedHeight: {\n      height: 350,\n    },\n    canvasPaper: {\n      padding: theme.spacing(0),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    title : {\n        color: theme.palette.text.disabled,\n        fontWeight: 500,\n        fontSize: 18,\n        borderBottom: \"2px solid\",\n    },\n    prompt: {\n      color: theme.palette.text.secondary,\n    },\n    button: {\n      width: \"100%\"\n    },\n}))\n\nconst cmll_name_to_alg = Object.fromEntries(cmll_algs_raw)\nconst nmcll_display_algs = nmcll_to_cmll_mapping.map( ([x, y], i) => {\n  let parity = nmcll_display_parity[i]\n  let alg = cmll_name_to_alg[y[0][0]]\n  alg = parity[2] + \" \" + alg + \" \" + parity[1]\n  return [x, alg] as [string, string]\n})\n//console.log(nmcll_display_algs)\n\nfunction NMCLLSelect(props:  { state: AppState, dispatch: React.Dispatch<Action> } ) {\n  const {state, dispatch} = props\n  const groups = [\"o\", \"s\", \"as\", \"t\", \"u\", \"l\", \"pi\", \"h\"]\n  return <CaseSelectDialog {...{state, dispatch, settings: {\n    selector: \"nmcllSelector\",\n    groups,\n    algs: nmcll_display_algs,\n    visualizeMask: \"cmll\",\n    cubeOptions: {\n      colorScheme: {\n        0: '#ffffff', // URFDLB. U = white\n        1: '#ee0000', // R = red\n        2: '#404040', // F = green\n        3: '#404040', // D = yellow\n        4: '#ffa100', // L = orange\n        5: '#404040', // B = blue\n      }\n    }\n    },\n    title: \"Select cases by NMCLL recog (this is a separate selection from above, only activated when you're in L/R or F/B mode)\",\n    label: \"Select by NMCLL\"\n  } }/>\n}\n\nfunction _getMask(name: string) {\n  switch (name) {\n    case \"Show\": return Mask.solved_mask;\n    case \"Hide\": return Mask.empty_mask;\n    case \"Hide LSE\": return Mask.lse_mask;\n    default: return Mask.solved_mask\n  }\n}\nexport function CmllTrainerView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n    let { state, dispatch } = props\n    let cube = state.cube.state\n    let classes = useStyles()\n    const canvasPaper = clsx(classes.canvasPaper, classes.fixedHeight);\n    let facelet = FaceletCube.from_cubie(cube,\n      _getMask( state.config.cmllCubeMaskSelector.getActiveName() || \"Show\"))\n\n    const use3D = (state.config.cmll2D3DSelector.getActiveName() || \"3D\") === \"3D\"\n    let kataMode = state.config.cmllKataSelector.getActiveName()\n\n    let hyperori = state.config.hyperOriSelector.getActiveName() || \"off\"\n    if (hyperori !== \"off\") {\n      // if hyperori on\n      if (hyperori === \"F/B\") {\n        facelet = FaceletCube.as_actrm(facelet, \"fb\", true)\n      } else {\n        facelet = FaceletCube.as_actrm(facelet, \"lr\", true)\n      }\n    } else {\n      // if kata mode is on, we mask out all non-U stickers that are not used by recognition\n      // we will go with the following (OO) recognition schema courtesy of James Macdiarmid:\n      // Pi/H: U face\n      // S/As/T/U: the T shape\n      // L: the U face plus the FUR and BUL\n      if (kataMode !== \"off\") {\n        // for now, let's add support for T-shape kata only.\n        // This may be used for T,U,Pi,H obviously, but also for Sune/AntiSune with the James Macdiarmid recog methdo\n        facelet = FaceletCube.as_kata(facelet)\n      }\n    }\n    const theme = useTheme()\n\n    const cmllSel = \"cmllSelector\";\n    const cmllcubemaskSel = \"cmllCubeMaskSelector\";\n    const cmllaufSel = \"cmllAufSelector\";\n    const triggerSel = \"triggerSelector\";\n    const hyperoriSel = \"hyperOriSelector\";\n    const _2d3dSel = \"cmll2D3DSelector\";\n    const kataSel = \"cmllKataSelector\";\n\n\n    const panel = (\n      <Box>\n        <CaseSelectDialog {...{state, dispatch, settings: {\n          selector: \"cmllCaseSelector\",\n          algs: cmll_algs_raw,\n          groups: [\"o\", \"s\", \"as\", \"t\", \"u\", \"l\", \"pi\", \"h\"],\n          visualizeMask: \"cmll\",\n          cubeOptions: {\n            colorScheme: {\n              0: '#FEFE00', // URFDLB. U = yellow\n              1: '#ffa100', // R = o\n              2: '#00b800', // F = g\n              3: '#404040', // D = w\n              4: '#ee0000', // L = r\n              5: '#0000f2', // B = blue\n            }\n          }\n          },\n          label: \"Select CMLL Cases\"\n        } }/>\n\n        <MultiSelect {...{state, dispatch, select: cmllaufSel, options: { label: \"CMLL Auf\", noDialog: true} }} />\n        <Box width={16} display=\"inline-block\"></Box>\n        <MultiSelect {...{state, dispatch, select: triggerSel, options: { label: \"SB Last Pair Trigger (Uncheck all for pure CMLL)\", noDialog: true} } } />\n\n        <Box height={10}/>\n        <Divider />\n        <Box height={20}/>\n\n\n        <SingleSelect {...{state, dispatch, select: cmllcubemaskSel, label: \"Virtual Cube\"}} />\n        <br/>\n\n        <SingleSelect {...{state, dispatch, select: _2d3dSel, label: \"Visualize as\" } } />\n        <Box width={16} display=\"inline-block\"></Box>\n        <br/>\n        <SingleSelect {...{state, dispatch, select: kataSel, label: \"Display recog stickers only\" } } />\n        <ColorPanel {...{state, dispatch}} />\n\n        <Box height={20}/>\n        <Divider />\n        <Box height={20}/>\n\n        <SingleSelect {...{state, dispatch, select: hyperoriSel, label: \"NMCLL Recog Mode\" } } />\n        {hyperori !== \"off\" && <NMCLLSelect {...{state, dispatch}}/>}\n\n      </Box>\n    )\n\n    React.useEffect( () =>  {\n      setReveal(false) // todo: drive this from props. now there's a delay which causes the answer to leak for a split second\n    }, [ state ])\n    const [reveal, setReveal] = React.useState(false)\n    const handleClick = () => {\n      setReveal(true)\n    }\n    const handleNext = () => {\n      dispatch({type: \"key\", content: \"#space\"})\n    }\n\n    React.useEffect(() => {\n      function downHandler(event: KeyboardEvent) {\n        state.keyMapping.handle(event, dispatch);\n        // intercept keyboard event for local control\n        if (event.key === \"/\") {\n          setReveal(true)\n        }\n      }\n      window.addEventListener('keydown', downHandler);\n      return () => {\n        window.removeEventListener('keydown', downHandler);\n      };\n    });\n\n    let alg = \"\"\n    let setup = \"\"\n    if (state.case.desc.length === 4) {\n      setup = state.case.desc[3].algs[0]\n    }\n    if (reveal && state.case.desc.length >= 3) {\n      const moves = new MoveSeq(state.case.desc[1].algs[0] + state.case.desc[2].algs[0] )\n      let moves_c = moves.collapse()\n      if (moves_c.moves.length > 0) {\n        if (moves_c.moves[0].name[0] === \"U\") {\n          alg += \"(\" + moves_c.moves[0].name + \") \";\n          moves_c.moves = moves_c.moves.slice(1)\n        }\n        alg += moves_c.toString()\n      }\n    }\n    const colorSchemeColors = state.colorScheme.getColorsForOri(state.cube.ori)\n    return (\n    <Box className={classes.container}>\n    <Grid container >\n      <Grid item xs={12} >\n          {use3D ?\n            <Paper className={canvasPaper}>\n              <Box margin=\"auto\">\n              {<CubeSim\n                width={400}\n                height={350}\n                cube={facelet}\n                colorScheme={colorSchemeColors}\n                theme={state.config.theme.getActiveName()}\n                facesToReveal={[Face.L]}\n              />}\n              </Box>\n            </Paper>\n           :\n            <Paper className={canvasPaper}>\n              <Box margin=\"auto\">\n              {<CubeSim2D\n                width={400}\n                height={350}\n                cube={facelet}\n                colorScheme={colorSchemeColors}\n                theme={state.config.theme.getActiveName()}\n              />}\n              </Box>\n            </Paper>\n          }\n      </Grid>\n    </Grid>\n\n    <Box height = {5}/>\n\n    <Paper className={classes.paper} elevation={2}>\n    <Grid container spacing={2}>\n\n      <Grid item xs={3}>\n\n      <Box display=\"flex\">\n              <Box>\n              <Box className={classes.title} >\n                Scramble\n              </Box> </Box>\n      </Box>\n      </Grid>\n      <Grid item xs={9}>\n        <Box paddingBottom={1} lineHeight={1} >\n          <Typography style={{whiteSpace: 'pre-line', fontSize: 18, fontWeight: 500}}>\n            { setup }\n          </Typography>\n        </Box>\n\n      </Grid>\n      <Grid item xs={3}>\n\n      <Box display=\"flex\">\n              <Box>\n              <Box className={classes.title} >\n                Case\n              </Box> </Box>\n      </Box>\n      </Grid>\n      { (!reveal) ?\n      <Grid item xs={3}>\n      <Button onFocus={(evt) => evt.target.blur() } className={classes.button}\n      size=\"medium\" variant=\"outlined\" color=\"primary\" onClick={handleClick}> { /* className={classes.margin}>  */ }\n          Show\n      </Button>\n      </Grid>\n      :\n      <Grid item xs={9}>\n        <Box paddingBottom={1} lineHeight={1} >\n          <Typography style={{whiteSpace: 'pre-line', fontSize: 18, fontWeight: 500}}>\n            { alg }\n          </Typography>\n        </Box>\n\n        <Box borderColor=\"primary.main\"\n                style={{transition: \"all .3s ease\" }}>\n                {/* TODO: make the cube colors match above */}\n                <CaseVisualizer\n                  name=\"\"\n                  size={100}\n                  alg={alg}\n                  mask=\"cmll\"\n                  color={colorSchemeColors}\n                  cubeOptions={{}}\n                />\n        </Box>\n\n      </Grid>\n      }\n    </Grid>\n    <Box height={30}/>\n\n    <Grid container spacing={0}>\n        <Grid item xs={4} sm={4} md={3}>\n          <Button onFocus={(evt) => evt.target.blur() } className={classes.button}\n          size=\"medium\" variant=\"contained\" color=\"primary\" onClick={handleNext}>\n              Next\n          </Button>\n        </Grid>\n    </Grid>\n    </Paper>\n\n\n    <Box height={20}/>\n      <Divider />\n    <Box height={20}/>\n    { panel }\n\n    <Box height={20}/>\n      <Divider />\n    <Box height={15}/>\n\n    <Box>\n    <FormControl component=\"fieldset\" className={classes.prompt}>\n      <FormLabel component=\"legend\">\n         Usage: Press space for next case. Enter to redo. / to reveal.\n      </FormLabel>\n    </FormControl>\n    </Box>\n\n    </Box>\n    );\n}\n\n//export default CmllTrainerView\n\n\nexport function OllcpTrainerView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n  let { state, dispatch } = props\n  let cube = state.cube.state\n  let classes = useStyles()\n  const canvasPaper = clsx(classes.canvasPaper, classes.fixedHeight);\n  let facelet = FaceletCube.from_cubie(cube, Mask.solved_mask)\n\n  const use3D = (state.config.cmll2D3DSelector.getActiveName() || \"3D\") === \"3D\"\n  let kataMode = state.config.cmllKataSelector.getActiveName()\n\n  if (kataMode !== \"off\") {\n    facelet = FaceletCube.as_kata(facelet)\n  }\n\n  const _2d3dSel = \"cmll2D3DSelector\";\n  const kataSel = \"cmllKataSelector\";\n\n  const panel = (\n    <Box>\n      <CaseSelectDialog {...{state, dispatch, settings: {\n        selector: \"ollcpCaseSelector\",\n        algs: ollcp_algs_raw,\n        groups: [\"34\", \"39\", \"45\", \"51\", \"56\", \"13\", \"14\"],\n        visualizeMask: \"coll\",\n        cubeOptions: {\n          colorScheme: {\n            0: '#FEFE00', // URFDLB. U = yellow\n            1: '#ffa100', // R = o\n            2: '#00b800', // F = g\n            3: '#404040', // D = w\n            4: '#ee0000', // L = r\n            5: '#0000f2', // B = blue\n          }\n        }\n        },\n        label: \"Select OLLCP Cases\"\n      } }/>\n\n      {/* <MultiSelect {...{state, dispatch, select: cmllaufSel, options: { label: \"CMLL Auf\", noDialog: true} }} />\n      <Box width={16} display=\"inline-block\"></Box>\n      <MultiSelect {...{state, dispatch, select: triggerSel, options: { label: \"SB Last Pair Trigger (Uncheck all for pure CMLL)\", noDialog: true} } } />\n\n      <Box height={10}/>\n      <Divider />\n      <Box height={20}/>\n\n\n      <SingleSelect {...{state, dispatch, select: cmllcubemaskSel, label: \"Virtual Cube\"}} />\n      <br/> */}\n\n      <SingleSelect {...{state, dispatch, select: _2d3dSel, label: \"Visualize as\" } } />\n      <Box width={16} display=\"inline-block\"></Box>\n      <SingleSelect {...{state, dispatch, select: kataSel, label: \"Display recog stickers only\" } } />\n      <ColorPanel {...{state, dispatch}} />\n\n      <Box height={20}/>\n      <Divider />\n      <Box height={20}/>\n\n    </Box>\n  )\n\n  React.useEffect( () =>  {\n    setReveal(false) // todo: drive this from props. now there's a delay which causes the answer to leak for a split second\n  }, [ state ])\n  const [reveal, setReveal] = React.useState(false)\n  const handleClick = () => {\n    setReveal(true)\n  }\n  const handleNext = () => {\n    dispatch({type: \"key\", content: \"#space\"})\n  }\n\n  React.useEffect(() => {\n    function downHandler(event: KeyboardEvent) {\n      state.keyMapping.handle(event, dispatch);\n      // intercept keyboard event for local control\n      if (event.key === \"/\") {\n        setReveal(true)\n      }\n    }\n    window.addEventListener('keydown', downHandler);\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n    };\n  });\n\n  let alg = \"\"\n  let setup = \"\"\n  if (state.case.desc.length === 4) {\n    setup = state.case.desc[3].algs[0]\n  }\n  if (reveal && state.case.desc.length >= 3) {\n    const moves = new MoveSeq(state.case.desc[1].algs[0] + state.case.desc[2].algs[0] )\n    let moves_c = moves.collapse()\n    if (moves_c.moves.length > 0) {\n      if (moves_c.moves[0].name[0] === \"U\") {\n        alg += \"(\" + moves_c.moves[0].name + \") \";\n        moves_c.moves = moves_c.moves.slice(1)\n      }\n      alg += moves_c.toString()\n    }\n  }\n  const colorSchemeColors = state.colorScheme.getColorsForOri(state.cube.ori)\n  return (\n  <Box className={classes.container}>\n  <Grid container >\n    <Grid item xs={12} >\n        {use3D ?\n          <Paper className={canvasPaper}>\n            <Box margin=\"auto\">\n            {<CubeSim\n              width={400}\n              height={350}\n              cube={facelet}\n              colorScheme={colorSchemeColors}\n              theme={state.config.theme.getActiveName()}\n              facesToReveal={[Face.L]}\n            />}\n            </Box>\n          </Paper>\n         :\n          <Paper className={canvasPaper}>\n            <Box margin=\"auto\">\n            {<CubeSim2D\n              width={400}\n              height={350}\n              cube={facelet}\n              colorScheme={colorSchemeColors}\n              theme={state.config.theme.getActiveName()}\n            />}\n            </Box>\n          </Paper>\n        }\n    </Grid>\n  </Grid>\n\n  <Box height = {5}/>\n\n  <Paper className={classes.paper} elevation={2}>\n  <Grid container spacing={2}>\n\n    <Grid item xs={3}>\n\n    <Box display=\"flex\">\n            <Box>\n            <Box className={classes.title} >\n              Scramble\n            </Box> </Box>\n    </Box>\n    </Grid>\n    <Grid item xs={9}>\n      <Box paddingBottom={1} lineHeight={1} >\n        <Typography style={{whiteSpace: 'pre-line', fontSize: 18, fontWeight: 500}}>\n          { setup }\n        </Typography>\n      </Box>\n\n    </Grid>\n    <Grid item xs={3}>\n\n    <Box display=\"flex\">\n            <Box>\n            <Box className={classes.title} >\n              Case\n            </Box> </Box>\n    </Box>\n    </Grid>\n    { (!reveal) ?\n    <Grid item xs={3}>\n    <Button onFocus={(evt) => evt.target.blur() } className={classes.button}\n    size=\"medium\" variant=\"outlined\" color=\"primary\" onClick={handleClick}> { /* className={classes.margin}>  */ }\n        Show\n    </Button>\n    </Grid>\n    :\n    <Grid item xs={9}>\n      <Box paddingBottom={1} lineHeight={1} >\n        <Typography style={{whiteSpace: 'pre-line', fontSize: 18, fontWeight: 500}}>\n          { alg }\n        </Typography>\n      </Box>\n\n      <Box borderColor=\"primary.main\"\n              style={{transition: \"all .3s ease\" }}>\n              {/* TODO: make the cube colors match above */}\n              <CaseVisualizer\n                name=\"\"\n                size={100}\n                alg={alg}\n                mask=\"cmll\"\n                color={colorSchemeColors}\n                cubeOptions={{}}\n              />\n      </Box>\n\n    </Grid>\n    }\n  </Grid>\n  <Box height={30}/>\n\n  <Grid container spacing={0}>\n      <Grid item xs={4} sm={4} md={3}>\n        <Button onFocus={(evt) => evt.target.blur() } className={classes.button}\n        size=\"medium\" variant=\"contained\" color=\"primary\" onClick={handleNext}>\n            Next\n        </Button>\n      </Grid>\n  </Grid>\n  </Paper>\n\n\n  <Box height={20}/>\n    <Divider />\n  <Box height={20}/>\n  { panel }\n\n  <Box height={20}/>\n    <Divider />\n  <Box height={15}/>\n\n  <Box>\n  <FormControl component=\"fieldset\" className={classes.prompt}>\n    <FormLabel component=\"legend\">\n       Usage: Press space for next case. Enter to redo. / to reveal.\n    </FormLabel>\n  </FormControl>\n  </Box>\n\n  </Box>\n  );\n}\n","import React, { Fragment } from 'react'\n\nimport {\n    TextField,\n    Button,\n    Box,\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    DialogActions,\n    useMediaQuery,\n} from '@mui/material';\n\nimport makeStyles from '@mui/styles/makeStyles';\n\nimport EditIcon from '@mui/icons-material/Edit';\nimport { theme } from '../theme';\n\n\nimport { Action } from '../Types';\nimport { MoveSeq } from '../lib/CubeLib';\n\nconst useStyles = makeStyles(theme => ({\n\n    setupEdit: {\n        whiteSpace: 'pre-line',\n        fontSize: \"1.2rem\",\n        fontWeight:500,\n        [theme.breakpoints.down('sm')]: {\n        fontSize: \"1.0rem\",\n        fontWeight: 500\n        },\n    },\n    button: {\n        marginRight: theme.spacing(1)\n        //margin: theme.spacing(1)\n    }\n}))\n\nexport function ScrambleInputView(props: { display: string, scrambles: string[], dispatch: React.Dispatch<Action>}) {\n    let classes = useStyles()\n    let [editing, setEditing] = React.useState(false)\n    let [value, setValue] = React.useState(props.scrambles.join(\"\\n\"))\n    let textField = React.useRef<HTMLInputElement | null>(null)\n    const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setValue(event.target.value)\n        event.stopPropagation()\n    }\n    const onKeyPress = (event: React.KeyboardEvent<HTMLInputElement>) => {\n        event.stopPropagation()\n    }\n    const toggleEdit = () => {\n        setEditing(!editing)\n    }\n    const handleClose = () => {\n        setEditing(false)\n    }\n    const handleSubmit = () => {\n        setEditing(false)\n        props.dispatch({type: \"scrambleInput\", content: value.split(\"\\n\").filter(s => s.trim())})\n    }\n    const handleInvert = () => {\n        setEditing(false)\n        const inverted = (value.split(\"\\n\").map(x => new MoveSeq(x).inv().toString()))\n        props.dispatch({type: \"scrambleInput\", content: inverted})\n    }\n    React.useEffect(  () => {\n        setValue(props.scrambles.join(\"\\n\"))\n    }, [props.scrambles])\n\n    /*\n    React.useEffect( ()=> {\n        if (editing) {\n            textField.current && textField.current.focus()\n        } else {\n            textField.current && textField.current.blur()\n            editButton.current && editButton.current.blur()\n        }\n    }, [editing]*/\n\n    const onEntered = () => {\n        textField.current && textField.current.focus()\n    }\n    const gt_sm = useMediaQuery(theme.breakpoints.up('sm'));\n    return <>\n    <Box>\n        { gt_sm ? \n            <Button variant={editing ? \"contained\" : \"outlined\"}\n                color=\"primary\"\n                size=\"small\"\n                onClick={toggleEdit}\n                className={classes.button}\n                startIcon={<EditIcon />}\n            >\n                Input\n            </Button>\n            : \n            <Button variant={editing ? \"contained\" : \"outlined\"}\n                color=\"primary\"\n                size=\"small\"\n                onClick={toggleEdit}\n                className={classes.button}\n            >\n                <Box marginTop={0.5}>\n                    <EditIcon fontSize=\"small\"/>\n                </Box>\n            </Button>\n            // <Box>\n            // <IconButton \n            //     size=\"small\"\n            //     onClick={toggleEdit}\n            //     className={classes.button}\n            //     color=\"primary\"\n            // >\n            //     <EditIcon />\n            // </IconButton>\n            // </Box>\n        }\n\n    </Box>\n\n    <Dialog open={editing} \n            onClose={handleClose}  \n            onKeyPress={onKeyPress} \n            onKeyDown={onKeyPress} \n            onKeyUp={onKeyPress}\n            /* onEntered={onEntered} */\n            >\n          <DialogTitle> Input your own solution / scrambles (one per line) </DialogTitle>\n          <DialogContent>\n                <TextField\n                    inputRef={textField}\n                    multiline\n                    size=\"medium\"\n                    fullWidth\n                    maxRows={10}\n                    rows={3}\n                    InputProps={{\n                        className:classes.setupEdit\n                    }}\n                    autoFocus\n                \n                    value={value}\n                    onChange={onChange}\n                    variant=\"outlined\">\n                </TextField>\n          </DialogContent>\n          <DialogActions>\n              <Box padding={1}>\n              <Button onClick={handleInvert} color=\"primary\" variant=\"outlined\" fullWidth >\n                  Use as solution\n              </Button>\n              <Button onClick={handleSubmit} color=\"primary\" variant=\"outlined\" fullWidth >\n                  Use as scramble\n              </Button>\n              </Box>\n          </DialogActions>\n    </Dialog>\n    </>\n}","import React from 'react'\nimport Tooltip, { tooltipClasses, TooltipProps } from '@mui/material/Tooltip';\nimport { styled } from '@mui/material/styles';\nimport { theme } from '../theme';\n\nexport const CustomTooltip = styled(({ className, ...props }: TooltipProps) => (\n    <Tooltip {...props} classes={{ popper: className }} />\n  ))({\n    [`& .${tooltipClasses.tooltip}`]: {\n      maxWidth: 400,\n      fontSize: \"1rem\"\n    },\n  });","import React, { Fragment } from 'react'\n\nimport CubeSim from './CubeSim'\nimport { Button, Typography, useTheme, FormControl, FormLabel } from '@mui/material';\nimport makeStyles from '@mui/styles/makeStyles';\nimport Divider from '@mui/material/Divider';\n\nimport Grid from '@mui/material/Grid';\nimport Paper from '@mui/material/Paper';\nimport Box from '@mui/material/Box';\n\nimport FavoriteIcon from '@mui/icons-material/Favorite';\nimport useMediaQuery from '@mui/material/useMediaQuery';\nimport ErrorOutlineIcon from '@mui/icons-material/ErrorOutline';\nimport IconButton from '@mui/material/IconButton';\n\n\nimport { FaceletCube, Mask, MoveSeq } from '../lib/CubeLib';\n\nimport { AppState,  Action, FavCase, Mode} from \"../Types\";\nimport 'typeface-roboto-mono';\nimport { Face } from '../lib/Defs';\n\nimport { SingleSelect, MultiSelect, SliderSelect } from './SelectorViews';\nimport { ColorPanel } from './Input';\nimport { CaseDesc } from '../lib/Algs';\nimport { ScrambleInputView } from './ScrambleInputView';\nimport { CustomTooltip } from './Tooltip';\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      paddingTop: theme.spacing(0),\n      paddingBottom: theme.spacing(2),\n      backgroundColor: theme.palette.background.default,\n      transition: \"all .5s ease-in-out\"\n    },\n    button: {\n      width: \"100%\",\n      height: 50\n    },\n    paper: {\n      padding: theme.spacing(3),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n      marginBottom: 3,\n      borderRadius: 0\n    },\n    canvasPaper: {\n      padding: theme.spacing(0),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    infoColumn: {\n      color: theme.palette.background.paper\n    },\n    scrambleColumn: {\n      paddingLeft: theme.spacing(3)\n    },\n    textColumn: {\n      // color: \"black\",\n      [theme.breakpoints.up('sm')]: {\n        minHeight: 138\n      },\n    },\n    setup: {\n      whiteSpace: 'pre-line',\n      fontSize: \"1.4rem\",\n      fontWeight:500,\n      [theme.breakpoints.down('sm')]: {\n      fontSize: \"1.2rem\",\n      fontWeight: 500\n      },\n    },\n    condGap: {\n    },\n    fgap: {\n      flexShrink: 100, flexBasis: \"2.5rem\", minWidth: \"1.5em\",\n      [theme.breakpoints.down('sm')]: {\n        flexBasis: \"1.0rem\", \n        minWidth: \"0.4rem\"\n      }\n    },\n    fixedHeight: {\n      height: 250,\n    },\n    title : {\n        color: theme.palette.text.disabled,\n        fontWeight: 500,\n        borderBottom: \"3px solid\",\n    },\n    sourceIcon : {\n        color: theme.palette.text.disabled,\n        fontSize: 15,\n        padding: 0\n    },\n    sourceIconWrap : {\n        //border: \"1px solid \" + theme.palette.text.disabled,\n        //borderRadius: 3\n    },\n    fab: {\n      position: 'absolute',\n      top: theme.spacing(7),\n      left: theme.spacing(2),\n    },\n    prompt: {\n      color: theme.palette.text.secondary,\n    },\n  }))\n\n\nfunction getMask(state: AppState) : Mask {\n    if (state.mode === \"fbdr\") {\n      const fbOnly = (state.case.desc.length === 0 || state.case.desc[0].kind === \"fb\")\n      //   getActiveName(state.config.fbOnlySelector) === \"FB Last Pair\"\n      return fbOnly ? Mask.fb_mask : Mask.fbdr_mask\n    }\n    else if (state.mode === \"fs\") {\n      let name = state.config.fsSelector.getActiveName()\n      return ({\n        \"Front FS\": Mask.fs_front_mask,\n        \"Back FS\": Mask.fs_back_mask,\n        \"Both\": Mask.fb_mask\n      } as any)[name]\n    }\n    else if (state.mode === \"ss\") {\n      if (state.case.desc.length === 0) return Mask.sb_mask\n      let name = state.config.ssSelector.getActiveName()\n      let dpair = state.config.ssPairOnlySelector.getActiveName() === \"D-Pair only\"\n\n      switch (name) {\n        case \"Front SS\": return dpair ? Mask.ssdp_front_mask : Mask.ss_front_mask; \n        case \"Back SS\": return dpair ? Mask.ssdp_back_mask : Mask.ss_back_mask; \n        default : return dpair ? Mask.ssdp_both_mask : Mask.f2b_mask\n      }\n    }\n    else if (state.mode === \"fb\") {\n      if (state.case.desc.length === 0 || state.case.desc[0].kind === \"fb\" || state.case.desc[0].kind.startsWith(\"fb@\")) {\n        return Mask.fb_mask\n      }\n      else if (state.case.desc[0].kind === \"fbdr\") {\n        return Mask.fbdr_mask\n      } else {\n        return Mask.solved_mask\n      }\n    }\n    else if (state.mode === \"fbss\") {\n      let name = state.config.fbssSsSelector.getActiveName()\n      return ({\n        \"Front SS\": Mask.ss_front_mask,\n        \"Back SS\": Mask.ss_back_mask,\n        \"Both\": Mask.f2b_mask\n      } as any)[name]\n    }\n    else if (state.mode === \"4c\" || state.mode === \"eopair\") {\n      return Mask.solved_mask\n    }\n    else return Mask.sb_mask\n}\n\nfunction getHelperTextForMode(mode: Mode) {\n  if (mode === \"4c\" || mode === \"eopair\") {\n    return (\"Usage: Press space for next case. Enter to redo.\"\n      + \"\\n\\nVirtual Cube: I/K (E/D) for M'/M, J/F for U/U'\")\n  } else {\n    return null\n  }\n}\n\n\nfunction BlockTrainerView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n    let { state, dispatch } = props\n    let cube = state.cube.state\n    let classes = useStyles()\n\n    let facelet = FaceletCube.from_cubie(cube, getMask(state))\n\n    let desc : CaseDesc[] = state.case.desc.length ? state.case.desc :\n       [ { algs: [\"\"], setup:\"Press next for new case\", id: \"\", kind: \"\"} ]\n\n    let spaceButtonText = (state.name === \"hiding\") ? \"Reveal\" : \"Next\"\n    let showMoveCountHint = state.config.moveCountHint.getActiveName() === \"Show\"\n\n    let describe_reveal = function(algs: CaseDesc[]) {\n      let get_algs = (d: CaseDesc) => d.algs;\n      if (algs.length === 1) {\n        return get_algs(algs[0]).join(\"\\n\")\n      } else {\n        return algs.map( alg =>\n          `[${alg.kind}]:\\n` + get_algs(alg).join(\"\\n\") + \"\\n\"\n        )\n      }\n    }\n\n    let describe_hide = (desc: CaseDesc[]) => {\n      let minMove = desc.map( d =>\n        d.algs.map(a => new MoveSeq(a).remove_setup().moves.length))\n        .flat()\n        .reduce( (a, b) => Math.min(a, b), 100 )\n      return `(Min = ${minMove} STM)`\n    }\n    let algText = (state.name === \"hiding\") ? (showMoveCountHint ? describe_hide(desc) : \"\")\n      : (state.name === \"revealed\") ? describe_reveal(desc) : \"\"\n\n    const handleSpace = () => {\n      dispatch({type: \"key\", content: \"#space\"})\n      if (spaceButtonText === \"Next\") {\n        setFav(false)\n      }\n    }\n\n    const setup = desc.length ? desc[0].setup! : \"\"\n    const theme = useTheme()\n\n    // source\n    // Add event listeners\n    React.useEffect(() => {\n      function downHandler(event: KeyboardEvent) {\n        if (event.key === \" \" && spaceButtonText === \"Next\") {\n          setFav(false)\n        }\n        state.keyMapping.handle(event, dispatch);\n      }\n      window.addEventListener('keydown', downHandler);\n      return () => {\n        window.removeEventListener('keydown', downHandler);\n      };\n    });\n\n    const [favSelected, setFav] = React.useState(false)\n    const handleFav = () => {\n      if (state.case.desc.length === 0) return\n      const case_ : FavCase = {\n        mode: state.mode,\n        solver: state.case.desc.map(x => x.kind),\n        setup: setup || \"\"\n      }\n      if (!favSelected){\n        setFav(true)\n        dispatch({type: \"favList\", content: [ case_ ], action: \"add\"})\n      } else {\n        setFav(false)\n        dispatch({type: \"favList\", content: [ case_ ], action: \"remove\" })\n      }\n    }\n\n    const gt_sm = useMediaQuery(theme.breakpoints.up('sm'));\n    const canvas_wh = (gt_sm) ? [400, 350] : [320, 280]\n    const ADD_STR = (gt_sm) ? \"Add\" : \"\";\n\n    // helper-text\n    let helperText = getHelperTextForMode(state.mode)\n\n    let levelSelectionWarning = \"We weren't able to generate your level within time limit. You can try again -- some levels are reachable within a few tries.\"\n    let levelSelectionSuccess = state.cube.levelSuccess\n\n    const scramblePanel = \n          <Box style={{display: \"flex\", flexWrap: \"wrap\", padding: 0}}>\n            <ScrambleInputView display = {setup}\n                dispatch={dispatch} scrambles={state.scrambleInput}/>\n\n            <Box>\n            {\n              gt_sm ?\n              <Button variant={favSelected ? \"contained\" : \"outlined\"}\n                  color=\"primary\"\n                  size=\"small\"\n                  name=\"fav\"\n                  onClick={handleFav}\n                  startIcon={<FavoriteIcon/>} \n                  >\n                  {favSelected ? \"✓\" : ADD_STR}\n              </Button> \n              :\n              null\n              // <Button variant={favSelected ? \"contained\" : \"outlined\"}\n              //     color=\"primary\"\n              //     size=\"small\"\n              //     name=\"fav\"\n              //     onClick={handleFav}\n              // >\n              //   <Box marginTop={0.5}>\n              //     <FavoriteIcon fontSize=\"small\"/>\n              //   </Box>\n              // </Button>\n            }\n            </Box>\n          </Box>\n\n    return (\n    <Box className={classes.container}>\n      <Paper className={classes.paper} elevation={1}>\n        <Box style={{display: \"flex\"}}>\n          <Box style={{display: \"flex\", flexDirection: \"column\", alignItems: \"center\"}}>\n            <Box className={classes.title} style={{}}>\n              Scramble\n            </Box> \n          </Box>\n          <Box style={{}} className={classes.fgap} />\n          <Box style={{display: \"flex\", alignItems: \"center\", flexGrow: 1}}>\n            <Typography className={classes.setup} >\n                  {setup}\n            </Typography>\n          </Box>\n          <Box style={{}} className={classes.fgap} />\n\n          {gt_sm && scramblePanel}\n          \n          \n        </Box>\n      </Paper>\n\n      <Paper className={ classes.paper}>\n      <Grid container>\n\n        <Grid item md={6} sm={12} xs={12} className={classes.condGap}>\n          <Box style={{display: \"flex\" }}>\n            <Box display=\"flex\" >\n                <Box style={{display: \"flex\", alignSelf: \"flex-start\"}}> <Box className={classes.title} style={{}}>\n                  Solutions\n                </Box> </Box>\n            </Box>\n            <Box style={{}} className={classes.fgap} />\n            <div>\n              <Box paddingBottom={2} lineHeight={1}>\n                <Typography style={{whiteSpace: 'pre-line', fontSize: \"1.2rem\"}} >\n                  {algText}\n                </Typography>\n              </Box>\n            </div>\n          </Box>\n        </Grid>\n\n\n        <Grid item md={6} sm={12} xs={12} style={{display: \"flex\", justifyContent: \"center\"}}>\n          <Box style={{backgroundColor: \"rgba(0, 0, 0, 0)\"}}>\n            { props.state.config.showCube.getActiveName() === \"Show\" ?\n            <CubeSim\n              width={canvas_wh[0]}\n              height={canvas_wh[1]}\n              cube={facelet}\n\n              colorScheme={state.colorScheme.getColorsForOri(state.cube.ori)}\n              hintDistance={ (state.mode === \"4c\" || state.mode === \"eopair\") ? 3 : 7 }\n              theme={state.config.theme.getActiveName()}\n              facesToReveal={ [Face.L, Face.B, Face.D]  }\n            /> : null }\n          </Box>\n        </Grid>\n      </Grid>\n      </Paper>\n\n      <Paper className={classes.paper} style={{paddingTop: 20, paddingBottom: 22}}>\n\n      <Grid container spacing={1}>\n        <Grid item xs={5} sm={4} md={3} marginLeft={1}>\n          <Button onFocus={(evt) => evt.target.blur() } className={classes.button} \n            size=\"large\" variant=\"contained\" color=\"primary\" \n            onClick={handleSpace} sx={{borderRadius: 0}}>\n              {spaceButtonText}\n          </Button>\n        </Grid>\n        {\n          !levelSelectionSuccess ?\n          <Grid item xs={1} marginLeft={1}>\n            <CustomTooltip title={levelSelectionWarning}>\n              <IconButton>\n                <ErrorOutlineIcon sx={{ fontSize: 30 }}/>\n              </IconButton>\n            </CustomTooltip> \n          </Grid> :\n          null\n        }\n\n\n      </Grid>\n\n      </Paper>\n\n      <Box height={20}/>\n      <Divider/>\n      <Box height={20}/>\n\n      <ConfigPanelGroup {...{state, dispatch} } />\n\n      {helperText ?\n      <Fragment>\n        <Box height={20}/>\n          <Divider/>\n        <Box height={15}/>\n        <Box>\n        <FormControl component=\"fieldset\" className={classes.prompt}>\n          <FormLabel component=\"legend\">\n            <pre style={{ fontFamily: 'inherit' }}>\n              {helperText}\n            </pre>\n          </FormLabel>\n          </FormControl>\n        </Box>\n      </Fragment> : null }\n    </Box>\n    );\n}\n\n\n\nfunction ConfigPanelGroup(props: {state: AppState, dispatch: React.Dispatch<Action> }) {\n  let { state, dispatch } = props\n  if (state.mode === \"ss\") {\n    let DRManip = [\n      // names: [\"UF\", \"FU\", \"UL\", \"LU\", \"UB\", \"BU\", \"UR\", \"RU\", \"DF\", \"FD\", \"DB\", \"BD\",\n      // \"DR\", \"RD\", \"BR\", \"RB\", \"FR\", \"RF\"],\n      { name: \"Toggle Select All\", enableIdx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17] },\n      { name: \"Toggle All Oriented\", enableIdx: [0, 2, 4, 6, 8, 10, 12, 14, 16] },\n    ]\n    return (\n      <Fragment>\n      <SliderSelect {...{state, dispatch, select: \"ssLevelSelector\"}} /> \n\n      <SingleSelect {...{state, dispatch, select: \"ssSelector\"}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: \"ssPairOnlySelector\"}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: \"solutionNumSelector\"}}> </SingleSelect>\n      {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n      \n      <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: \"showCube\"}}> </SingleSelect>\n      <MultiSelect {...{state, dispatch, select: \"ssPosSelector\", options: {manipulators: DRManip} }}> </MultiSelect>\n      <ColorPanel {...{state, dispatch}} />\n\n      </Fragment>\n    )\n  } else if (state.mode === \"fbdr\") {\n    let select1 = \"fbdrSelector\"\n    let select2 = \"fbOnlySelector\"\n    let select3 = \"fbPairSolvedSelector\"\n    let select4 = \"fbdrScrambleSelector\"\n    let select5 = \"solutionNumSelector\"\n\n    let LPEdgeManip = [\n      { name: \"Toggle Select All\", enableIdx: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17] },\n    ]\n    let pos1 = \"fbdrPosSelector1\"\n    let pos3 = \"fbdrPosSelector3\"\n\n    return (\n      <Fragment>\n      <SliderSelect {...{state, dispatch, select: \"fbdrLevelSelector\"}} /> \n\n      <SingleSelect {...{state, dispatch, select: select2}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: select1}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: select3}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: select4}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: select5}}> </SingleSelect>\n      {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n      <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n      <SingleSelect {...{state, dispatch, select: \"showCube\"}}> </SingleSelect>\n\n      <MultiSelect {...{state, dispatch, select: pos1, options: {manipulators: LPEdgeManip} }}> </MultiSelect>\n      <MultiSelect {...{state, dispatch, select: pos3, options: {manipulators: LPEdgeManip} }}> </MultiSelect>\n      <ColorPanel {...{state, dispatch}} />\n\n      </Fragment>\n    )\n  } else if (state.mode === \"fb\") {\n    return (\n      <Fragment>\n        <SliderSelect {...{state, dispatch, select: \"fbLevelSelector\"}} /> \n        {/* <SingleSelect {...{state, dispatch, select: \"fbStratSelector\"}} />  */}\n\n        <SingleSelect {...{ state, dispatch, select: \"fbPieceSolvedSelector\" }}> </SingleSelect>\n        {/* <SingleSelect {...{state, dispatch, select: \"fbBasisSelector\"}} />  */}\n        <SingleSelect {...{ state, dispatch, select: \"solutionNumSelector\"}}> </SingleSelect>\n      {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n        <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n        <SingleSelect {...{state, dispatch, select: \"showCube\"}}> </SingleSelect>\n\n        <ColorPanel {...{state, dispatch}} />\n\n\n      </Fragment>\n    )\n   } else if (state.mode === \"fs\") {\n    let select1 = \"fsSelector\"\n    let select2 = \"solutionNumSelector\"\n\n    return (\n      <Fragment>\n        <SliderSelect {...{state, dispatch, select: \"fsLevelSelector\"}} /> \n\n        <SingleSelect {...{ state, dispatch, select: select1 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select2 }}> </SingleSelect>\n        {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n        <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n        <SingleSelect {...{state, dispatch, select: \"showCube\" }}> </SingleSelect>\n\n        <ColorPanel {...{state, dispatch}} />\n\n\n      </Fragment>\n    )\n   } else if (state.mode === \"fsdr\") {\n    let select1 = \"fsSelector\"\n    let select2 = \"solutionNumSelector\"\n\n    return (\n      <Fragment>\n        <SliderSelect {...{state, dispatch, select: \"fsLevelSelector\"}} /> \n\n        <SingleSelect {...{ state, dispatch, select: select1 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select2 }}> </SingleSelect>\n        {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n        <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n        <SingleSelect {...{state, dispatch, select: \"showCube\" }}> </SingleSelect>\n\n        <ColorPanel {...{state, dispatch}} />\n\n\n      </Fragment>\n    )\n   }  \n   else if (state.mode === \"fbss\") {\n    let select1 = \"fbssLpSelector\"\n    let select2 = \"fbssSsSelector\"\n    let select3 = \"solutionNumSelector\"\n\n    return (\n      <Fragment>\n        <SliderSelect {...{state, dispatch, select: \"fbssLevelSelector\"}} /> \n        <SingleSelect {...{ state, dispatch, select: select1 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select2 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select3 }}> </SingleSelect>\n        {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n        <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n        <ColorPanel {...{state, dispatch}} />\n\n\n      </Fragment>\n    )\n   }\n   else if (state.mode === \"4c\"){\n    let select1 = \"lseStageSelector\"\n    let select2 = \"lseMCSelector\"\n    let select3 = \"lseBarSelector\"\n    let select4 = \"solutionNumSelector\"\n\n    return (\n      <Fragment>\n        <SingleSelect {...{ state, dispatch, select: select1 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select2 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select3 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select4 }}> </SingleSelect>\n        {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n        <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n        <SingleSelect {...{state, dispatch, select: \"showCube\"}}> </SingleSelect>\n\n        <ColorPanel {...{state, dispatch}} />\n      </Fragment>\n    )\n   } else if (state.mode === \"eopair\"){\n    let select1 = \"lseEOSelector\"\n    let select2 = \"lseEOLRMCSelector\"\n    let select3 = \"lseBarbieSelector\"\n    let select4 = \"lseEOLRScrambleSelector\"\n    let select5 = \"solutionNumSelector\"\n\n    return (\n      <Fragment>\n        <MultiSelect {...{ state, dispatch, select: select1, options: {noDialog: true}} }> </MultiSelect>\n        <SingleSelect {...{ state, dispatch, select: select2 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select3 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select4 }}> </SingleSelect>\n        <SingleSelect {...{ state, dispatch, select: select5 }}> </SingleSelect>\n        {/* <SingleSelect {...{state, dispatch, select: \"evaluator\"}}> </SingleSelect> */}\n        <SingleSelect {...{state, dispatch, select: \"moveCountHint\"}}> </SingleSelect>\n        <SingleSelect {...{state, dispatch, select: \"showCube\"}}> </SingleSelect>\n\n        <ColorPanel {...{state, dispatch}} />\n      </Fragment>\n    )\n   }\n   else return <Fragment/>\n}\n\n\n\nexport default BlockTrainerView\n\n\n","import React, { Dispatch } from 'react'\n\nimport makeStyles from '@mui/styles/makeStyles';\nimport { ImageList, ImageListItem} from '@mui/material';\n\nimport { CaseDesc } from \"../lib/Algs\";\nimport { AppState, Action } from '../Types';\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-around',\n        overflow: 'hidden',\n        backgroundColor: theme.palette.background.paper,\n      },\n    container: {\n        paddingTop: theme.spacing(0),\n        paddingBottom: theme.spacing(2),\n        backgroundColor: theme.palette.background.default,\n      },\n    paper: {\n        padding: theme.spacing(1),\n        textAlign: 'center',\n        color: theme.palette.text.secondary,\n      },\n      gridList: {\n        width: 600,\n        height: 450,\n      },\n}))\n\ntype VisualCubeConfig = {\n    alg: string;\n    stage: string;\n    sch: string; //yrbwog\n}\nfunction VisualCube(props: VisualCubeConfig) {\n  let { alg, stage, sch } = props\n  const template =\n  `http://localhost:8000/visualcube.php?fmt=svg&r=y30x-24&size=150&co=40&fo=100&cc=ccc`\n    + `&stage=${stage}&sch=${sch}&case=${alg}`\n  return <img src={template} alt=\"\"/>\n}\n\nfunction PanoramaTable(props: {algs: CaseDesc[]}){\n    let classes = useStyles()\n    let { algs } = props\n    //  /* cellHeight={160} className={classes.gridList} cols={3}>\n    return <ImageList>\n            {algs.map((alg) => (\n                <ImageListItem key={alg.id} cols={1}>\n                    <VisualCube alg={alg.algs[0]} stage=\"f2b\" sch=\"yrbwog\"/>\n                </ImageListItem>\n            ))}\n        </ImageList>\n}\n\nexport default function PanoramaView(props: { state: AppState, dispatch: Dispatch<Action> }) {\n    let classes = useStyles()\n    let algs : CaseDesc[] = [\n        \"RUR\", \"RU'R'\"\n    ].map( str => ({\n        id: str,\n        algs: [str],\n        kind: \"sb\"\n    }))\n\n    return <div className={classes.root}>\n        <div>\n        <PanoramaTable algs={algs}/>\n        </div>\n        <div>\n        <PanoramaTable algs={algs}/>\n        </div>\n    </div>\n}","import { CubieCube, Move } from './CubeLib';\nimport { Face } from './Defs';\nimport { cartesianProduct } from './Math';\nif ((globalThis as any).$RefreshReg$ === undefined) {\n    // hack for disabling refresh plugin in web worker\n    (globalThis as any).$RefreshReg$ = () => {};\n    (globalThis as any).$RefreshSig$ = () => () => {};\n}\n\nexport type PrunerConfig = {\n    size: number,\n    encode: (cube : CubieCube) => number,\n    solved_states: CubieCube[],\n    max_depth: number,\n    moveset: string[],\n    rev_lookup_depth?: number,\n    name: string\n}\n\nexport type PrunerT = {\n    init: () => void,\n    query: (c : CubieCube) => number,\n    equal: (c1 : CubieCube, c2: CubieCube) => boolean,\n    encode: (c : CubieCube) => number,\n    moveset: Move[],\n    max_depth: number,\n    size: number\n}\n\nenum PrunerPiece {\n    S, O, I, X\n}; // Solved, Oriented, Ignore, Exclude\nconst { S, I } = PrunerPiece\n\nexport type PrunerDef = {\n    corner: PrunerPiece[],\n    edge:   PrunerPiece[],\n    center: PrunerPiece[],\n    solved_states: string[],\n    moveset: string[],\n    max_depth: number,\n    name: string\n}\n\nlet htm_rwm = [\"U\", \"U2\", \"U'\", \"F\", \"F2\", \"F'\", \"R\", \"R2\", \"R'\",\n    \"r\", \"r2\", \"r'\", \"D\", \"D2\", \"D'\", \"M\", \"M'\", \"M2\", \"B\", \"B'\", \"B2\"]\nlet rrwmu = [\"U\", \"U'\", \"U2\", \"R\", \"R'\", \"R2\",\n    \"r\", \"r'\", \"r2\", \"M'\", \"M\", \"M2\"]\nlet rrwmu_m_first = [\"U\", \"U'\", \"U2\", \"R\", \"R'\", \"R2\", \"M'\", \"M\", \"M2\",\n\"r\", \"r'\", \"r2\"]\nlet rrwmu_f = [\"U\", \"U'\", \"U2\", \"R\", \"R'\", \"R2\",\n    \"r\", \"r'\", \"r2\", \"M'\", \"M\", \"M2\", \"F'\", \"F\", \"F2\"]\nlet rrwmu_b = [\"U\", \"U'\", \"U2\", \"R\", \"R'\", \"R2\",\n    \"r\", \"r'\", \"r2\", \"M'\", \"M\", \"M2\", \"B'\", \"B\", \"B2\"]\nlet htm_rwm_uw = [\"U\", \"U2\", \"U'\", \"F\", \"F2\", \"F'\", \"R\", \"R2\", \"R'\",\n    \"r\", \"r2\", \"r'\", \"u\", \"u2\", \"u'\", \"M\", \"M'\", \"M2\", \"B\", \"B'\", \"B2\"]\nlet htm_rwm_fws = [\"U\", \"U2\", \"U'\", \"F\", \"F2\", \"F'\", \"R\", \"R2\", \"R'\",\n    \"r\", \"r2\", \"r'\", \"M\", \"M'\", \"M2\", \"D\", \"D'\", \"D2\",\n    \"f\", \"f'\", \"f2\", \"S'\", \"S\", \"S2\"] // TODO: suppress the other S for OH mode?\n\nlet xyz = [\"x\", \"x'\", \"x2\", \"y\", \"y'\", \"y2\", \"z\", \"z'\", \"z2\"]\n\nexport function Pruner(config: PrunerConfig) : PrunerT {\n    let dist: Uint8Array;\n    let { size, encode, solved_states, max_depth, moveset: moveset_str, name} = config\n    let moveset = moveset_str.map(x => Move.all[x])\n    let initialized = false\n    let level_states = [[...solved_states]]\n    function init() {\n        if (initialized) return\n        initialized = true\n        dist = new Uint8Array(size).fill(255)\n        for (let state of solved_states) {\n            dist[encode(state)] = 0\n        }\n        let frontier = [...solved_states]\n        let total_expanded = frontier.length\n        for (let i = 0; i < max_depth; i++) {\n            //console.log(\"pruner: expanding depth \", i)\n            let new_frontier = []\n            for (let state of frontier) {\n                for (let move of moveset) {\n                    let newState = state.apply(move) // clone\n                    let idx = encode(newState)\n                    if (dist[idx] === 255) {\n                        dist[idx] = i + 1;\n                        new_frontier.push(newState)\n                    }\n                }\n            }\n            frontier = new_frontier\n            if (config.rev_lookup_depth && i + 1 <= config.rev_lookup_depth) {\n                level_states.push([...frontier])\n            }\n            total_expanded += frontier.length\n        }\n        //console.log(`${name} pruning table generated. depth = ${max_depth}. size = ${total_expanded}`)\n        if (config.rev_lookup_depth) {\n            // console.log(`${name} pruning reverse lookup generated. depth = ${config.rev_lookup_depth}. size = ${level_states.map(x => x.length).reduce((x,y)=>x+y)}`)\n        }\n    }\n    function query(cube: CubieCube) {\n        let d = dist[encode(cube)]\n        if (d === 255) return max_depth + 1;\n        return d\n    }\n    function equal(cube1: CubieCube, cube2: CubieCube) {\n        return encode(cube1) === encode(cube2)\n    }\n    return  {\n        init,\n        query,\n        equal,\n        encode,\n        moveset,\n        max_depth,\n        size\n    }\n}\n\n\n\nlet prunerFactory = function(def: PrunerDef): PrunerConfig {\n    // edge\n    if (def.corner.length !== 8 || def.edge.length !== 12 || def.center.length !== 6) {\n        throw new Error(\"Invalid pruner def\");\n    }\n    const {S, O, I, X} = PrunerPiece\n    const def_to_idx = (d : PrunerPiece[], count_all?: boolean) => {\n        let curr_idx = 0, idx_arr = []\n        for (let i = 0; i < d.length; i++) {\n            if (d[i] === S || (count_all && (d[i] === O || d[i] === I))) {\n                idx_arr.push(curr_idx++);\n            } else idx_arr.push(-1);\n        }\n        return idx_arr;\n    }\n    let eosize = def.edge.filter(x => x === S || x === O).length\n    let epsize = def.edge.filter(x => x === S).length\n    let eisize = def.edge.filter(x => x !== X).length\n    let esize = Math.pow(2, eosize) * Math.pow(eisize, epsize)\n    let ep_idx = def_to_idx(def.edge, false);\n    let e_idx = def_to_idx(def.edge, true);\n\n    let cosize = def.corner.filter(x => x === S || x === O).length\n    let cpsize = def.corner.filter(x => x === S).length\n    let cisize = def.corner.filter(x => x !== X).length\n    let csize = Math.pow(3, cosize) * Math.pow(cisize, cpsize)\n    let cp_idx = def_to_idx(def.corner, false);\n    let c_idx = def_to_idx(def.corner, true);\n\n    let tosize = def.center.filter(x => x === O).length\n    let tpsize = def.center.filter(x => x === S).length\n    let tisize = def.center.filter(x => x !== X).length\n    let tsize = Math.pow(2, tosize) * Math.pow(tisize, tpsize)\n    let tp_idx = def_to_idx(def.center, false);\n\n    let size = esize * csize * tsize;\n\n    function encode(cube: CubieCube) {\n        let eo = 0, ep = 0, co = 0, cp = 0, to = 0, tp = 0, e, c, t\n        for (let i = 0; i < 12; i++) {\n            switch (def.edge[cube.ep[i]]) {\n                case S:\n                    eo = eo * 2 + cube.eo[i];\n                    ep = ep + Math.pow(eisize, ep_idx[cube.ep[i]]) * e_idx[i];\n                    break;\n                case O:\n                    eo = eo * 2 + cube.eo[i];\n                    break;\n            }\n        }\n        e = ep * Math.pow(2, eosize) + eo\n        for (let i = 0; i < 8; i++) {\n            switch (def.corner[cube.cp[i]]) {\n                case S:\n                    co = co * 3 + cube.co[i];\n                    cp = cp + Math.pow(cisize, cp_idx[cube.cp[i]]) * c_idx[i];\n                    break;\n                case O:\n                    co = co * 3 + cube.co[i];\n                    break;\n            }\n        }\n        c = cp * Math.pow(3, cosize) + co\n        for (let i = 0; i < 6; i++) {\n            switch (def.center[cube.tp[i]]) {\n                case S:\n                    tp = Math.pow(tisize, tp_idx[cube.tp[i]]) + i;\n                    break;\n                case O:\n                    to = to * 3 + (cube.tp[i] / 2) | 0;\n                    break;\n            }\n        }\n        t = tp * Math.pow(3, tosize) + to\n        return e * csize * tsize + c * tsize + t\n    }\n\n    const solved_states = def.solved_states.map( m => new CubieCube().apply(m))\n    const moveset = def.moveset\n    const max_depth = def.max_depth\n    const name = def.name\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name\n    }\n}\n\n\nlet fbdrPrunerConfigGen = (max_depth: number) : PrunerConfig => {\n    const esize = Math.pow(24, 4)\n    const csize = Math.pow(24, 2)\n    const size = esize * csize\n\n    function encode(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        if (cube.cp[i] === 4) {\n          c1 = i * 3 + cube.co[i]\n        } else if (cube.cp[i] === 5) {\n          c2 = i * 3 + cube.co[i];\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0, e3 = 0, e4 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 5 : e1 = i * 2 + cube.eo[i]; break;\n              case 8 : e2 = i * 2 + cube.eo[i]; break;\n              case 9 : e3 = i * 2 + cube.eo[i]; break;\n              case 7 : e4 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24 * 24) + e2 * (24 * 24) + e3 * 24 + e4\n      return enc_c + 24 * 24 * enc_e\n    }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n    const moveset = htm_rwm\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"fbdr\"\n    }\n}\n\nlet fbdrPrunerConfig = fbdrPrunerConfigGen(5)\n\n// let fbPrunerConfigAuto = prunerFactory({\n//     corner: [I,I,I,I,S,S,I,I],\n//     edge:   [I,I,I,I,I,S,I,I,S,S,I,I],\n//     center: [I,I,I,I,S,I],\n//     solved_states: [\"id\"],\n//     moveset: htm_rwm,\n//     max_depth: 5\n// });\n\n\nlet fbAtBLPrunerConfigGen = (max_depth: number) : PrunerConfig => {\n    const esize = Math.pow(24, 2)\n    const csize = Math.pow(24, 2)\n    const tsize = 6\n    const size = esize * csize * tsize\n\n    function encode(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 4: c1 = i * 3 + cube.co[i]; break;\n            case 5: c2 = i * 3 + cube.co[i]; break;\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 5 : e1 = i * 2 + cube.eo[i]; break;\n              case 8 : e2 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24) + e2\n      let t1 = 0\n      for (let i = 0; i < 6; i++) {\n         if (cube.tp[i] === Face.L) {\n            t1 = i;\n         }\n      }\n      const enc_t = t1\n      return enc_e * (csize * tsize) + enc_c * tsize + enc_t\n    }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    const moveset = htm_rwm_fws\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        // rev_lookup_depth: 3,\n        name: \"fb\"\n    }\n}\n\nlet fbAtDLPrunerConfigGen = (max_depth: number) : PrunerConfig => {\n    const esize = Math.pow(24, 2)\n    const csize = Math.pow(24, 2)\n    const tsize = 6\n    const size = esize * csize * tsize\n\n    function encode(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 4: c1 = i * 3 + cube.co[i]; break;\n            case 5: c2 = i * 3 + cube.co[i]; break;\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 8 : e1 = i * 2 + cube.eo[i]; break;\n              case 9 : e2 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24) + e2\n      let t1 = 0\n      for (let i = 0; i < 6; i++) {\n         if (cube.tp[i] === Face.L) {\n            t1 = i;\n         }\n      }\n      const enc_t = t1\n      return enc_e * (csize * tsize) + enc_c * tsize + enc_t\n    }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    const moveset = htm_rwm_uw\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        // rev_lookup_depth: 3,\n        name: \"fb\"\n    }\n}\n\nlet fbPrunerConfigGen = (max_depth: number) : PrunerConfig => {\n    const esize = Math.pow(24, 3)\n    const csize = Math.pow(24, 2)\n    const size = esize * csize\n\n    function encode(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 4: c1 = i * 3 + cube.co[i]; break;\n            case 5: c2 = i * 3 + cube.co[i]; break;\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0, e3 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 5 : e1 = i * 2 + cube.eo[i]; break;\n              case 8 : e2 = i * 2 + cube.eo[i]; break;\n              case 9 : e3 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24) + e2 * (24) + e3\n      return enc_e * (24 * 24) + enc_c\n    }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    const moveset = htm_rwm\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        // rev_lookup_depth: 3,\n        name: \"fb\"\n    }\n}\n\nlet fbAtBLPrunerConfig = fbAtBLPrunerConfigGen(5)\nlet fbAtDLPrunerConfig = fbAtDLPrunerConfigGen(5)\nlet fbPrunerConfig = fbPrunerConfigGen(5)\nlet ssPrunerConfig = (is_front: boolean) => {\n    const size = Math.pow(24, 3)\n    const c1 = is_front ? 7 : 6;\n    const e1 = is_front ? 11 : 10\n    const e2 = 7\n    function encode(cube:CubieCube) {\n      let v = [0 ,0, 0]\n      for (let i = 0; i < 8; i++) {\n        if ( cube.cp[i] === c1) v[0] = i * 3 + cube.co[i]\n      }\n      for (let i = 0; i < 12; i++) {\n          if (cube.ep[i] === e1) v[1] = i * 2 + cube.eo[i];\n          else if (cube.ep[i] === e2) v[2] = i * 2 + cube.eo[i]\n      }\n      return v[0] + v[1] * 24 + v[2] * 24 * 24\n    }\n\n    const moves = [[]]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move))\n    const max_depth = 8\n    const moveset = rrwmu\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"ss\" + (is_front ? \"-front\" : \"-back\")\n    }\n}\n\nlet ssDpPrunerConfig = (is_front: boolean) => {\n    const size = Math.pow(24, 2)\n    const c1 = is_front ? 7 : 6;\n    const e1 = 7\n    function encode(cube:CubieCube) {\n      let v0 = 0, v1 = 0\n      for (let i = 0; i < 8; i++) {\n        if ( cube.cp[i] === c1) v0 = i * 3 + cube.co[i]\n      }\n      for (let i = 0; i < 12; i++) {\n          if (cube.ep[i] === e1) v1 = i * 2 + cube.eo[i];\n      }\n      return v0 + v1 * 24\n    }\n\n    const moves = [\"\", \"R\", \"R2\", \"R'\"]\n    const solved_states = moves.map( (move : string) => new CubieCube().apply(move))\n    const max_depth = 8\n    const moveset = rrwmu_m_first\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"ssdp\" + (is_front ? \"-front\" : \"-back\")\n    }\n}\n\nlet sbPrunerConfig = function(){\n    const esize = Math.pow(24, 3)\n    const csize = Math.pow(24, 2)\n    const size = esize * csize\n\n    function encode(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 6: c1 = i * 3 + cube.co[i]; break;\n            case 7: c2 = i * 3 + cube.co[i]; break;\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0, e3 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 7  : e1 = i * 2 + cube.eo[i]; break;\n              case 10 : e2 = i * 2 + cube.eo[i]; break;\n              case 11 : e3 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24) + e2 * (24) + e3\n      return enc_e * (24 * 24) + enc_c\n    }\n\n    const moves = [[]]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    const moveset = rrwmu\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth: 6,\n        moveset,\n        // rev_lookup_depth: 3,\n        name: \"sb_rRUM\"\n    }\n}()\n\nlet lpSbPrunerConfigsAuto = (lp_front: boolean) => [\n    prunerFactory({\n        corner: lp_front ? [I,I,I,I,S,I,I,S] : [I,I,I,I,I,S,S,I],\n        edge:   lp_front ? [I,I,I,I,I,I,I,S,S,I,I,S] : [I,I,I,I,I,I,I,S,I,S,S,I],\n        center: [I,I,I,I,I,I],\n        solved_states: [\"id\"],\n        moveset: lp_front ? rrwmu_f : rrwmu_b,\n        max_depth: 5,\n        name: \"FBLP+SSdiag\"\n    }),\n    prunerFactory({ // SB\n        corner: [I,I,I,I,I,I,S,S],\n        edge:   [I,I,I,I,I,I,I,S,I,I,S,S],\n        center: [I,I,I,I,I,I],\n        solved_states: [\"id\"],\n        moveset: lp_front ? rrwmu_f : rrwmu_b,\n        max_depth: 5,\n        name: \"SB with LP\"\n    }),\n];\n\nlet lpSbSbPrunerConfigGen = (lp_front: boolean, max_depth: number) : PrunerConfig => {\n    const esize = Math.pow(24, 3)\n    const csize = Math.pow(24, 2)\n    const size = esize * csize\n    function encode(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 6: c1 = i * 3 + cube.co[i]; break;\n            case 7: c2 = i * 3 + cube.co[i]; break;\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0, e3 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 7 : e1 = i * 2 + cube.eo[i]; break;\n              case 10 : e2 = i * 2 + cube.eo[i]; break;\n              case 11 : e3 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24) + e2 * (24) + e3\n      return enc_e * (24 * 24) + enc_c\n    }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    const moveset = (lp_front ? rrwmu_f : rrwmu_b)\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"lpsb-sb\" + (lp_front ? \"+front-lp\" : \"+back-lp\")\n    }\n}\n\nlet lpSbDiagPrunerConfigGen = (lp_front: boolean, max_depth: number) : PrunerConfig => {\n    const esize = Math.pow(24, 3)\n    const csize = Math.pow(24, 2)\n    const size = esize * csize\n    function encode_f(cube:CubieCube) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 4: c1 = i * 3 + cube.co[i]; break;\n            case 7: c2 = i * 3 + cube.co[i]; break;\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0, e3 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 7 : e1 = i * 2 + cube.eo[i]; break;\n              case 8 : e2 = i * 2 + cube.eo[i]; break;\n              case 11 : e3 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24) + e2 * (24) + e3\n      return enc_e * (24 * 24) + enc_c\n    }\n    function encode_b(cube:CubieCube) {\n        let c1 = 0, c2 = 0\n        for (let i = 0; i < 8; i++) {\n          switch (cube.cp[i]) {\n              case 5: c1 = i * 3 + cube.co[i]; break;\n              case 6: c2 = i * 3 + cube.co[i]; break;\n          }\n        }\n        const enc_c = c1 * 24 + c2\n        let e1 = 0, e2 = 0, e3 = 0\n        for (let i = 0; i < 12; i++) {\n            switch (cube.ep[i]) {\n                case 7 : e1 = i * 2 + cube.eo[i]; break;\n                case 9 : e2 = i * 2 + cube.eo[i]; break;\n                case 10 : e3 = i * 2 + cube.eo[i]; break;\n            }\n        }\n        const enc_e = e1 * (24 * 24) + e2 * (24) + e3\n        return enc_e * (24 * 24) + enc_c\n      }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    const moveset = (lp_front ? rrwmu_f : rrwmu_b)\n\n    return {\n        size,\n        encode: lp_front ? encode_f : encode_b,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"lpsb-2sq\" + (lp_front ? \"+front-lp\" : \"+back-lp\")\n    }\n}\n\nlet lpSbPrunerConfigs = (lp_front: boolean) => [\n    lpSbSbPrunerConfigGen(lp_front, 5),\n    lpSbDiagPrunerConfigGen(lp_front, 5)\n];\n\nlet fsPrunerConfig = (is_front: boolean) => {\n    const size = Math.pow(24, 3)\n    const c1 = is_front ? 4 : 5;\n    const e1 = is_front ? 8 : 9;\n    const e2 = 5\n    function encode(cube:CubieCube) {\n      let v0 = 0, v1 = 0, v2 = 0\n      for (let i = 0; i < 8; i++) {\n        if ( cube.cp[i] === c1) v0 = i * 3 + cube.co[i]\n      }\n      for (let i = 0; i < 12; i++) {\n          if (cube.ep[i] === e1) v1 = i * 2 + cube.eo[i];\n          else if (cube.ep[i] === e2) v2 = i * 2 + cube.eo[i]\n      }\n      return v0 + v1 * 24 + v2 * 24 * 24\n    }\n\n    const moves = [[]]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move))\n\n    const max_depth = 5\n    const moveset = htm_rwm\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"fs\" + (is_front ? \"-front\" : \"-back\")\n    }\n}\n\nlet fsPseudoPrunerConfig = (is_front: boolean) => {\n    const size = Math.pow(24, 3)\n    const c1 = is_front ? 5 : 4; // pseudo FS: front solved == FL solved and DL+DBL paired up D* away from solved\n    const e1 = is_front ? 8 : 9;\n    const e2 = 5\n    function encode(cube:CubieCube) {\n        let v0 = 0, v1 = 0, v2 = 0\n        for (let i = 0; i < 8; i++) {\n          if ( cube.cp[i] === c1) v0 = i * 3 + cube.co[i]\n        }\n        for (let i = 0; i < 12; i++) {\n            if (cube.ep[i] === e1) v1 = i * 2 + cube.eo[i];\n            else if (cube.ep[i] === e2) v2 = i * 2 + cube.eo[i]\n        }\n        return v0 + v1 * 24 + v2 * 24 * 24\n    }\n    const pre_moves = is_front ? [\"D\"] : [\"D'\"]\n    const solved_states = pre_moves.map( (move : string) => new CubieCube().apply(move))\n\n    const max_depth = 5\n    const moveset = htm_rwm\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"fs-pseudo\" + (is_front ? \"-front\" : \"-back\")\n    }\n}\n\nlet fELineP1PrunerConfig = (is_front: boolean) => {\n    const size = Math.pow(24, 3)\n    const c1 = is_front ? 5 : 4; // FS Eline: front solved == FL + BL solved and DBL staged in DFL, D* away from solved\n    const e1 = 8;\n    const e2 = 9;\n    function encode(cube:CubieCube) {\n        let v0 = 0, v1 = 0, v2 = 0\n        for (let i = 0; i < 8; i++) {\n          if ( cube.cp[i] === c1) v0 = i * 3 + cube.co[i]\n        }\n        for (let i = 0; i < 12; i++) {\n            if (cube.ep[i] === e1) v1 = i * 2 + cube.eo[i];\n            else if (cube.ep[i] === e2) v2 = i * 2 + cube.eo[i]\n        }\n        return v0 + v1 * 24 + v2 * 24 * 24\n    }\n    const pre_moves = is_front ? [\"D\"] : [\"D'\"]\n    const solved_states = pre_moves.map( (move : string) => new CubieCube().apply(move))\n\n    const max_depth = 5\n    const moveset = htm_rwm\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"feline\" + (is_front ? \"-front\" : \"-back\")\n    }\n}\n\nlet fsDrPrunerConfig = (is_front: boolean) => {\n    const size = Math.pow(24, 4)\n    const c1 = is_front ? 4 : 5;\n    const e1 = is_front ? 8 : 9;\n    const e2 = 5\n    const e3 = 7\n    function encode(cube:CubieCube) {\n      let v0 = 0, v1 = 0, v2 = 0, v3 = 0\n      for (let i = 0; i < 8; i++) {\n        if ( cube.cp[i] === c1) v0 = i * 3 + cube.co[i]\n      }\n      for (let i = 0; i < 12; i++) {\n        const ep = cube.ep[i]\n        const eo = cube.eo[i]\n        if (ep === e1) v1 = i * 2 + eo;\n        else if (ep === e2) v2 = i * 2 + eo;\n        else if (ep === e3) v3 = i * 2 + eo;\n      }\n      return v0 + v1 * 24 + v2 * (24 * 24) + v3 * (24 * 24 * 24)\n    }\n\n    const moves = [[]]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move))\n\n    const max_depth = 5\n    const moveset = htm_rwm\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"fs\" + (is_front ? \"-front\" : \"-back\")\n    }\n}\n\n// let fsPrunerConfigAuto = (is_front: boolean) => prunerFactory({\n//         corner: is_front ? [I,I,I,I,S,I,I,I] : [I,I,I,I,I,S,I,I] ,\n//         edge:   is_front ? [I,I,I,I,I,S,I,I,S,I,I,I] : [I,I,I,I,I,S,I,I,I,S,I,I] ,\n//         center: [I,I,I,I,S,I],\n//         solved_states: [\"id\"],\n//         moveset: htm_rwm,\n//         max_depth: 4\n// });\n\nlet fbssPrunerConfigsManual = (is_front: boolean, max_depth?: number) : PrunerConfig[] => {\n    // make a line+ss solver\n    max_depth = max_depth || 5\n    const esize = Math.pow(24, 3) // 3 edges\n    const csize = Math.pow(24, 3) // 3 corners\n    const size = esize * csize\n\n    function encode_front(cube:CubieCube) {\n      let c1 = 0, c2 = 0, c3 = 0\n      for (let i = 0; i < 8; i++) {\n        switch (cube.cp[i]) {\n            case 4 : c1 = i * 3 + cube.co[i]; break\n            case 5 : c2 = i * 3 + cube.co[i]; break\n            case 7 : c3 = i * 3 + cube.co[i]; break\n        }\n      }\n      const enc_c = c1 * (24 * 24) + c2 * 24 + c3\n      let e1 = 0, e2 = 0, e3 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 5 : e1 = i * 2 + cube.eo[i]; break;\n              case 7 : e2 = i * 2 + cube.eo[i]; break;\n              case 11 : e3 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24) + e2 * 24 + e3\n      return enc_c + csize * enc_e\n    }\n\n    function encode_back(cube:CubieCube) {\n        let c1 = 0, c2 = 0, c3 = 0\n        for (let i = 0; i < 8; i++) {\n          switch (cube.cp[i]) {\n              case 4 : c1 = i * 3 + cube.co[i]; break\n              case 5 : c2 = i * 3 + cube.co[i]; break\n              case 6 : c3 = i * 3 + cube.co[i]; break\n          }\n        }\n        const enc_c = c1 * (24 * 24) + c2 * 24 + c3\n        let e1 = 0, e2 = 0, e3 = 0\n        for (let i = 0; i < 12; i++) {\n            switch (cube.ep[i]) {\n                case 5 : e1 = i * 2 + cube.eo[i]; break;\n                case 7 : e2 = i * 2 + cube.eo[i]; break;\n                case 10 : e3 = i * 2 + cube.eo[i]; break;\n            }\n        }\n        const enc_e = e1 * (24 * 24) + e2 * 24 + e3\n        return enc_c + csize * enc_e\n    }\n\n    const moves = [[]]//, Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : Move[]) => new CubieCube().apply(move) )\n\n    //const moveset : Move[] = [\"U\", \"U2\", \"U'\", \"F\", \"F2\", \"F'\", \"R\", \"R2\", \"R'\",\n    //\"r\", \"r2\", \"r'\", \"D\", \"D2\", \"D'\", \"M\", \"M'\", \"M2\", \"B\", \"B'\", \"B2\"].map(s => Move.all[s])\n\n    const moveset = htm_rwm\n\n    return [\n        fbdrPrunerConfigGen(max_depth),\n        {\n            size,\n            encode: (is_front ? encode_front : encode_back),\n            solved_states,\n            max_depth,\n            moveset,\n            name: \"liness-\" + (is_front ? \"front\" : \"back\")\n        },\n    ]\n}\n\n// let fbssPrunerConfigsAuto = (is_front: boolean) => [\n//     prunerFactory({\n//         corner: is_front ? [I,I,I,I,S,S,I,S]: [I,I,I,I,S,S,S,I],\n//         edge:   [I,I,I,I,I,I,I,I,I,I,I,I],\n//         center: [I,I,I,I,I,I],\n//         solved_states: [\"id\"],\n//         moveset: htm_rwm,\n//         max_depth: 5,\n//         name: \"fbss-corner\"\n//     }),\n//     prunerFactory({\n//         corner: [I,I,I,I,I,I,I,I],\n//         edge:   [I,I,I,I,I,S,I,S,S,S,is_front ? I : S,is_front ? S : I],\n//         center: [I,I,I,I,I,I],\n//         solved_states: [\"id\"],\n//         moveset: htm_rwm,\n//         max_depth: 5,\n//         name: \"fbss-edge\"\n//     }),\n// ]\n\nlet fbssPrunerConfigs = fbssPrunerConfigsManual\n\nlet lsePrunerConfig : PrunerConfig = function() {\n    const size = Math.pow(12, 6) * 4 * 4 / 2 // TODO: optimize this plz\n    const edge_encode = [0, 1, 2, 3, 4, -1, 5, -1, -1, -1, -1, -1];\n    function encode(cube:CubieCube) {\n      let enc = [0, 0, 0, 0, 0, 0]\n      for (let i = 0; i < 12; i++) {\n        let idx = edge_encode[cube.ep[i]];\n        if (idx > 0) {\n            enc[idx] = edge_encode[i] * 2 + cube.eo[i];\n        }\n      }\n      let edge_enc = 0;\n      for (let i = 0; i < 6; i++) {\n        edge_enc = edge_enc * 12 + enc[i];\n      }\n      return edge_enc * 4 * 4 + cube.tp[0] * 4 + cube.cp[0]// center[0] and cp[0] must be (0-3)\n    }\n\n    const moves = [Move.all[\"id\"]]\n    const solved_states = moves.map( m => new CubieCube().apply(m))\n\n    const max_depth = 7\n    const moveset = [\"U\", \"U'\", \"U2\", \"M'\", \"M\", \"M2\"]\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"lse\"\n    }\n}()\n\nfunction eolrPrunerConfig(center_flag: number, barbie_mode?: string): PrunerConfig {\n    const size = 6 * 6 * Math.pow(2, 6) * 4 * 2 // TODO: optimize this plz\n\n    const edge_encode = [0, 1, 0, 2, 0, -1, 0, -1, -1, -1, -1, -1];\n    const edge_idx = [0, 1, 2, 3, 4, -1, 5, -1, -1, -1, -1, -1];\n    function encode(cube:CubieCube) {\n      let eo = 0, ep = 0\n      for (let i = 0; i < 12; i++) {\n        let idx = edge_encode[cube.ep[i]];\n        if (idx >= 0) {\n            eo = eo * 2 + cube.eo[i]\n        }\n        if (idx > 0) {\n            ep += Math.pow(6, idx - 1) * edge_idx[i]\n        }\n      }\n      // make no distinction between centers M2 apart\n      return (eo * 36 + ep) * 4 * 2 + ~~(cube.tp[0] / 2) * 4 + cube.cp[0]// center[0] and cp[0] must be (0-3)\n    }\n\n    const moves_ac = cartesianProduct( [\"U'\", \"U\"], [\"M2\"], [\"\", \"U\", \"U'\", \"U2\"] ).map(x => x.join(\" \"))\n    const moves_mc = cartesianProduct( [\"M'\"], [\"U\", \"U'\"], [\"M2\"], [\"\", \"U\", \"U'\", \"U2\"]).map(x => x.join(\" \"))\n    let moves: string[] = []\n    if (center_flag & 0x01) moves = moves.concat(moves_ac)\n    if (center_flag & 0x10) moves = moves.concat(moves_mc)\n\n    const barb_moves_ac = [\"U\", \"U'\"]\n    const barb_moves_mc = [\"M U\", \"M U'\"]\n    let barb_moves: string[] = []\n    if (center_flag & 0x01) barb_moves = barb_moves.concat(barb_moves_ac)\n    if (center_flag & 0x10) barb_moves = barb_moves.concat(barb_moves_mc)\n\n    const pre_moves = barbie_mode === \"barbie\" ? barb_moves :\n        (barbie_mode === \"ab4c\" ? [\"id\"] : moves)\n\n    const solved_states = pre_moves.map( m => new CubieCube().apply(m))\n\n    const max_depth = 20\n    const moveset = [\"U\", \"U'\", \"U2\", \"M'\", \"M\", \"M2\"]\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"eolr-\" + center_flag + \"-\" + barbie_mode\n    }\n}\n\nlet eodmPrunerConfig : PrunerConfig = (function(){\n    const size = 6 * 6 * Math.pow(2, 6) * 4\n\n    const edge_encode = [0, 0, 0, 0, 1, -1, 2, -1, -1, -1, -1, -1];\n    const edge_idx = [0, 1, 2, 3, 4, -1, 5, -1, -1, -1, -1, -1];\n    function encode(cube:CubieCube) {\n      let eo = 0, ep = 0\n      for (let i = 0; i < 12; i++) {\n        let idx = edge_encode[cube.ep[i]];\n        if (idx >= 0) {\n            eo = eo * 2 + cube.eo[i]\n        }\n        if (idx > 0) {\n            ep += Math.pow(6, idx - 1) * edge_idx[i]\n        }\n      }\n      // make no distinction between centers M2 apart\n      return (eo * 36 + ep) * 4 + cube.tp[0]\n    }\n\n    const solved_states = [new CubieCube()]\n    const max_depth = 20\n    const moveset = [\"U\", \"U'\", \"U2\", \"M'\", \"M\", \"M2\"]\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"eodm\"\n    }\n})()\n\nlet centerPrunerConfig : PrunerConfig = (function(){\n    const size = 6 * 6\n    const solved_states = [new CubieCube()]\n    const max_depth = 3\n    const moveset = xyz\n    function encode(cube:CubieCube) {\n        return cube.tp[0] * 6 + cube.tp[2]; // UD FB LR\n    }\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset,\n        name: \"center\"\n    }\n})()\n\nexport { fbdrPrunerConfig, fsPrunerConfig, fsDrPrunerConfig, fsPseudoPrunerConfig, fELineP1PrunerConfig, sbPrunerConfig, ssPrunerConfig, ssDpPrunerConfig,\n    fbPrunerConfig, fbAtDLPrunerConfig, fbAtBLPrunerConfig, lsePrunerConfig, eolrPrunerConfig,\n    prunerFactory, fbssPrunerConfigs, lpSbPrunerConfigs, eodmPrunerConfig, centerPrunerConfig }","import {initialize, solve as min2phaseSolve, Min2PhaseCube} from \"./min2phase.js\"\nimport { CubieCube } from \"../CubeLib\";\n\nexport {initialize}\n\nfunction toMin2Phase(state: CubieCube): Min2PhaseCube {\n  // Note: this is its own inverse.\n  // const conjugate = {\n  //   EDGE: { permutation: [ 1, 0, 3, 2, 5, 4, 7, 6, 8, 9, 11, 10 ],\n  //           orientation: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ] },\n  //   CORNER: { permutation: [ 0, 3, 2, 1, 4, 5, 6, 7 ],\n  //             orientation: [ 0, 0, 0, 0, 0, 0, 0, 0 ] },\n  //   CENTER: { permutation: [ 0, 1, 2, 3, 4, 5 ],\n  //             orientation: [ 0, 0, 0, 0, 0, 0 ] }\n  // };\n  // const pseudo = Combine(def, Combine(def, conjugate, Invert(def, state)), conjugate);\n\n  return {\n    cp: state.cp,\n    co: state.co,\n    ep: state.ep,\n    eo: state.eo\n  }\n}\n\nexport function solve(state: CubieCube): string {\n  return min2phaseSolve(toMin2Phase(state));\n}\n","import { CubieCube, Move, MoveSeq } from './CubeLib';\nimport { arrayEqual } from './Math';\n\nimport { PrunerT, fbdrPrunerConfig, fbssPrunerConfigs, fsPrunerConfig, fsDrPrunerConfig, fsPseudoPrunerConfig, fELineP1PrunerConfig, sbPrunerConfig, ssPrunerConfig, ssDpPrunerConfig, fbPrunerConfig, lsePrunerConfig, PrunerConfig, eolrPrunerConfig, lpSbPrunerConfigs, fbAtDLPrunerConfig, fbAtBLPrunerConfig, eodmPrunerConfig, centerPrunerConfig } from './Pruner';\n\nimport {initialize as min2phase_init, solve as min2phase_solve} from \"../lib/min2phase/min2phase-wrapper\"\nimport { __DEV__ } from '../settings';\n\nimport { CachedPruner } from './CachedSolver';\n\ntype SolverConfig = {\n    is_solved: (cube : CubieCube) => boolean,\n    moveset: Move[],\n    pruners: PrunerT[],\n    pruneSeenEncodings?: boolean\n}\n\ntype Accumulator = {\n    solutions: MoveSeq[],\n    capacity: number\n}\n\nexport type SolverT = {\n    solve: (cube : CubieCube, l : number, r : number, c : number) => MoveSeq[],\n    is_solved: (cube : CubieCube) => boolean,\n    getPruners: () => PrunerT[]\n}\n\n\nfunction Solver(config: SolverConfig) : SolverT{\n    const MAX_STATE_COUNT = 3000000\n    let { moveset, is_solved, pruners } = config\n    let state_count = 0, prune_count = 0;\n    let accum : Accumulator\n    let max_depth : number\n    let min_depth : number\n\n    enum SState {\n        CONTINUE,\n        STOP\n    };\n\n    function solve_depth(cube: CubieCube, min_depth_: number, max_depth_: number, accum_: Accumulator) {\n        accum = accum_\n        max_depth = max_depth_\n        min_depth = min_depth_\n        state_count = 0\n        prune_count = 0\n        search(cube, 0, [])\n        return accum\n    }\n\n    let nextMoves : {[move: string] : Move[] }= Object.create({})\n    function generateNextMoveTable() {\n        function getAvailableMove(name : string) {\n            switch (name[0]) {\n                case \"U\": return moveset.filter(k => k.name[0] !== \"U\" && k.name[0] !== \"u\");\n                case \"u\": return moveset.filter(k => k.name[0] !== \"u\");\n                case \"D\": return moveset.filter(k => k.name[0] !== \"U\" && k.name[0] !== \"D\");\n                case \"R\": {\n                    let base = moveset.filter(k => k.name[0] !== \"R\" && k.name[0] !== \"r\");\n                    // we want to represent all Rr's as RM's. This demands M&r to always be enabled together.\n                    if (name === \"R\") return base.filter(k => k.name !== \"M'\")\n                    if (name === \"R'\") return base.filter(k => k.name !== \"M\")\n                    if (name === \"R2\") return base.filter(k => k.name !== \"M2\")\n                    return base\n                }\n                case \"L\": return moveset.filter(k => k.name[0] !== \"R\" && k.name[0] !== \"M\" && k.name[0] !== \"L\" && k.name[0] !== \"r\");\n                case \"r\": return moveset.filter(k => k.name[0] !== \"R\" && k.name[0] !== \"M\" && k.name[0] !== \"L\" && k.name[0] !== \"r\");\n                case \"M\": return moveset.filter(k => k.name[0] !== \"R\" && k.name[0] !== \"M\" && k.name[0] !== \"L\" && k.name[0] !== \"r\");\n                // f precede F. f'F represented as S'. S' must be standalone (no F/f/S allowed in its neighbor)\n                case \"F\": return moveset.filter(k => k.name[0] !== \"F\" && k.name[0] !== \"f\" && k.name[0] !== \"S\");\n                case \"f\": {\n                    const base = moveset.filter(k => k.name[0] !== \"S\" && k.name[0] !== \"f\")\n                    if (name === \"f'\") return base.filter(k => k.name !== \"F\")\n                    else if (name === \"f\") return base.filter(k => k.name !== \"F'\")\n                    else if (name === \"f2\") return base.filter(k => k.name !== \"F2\")\n                    else return base\n                }\n                case \"S\": return moveset.filter(k => k.name[0] !== \"F\" && k.name[0] !== \"B\" && k.name[0] !== \"S\" && k.name[0] !== \"f\");\n                case \"B\": return moveset.filter(k => k.name[0] !== \"F\" && k.name[0] !== \"B\");\n\n                case \"E\": return moveset.filter(k => k.name[0] !== \"U\" && k.name[0] !== \"D\" && k.name[0] !== \"E\");\n                default: return moveset\n            }\n        }\n        for (let move of moveset) {\n            nextMoves[move.name] = getAvailableMove(move.name)\n        }\n    }\n    generateNextMoveTable()\n\n    function expand(cube: CubieCube, depth: number, solution: Move[]) : SState{\n        const availableMoves : Move[] = solution.length > 0 ? nextMoves[solution[solution.length - 1].name] : moveset\n        let seen_encodings : Set<BigInt|number> | null = null\n        let prune = config.pruneSeenEncodings\n        if (prune) {\n            seen_encodings = new Set()\n            if (pruners.length === 1)\n                seen_encodings.add(pruners[0].encode(cube))\n            else  {\n                let n = BigInt(pruners[0].encode(cube)) * BigInt(pruners[1].size) + BigInt(pruners[1].encode(cube))\n                seen_encodings.add(n)\n            }\n        }\n        for (let move of availableMoves) {\n            let new_cube = cube.apply_one(move)\n            let enc = (pruners.length === 1) ? pruners[0].encode(new_cube) :\n                BigInt(pruners[0].encode(new_cube)) * BigInt(pruners[1].size) + BigInt(pruners[1].encode(new_cube))\n\n            if (seen_encodings == null || !seen_encodings.has(enc)) {\n                seen_encodings?.add(enc)\n                solution.push(move)\n                let st : SState = search(new_cube, depth + 1, solution)\n                solution.pop()\n                if (st === SState.STOP) {\n                    return SState.STOP\n                }\n            }\n        }\n        return SState.CONTINUE\n    }\n\n    function try_push(solution: Move[], depth: number) {\n        if (depth < min_depth) return SState.CONTINUE\n        if (accum.solutions.length < accum.capacity) {\n            let flag = true\n            for (let sol of accum.solutions) {\n                if (arrayEqual(sol.moves, solution)) {\n                    flag = false;\n                    break;\n                }\n            }\n            if (flag) {\n                accum.solutions.push(new MoveSeq([...solution]))\n            }\n        }\n\n        if (accum.solutions.length === accum.capacity) {\n            return SState.STOP\n        } else {\n            return SState.CONTINUE\n        }\n    }\n\n    function search(cube: CubieCube, depth: number, solution: Move[]) : SState {\n        state_count++;\n        if (state_count > MAX_STATE_COUNT) {\n            return SState.STOP\n        }\n        if (is_solved(cube)) {\n            return try_push(solution, depth)\n        } else {\n            if (depth >= max_depth) return SState.CONTINUE;\n            let d = Math.max(...pruners.map(p => p.query(cube)))\n            if (d + depth > max_depth) {\n                prune_count++;\n                return SState.CONTINUE\n            } else {\n                return expand(cube, depth, solution)\n            }\n        }\n    }\n\n    function solve(cube: CubieCube, depth_l: number, depth_r: number, capacity: number) {\n        let accum : Accumulator = {\n            solutions: [],\n            capacity\n        }\n        for (let i = depth_l; i <= depth_r; i++) {\n            accum = solve_depth(cube, depth_l, i, accum)\n            if (accum.solutions.length === accum.capacity || state_count >= MAX_STATE_COUNT) {\n                break;\n            }\n        }\n        if (__DEV__) console.log(`Number of states = ${state_count}, pruned = ${prune_count}`);\n        return accum.solutions\n    }\n\n    function getPruners() {\n        return pruners\n    }\n    return { solve, is_solved, getPruners }\n};\n\nfunction solverFactory(prunerConfig: PrunerConfig) {\n    let pruner = CachedPruner.get(prunerConfig) //Pruner(prunerConfig)\n    pruner.init()\n\n    let is_solved = (cube: CubieCube) => pruner.query(cube) === 0;\n\n    let config = {\n        is_solved,\n        moveset: prunerConfig.moveset.map(s => Move.all[s]),\n        pruners: [pruner],\n        pruneSeenEncodings: true\n    }\n\n    let solver = Solver(config)\n    return solver\n}\n\nexport function solverFactory2(prunerConfigs: PrunerConfig[]) {\n    let pruners = prunerConfigs.map(pc => {\n        return CachedPruner.get(pc)\n    })\n    pruners.forEach(p => p.init())\n    //let solvedEncodings = prunerConfig.solved_states.map(s => prunerConfig.encode(s))\n    let is_solved = (cube: CubieCube) => pruners.every(p => p.query(cube) === 0)\n\n    let config : SolverConfig = {\n        is_solved,\n        moveset: prunerConfigs[0].moveset.map(s => Move.all[s]),\n        pruners,\n        pruneSeenEncodings: true\n    }\n    let solver = Solver(config)\n    return solver\n}\n\n\nlet FbSolver = () => solverFactory(fbPrunerConfig)\n\nlet FbSolverAtDL = () => solverFactory(fbAtDLPrunerConfig)\n\nlet FbSolverAtBL = () => solverFactory(fbAtBLPrunerConfig)\n\nlet FbdrSolver = () => solverFactory(fbdrPrunerConfig)\n\nlet SsSolver = (is_front: boolean) => solverFactory(ssPrunerConfig(is_front))\n\nlet SsDpSolver = (is_front: boolean) => solverFactory(ssDpPrunerConfig(is_front))\n\n// hand-crafted encoders are much faster though...\nlet FbssSolver =  (is_front: boolean) => solverFactory2(fbssPrunerConfigs(is_front))\n\nlet LpsbSolver = (is_front: boolean) => solverFactory2(lpSbPrunerConfigs(is_front))\nlet SbSolver = () => solverFactory(sbPrunerConfig)\n\nlet FsSolver = (is_front: boolean) => solverFactory(fsPrunerConfig(is_front))\nlet FsPseudoSolver = (is_front: boolean) => solverFactory(fsPseudoPrunerConfig(is_front))\nlet FELineP1Solver = (is_front: boolean) => solverFactory(fELineP1PrunerConfig(is_front))\nlet FsDrSolver = (is_front: boolean) => solverFactory(fsDrPrunerConfig(is_front))\n\nlet LSESolver = () => solverFactory(lsePrunerConfig)\n\nlet EOLRSolver = (center_flag: number, barbie_mode?: string) =>\n    solverFactory(eolrPrunerConfig(center_flag, barbie_mode))\n\nlet EOdMSolver = () => solverFactory(eodmPrunerConfig)\n\nlet CenterSolver = () => solverFactory(centerPrunerConfig)\n\nlet Min2PhaseSolver : () => SolverT = function() {\n    // polyfill for min2phase\n\n    min2phase_init();\n    function solve(cube : CubieCube, l : number, r : number, c : number) {\n        console.assert(arrayEqual(cube.tp, new CubieCube().tp), \"Cube center is not solved: \" + cube.tp)\n        const transformed_cube = cube.to_cstimer_cube()\n        console.assert( transformed_cube.is_solveable(), \"Cube must be solveable\")\n        let solution = min2phase_solve(transformed_cube);\n        return [ new MoveSeq(solution).inv() ]\n    }\n    function is_solved(cube: CubieCube) {\n        return true\n    }\n    function getPruners() {\n        return []\n    }\n    return {\n        solve,\n        is_solved,\n        getPruners\n    }\n}\n\n\n\nexport { FbdrSolver, FbSolver, FbSolverAtDL, FbSolverAtBL, SbSolver, FbssSolver, FsSolver, FsDrSolver, FsPseudoSolver, FELineP1Solver, SsSolver, SsDpSolver, Min2PhaseSolver, LSESolver, EOLRSolver, LpsbSolver, EOdMSolver, CenterSolver }","import { Pruner, PrunerConfig, PrunerT } from './Pruner';\nimport { FbdrSolver, SolverT, FsSolver, FsDrSolver, FsPseudoSolver, FELineP1Solver, SsSolver, SsDpSolver, SbSolver, FbSolver, FbSolverAtBL, FbSolverAtDL, FbssSolver, LpsbSolver, Min2PhaseSolver, LSESolver, EOLRSolver, EOdMSolver, CenterSolver} from './Solver';\n\nlet all_solvers = [\n\"fbdr\",\"fb\", \"fs-front\", \"fs-back\", \"ss-front\", \"ss-back\", \"min2phase\",\n\"fsdr-front\", \"fsdr-back\",\n\"lse\", \"eolrac\", \"eolrmc\", \"eolr\", \"eolrac-b\", \"eolrmc-b\", \"eolr-b\", \"sb\", \"eodm\" ]\n\nlet CachedPruner = function() {\n    let cache : Map<string, PrunerT> = new Map()\n    function get(pc: PrunerConfig) {\n        let pcs = JSON.stringify(pc)\n        if (!cache.has(pcs)) {\n            let pruner = Pruner(pc)\n            cache.set(pcs, pruner)\n            return pruner\n        } else {\n            return cache.get(pcs) as PrunerT\n        }\n    }\n    return { get }\n}()\n\nlet CachedSolver = function() {\n    let cache : Map<string, SolverT> = new Map()\n    function get(s: string) {\n        if (!cache.has(s)) {\n            switch (s) {\n                case \"fbdr\": cache.set(s, FbdrSolver()); break\n                case \"fb\": cache.set(s, FbSolver()); break\n                case \"fb@dl\": cache.set(s, FbSolverAtDL()); break\n                case \"fb@bl\": cache.set(s, FbSolverAtBL()); break\n                case \"fs-front\": cache.set(s, FsSolver(true)); break\n                case \"fs-back\": cache.set(s, FsSolver(false)); break\n                case \"fs-pseudo-front\": cache.set(s, FsPseudoSolver(true)); break\n                case \"fs-pseudo-back\": cache.set(s, FsPseudoSolver(false)); break\n                case \"felinep1-front\": cache.set(s, FELineP1Solver(true)); break\n                case \"felinep1-back\": cache.set(s, FELineP1Solver(false)); break\n                case \"fsdr-front\": cache.set(s, FsDrSolver(true)); break\n                case \"fsdr-back\": cache.set(s, FsDrSolver(false)); break\n                case \"ss-front\": cache.set(s, SsSolver(true)); break\n                case \"ss-back\": cache.set(s, SsSolver(false)); break\n                case \"ssdp-front\": cache.set(s, SsDpSolver(true)); break\n                case \"ssdp-back\": cache.set(s, SsDpSolver(false)); break\n                case \"fbss-front\": cache.set(s, FbssSolver(true)); break\n                case \"fbss-back\": cache.set(s,FbssSolver(false)); break\n                case \"lpsb-front\": cache.set(s,LpsbSolver(true)); break\n                case \"lpsb-back\": cache.set(s,LpsbSolver(false)); break\n                case \"sb\": cache.set(s, SbSolver()); break\n\n                case \"min2phase\": cache.set(s, Min2PhaseSolver()); break\n                case \"lse\": cache.set(s, LSESolver()); break\n                case \"lse-ab4c\": cache.set(s, EOLRSolver(0x01, \"ab4c\")); break\n                case \"eolrac\": cache.set(s, EOLRSolver(0x01)); break\n                case \"eolrmc\": cache.set(s, EOLRSolver(0x10)); break\n                case \"eolr\": cache.set(s, EOLRSolver(0x11)); break\n                case \"eolrac-b\": cache.set(s, EOLRSolver(0x01, \"barbie\")); break\n                case \"eolrmc-b\": cache.set(s, EOLRSolver(0x10, \"barbie\")); break\n                case \"eolr-b\": cache.set(s, EOLRSolver(0x11, \"barbie\")); break\n                case \"eodm\" : cache.set(s, EOdMSolver()); break\n\n                case \"center\": cache.set(s, CenterSolver()); break\n            }\n        }\n        return cache.get(s) as SolverT\n    }\n    return {get}\n}()\n\nexport {CachedSolver, CachedPruner, all_solvers}","import React from 'react';\nimport makeStyles from '@mui/styles/makeStyles';\n\nimport {\n  Button, IconButton, DialogContent, TextField, DialogContentText\n} from '@mui/material';\n\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogTitle from '@mui/material/DialogTitle';\n\nimport { Table, Paper, TableBody, TableCell, TableHead, TableRow } from '@mui/material';\n\nimport PlaylistPlayIcon from '@mui/icons-material/PlaylistPlay';\nimport DeleteOutlineIcon from '@mui/icons-material/DeleteOutline';\nimport AddIcon from '@mui/icons-material/Add';\nimport { AppState, Action, FavCase } from '../Types';\nimport { all_solvers } from '../lib/CachedSolver';\n\n\nconst useStyles = makeStyles(theme => ({\n  table: {\n    width: '100%',\n    minWidth: 200,\n    backgroundColor: theme.palette.background.paper,\n  },\n}));\n\nexport function warnDialog(props: { confirm: () => void} ) {\n\n}\n\nfunction parseAddString(state: AppState, s : string) : [ FavCase[], boolean] {\n  const res : FavCase[] = []\n\n  const allSolvers = new Set(all_solvers);\n  for (const line of s.split('\\n')) {\n    let cols = line.split(',')\n    if (cols.length !== 2) continue\n    let solver = cols[0].trim().split(\"|\")\n    let setup = cols[1].trim()\n\n    if (solver.every(x => allSolvers.has(x))) {\n      let case_ : FavCase = {\n        mode: state.mode,\n        solver,\n        setup\n      }\n      res.push(case_)\n    }\n  }\n  if (res.length > 0) return [res, true]\n  else return [ [], false]\n}\n\nexport default function FavListView(props: { state: AppState, dispatch: React.Dispatch<Action> }) {\n  const {state, dispatch} = props\n  const classes = useStyles();\n  const favList = state.favList.filter(c => c.mode === state.mode)\n\n  const play = (i: number) => {\n    dispatch({ type: \"favList\", content: [ favList[i] ], action: \"replay\" })\n  }\n  const remove = () => {\n    if (dialogID >= 0 && dialogID < favList.length)\n    dispatch({ type: \"favList\", content: [ favList[dialogID] ], action: \"remove\" })\n  }\n  const [ dialogID, setDialogID ] = React.useState(-1)\n\n  const handleClose = () => setDialogID(-1)\n  const handleRemove = () => { remove(); setDialogID(-1); }\n  const dialogDelete = (<Dialog open={dialogID >= 0} onClose={handleClose} >\n    <DialogTitle id=\"alert-dialog-title\">{\"Delete this alg from favorites?\"}</DialogTitle>\n    <DialogActions>\n      <Button onClick={handleClose} color=\"primary\">\n        No\n    </Button>\n      <Button onClick={handleRemove} color=\"primary\" autoFocus>\n        Yes\n    </Button>\n    </DialogActions>\n  </Dialog>)\n\n  const [ addDialogOpen, setAddDialogOpen ] = React.useState(false)\n  const [ addString, setAddString ] = React.useState(\"\")\n  const handleAdd = () => setAddDialogOpen(true)\n  const handleAddClose = () => setAddDialogOpen(false)\n  const handleAddSuccess = () => {\n    let [res, status] = parseAddString(state, addString)\n    if (status) {\n      dispatch({ type: \"favList\", content: res, action: \"add\" })\n    }\n    handleAddClose()\n  }\n  const handleTextChange = (event: { target: { value: React.SetStateAction<string>; }; }) => {\n    setAddString(event.target.value)\n  }\n  const dialogAdd = <Dialog open={addDialogOpen} onClose={handleAddClose} aria-labelledby=\"form-dialog-title\">\n    <DialogTitle id=\"form-dialog-title\">Add New Cases</DialogTitle>\n    <DialogContent>\n      <DialogContentText>\n        Input your cases here. (one per line) <br></br>\n        Format: [category], [setup algorithm].\n        category := fb | fbdr | ss-front | ss-back\n      </DialogContentText>\n      <TextField\n        autoFocus\n        multiline\n        margin=\"dense\"\n        id=\"name\"\n        fullWidth\n        onChange={handleTextChange}\n        onKeyDown={ (event) => { event.stopPropagation() } }\n      />\n    </DialogContent>\n    <DialogActions>\n      <Button onClick={handleAddClose} color=\"primary\">\n        Cancel\n    </Button>\n      <Button onClick={handleAddSuccess} color=\"primary\">\n        Add All\n    </Button>\n    </DialogActions>\n  </Dialog>\n\n\n  return (\n    <div>\n    {dialogDelete}\n    {dialogAdd}\n    <Paper>\n      <Table className={classes.table} size=\"small\" >\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\"> Scramble </TableCell>\n            <TableCell align=\"center\" rowSpan={1}>\n              <IconButton   onClick={handleAdd} component=\"span\" edge=\"end\" size=\"small\" color=\"primary\">\n                <AddIcon />\n              </IconButton>\n              \n            {/* <IconButton component=\"span\" edge=\"end\" size=\"small\" color=\"primary\">\n                <FileCopyIcon />\n              </IconButton> */}\n             </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {favList.map((value, i) => {\n            //const labelId = `favlist-label-${i}`;\n            return (\n              <TableRow key={i}>\n                {/* <TableCell align=\"center\" >\n                  {/* padding=checkbox <Checkbox></Checkbox> */}\n\n                <TableCell align=\"center\">\n                { value.solver.join(\"|\") + \",\" + value.setup }\n                </TableCell>\n                <TableCell align=\"center\">\n                  <IconButton onFocus={(e: { target: { blur: () => void; }; }) => e.target.blur() } onClick={() => play(i)}\n                  component=\"span\" edge=\"end\" size=\"small\" color=\"primary\">\n                    <PlaylistPlayIcon />\n                  </IconButton>\n\n                  <IconButton onFocus={(e: { target: { blur: () => void; }; }) => e.target.blur() } onClick={() => setDialogID(i)}\n                  component=\"span\" edge=\"end\" size=\"small\" color=\"primary\">\n                    <DeleteOutlineIcon />\n                  </IconButton>\n\n                </TableCell>\n              </TableRow>\n            )\n          })}</TableBody>\n      </Table>\n    </Paper>\n    </div>\n  )\n}","import React from \"react\";\n\nimport makeStyles from '@mui/styles/makeStyles';\nimport Toolbar from '@mui/material/Toolbar';\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\n\nimport Box from '@mui/material/Box';\nimport Typography from '@mui/material/Typography';\nimport InfoIcon from '@mui/icons-material/Info';\nimport BookmarkIcon from '@mui/icons-material/Bookmark';\nimport Brightness6Icon from '@mui/icons-material/Brightness6';\nimport IconButton from \"@mui/material/IconButton\";\nimport { SelectChangeEvent } from '@mui/material/Select';\nimport { tab_modes } from \"./AppView\";\n\nimport { theme } from '../theme';\nimport useMediaQuery from '@mui/material/useMediaQuery';\n\nconst useStyles = makeStyles(theme => {\n    let is_bright = theme.palette.primary.main === '#556cd6';\n    return ({\n    page: {\n      backgroundColor: theme.palette.background.default\n    },\n    container: {\n      display: \"flex\"\n    },\n    icon: {\n      minWidth: 0\n    },\n    root: {\n      display: \"flex\"\n    },\n    bar: {\n      backgroundColor: is_bright ? theme.palette.primary.main : '#6e728a', // ,\n      color: theme.palette.background.paper,\n      //borderRadius: \"5px\"\n      display: \"flex\",\n      flexWrap: \"nowrap\",\n      justifyContent: \"space-between\",\n    },\n    select: {\n      backgroundColor: is_bright ? \"#657ce9\" : \"#9095b2\", //9297b3\", //9FA4C2\",\n      color: theme.palette.background.paper,\n      paddingLeft: 25,\n      marginRight: 5,\n      marginLeft: 15,\n      height: 60,\n      fontWeight: 400,\n      fontSize: \"1.0rem\",\n      paddingTop: 6,\n      paddingBottom: 7,\n      [theme.breakpoints.down('sm')]: {\n        paddingLeft: 15,\n        marginRight: -5,\n        marginLeft: 10,\n        fontSize: \"0.9rem\",\n      },\n      [theme.breakpoints.down(400)]: {\n        maxWidth: 160,\n      }\n      //borderBottom: \"1px solid \" + theme.palette.background.default,\n    }\n})})\n\n\nfunction TopBarView(props: { value: number, onChange: (x: number) => void,\n    toggleFav: () => void, toggleBright: () => void, handleInfoOpen: () => void } )\n{\n    let classes = useStyles()\n    let { value, onChange, toggleFav, toggleBright, handleInfoOpen } = props\n    let value_str = tab_modes[value][1] || \"\"\n    let handleChange = (event: SelectChangeEvent<String>) =>  {\n        let tab_idx = tab_modes.findIndex(x => x[1] === (event.target.value as string))\n        onChange(tab_idx)\n        //\n    }\n    const is_sm = useMediaQuery(theme.breakpoints.down('sm'));\n    return (\n        <div>\n            <Box boxShadow={4} >\n            <Toolbar className={classes.bar} >\n            <Typography style={{wordWrap: \"break-word\", fontSize: \"0.9rem\", fontFamily: \"Public Sans\"}} >\n              {is_sm ? \"Roux 🐱\" : \"Roux Trainer\"}\n            </Typography>\n            <Box paddingX={is_sm ? 0: 0.5}/>\n            <Box>\n                <Select\n                     fullWidth\n                     value={value_str}\n                     className={classes.select}\n                     onChange={handleChange}\n                     onFocus={(e) => e.target.blur()}\n                     variant=\"standard\"\n                >\n                    { tab_modes.map( (s, i) => \n                      <MenuItem key={i} value={s[1]} sx={{mx: 1.5}} style={{fontSize: \"1.1rem\", marginBottom: 5}}>\n                        {is_sm ? s[2] : s[1]}\n                      </MenuItem> \n                    )}\n                </Select>\n            </Box>\n            <Box style={{flexGrow: 10}}> </Box>\n            <Box>\n              <IconButton onClick={toggleFav} size={is_sm ? \"small\" : \"large\"}>\n                  <BookmarkIcon />\n              </IconButton>\n              <IconButton onClick={toggleBright} size={is_sm ? \"small\" : \"large\"}>\n                  <Brightness6Icon/>\n              </IconButton>\n              <IconButton onClick={handleInfoOpen} size={is_sm ? \"small\" : \"large\"}>\n                  <InfoIcon />\n              </IconButton>\n            </Box>\n            </Toolbar>\n            </Box>\n        </div>\n    );\n}\n\nexport default TopBarView;","import { CubieCube, MoveSeq } from \"./CubeLib\";\nimport two_gram_meter from './two_gram_v1.json'\nexport abstract class Evaluator {\n    abstract evaluate(moves: MoveSeq) : number;\n    abstract name : string;\n}\nexport class SeqEvaluator extends Evaluator {\n    name = \"sequential\";\n    static moveCost_gen() {\n        let pairs: [string, number][] = [\n            [\"U\", 0.8], [\"U'\", 0.8], [\"U2\", 1.0],\n            [\"R\", 0.8], [\"R'\", 0.8], [\"R2\", 1.2],\n            [\"r\", 1], [\"r'\", 1], [\"r2\", 1.3],\n            [\"L\", 1], [\"L'\", 1], [\"L2\", 1.4],\n            [\"F\", 1.4], [\"F'\", 1.4], [\"F2\", 1.8],\n            [\"f\", 1.4], [\"f'\", 1.4], [\"f2\", 1.8],\n            [\"B\", 1.6], [\"B'\", 1.6], [\"B2\", 2.0],\n            [\"D\", 1.3], [\"D'\", 1.3], [\"D2\", 1.6],\n            [\"M\", 1.5], [\"M'\", 1.2], [\"M2\", 1.6],\n            [\"S\", 3.0], [\"S'\", 1.3], [\"S2\", 2.0],\n            [\"E\", 1.5], [\"E'\", 1.5], [\"E2\", 2.4],\n        ];\n        let costMap = new Map(pairs);\n        return costMap;\n    }\n    static moveCost = SeqEvaluator.moveCost_gen();\n\n    evaluate(moves: MoveSeq) {\n        let sum = 0;\n        for (let m of moves.moves) {\n            const value = (SeqEvaluator.moveCost.get(m.name)) || 1.4;\n            sum += value;\n        }\n        // 090822: solutions should be primarily sorted by HTM to guarantee that an optimal solution can always be returned by the solver\n        return moves.moves.length * 100 + sum;\n    }\n\n}\n\nexport class QTMEvaluator extends Evaluator {\n    name = \"qtm\";\n    evaluate(moves: MoveSeq) {\n        let sum = 0;\n        for (let m of moves.moves) {\n            sum += m.name[1] === \"2\" ? 2 : 1;\n        }\n        return sum * 100 + moves.moves.length;\n    }\n}\n\nexport class RawEvaluator extends Evaluator {\n    name = \"raw\";\n    evaluate(moves: MoveSeq) {\n        return moves.moves.length;\n    }\n}\n\n\nexport class TwoGramEvaluator extends Evaluator {\n    name = \"two-gram\";\n    static meter = two_gram_meter as {[s: string]: string};\n    evaluate(moves_input: MoveSeq) {\n        let score = 0\n        let moves = [\"\", ...moves_input.moves.map(x => x.name), \"\"]\n        for (let i =0; i < moves.length - 1; i++) {\n            let two_gram = moves[i] + moves[i + 1]\n            let curr_score = Number.parseFloat(TwoGramEvaluator.meter[two_gram])\n            if (Number.isNaN(curr_score)) {\n                curr_score = 0.3;\n            }\n            score += curr_score;\n        }\n        return score\n    }\n}\n\n// support right-hand heavy for now only\nenum DPGrip {\n    HOME = 0,\n    R_AWAY,\n    Rp_AWAY,\n    R2_AWAY,\n    DEAD_END\n};\nexport class DPEvaluator extends Evaluator {\n    name = \"dp\";\n    \n    static moveCost_gen() {\n        const HI = 10\n        // TODO: Add combo move + regripk some might be fast\n        let pairs: {[move: string]: number[]} = {\n            // array representing cost of performing move at grip \n            // easiest quarter moves are evaluated at 1 (RUFBDrM'), harder at 1.5 (M), \n               // forced ones at 3\n            // easiest double moves as 1.5, harder ones at 2(M2), forced at 2.5\n            // RH quarter grip in the direction of R at 3\n            // RH quarter grip in the direction of R' at 3\n            // RH quarter grip in the direction of R2 at 4\n            // HI means cost is too high (i.e. regrip is needed)\n\n            // TODO: add \"end state\"\n            \"U\":  [1, 2, HI, HI],\n            \"U'\": [1, 1, 1, 1],\n            \"U2\": [1.5, 1.5, 1.5, 1.5],\n            \"R\":  [1, 1, 1, HI],\n            \"R'\": [1, 1, 1, HI],\n            \"R2\": [1.5, 1.5, 1.5, 1.5],\n            \"F\":  [2.5, HI, 1, HI],\n            \"F'\": [1, 1.5, 1, HI],\n            \"F2\": [HI, 2, 2, HI],\n            \"D\":  [1, 1, 1, HI],\n            \"D'\": [1, 2, 1, HI],\n            \"D2\": [1.5, 1.5, 1.5, HI],\n            \"B\":  [HI, 1, 3, HI],\n            \"B'\": [3, 1.5, 1, HI],\n            \"B2\": [4, 2, 2, HI],\n            \"r\":  [1, 1, 1, HI],\n            \"r'\": [1, 1, 1, HI],\n            \"r2\": [1.5, HI, 1.5, HI],\n            \"M\":  [1, 2, 2, HI],\n            \"M'\": [1, 1.5, 1.5, 2],\n            \"M2\": [1.5, 2, 2, 3],\n        };\n        return pairs\n    }\n    static moveCost = DPEvaluator.moveCost_gen();\n    static moveTransition_gen(): {[key: string]: number[]}{\n        let {R_AWAY, R2_AWAY, HOME, Rp_AWAY, DEAD_END} = DPGrip\n        return {\n            //     HOME  ,  R_AWAY , Rp_AWAY ,  R2_AWAY\n            \"R\":  [R_AWAY,  R2_AWAY, HOME    , DEAD_END],\n            \"R'\": [Rp_AWAY, HOME   , DEAD_END,  R_AWAY ],\n            \"R2\": [R2_AWAY, Rp_AWAY,R_AWAY,  HOME ],\n\n            \"r\":  [R_AWAY,  R2_AWAY, HOME    , DEAD_END],\n            \"r'\": [Rp_AWAY, HOME   , DEAD_END,  R_AWAY ],\n            \"r2\": [R2_AWAY, Rp_AWAY,R_AWAY,  HOME ],\n        }\n    }\n    static moveTransition = DPEvaluator.moveTransition_gen();\n\n    static regripCost_gen() {\n        const HI = 10\n        let pairs: number[][] = [\n            // HOME\n            [0, 2, 2, 3],\n            // R AWAY\n            [1.5, 0, 2, 2],\n            // R' AWAY\n            [1.5, 3, 0, HI],\n            // R2 AWAY\n            [3, 2, HI, 0]\n        ]\n        return pairs\n    }\n    static regripCost = DPEvaluator.regripCost_gen();\n\n    evaluate(moves_input: MoveSeq) {\n        return this.evaluate_with_plan(moves_input).cost\n    }\n    evaluate_with_plan(moves_input: MoveSeq) {\n        // allow \n        const HI = 1e5\n        const allow_any_start = true\n        const len = moves_input.moves.length\n        const DP = Array(len + 1).fill(null).map(() => [HI, HI, HI, HI])\n        const DP_path = Array(len + 1).fill(null).map(() => Array(4).fill(null).map(() => [-1, -1]))\n\n        const regripCost = DPEvaluator.regripCost\n        const moveCost = DPEvaluator.moveCost\n        const moveTransition = DPEvaluator.moveTransition\n        if (allow_any_start) {\n            DP[0] = [0, 0, 0, HI]\n        } else {\n            DP[0] = [0, HI, HI, HI] \n        }\n        for (let i = 0; i < len; i++) {\n            const move = moves_input.moves[i].name\n            for (let prev_grip = 0; prev_grip < 4; prev_grip++) {\n                for (let shifted_grip = 0; shifted_grip < 4; shifted_grip++) {\n                    const cur_scheme = DP[i][prev_grip] + regripCost[prev_grip][shifted_grip] + moveCost[move][shifted_grip]\n                    const cur_grip = moveTransition[move] ? moveTransition[move][shifted_grip] : shifted_grip\n                    if (cur_grip === DPGrip.DEAD_END) continue\n                    if (cur_scheme < DP[i+1][cur_grip]) {\n                        DP[i+1][cur_grip] = cur_scheme\n                        DP_path[i+1][cur_grip] = [prev_grip, shifted_grip]\n                    }\n                }\n            }\n        }\n        // assume not take account cost of readjuting to home grip at the end\n        // Now, find optimal plan\n        let optimal_cost = HI\n        let optimal_ending_grip = -1\n        for (let grip = 0; grip < 4; grip++) {\n            if (DP[len][grip] < optimal_cost) {\n                optimal_cost = DP[len][grip]\n                optimal_ending_grip = grip\n            }\n        }\n        let current_grip = optimal_ending_grip\n        let optimal_plan: [number, number][] = [[current_grip, current_grip]]\n        for (let i = len; i >= 1; i--) {\n            const [previous_grip, previous_shifted_grip] = DP_path[i][current_grip]\n            optimal_plan.push([previous_grip, previous_shifted_grip])\n            current_grip = previous_grip\n        }\n        optimal_plan.reverse()\n\n        let grip_str = [\n            \"HOME\", \"R GRIP\", \"R' GRIP\", \"R2 GRIP\"\n        ]\n        let desc = `start from ${grip_str[optimal_plan[0][0]]}` \n        let current_segment : string[] = []\n        for (let i = 0; i < len; i++) {\n            let [g1, g2] = optimal_plan[i]\n            let move = moves_input.moves[i].name\n            if (g1 === g2) current_segment.push(move)\n            else {\n                desc += `, do ${current_segment.join(\" \")}, regrip to ${grip_str[g2]}`\n                current_segment = [move]\n            }\n        }\n        if (current_segment.length) desc += `, do ${current_segment.join(\" \")}`\n        desc += `, end in ${grip_str[optimal_plan[len][0]]}`\n        return {\n            alg: moves_input.toString(),\n            cost: optimal_cost,\n            //plan: optimal_plan,\n            desc: desc\n        }\n    }\n}\n\n\n\nexport class MovementEvaluator extends Evaluator {\n    name = \"movement\";\n    evaluate(moves_input: MoveSeq) {\n        let cube = new CubieCube()\n        let moves = moves_input.inv().moves\n        //let fb_corners = [4, 5]\n        //let fb_edges = [5, 8, 9]\n        let movement = 0\n        for (let i = 0; i < moves.length - 1; i++) {\n            let cube1 = cube.apply_one(moves[i])\n            let stationary = 0\n            for (let j = 0; j < 8; j++) {\n                if ((cube.cp[j] === 4 || cube.cp[j] === 5) && (cube.cp[j] === cube1.cp[j])) {\n                    stationary++\n                }\n            }\n            for (let j = 0; j < 12; j++) {\n                if ((cube.ep[j] === 5 || cube.ep[j] === 8 || cube.ep[j] === 9) && (cube.ep[j] === cube1.ep[j])) {\n                    stationary++\n                }\n            }\n            if (moves[i].name[1] === \"2\") {\n                movement += 2 * (5 - stationary);\n            } else {\n                movement += 5 - stationary;\n            }\n            cube = cube1\n        }\n        return movement\n    }\n}\n//ames: [\"sequential\", \"two-gram\", \"QTM\", \"default\"],\nexport function getEvaluator(s: string) {\n    switch (s) {\n        case \"Default\": return new SeqEvaluator();\n        case \"two-gram\": return new TwoGramEvaluator();\n        case \"QTM\": return new QTMEvaluator();\n        case \"dp\": return new DPEvaluator();\n        case \"movement\": return new MovementEvaluator();\n        case \"raw\": return new RawEvaluator(); \n        default :\n            return new SeqEvaluator();\n    }\n} \n","import { CubeUtil, CubieCube, Mask, Move, MoveSeq } from './CubeLib';\nimport { CachedSolver } from '../lib/CachedSolver';\nimport { getEvaluator } from '../lib/Evaluator';\n\nexport type fbStageT = \"fb\" | \"fs\" | \"pseudo-fs\" | \"fs-combo\" | \"felinep1\"\n\nexport type AnalyzerState = {\n    scramble: string,\n    post_scramble: string, // the part of solution leading up to the stage under analysis\n    full_solution: SolutionDesc[],\n    stage: string,\n    orientation: string,\n    pre_orientation: string,\n    num_solution: number,\n    fb_stage: fbStageT\n    show_mode: string, //\"foreach\" | \"combined\"\n    hide_solutions: boolean\n}\nexport let initialState : AnalyzerState = {\n    scramble: \"\",\n    post_scramble: \"\",\n    full_solution: [],\n    stage: \"fb\",\n    orientation: \"x2y\",\n    pre_orientation: \"\",\n    num_solution: 1,\n    fb_stage: \"fb\",\n    show_mode: \"foreach\",\n    hide_solutions: true\n}\n\nexport type SolverConfig = {\n    premoves?: string[],\n    num_solution: number,\n    upper_limit: number,\n    lower_limit?: number,\n    evaluator?: string\n  }\n\nexport type SolutionDesc = {\n    solution: MoveSeq,\n    premove: string,\n    score: number,\n    orientation?: string,\n    stage: string,\n    fb_tag?: string\n}\n\nfunction is_fb_solved(cube: CubieCube, oris: MoveSeq[]) {\n    for (let ori of oris) {\n        let cube1 = cube.changeBasis(ori).apply(ori.inv())\n        if (CubeUtil.is_solved(cube1, Mask.fb_mask)) return ori\n    }\n    return null\n}\n\n\n\nexport function analyze_roux_solve(cube: CubieCube, solve: MoveSeq) {\n    //todo: break up half turns to detect cancellation in between stages\n    let oris = get_oris(\"cn\").map(m => new MoveSeq(m))\n    let pres = [\"\", \"x\", \"x'\", \"x2\"].map(m => new MoveSeq(m))\n    const defaultSolution = {\n        solution: [], premove: \"\", orientation: \"\", stage: \"\", score: 0\n    }\n    // figure out which fb gets solved first\n    let stages = [\"fb\", \"ss\", \"sp\", \"cmll\", \"lse\"]\n    let solution : SolutionDesc[] = [];\n    let current_moves : Move[] = []\n    let stage_idx = 0\n    let getMasksForStage = (s: string) => {\n        switch (s) {\n            case \"ss\": return [Mask.ss_front_mask, Mask.ss_back_mask]\n            case \"sp\": return [Mask.sb_mask]\n            case \"cmll\": return [Mask.cmll_mask]\n            case \"lse\": return [Mask.solved_mask]\n            default: return [Mask.solved_mask]\n        }\n    }\n\n    let moves = [ Move.all[\"id\"], ...solve.moves]\n    for (let move of moves) {\n        cube = cube.apply(move)\n        if (move.name !== \"id\") current_moves.push(move)\n\n        if (stage_idx === 0) {\n            let res = is_fb_solved(cube, oris)\n            if (res !== null) {\n                let orientation = res\n                solution.push({ ...defaultSolution,\n                    solution: new MoveSeq(current_moves),\n                    orientation: orientation.moves.join(\"\"),\n                    stage: \"fb\"\n                })\n                stage_idx++\n                current_moves = []\n                cube = cube.changeBasis(orientation).apply(orientation.inv())\n            }\n        }\n        else if (stage_idx !== 3) {\n            let stage = stages[stage_idx]\n            let masks = getMasksForStage(stage)\n            if (masks.some(mask => CubeUtil.is_solved(cube, mask))) {\n                solution.push({ ...defaultSolution,\n                    solution: new MoveSeq(current_moves),\n                    stage\n                })\n                stage_idx++\n                current_moves = []\n            }\n        } else {\n            if (CubeUtil.is_cmll_solved(cube)) {\n                solution.push({ ...defaultSolution,\n                    solution: new MoveSeq(current_moves),\n                    stage: \"cmll\"\n                })\n                stage_idx++\n                current_moves = []\n            }\n        }\n        if (stage_idx >= stages.length) break\n    }\n    if (current_moves.length > 0) {\n        solution.push({ ...defaultSolution,\n            solution: new MoveSeq(current_moves),\n            stage: \"unknown\"\n        })\n    }\n    return solution\n}\n\nfunction solve(solver_str: string, cube: CubieCube, config: SolverConfig) {\n    const solver = CachedSolver.get(solver_str)\n    let { premoves, num_solution, upper_limit } = config\n    let ev = getEvaluator(config.evaluator || \"sequential\")\n    let solver_num_solution = (num_solution < 10) ? 10 : num_solution\n    let solutions = (premoves || [\"\"]).map(pm =>\n        solver.solve(cube.apply(pm), 0, upper_limit, solver_num_solution)\n            .map(x => ({premove: pm, solution: x, score: ev.evaluate(x)}))\n    ).flat()\n    return solutions.sort( (x, y) => x.score - y.score).slice(0, num_solution)\n}\n\n\nconst get_oris = (ori: string, preori?: string) => {\n    let oris : string[] = []\n    if (ori === \"x2y\") {\n        oris = (preori === \"\") ? [\"\", \"y\", \"y'\", \"y2\", \"x2\", \"x2y\", \"x2y'\", \"x2y2\"] :\n        (preori === \"x\") ? [\"x\", \"xy\", \"xy'\", \"xy2\", \"x'\", \"x'y\", \"x'y'\", \"x'y2\"] :\n        [\"z\", \"zy\", \"zy'\", \"zy2\", \"z'\", \"z'y\", \"z'y'\", \"z'y2\"]\n\n    } else if (ori === \"cn\") {\n        oris = [\"\", \"y\", \"y'\", \"y2\", \"x2\", \"x2y\", \"x2y'\", \"x2y2\",\n                \"x\", \"xy\", \"xy'\", \"xy2\", \"x'\", \"x'y\", \"x'y'\", \"x'y2\",\n                \"z\", \"zy\", \"zy'\", \"zy2\", \"z'\", \"z'y\", \"z'y'\", \"z'y2\"]\n    }\n    return oris\n}\nfunction analyze_fb(state: AnalyzerState, cube: CubieCube): SolutionDesc[] {\n    let config : SolverConfig = {\n        premoves: [\"\", \"x\", \"x'\", \"x2\"],\n        num_solution: state.num_solution,\n        upper_limit: 9\n    }\n    let oris = get_oris(state.orientation, state.pre_orientation)\n\n    let solutions : SolutionDesc[] = []\n    if (state.fb_stage === \"fb\") {\n        solutions = oris.map(ori => solve(\"fb\", cube.changeBasis(new MoveSeq(ori)), config).map(sol => ({\n        ...sol, orientation: ori, stage: \"fb\"\n        })).sort( (x, y) => x.score - y.score)).flat()\n    } else {\n        const fb_stage_solvers : Record<fbStageT, string[]>= {\n            \"fb\": [\"fb\"],\n            \"fs\": [\"fs-front\", \"fs-back\"],\n            \"pseudo-fs\": [\"fs-pseudo-front\", \"fs-pseudo-back\"],\n            \"felinep1\": [\"felinep1-front\", \"felinep1-back\"],\n            \"fs-combo\": [\"fs-front\", \"fs-back\", \"fs-pseudo-front\", \"fs-pseudo-back\", \"felinep1-front\", \"felinep1-back\"],\n        }\n        const needs_fb_tag = state.fb_stage === \"fs-combo\"\n        // label the fb_tag if we are in fs-combo mode\n        const fb_tag : Record<string, string> = {\n            \"fs-pseudo-front\": \"Ps\",\n            \"fs-pseudo-back\": \"Ps\",\n            \"felinep1-front\": \"Line\",\n            \"felinep1-back\": \"Line\",\n            \"fs-front\": \"FS\",\n            \"fs-back\": \"FS\",\n            \"fb\": \"FB\"\n        }\n        const solvers = fb_stage_solvers[state.fb_stage]\n\n        solutions = oris\n            .map(ori =>\n                solvers\n                    .map(s => solve(s, cube.changeBasis(new MoveSeq(ori)), config)\n                        .map(sol => ({\n                            ...sol,\n                            orientation: ori,\n                            fb_tag: fb_tag[s],\n                            stage: \"fb\"\n                        })))\n                    .flat()\n                    .sort((x, y) => x.score - y.score)\n            )\n            .flat()\n    }\n\n    return solutions\n}\n\nfunction analyze_ss(state: AnalyzerState, cube: CubieCube): SolutionDesc[] {\n    let config : SolverConfig = {\n        num_solution: state.num_solution,\n        upper_limit: 15\n    }\n    let solutions = [\"ss-front\", \"ss-back\"].map(name => solve(name, cube, config).map(sol => ({\n        ...sol, stage: name\n    })).sort( (x, y) => x.score - y.score)).flat()\n    return solutions\n}\n\nfunction analyze_sp(state: AnalyzerState, cube: CubieCube): SolutionDesc[] {\n    let config : SolverConfig = {\n        num_solution: state.num_solution,\n        upper_limit: 10\n    }\n    let solutions = solve(\"sb\", cube, config).map(sol => ({\n        ...sol, stage: \"sp\"\n    })).sort( (x, y) => x.score - y.score)\n\n    return solutions\n}\n\nfunction analyze_lse(state: AnalyzerState, cube: CubieCube): SolutionDesc[] {\n    let config : SolverConfig = {\n        num_solution: state.num_solution,\n        upper_limit: 20\n    }\n    let solutions = solve(\"lse\", cube, config).map(sol => ({\n        ...sol, stage: \"lse\"\n    })).sort( (x, y) => x.score - y.score)\n\n    return solutions\n}\n\n\nexport function analyze(state: AnalyzerState) {\n    let cube = new CubieCube().apply(state.scramble).apply(state.post_scramble)\n    if (state.stage === \"fb\") return analyze_fb(state, cube)\n    else {\n        let ori = new MoveSeq((state.full_solution[0]?.orientation) || \"\")\n        cube = cube.changeBasis(ori).apply(ori.inv())\n        if (state.stage === \"ss\") return analyze_ss(state, cube)\n        else if (state.stage === \"sp\") return analyze_sp(state, cube)\n        else if (state.stage === \"lse\") return analyze_lse(state, cube)\n    }\n    return []\n}","import React, { Fragment } from 'react'\n\nimport CubeSim from './CubeSim'\nimport { Button, Typography, useTheme, FormControl } from '@mui/material';\nimport makeStyles from '@mui/styles/makeStyles';\nimport Divider from '@mui/material/Divider';\n\nimport Grid from '@mui/material/Grid';\nimport Paper from '@mui/material/Paper';\nimport Box from '@mui/material/Box';\n\nimport { CubeUtil, CubieCube, FaceletCube, Mask, MoveSeq } from '../lib/CubeLib';\n\nimport { AppState, Action} from \"../Types\";\nimport 'typeface-roboto-mono';\nimport { Face, Typ } from '../lib/Defs';\n\nimport { SelectChangeEvent } from '@mui/material/Select';\nimport TextField from '@mui/material/TextField';\n\nimport { AnalyzerState, SolutionDesc, initialState, analyze_roux_solve, fbStageT } from '../lib/Analyzer';\n\nimport { useAnalyzer } from \"../lib/Hooks\";\n\nimport InputLabel from '@mui/material/InputLabel';\nimport Select from '@mui/material/Select';\nimport MenuItem from '@mui/material/MenuItem';\nimport FormHelperText from '@mui/material/FormHelperText';\n\nimport Chip from '@mui/material/Chip';\nimport { CachedSolver } from '../lib/CachedSolver';\nimport Dialog from '@mui/material/Dialog';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogActions from '@mui/material/DialogActions';\nimport EditIcon from '@mui/icons-material/Edit';\n\nimport SearchIcon from '@mui/icons-material/Search';\nimport useMediaQuery from '@mui/material/useMediaQuery';\n\nimport { ColorScheme } from '../lib/CubeLib';\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      paddingTop: theme.spacing(0),\n      paddingBottom: theme.spacing(0),\n      backgroundColor: theme.palette.background.default,\n      transition: \"all .5s ease-in-out\"\n    },\n    button: {\n      width: \"100%\",\n    },\n    paper: {\n      padding: theme.spacing(3),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n      marginBottom: 3,\n      borderRadius: 0\n    },\n    paper2: {\n      paddingLeft: theme.spacing(3),\n      paddingTop: theme.spacing(2),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n      marginBottom: 3,\n      borderRadius: 0\n    },\n    canvasPaper: {\n      padding: theme.spacing(0),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    infoColumn: {\n      color: theme.palette.background.paper\n    },\n    scrambleColumn: {\n      paddingLeft: theme.spacing(3)\n    },\n    textColumn: {\n      // color: \"black\",\n      [theme.breakpoints.up('sm')]: {\n        minHeight: 138\n      },\n    },\n    setup: {\n      whiteSpace: 'pre-line',\n      fontSize: \"1.4rem\",\n      fontWeight:500,\n      [theme.breakpoints.down('sm')]: {\n      fontSize: \"1.0rem\",\n      fontWeight: 500\n      },\n  },\n    condGap: {\n    },\n    fgap: {\n      flexShrink: 100, flexBasis: \"1.5rem\", minWidth: \"1.5em\",\n      [theme.breakpoints.down('sm')]: {\n        flexBasis: \"1.0rem\",\n        minWidth: \"0.4rem\"\n      }\n    },\n    fixedHeight: {\n      height: 250,\n    },\n    title : {\n        color: theme.palette.text.disabled,\n        fontWeight: 500,\n        borderBottom: \"3px solid\",\n    },\n    title1 : {\n      fontWeight: 500,\n      marginTop: 7,\n      border: \"1px solid\",\n      borderRadius: 4,\n      fontSize: \"0.8rem\"\n   },\n    stage: {\n      paddingTop: 5,\n      paddingLeft: 5,\n    },\n    configItem: {\n      paddingRight: 15\n    },\n    stageText: {\n      color: theme.palette.text.primary,\n      textTransform: \"none\"\n    },\n    sourceIcon : {\n        color: theme.palette.secondary.main,\n        fontSize: 15,\n        padding: 0\n    },\n    sourceIconWrap : {\n        //border: \"1px solid \" + theme.palette.text.disabled,\n        //borderRadius: 3\n    },\n    fab: {\n      position: 'absolute',\n      top: theme.spacing(7),\n      left: theme.spacing(2),\n    },\n    prompt: {\n      color: theme.palette.text.secondary,\n    },\n    formControl: {\n      margin: theme.spacing(0),\n      minWidth: 80,\n      maxWidth: 160,\n    },\n    menu: {\n        '& .MuiMenuItem-root': {\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n        },\n    },\n  }))\n\nconst resetState = (state: AnalyzerState) => {\n  return {\n    ...state,\n    postScramble: \"\",\n    full_solution: [],\n    scramble: \"\",\n    stage: \"fb\"\n  }\n}\nfunction ScrambleView(props: { state: AnalyzerState, setState: (newState: AnalyzerState) => void }) {\n    let { state, setState } = props\n    let classes = useStyles()\n    const theme = useTheme()\n    const isSmallScreen = useMediaQuery(theme.breakpoints.down('sm'))\n    // Add event listeners\n    let [ value, setValue ] = React.useState(state.scramble)\n\n    let onScrambleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n      setValue(event?.target.value)\n    }\n\n    let handleBegin = () => {\n\n      setState({...resetState(state), scramble: value})\n    }\n    let handleGen = () => {\n      let cube = CubeUtil.get_random_with_mask(Mask.empty_mask)\n      let scramble = CachedSolver.get(\"min2phase\").solve(cube,0,0,0)[0].inv().toString()\n      setState({...resetState(state), scramble})\n      setValue(scramble)\n    }\n\n    return (\n    <Box style={{display: \"flex\"}}>\n\n      <Box style={{display: \"flex\", alignItems: \"center\", flexGrow: 1}}>\n        <TextField\n          size=\"medium\"\n          fullWidth\n          multiline\n          maxRows={3}\n          label={\"Scramble\"}\n          value={value}\n          onChange={onScrambleChange}\n          variant=\"filled\"\n          inputProps={{\n            sx: {fontSize: \"1.2rem\", fontWeight: 500}\n          }}\n        />\n      </Box>\n      <Box style={{}} className={classes.fgap} />\n      <Box sx={{ display: 'flex', flexDirection: isSmallScreen ? 'column' : 'row', gap: isSmallScreen ? 0.5 : 0.5, alignItems: 'stretch' }}>\n        <Button onFocus={(evt) => evt.target.blur() } onClick={handleGen}\n              size=\"medium\" variant=\"contained\" color=\"primary\" >\n                Gen\n        </Button>\n        <Button onFocus={(evt) => evt.target.blur() } onClick={handleBegin}\n              size=\"medium\" variant=\"contained\" color=\"primary\" >\n                GO\n        </Button>\n      </Box>\n    </Box> )\n}\n\nfunction ConfigView(props: { state: AnalyzerState, setState: (newState: AnalyzerState) => void}) {\n  let { state, setState } = props\n  let classes = useStyles()\n\n  const menuProps = {\n    PaperProps: {\n        style: {\n            maxWidth: 160,\n        },\n    },\n    className: classes.menu\n  };\n\n  const selectSx = { fontSize: \"1.0rem\" };\n\n  let fb_ori_str = state.orientation + \",\" + state.pre_orientation\n  let handleFBOri = (event: SelectChangeEvent<String>) => {\n    let value: string[]= (event.target.value).split(\",\")\n    setState({...state, orientation: value[0], pre_orientation: value[1]})\n  }\n  let display_mode_str = state.show_mode\n  let handle_display_mode = (event: SelectChangeEvent<String>) =>  {\n    let value = (event.target.value as string)\n    setState({...state, show_mode: value})\n  }\n  let handle_num_solution = (event: SelectChangeEvent<number>) =>  {\n    let value = Number.parseInt(event.target.value as string)\n    setState({...state, num_solution: value || state.num_solution})\n  }\n  let handle_fb_stage = (event: SelectChangeEvent<fbStageT>) =>  {\n    let value = (event.target.value as fbStageT)\n    setState({...state, fb_stage: value})\n  }\n  let handle_hide_solutions = (event: SelectChangeEvent<String>) =>  {\n    let value = (event.target.value as string)\n    setState({...state, hide_solutions: value === \"true\"})\n  }\n  return (\n  <Box display=\"flex\" flexWrap=\"wrap\" gap={0} sx={{ rowGap: 2}}>\n    <Box className={classes.configItem}>\n      <FormControl className={classes.formControl}>\n        <InputLabel id=\"demo-simple-select-helper-label\">FB Orientation</InputLabel>\n        <Select\n          labelId=\"demo-simple-select-helper-label\"\n          id=\"demo-simple-select-helper\"\n          value={fb_ori_str}\n          onChange={handleFBOri}\n          MenuProps={menuProps}\n          sx={selectSx}\n        >\n          <MenuItem value={\"x2y,\"}>x2y on W/Y</MenuItem>\n          <MenuItem value={\"x2y,x\"}>x2y on B/G</MenuItem>\n          <MenuItem value={\"x2y,z\"}>x2y on R/O</MenuItem>\n          <MenuItem value={\"cn,\"}>Color Neutral</MenuItem>\n        </Select>\n        <FormHelperText></FormHelperText>\n      </FormControl>\n    </Box>\n    <Box className={classes.configItem}>\n      <FormControl className={classes.formControl}>\n      <InputLabel id=\"demo-simple-select-helper-label\">Organize</InputLabel>\n      <Select\n        labelId=\"demo-simple-select-helper-label\"\n        id=\"demo-simple-select-helper\"\n        value={display_mode_str}\n        onChange={handle_display_mode}\n        MenuProps={menuProps}\n        sx={selectSx}\n      >\n        <MenuItem value={\"foreach\"}>By FB</MenuItem>\n        <MenuItem value={\"combined\"}>Combined </MenuItem>\n      </Select>\n      <FormHelperText></FormHelperText>\n     </FormControl>\n    </Box>\n    <Box  className={classes.configItem}>\n    <FormControl className={classes.formControl}>\n      <InputLabel id=\"demo-simple-select-helper-label\"># Solutions</InputLabel>\n      <Select\n        labelId=\"demo-simple-select-helper-label\"\n        id=\"demo-simple-select-helper\"\n        value={state.num_solution}\n        onChange={handle_num_solution}\n        MenuProps={menuProps}\n        sx={selectSx}\n      >\n        <MenuItem value={1}>1</MenuItem>\n        <MenuItem value={3}>3 </MenuItem>\n        <MenuItem value={5}>5</MenuItem>\n        <MenuItem value={10}>10 </MenuItem>\n        <MenuItem value={25}>25 </MenuItem>\n      </Select>\n      <FormHelperText></FormHelperText>\n    </FormControl>\n    </Box>\n    <Box  className={classes.configItem}>\n    <FormControl className={classes.formControl}>\n      <InputLabel id=\"demo-simple-select-helper-label\">FB Stage</InputLabel>\n      <Select\n        labelId=\"demo-simple-select-helper-label\"\n        id=\"demo-simple-select-helper\"\n        value={state.fb_stage}\n        onChange={handle_fb_stage}\n        MenuProps={menuProps}\n        sx={selectSx}\n      >\n        <MenuItem value={\"fb\"}>FB</MenuItem>\n        <MenuItem value={\"fs\"}>FS</MenuItem>\n        <MenuItem value={\"pseudo-fs\"}>Pseudo FS</MenuItem>\n        <MenuItem value={\"felinep1\"}>E-Line+1</MenuItem>\n        <MenuItem value={\"fs-combo\"}>FS/Line</MenuItem>\n      </Select>\n      <FormHelperText></FormHelperText>\n    </FormControl>\n    </Box>\n    <Box className={classes.configItem}>\n      <FormControl className={classes.formControl}>\n        <InputLabel id=\"hide-solutions-label\">Hints?</InputLabel>\n        <Select\n          labelId=\"hide-solutions-label\"\n          id=\"hide-solutions-select\"\n          value={state.hide_solutions.toString()}\n          onChange={handle_hide_solutions}\n          MenuProps={menuProps}\n          sx={selectSx}\n        >\n          <MenuItem value={\"true\"}>Yes</MenuItem>\n          <MenuItem value={\"false\"}>No</MenuItem>\n        </Select>\n        <FormHelperText></FormHelperText>\n      </FormControl>\n    </Box>\n  </Box>)\n}\n\n\nfunction SolutionInputView(props: { state: AnalyzerState, setState: (newState: AnalyzerState) => void}) {\n  let [editing, setEditing] = React.useState(false)\n  let [value, setValue] = React.useState(\"\")\n  let textField = React.useRef<HTMLInputElement | null>(null)\n  const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n      setValue(event.target.value)\n      event.stopPropagation()\n  }\n  const toggleEdit = () => {\n      setEditing(true)\n  }\n  const handleClose = () => {\n    setEditing(false)\n    let full_solution = analyze_roux_solve(new CubieCube().apply(props.state.scramble), new MoveSeq(value))\n    if ( (full_solution.length > 1) || (full_solution.length === 1 && full_solution[0].solution.moves.length > 0)) {\n      props.setState({...props.state, full_solution})\n    }\n  }\n  //const onEntered = () => {\n  //    textField.current && textField.current.focus()\n  //}\n  return <Box>\n    <Box >\n          <Button variant={editing ? \"contained\" : \"outlined\"}\n              color=\"primary\"\n              size=\"small\"\n              onClick={toggleEdit}\n\n              startIcon={<EditIcon />}\n          >\n              {\"Input Your Solution\"}\n          </Button>\n    </Box>\n\n    <Dialog open={editing}\n            onClose={handleClose}\n            /*onEntered={onEntered}*/\n            maxWidth=\"sm\"\n            fullWidth\n            >\n          <DialogTitle> Input your reconstructed solution </DialogTitle>\n          <DialogContent>\n                <TextField\n                    inputRef={textField}\n                    multiline\n                    size=\"medium\"\n                    fullWidth\n                    maxRows={10}\n                    rows={5}\n                    value={value}\n                    onChange={onChange}\n                    variant=\"outlined\">\n                </TextField>\n          </DialogContent>\n          <DialogActions>\n              <Box padding={1}>\n              <Button onClick={handleClose} color=\"primary\" variant=\"outlined\" fullWidth >\n                  Confirm\n              </Button>\n              </Box>\n          </DialogActions>\n    </Dialog>\n  </Box>\n}\n\n\n// Generic memoization function\nfunction memoize<T, R>(fn: (arg: T) => R): (arg: T) => R {\n    const cache = new Map<string, R>();\n\n    return (arg: T) => {\n        const key = String(arg);\n        if (cache.has(key)) {\n            return cache.get(key)!;\n        }\n\n        const result = fn(arg);\n        cache.set(key, result);\n        return result;\n    };\n}\n\n// The actual rotation shortening function without caching logic\nfunction _shorten_rotation(rotation: string): string {\n    const rotation_inv = new MoveSeq(rotation).inv();\n    const cube = new CubieCube().apply(rotation_inv);\n    const solution = CachedSolver.get(\"center\").solve(cube, 0, 3, 1)[0];\n    return solution.toString();\n}\n\n// Create the memoized version\nexport const get_shortened_rotation = memoize(_shorten_rotation);\n\n// Add this color mapping at the top level\nconst colorMap : { [key: string]: string } = ColorScheme.default_colors;\n/*{ [key: string]: string } = {\n  \"W\": \"#FFFFFF\",\n  \"Y\": \"#FFD500\",\n  \"G\": \"#00B500\",\n  \"B\": \"#0000FF\",\n  \"O\": \"#FF5800\",\n  \"R\": \"#C41E3A\"\n};*/\n\n// Add this component for the color squares\nfunction ColorPair({ colors }: { colors: string[] }) {\n  return (\n    <Box sx={{ display: 'inline-flex', alignItems: 'center', gap: 0.2}}>\n      {colors.map((color, i) => (\n        <Box\n          key={i}\n          sx={{\n            width: '1.0rem',\n            height: '1.1rem',\n            backgroundColor: colorMap[color],\n            border: '1px solid rgba(0,0,0,0.5)',\n            display: 'inline-block'\n          }}\n        />\n      ))}\n    </Box>\n  );\n}\n\n// Modify the _orientation_fb_name function to return colors instead of names\nfunction _orientation_fb_colors(orientation: string): string[] {\n    const cube = new CubieCube().apply(orientation)\n    const dl_d = FaceletCube.color_of_sticker(cube, [5, 0, Typ.E])\n    const dl_l = FaceletCube.color_of_sticker(cube, [5, 1, Typ.E])\n    const color_lookup = [\"W\", \"Y\", \"G\", \"B\", \"O\", \"R\"]\n    return [color_lookup[dl_d], color_lookup[dl_l]]\n}\nexport const get_orientation_fb_colors = memoize(_orientation_fb_colors);\n\nfunction StageSolutionView(props: { solution: SolutionDesc, shortestLength?: number }) {\n  let { solution, stage, premove, orientation, fb_tag } = props.solution\n  let getTags = () => {\n    if (stage === \"fb\") {\n      const colors = get_orientation_fb_colors(orientation || \"\")\n      return [<ColorPair key=\"colors\" colors={colors} />, fb_tag].filter(Boolean)\n    } else if (stage === \"ss-front\" || stage === \"ss-back\"){\n      return [ stage ]\n    } else return []\n  }\n  let tags = getTags()\n  const isShortest = props.shortestLength !== undefined && solution.moves.length === props.shortestLength\n  const shortened_rotation = get_shortened_rotation(orientation + \" \" + premove)\n\n  return (\n    <Box style={{display: \"flex\", marginBottom: \"2px\", alignItems: \"center\"}}>\n      {tags.filter(x=>x).map( (t, i) =>\n        <Chip variant=\"outlined\" size=\"small\" color=\"primary\" label={t} key={i}\n          sx={{ '& .MuiChip-label': { fontSize: '0.9rem', fontWeight: 500, padding: '0 8px',\n                                      minWidth: \"6ch\", textAlign: \"center\",\n                                      display: \"flex\",\n                                      alignItems: \"center\", justifyContent: \"center\" } }} />\n      )}\n      {/* add a little space between the tags and the solution */}\n      <Box style={{width: \".5ch\"}} />\n      <Box style={{marginLeft: 5}}>\n        <Typography sx={{fontSize: \"1.3rem\"}}>\n          {shortened_rotation + \" \" + solution.moves.map(m => m.name).join(\" \")}\n          {isShortest && \" (*)\"}\n        </Typography>\n      </Box>\n    </Box>\n  )\n}\n\n\nfunction StageSolutionListView(props: { solutions: SolutionDesc[], num_to_display: number, state: AnalyzerState, setState: (newState: AnalyzerState) => void} ) {\n  let { solutions, num_to_display, state } = props\n  const [isRevealed, setIsRevealed] = React.useState(!state.hide_solutions)\n\n  // Update isRevealed when hide_solutions changes\n  React.useEffect(() => {\n    setIsRevealed(!state.hide_solutions)\n  }, [state.hide_solutions, solutions])\n\n  // Find the shortest solution by STM length\n  const shortestSolution = solutions.length > 0 ?\n    solutions.reduce((shortest, current) =>\n      current.solution.moves.length < shortest.solution.moves.length ? current : shortest\n    ) : null\n\n  // For hints, generate a reader friendly text framing it as a quiz:\n  // for each shortest solution, parse the tag into the correspnding DL-edge color (we will build a utility function for this)\n  // then for each fb_tag, have a separate line to describe it in the form of \"Can you spot the 3-STM ${fb_tag} solution in Blue-White or Green-Red block?\"\n\n  //TODO; ordering in per-orientation FS-combo mode\n  const handleClick = () => {\n    setIsRevealed(true)\n  }\n\n  const shortest_length = shortestSolution?.solution.moves.length || 0\n  const shortest_solutions = solutions.filter(s => s.solution.moves.length === shortest_length)\n  //console.log(\"shortest solutions\", shortest_solutions)\n  const tag_full_name : Record<string, string> = {\n    \"FS\": \"FS\",\n    \"FB\": \"FB\",\n    \"Ps\": \"Pseudo FS\",\n    \"Line\": \"E-Line + 1c\"\n  }\n  const shortest_solution_tag_names = shortest_solutions.map(s => ({tag: tag_full_name[s.fb_tag || \"FB\"], fb_name: get_orientation_fb_colors(s.orientation || \"\")}))\n  const shortest_tag_names = shortest_solution_tag_names.reduce((acc, curr) => {\n    if (!acc[curr.tag]) { acc[curr.tag] = new Set() }\n    acc[curr.tag].add(curr.fb_name.join(\"-\"))\n    return acc\n  }, {} as Record<string, Set<string>>)\n  const shortest_tag_names_str = Object.entries(shortest_tag_names).map(([tag, fb_names]) => {\n    const colorPairs = [...fb_names].map(name => {\n      const [color1, color2] = name.split(\"-\");\n      return <ColorPair key={name} colors={[color1, color2]} />;\n    });\n\n    return (\n      <React.Fragment key={tag}>\n        <Box sx={{ width: \"100%\", mb: 1 }}>\n          <Typography variant=\"body1\" color=\"text.primary\" sx={{ fontSize: \"1.1rem\", textAlign: \"center\" }} >\n            {`There exists ${shortest_length}-STM ${tag || \"solution\"} in: `}\n          </Typography>\n        </Box>\n        <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 2.0, justifyContent: \"center\", mb: 2 }}>\n          {colorPairs}\n        </Box>\n      </React.Fragment>\n    );\n  })\n\n  return (\n    <Box lineHeight={1}>\n      {solutions.length > 0 && (\n        <Box onClick={!isRevealed ? handleClick : undefined} sx={{ cursor: !isRevealed ? 'pointer' : 'default' }}>\n          {!isRevealed ? (\n            <Box sx={{ width: \"100%\" }}>\n              {shortest_tag_names_str}\n              <Typography variant=\"body1\" color=\"text.secondary\" sx={{ mt: 1, fontSize: \"1.0rem\", textAlign: \"center\" }}>\n                (Click to reveal)\n              </Typography>\n            </Box>\n          ) : (\n            <Box>\n              {solutions.slice(0, num_to_display).map((s, i) => (\n                <StageSolutionView\n                  solution={s}\n                  key={i}\n                  shortestLength={shortestSolution?.solution.moves.length}\n                />\n              ))}\n            </Box>\n          )}\n        </Box>\n      )}\n    </Box>\n  )\n}\n\nfunction FullSolutionView(props: { state: AnalyzerState, setState: (newState: AnalyzerState) => void} ) {\n  let { state, setState } = props\n  let classes = useStyles()\n\n  let setStage = (i: number) => () => {\n    setState({...state,\n      stage: state.full_solution[i].stage,\n      post_scramble: state.full_solution.slice(0, i).map(x => x.premove + x.solution.toString()).join(\" \")\n    })\n  }\n  let [show, setShow] = React.useState(-1)\n  let stageView = (sol: SolutionDesc, i: number) => {\n    return (\n      <Box display=\"flex\" key={i} className={classes.stage}\n        onMouseLeave={ () => setShow(-1)} onMouseEnter={() => setShow(i)} onClick={() => setShow(show === i ? -1 : i)}>\n        <Button variant={\"text\"}\n              color=\"primary\"\n              size=\"small\"\n              onClick={setStage(i)}\n              style={{fontSize: \"0.7rem\", marginLeft: 5, border: (show === i) ? \"1px solid\" : \"1px solid rgba(0, 0,0,0)\"\n            }} >\n        <Typography variant=\"subtitle1\" className={classes.stageText}>{sol.solution.toString()} \"//\" {sol.stage}\n        </Typography>\n        <SearchIcon fontSize=\"small\"/>\n        </Button>\n\n      </Box>\n    )\n  }\n  return (\n    <Box paddingBottom={2} lineHeight={1} >\n      <Box>\n        <SolutionInputView state={state} setState={setState}/>\n      </Box>\n      <Box style={{fontFamily: \"Public Sans\"}}>\n        { props.state.full_solution.map( (desc, i) => stageView(desc, i))}\n      </Box>\n    </Box>\n  )\n\n}\n\nfunction AnalyzerView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n    let { state: appState } = props\n\n    const theme = useTheme()\n    let [ state, setState ] = React.useState(initialState)\n\n    let classes = useStyles()\n\n    let mask = Mask.solved_mask\n    let cubieCube = new CubieCube().apply(state.scramble).apply(state.post_scramble)\n    let faceletCube = FaceletCube.from_cubie(cubieCube, mask)\n\n    const analyzerData = useAnalyzer(state)\n\n    let solutions_to_display = analyzerData.isRunning ? [] : (analyzerData.solutions || [])\n    let num_solutions_to_display = solutions_to_display.length\n\n    if (state.show_mode === \"combined\") {\n      solutions_to_display = solutions_to_display.sort( (x, y) => x.score - y.score) //.slice(0, state.num_solution)\n      num_solutions_to_display = state.num_solution\n    } else {\n     /// solutions_to_display = solutions.slice(0, Math.ceil(config.num_solution / oris.length))\n    }\n\n    const gt_md = useMediaQuery(theme.breakpoints.up('md'));\n    const gt_sm = useMediaQuery(theme.breakpoints.up('sm'));\n    const isSmallScreen = useMediaQuery(theme.breakpoints.down('sm'));\n    console.log(\"isSmallScreen\", isSmallScreen, theme.breakpoints)\n    const canvas_wh = (gt_md) ? [400, 350] : (gt_sm) ? [400, 350] : [320, 280]\n\n    const configPanel = (\n      <Paper className={classes.paper} elevation={2}>\n        <ConfigView state={state} setState={setState}/>\n      </Paper>\n    );\n    const inputSolutionPanel = (\n      <Paper className={classes.paper2} elevation={1}>\n      <Box display=\"flex\" >\n        {\n          state.full_solution.length >= 1 ? <>\n            <Box style={{display: \"flex\", flexDirection: \"column\", alignSelf: \"flex-start\"}}>\n              <Box className={classes.title} style={{}}>\n                My Solution\n              </Box>\n            </Box>\n            <Box style={{}} className={classes.fgap} />\n          </>\n        : null\n        }\n\n        <FullSolutionView state={state} setState={setState}/>\n      </Box>\n      </Paper>\n    )\n\n    return (\n    <Box className={classes.container}>\n      <Paper className={classes.paper} elevation={1}>\n        <ScrambleView state={state} setState={setState}/>\n      </Paper>\n\n      {!isSmallScreen && configPanel}\n      {/* {!isSmallScreen && inputSolutionPanel} */}\n\n      <Paper className={ classes.paper}>\n      <Grid container>\n        <Grid item md={6} sm={12} xs={12} className={classes.condGap}>\n          <Box style={{display: \"flex\" }}>\n            <Box display=\"flex\" >\n                <Box style={{display: \"flex\", flexDirection: \"column\", alignSelf: \"flex-start\"}}>\n                  <Box className={classes.title} style={{}}>\n                    Solutions\n                  </Box>\n                  <Box>\n                  <Button className={classes.title1} size=\"small\" variant=\"outlined\" color=\"primary\">\n                    { state.stage }\n                  </Button>\n                  </Box>\n                </Box>\n            </Box>\n            <Box style={{}} className={classes.fgap} />\n            <Box style={{flexGrow: 1}}>\n              <StageSolutionListView solutions={solutions_to_display} num_to_display={num_solutions_to_display} state={state} setState={setState}/>\n            </Box>\n          </Box>\n        </Grid>\n        {/* colorScheme=appState.colorScheme.getColorsForOri(appState.cube.ori)} */}\n        <Grid item md={6} xs={12} style={{display: \"flex\", justifyContent: \"center\"}}>\n          <Box style={{backgroundColor: \"rgba(0, 0, 0, 0)\"}}>\n            <CubeSim\n              width={canvas_wh[0]}\n              height={canvas_wh[1]}\n              cube={faceletCube}\n              colorScheme={appState.colorScheme.getColorsForOri(\"WG\")}\n              hintDistance={ 6 }\n              theme={appState.config.theme.getActiveName()}\n\n              facesToReveal={ [Face.L, Face.B, Face.D]  }\n            />\n          </Box>\n        </Grid>\n      </Grid>\n\n      {/* <Box height={20}/>\n      <Divider/>\n      <Box height={20}/> */}\n      </Paper>\n\n      {isSmallScreen && configPanel}\n      {/* <ColorPanel {...{state: appState, dispatch: appDispatch}} /> */}\n\n    </Box>\n    );\n}\n\n\nexport default AnalyzerView\n\n\n","import React from 'react'\nimport { AppState, Mode, Action } from \"../Types\";\n\nimport { Box, Typography, Button } from '@mui/material';\nimport makeStyles from '@mui/styles/makeStyles';\nimport { Dialog, DialogContent, DialogActions } from '@mui/material';\nimport { Grid, Container } from '@mui/material';\n\nimport { CmllTrainerView, OllcpTrainerView } from './CmllTrainerView';\nimport BlockTrainerView from './BlockTrainerView';\nimport PanoramaView from './PanoramaView';\n\n\nimport FavListView from './FavListView';\nimport TopBarView from './TopBarView';\nimport AnalyzerView from './AnalyzerView';\n\nimport Markdown from 'markdown-to-jsx';\nimport useMediaQuery from '@material-ui/core/useMediaQuery/useMediaQuery';\n\nimport { theme } from '../theme';\n\ninterface TabPanelProps {\n  value: number,\n  index: number,\n  children: any,\n  [key: string]: any\n}\nfunction TabPanel(props: TabPanelProps ) {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <Typography\n      component=\"div\"\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && <Box p={0}>{children}</Box>}\n    </Typography>\n  );\n}\nconst useStyles = makeStyles(theme => ({\n  page: {\n    backgroundColor: theme.palette.background.default\n  },\n  container: {\n    display: \"flex\"\n  },\n  icon: {\n    minWidth: 0\n  },\n  root: {\n    display: \"flex\"\n  },\n  bar: {\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.background.paper,\n    //borderRadius: \"5px\"\n  },\n  select: {\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.background.paper,\n    borderRadius: 4,\n    border: \"1px solid \" + theme.palette.background.default,\n  }\n}))\n\nexport const tab_modes : [Mode, string, string][] = [\n  [\"fb\", \"First Block (Fixed)\", \"FB (fixed)\"],\n  [\"analyzer\", \"First Block Analyzer (x2y | CN)\", \"FB analyzer (x2y | CN)\"],\n  [\"fs\", \"First Block Square\", \"FB square\"],\n  [\"fsdr\", \"First Block Square + DR edge\", \"FB square + DR\"],\n  [\"fbdr\", \"First Block Last Pair (+ DR edge)\", \"FB last pair (+DR)\"],\n  [\"fbss\", \"First Block Last Pair + Second Square\", \"FB last pair + SS\"],\n  [\"ss\", \"Second Block Square\", \"SB square\"],\n  [\"cmll\", \"CMLL\", \"CMLL\"],\n  //TODO: build this [\"misc-algs\", \"OLLCP\", \"OLLCP\"],\n  [\"4c\", \"LSE 4c\", \"LSE 4c\"],\n  [\"eopair\", \"EOLR / EOLRb\", \"EOLR(b)\"]\n  //[\"tracking\", \"Tracking Trainer (Beta)\", \"Tracking\"]\n]\n\nfunction _getInitialHashLocation() {\n  const default_idx = tab_modes.findIndex(x => x[0] === \"fbdr\")\n  if (window.location.hash) {\n    let idx = tab_modes.findIndex(x => x[0] === window.location.hash.slice(1))\n    if (idx === -1) {\n      window.location.hash = \"\";\n      return default_idx;\n    } else {\n      return idx;\n    }\n  } else {\n    return default_idx\n  }\n}\n\nconst introText = `# Onionhoney's Roux Trainers\n- A trainer collection that caters to all your Roux training needs  ❤️\n- Inspired by http://cubegrass.appspot.com/, but with everything that it is missing.\n\n## Modes supported\n- FB analyzer\n    - Solves for all x2y FBs, and suggests the best FB to start with!\n    - Also suggests the best FS/Pseudo FS/Line to start with!\n    - Can be presented as a 'can you find the x-mover' quiz with solution revealed in the spoiler.\n    - More orientations supported too (CN, blue/green x2y, red/orange x2y)\n- FB last slot (+ DR) trainer\n    - \\`HIGHLY USEFUL\\` if you're learning FB or FB + DR. Get a random scramble, think on your own, and check with our solutions!\n    - **Note**: while I try my best, the solver can still miss out on the best overall solution. So please, consult your human fellows when you're unsure, and always be careful with what you choose to learn.\n- FS/FB/SS trainer\n    - You can specify by piece positions. It seems these modes are pretty useful in providing new insights into blockbuilding  (for us dumb humans).\n- CMLL trainer\n    - Truly random L10P scrambles so you can't tell the cases. You can specify different OCLLs. You can even start with a random SB last pair (to simulate how real recognition works)\n    - Show only the stickers necessary for recognition!\n- LSE trainers (EOLR, 4c)\n    - Good for reviewing EOLR and practicing your 4c recognition method. You can filter by MC/Non-MC cases too.\n\n## Shortcuts\n- Space for the next scramble.\n- Enter to reset the virtual cube to current scramble.\n- Control your cube with cstimer key mapping.\n\n## Functionalities\n- Scrambles are all random state. Solver is Roux-optimized with M and r moves as first-class citizens, with up to 25 different solutions provided.\n\n- You can control the virtual cube with keyboard (CStimer mapping). You can also drag on the cube to change its perspective.\n\n- You can bookmark your favorite cases and these will be saved in your browser.\n\n- You can input your own scrambles as a list and our trainer will drain them one by one!\n\n- Appearance: dark mode enabled.\n\n---\n\n## Version Log\n- (v1.0.0) All work prior to 12/02/2020, which I forgot to version log for.\n- (v1.0.1) 12/02/2020: Add edge position control for FB Last Pair trainer.\n- (v1.1) 12/15/2020: Reworked UI. App bar now features a dropdown menu for selecting the mode. Scramble occupies its own row. Solutions are shown side by side with the sim cube in large screen.\n- (v1.2) 12/17/2020: Add support for scramble input for all modes. Now you can paste in a list of scrambles, and the trainer will consume them one by one in order.\n- (v1.3) 12/20/2020: Solve Analysis Beta is online! It can do the following:\n    - For any random scramble, it'll recommend the best FB solutions over all orientations (e.g. x2y yellow/white).\n    - Given a solve reconstruction, it'll analyze each stage, and compare your solution there with the solver-suggested solutions.\n- (v1.4) 12/23/2020: Refine the appearance of the virtual cube and enable camera control with mouse dragging.\n- (v1.5) 2/18/2021: Introduced Tracking Trainer Beta.\n- Refer to Github page for the full version log: https://github.com/onionhoney/roux-trainers\n\n---\n\nIf you have ideas on how to improve the app just shoot a message and let me know. <3\n`\n\nfunction Intro() {\n  return <Markdown>{introText}</Markdown>\n}\n\n// TODO: Write getter and setter for config items, and also write handlers that map to setters\nfunction AppView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n  //const [locations, setLocations] = React.useState([])\n  let { state, dispatch } = props\n  let classes = useStyles()\n\n  const handleChange = React.useCallback( (newValue:number) => {\n    if (newValue < tab_modes.length) {\n      setValue(newValue)\n      let mode = tab_modes[newValue][0]\n      dispatch({type: \"mode\", content: mode})\n    }\n  }, [dispatch])\n\n  const [ open, setOpen ] = React.useState(false)\n\n  const [value, setValue] = React.useState(_getInitialHashLocation());\n  React.useEffect( () => {\n    dispatch({type: \"mode\", content: tab_modes[_getInitialHashLocation()][0]})\n  }, [dispatch])\n\n  const handleInfoOpen = () => { setOpen(true) }\n  const handleInfoClose = () => { setOpen(false) }\n\n  const toggleBright = () => {\n    const theme_flag = [...state.config.theme.flags]\n    theme_flag[0] = 1 - theme_flag[0]\n    theme_flag[1] = 1 - theme_flag[1]\n    dispatch({ type: \"config\", content: {\n      theme: state.config.theme.setFlags(theme_flag)\n    }})\n  }\n  const toggleFav = () => {\n    setFav(!showFav)\n  }\n\n  const [ showFav, setFav ] = React.useState(false)\n  const createTabPanels = (elements: any[]) => {\n    return <React.Fragment>\n    {\n      elements.map( (el, i) => <TabPanel key={i} value={value} index={i} className={classes.page}>{el}</TabPanel>)\n    }\n    </React.Fragment>\n  }\n  return (\n    <main>\n      <Dialog open={open} onClose={handleInfoClose} >\n      <DialogContent dividers>\n        <Intro></Intro>\n      </DialogContent>\n      <DialogActions>\n        <Button color=\"primary\" onClick={handleInfoClose}>\n          Got it!\n        </Button>\n      </DialogActions>\n      </Dialog>\n\n      <TopBarView onChange={handleChange} value={value}\n        handleInfoOpen={handleInfoOpen} toggleBright={toggleBright} toggleFav={toggleFav}\n      />\n\n      <Box paddingY={2} paddingX={0}>\n      <Container maxWidth={showFav ? \"lg\" : \"md\" }>\n\n      {\n      value === -1?\n      (\n      <Grid container className={classes.container} spacing={3}>\n        <Grid item md={12} sm={12} xs={12}>\n        <TabPanel value={value} index={4} className={classes.page}>\n          <PanoramaView {...{state, dispatch}} />\n        </TabPanel>\n        </Grid>\n      </Grid>\n      )\n      :\n      (\n      <Grid container className={classes.container} spacing={ 3}>\n        <Grid item hidden={!showFav} md={4} sm={4} xs={12} >\n        <FavListView {...{state, dispatch}} />\n        </Grid>\n\n        <Grid item md={showFav ? 8 : 12} sm={showFav ? 8 : 12} xs={12}>\n        {\n          createTabPanels([\n            <BlockTrainerView {...{state, dispatch}} />, // fb\n            <AnalyzerView {...{state, dispatch}} />,\n            <BlockTrainerView {...{state, dispatch}} />, // fs\n            <BlockTrainerView {...{state, dispatch}} />, // fsdr\n            <BlockTrainerView {...{state, dispatch}} />, // fbdr\n            <BlockTrainerView {...{state, dispatch}} />, // fbss\n            <BlockTrainerView {...{state, dispatch}} />, // ss\n            <CmllTrainerView {...{state, dispatch}} />,\n            <OllcpTrainerView {...{state, dispatch}} />,\n            <BlockTrainerView {...{state, dispatch}} />,\n            <BlockTrainerView {...{state, dispatch}} />,\n            /*<TrackerView {...{state, dispatch}} /> */\n          ])\n        }\n\n        </Grid>\n      </Grid>\n      )\n      }\n      </Container></Box>\n    </main>\n  )\n}\nexport default AppView","const version = \"2.1\"\n\nexport {version}","export default class Selector {\n    names: string[];\n    flags: number[];\n    kind: string;\n    label?: string;\n    annotation?: string;\n\n    constructor(config: {names: string[], flags: number[], kind: string, label?: string, annotation? : string}) {\n        const { names, flags, kind, label, annotation } = config\n        this.names = names\n        this.flags = flags\n        this.kind = kind\n        this.label = label\n        this.annotation = annotation\n    }\n\n    getActiveNames() {\n        let ans = []\n        for (let i = 0; i < this.flags.length; i++) {\n            if (this.flags[i] === 1) {\n                ans.push(this.names[i])\n            }\n        }\n        return ans\n    }\n\n    getActiveName() {\n        for (let i = 0; i < this.flags.length; i++) {\n            if (this.flags[i] === 1) {\n                return (this.names[i])\n            }\n        }\n        return \"\"\n    }\n\n    setFlags(newFlags: number[]) {\n        const { names, kind, label } = this\n        return new Selector({names, flags: newFlags, kind, label})\n    }\n}","\nimport { FavCase } from \"./Types\"\nimport Selector from './lib/Selector';\nimport { cmll_algs_raw } from './lib/Algs';\nimport { SliderOpt } from \"./Types\";\n\nexport const initialFavList : FavCase[] = []\n\nexport type Config = {\n    showCube: Selector;\n    theme: Selector;\n    evaluator: Selector;\n    moveCountHint: Selector;\n    fbdrLevelSelector: SliderOpt;\n    fbssLevelSelector: SliderOpt;\n    fbLevelSelector: SliderOpt;\n    fsLevelSelector: SliderOpt;\n    ssLevelSelector: SliderOpt;\n    // lse4cLevelSelector: SliderOpt,\n    // eolrLevelSelector: SliderOpt,\n    cmllSelector: Selector;\n    cmllCaseSelector: Selector;\n    cmllAufSelector: Selector;\n    cmllCubeMaskSelector: Selector;\n    cmll2D3DSelector: Selector;\n    cmllKataSelector: Selector;\n    nmcllSelector: Selector;\n    triggerSelector: Selector;\n    hyperOriSelector: Selector;\n    ollcpCaseSelector: Selector;\n    orientationSelector: Selector;\n    fbdrSelector: Selector;\n    fsSelector: Selector;\n    fbdrPosSelector1: Selector;\n    fbdrPosSelector2: Selector;\n    fbdrPosSelector3: Selector;\n    fbssLpSelector: Selector;\n    fbssSsSelector: Selector;\n    ssSelector: Selector;\n    ssEOSelector: Selector;\n    ssPosSelector: Selector;\n    fbOnlySelector: Selector;\n    // fbStratSelector: Selector;\n    fbBasisSelector: Selector;\n    fbdrScrambleSelector: Selector;\n    ssPairOnlySelector: Selector;\n    fbPairSolvedSelector: Selector;\n    solutionNumSelector: Selector;\n    fbPieceSolvedSelector: Selector;\n    lseMCSelector: Selector;\n    lseBarSelector: Selector;\n    lseStageSelector: Selector;\n    lseEOSelector: Selector;\n    lseEOLRMCSelector: Selector;\n    lseBarbieSelector: Selector;\n    lseEOLRScrambleSelector: Selector;\n};\n\nconst cmll_alg_names = cmll_algs_raw.map(x => x[0])\nconst ollcp_alg_names = cmll_algs_raw.map(x => x[0])\n\nexport const EOLRMode = {\n    NONMC_SHORTER_ONLY: \"Only show cases where non-MC is optimal\",\n    MC_SHORTER_ONLY: \"Only show cases where MC is optimal\",\n    COMBINED: \"Combined\",\n    MC_ONLY: \"Only show MC solutions\",\n    NONMC_ONLY: \"Only show non-MC solutions\"\n}\n\nconst fbPieceSolvedAnnotation = `\nExplanation:\nThese modes apply different constraints on your FB state.\n[Hard] means there's no free pair AND no edges attached to the L center.\n[Hard over x2y] means it's hard for all FBs over the x2y orientations. To see solutions, paste them into the FB analyzer.`\n\nconst initialLevels = {\n    fbdrLevelSelector: ({\n        l: 1, r: 7, label: \"fbdr-level\", value: 0, extend_r: true\n    }),\n    fbssLevelSelector: ({\n        l: 3, r: 9, label: \"fbss-level\", value: 2\n    }),\n    fsLevelSelector: ({\n        l: 1, r: 6, label: \"fs-level\", value: 0\n    }),\n    fbLevelSelector: ({\n        l: 3, r: 8, label: \"fb-level\", value: 2, extend_r: true\n    }),\n    ssLevelSelector: ({\n        l: 1, r: 10, label: \"ss-level\", value: 0\n    }),\n    // lse4cLevelSelector: ({\n    //     l: 1, r: 11, label: \"4c-level\", value: 0\n    // }),\n    // eolrLevelSelector: ({\n    //     l: 1, r: 11, label: \"eolr-level\", value: 0\n    // }),\n}\nexport const initialConfig : Config = (() => {\n    let arr_ori_flag = Array(24).fill(0)\n    arr_ori_flag[7] = 1 // YR\n    return {\n        showCube: new Selector({\n            label: \"Virtual Cube\",\n            names:[\"Show\", \"Hide\"],\n            flags: [1,0],\n            kind: \"virtual-cube\"\n        }),\n        theme: new Selector({\n            names: [\"bright\", \"dark\"],\n            flags: [1,0],\n            kind: \"theme\"\n        }),\n        evaluator: new Selector({\n            label: \"Solution Sorting Metrics\",\n            names: [\"Default\", \"QTM\"],\n            flags: [1, 0],\n            kind: \"evaluator\"\n        }),\n        moveCountHint: new Selector({\n            label: \"Show Movecount Hint\",\n            names: [\"Show\", \"Hide\"],\n            flags: [1, 0],\n            kind: \"movecount_hint\"\n        }),\n        cmllSelector: new Selector({\n            names: [\"o\", \"s\", \"as\", \"t\", \"l\", \"u\", \"pi\", \"h\"],\n            flags: [1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"cmll\",\n        }),\n        nmcllSelector: new Selector({\n            names: [\"o_1\", \"o_2\", \"s_1\", \"s_2\", \"s_3\", \"as_1\", \"as_2\", \"as_3\", \"t_1\", \"t_2\", \"t_3\",\n                    \"u_1\", \"u_2\", \"u_3\", \"l_1\", \"l_2\", \"l_3\", \"pi_1\", \"pi_2\", \"pi_3\", \"h_1\", \"h_2\", \"h_3\"],\n            flags: Array(23).fill(1),\n            kind: \"nmcll\",\n        }),\n        cmllCaseSelector: new Selector({\n            names: cmll_alg_names,\n            flags: Array(cmll_alg_names.length).fill(1),\n            kind: \"cmll_case\"\n        }),\n        cmllAufSelector: new Selector({\n            names: [\"None\", \"U\", \"U'\", \"U2\"],\n            flags: [1, 1, 1, 1],\n            kind: \"u_auf\"\n        }),\n        //TODO: show L face\n        cmllCubeMaskSelector: new Selector({\n            names: [\"Show\", \"Hide\", \"Hide LSE\"],\n            flags: [1, 0, 0],\n            kind: \"cube_mask\"\n        }),\n        cmll2D3DSelector: new Selector({\n            names: [\"2D\", \"3D\"],\n            flags: [0, 1],\n            kind: \"cmll_vis_type\"\n        }),\n        cmllKataSelector: new Selector({\n            names: [\"off\", \"on\"],\n            flags: [1, 0],\n            kind: \"cmll_kata_type\"\n        }),\n        triggerSelector: new Selector({\n            names: [\"RUR'\", \"RU'R'\", \"R'U'R\", \"R'UR\", \"RU2R'\", \"R'U2R\"],\n            flags: [0, 0, 0, 0, 0, 0],\n            kind: \"trigger\"\n        }),\n        hyperOriSelector: new Selector({\n            names: [\"off\", \"L/R\", \"F/B\"],\n            flags: [1 ,0, 0],\n            kind: \"hyperori\"\n        }),\n        ollcpCaseSelector: new Selector({\n            names: ollcp_alg_names,\n            flags: Array(ollcp_alg_names.length).fill(1),\n            kind: \"ollcp_case\"\n        }),\n        orientationSelector: new Selector({\n            label: \"Color Scheme (U-F)\",\n            names: [\n                \"WG\", \"WB\", \"WO\", \"WR\",\n                \"YG\", \"YB\", \"YO\", \"YR\",\n                \"BW\", \"BY\", \"BO\", \"BR\",\n                \"GW\", \"GY\", \"GO\", \"GR\",\n                \"OW\", \"OY\", \"OB\", \"OG\",\n                \"RW\", \"RY\", \"RB\", \"RG\",\n            ],\n            flags: arr_ori_flag,\n            kind: \"orientation\"\n        }),\n        // fbStratSelector: new Selector({\n        //     label: \"Strategy for solving FB\",\n        //     names: [\"Any\", \"Half-Line\", \"Line\", \"DL\"],\n        //     flags: [1, 0, 0, 0],\n        //     kind: \"fb-strat\"\n        // }),\n        fbBasisSelector: new Selector({\n            label: \"Basis (piece considered solved) for FB. Default is L-center solved.\",\n            names: [\"Default\", \"DL\", \"BL\"],\n            flags: [1, 0, 0],\n            kind: \"fb-basis\"\n        }),\n        fbdrSelector: new Selector({\n            label: \"Position of square\",\n            names: [\"FS at back\", \"FS at front\", \"Either\"],\n            flags: [1, 0, 0],\n            kind: \"fbdr\"\n        }),\n        fbdrScrambleSelector: new Selector({\n            label: \"Type of scramble\",\n            names: [\"Short (Concerning FBDR Pieces only)\", \"Random State (Entire cube, useful for practicing F2B)\"],\n            flags: [1, 0],\n            kind: \"fbdr-scramble\"\n        }),\n        fbOnlySelector: new Selector({\n            label: \"Pieces to solve\",\n            names: [\"FB Last Pair + DR\", \"FB Last Pair Only\"],\n            flags: [0, 1],\n            kind: \"fb-only\"\n        }),\n        fbPairSolvedSelector: new Selector({\n            label: \"Last Pair pattern\",\n            names: [\"Random\", \"Solved\"],\n            flags: [1, 0],\n            kind: \"fb-pair-solved\"\n        }),\n        fbdrPosSelector1: new Selector({\n            label: \"Position of FB edge\",\n            names: [\"UF\", \"FU\", \"UL\", \"LU\", \"UB\", \"BU\", \"UR\", \"RU\", \"DF\", \"FD\", \"DB\", \"BD\",\n                    \"DR\", \"RD\", \"BR\", \"RB\", \"FR\", \"RF\"],\n            flags: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"fbdr-position-1\"\n        }),\n        fbdrPosSelector2: new Selector({\n            label: \"Position of FB edge\",\n            names: [\"UF\", \"FU\", \"UL\", \"LU\", \"UB\", \"BU\", \"UR\", \"RU\", \"DF\", \"FD\", \"DB\", \"BD\",\n                    \"DR\", \"RD\", \"BR\", \"RB\", \"FR\", \"RF\"],\n            flags: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"fbdr-position-2\"\n        }),\n        fbdrPosSelector3: new Selector({\n            label: \"Position of DR\",\n            names: [\"UF\", \"FU\", \"UL\", \"LU\", \"UB\", \"BU\", \"UR\", \"RU\", \"DF\", \"FD\", \"DB\", \"BD\",\n                    \"DR\", \"RD\", \"BR\", \"RB\", \"FR\", \"RF\"],\n            flags: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"fbdr-position-3\"\n        }),\n\n        fsSelector: new Selector({\n            label: \"Position of square\",\n            names: [\"Front FS\", \"Back FS\", \"Both\"],\n            flags: [0, 0, 1],\n            kind: \"fs\"\n        }),\n        ssSelector: new Selector({\n            label: \"Square position\",\n            names: [\"Front SS\", \"Back SS\", \"Both\"],\n            flags: [1, 0, 0],\n            kind: \"ss\"\n        }),\n        ssEOSelector: new Selector({\n            label: \"Orientation of DR\",\n            names: [\"Oriented\", \"Misoriented\", \"Either\"],\n            flags: [1, 0, 0],\n            kind: \"ss-orientation\"\n        }),\n        ssPosSelector: new Selector({\n            label: \"Position of DR\",\n            names: [\"UF\", \"FU\", \"UL\", \"LU\", \"UB\", \"BU\", \"UR\", \"RU\", \"DF\", \"FD\", \"DB\", \"BD\",\n                    \"DR\", \"RD\", \"BR\", \"RB\", \"FR\", \"RF\"],\n            flags: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"ss-position\"\n        }),\n        ssPairOnlySelector: new Selector({\n            label: \"Pieces to solve\",\n            names: [\"SS\", \"DR fixed\"],\n            flags: [1, 0],\n            kind: \"sb-pair-only\"\n        }),\n        solutionNumSelector: new Selector({\n            label: \"Number of solutions\",\n            names: [\"1\", \"3\", \"5\", \"10\", \"25\", \"100\"],\n            flags: [0, 0, 1, 0, 0, 0],\n            kind: \"solution-num\"\n        }),\n        fbPieceSolvedSelector: new Selector({\n            label: \"Difficulty\",\n            names: [\"Random\", \"DL Solved\", \"BL Solved\", \"Hard\", \"Hard over x2y (Scramble only)\"],\n            annotation: fbPieceSolvedAnnotation,\n            flags: [1, 0, 0, 0, 0],\n            kind: \"fb-piece-solved\"\n        }),\n        fbssLpSelector: new Selector({\n            label: \"FBLP Position\",\n            names: [\"Front FBLP\", \"Back FBLP\"],\n            flags: [1, 0],\n            kind: \"fbss-lp\"\n        }),\n        fbssSsSelector: new Selector({\n            label: \"SS Position\",\n            names: [\"Front SS\", \"Back SS\" , \"Both\"],\n            flags: [1, 0, 0],\n            kind: \"fbss-ss\"\n        }),\n        lseMCSelector: new Selector({\n            label: \"Center\",\n            names: [\"Aligned\", \"Misaligned\"],\n            flags: [0, 1],\n            kind: \"lse-mc\"\n        }),\n        lseBarSelector: new Selector({\n            label: \"EO Pair\",\n            names: [\"ULUR\", \"UFUB\"],\n            flags: [1, 0],\n            kind: \"lse-bar\"\n        }),\n        lseStageSelector: new Selector({\n            label: \"Stage\",\n            names: [\"4b for MC(1 move EOPair insert)\", \"M2 to 4c\", \"4c\"],\n            flags: [0, 1, 0],\n            kind: \"lse-stage\"\n        }),\n        lseEOSelector: new Selector({\n            label: \"EO\",\n            names: [\"solved\", \"arrow\", \"4/0\", \"2o/0\", \"2a/0\", \"1/1\", \"6flip\", \"2o/2\", \"0/2\", \"2a/2\"],\n            flags: [0, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"lse-eo\"\n        }),\n        lseEOLRMCSelector: new Selector({\n            label: \"Center strategy\",\n            names: [EOLRMode.NONMC_ONLY, EOLRMode.MC_ONLY, EOLRMode.COMBINED, EOLRMode.NONMC_SHORTER_ONLY, EOLRMode.MC_SHORTER_ONLY ],\n            flags: [0, 0, 1, 0, 0],\n            kind: \"lse-eolrmc\"\n        }),\n        lseBarbieSelector: new Selector({\n            label: \"EOLR / EOLRb\",\n            names: [\"EOLR\", \"EOLRb\", \"EOdM\"],\n            flags: [1, 0, 0],\n            kind: \"lse-barbie\"\n        }),\n        lseEOLRScrambleSelector: new Selector({\n            label: \"Type of scramble\",\n            names: [\"Short\", \"Random State\"],\n            flags: [0, 1],\n            kind: \"lse-eolr-scramble\"\n        }),\n        ...initialLevels\n    }\n})()\n\n","import { FavCase, Mode, SliderOpt } from \"../Types\"\nimport { version } from \"../Version\"\nimport { initialConfig, initialFavList, Config } from \"../Config\"\nimport Selector from '../lib/Selector';\n\nexport type FavCaseStore = {mode: Mode, setup: string, solver: string }\nlet favListManager = function() {\n    const key = \"fav\"\n    let cache : FavCase[] | null = null\n    let getFavList = () => {\n        if (cache) return cache\n        const item = window.localStorage.getItem(key)\n        const item1 : FavCaseStore[] = item ? JSON.parse(item) : initialFavList\n        const item2 : FavCase[] = item1.map( ({mode, setup, solver}) => ({mode, setup, solver: solver.trim().split(\"|\")}) );\n        return item2\n    }\n    let setFavList = (item : FavCase[]) => {\n        const item1 : FavCaseStore[] = item.map(({mode, setup, solver}) => ({mode, setup, solver: solver.join(\"|\")}) );\n        window.localStorage.setItem(key, JSON.stringify(item1));\n        cache = item\n    }\n    return {\n        getFavList,\n        setFavList\n    }\n}()\n\nlet serializeConfig = (config : Config) => {\n    return JSON.stringify(config)\n}\n\nlet deserializeConfig = (s: string) => {\n    const obj = JSON.parse(s)\n    return Object.fromEntries(Object.entries(obj).map( \n        ([k, v]) => {\n            if (\"names\" in (v as any)) { \n                return [k, new Selector(v as Selector)] \n            } else {\n                return [k, v as SliderOpt]\n            }\n        }) )\n}\n\nlet configManager = function() {\n    const key = \"config\"\n    const versionKey = \"version\"\n    let cache : Config | null = null\n\n    let resetConfig = () => {\n        const item = window.localStorage.getItem(key);\n        const item1 : Partial<Config> = item ? deserializeConfig(item) : initialConfig\n        // let's preserve orientation\n        let config = initialConfig\n        if (item1.orientationSelector) {\n            config = {...initialConfig, orientationSelector: new Selector(item1.orientationSelector) }\n        }\n        window.localStorage.setItem(key, serializeConfig(config));\n        window.localStorage.setItem(versionKey, version)\n\n        return config\n    }\n    let getConfig = () => {\n        if (cache) {\n            return cache\n        }\n        const item = window.localStorage.getItem(key);\n        const vers = window.localStorage.getItem(versionKey)\n\n        const item1 : Partial<Config> = item ? deserializeConfig(item) : initialConfig\n\n        if ( vers !== version) {\n            // version out of date\n            // let's preserve orientation and theme\n            let config = initialConfig\n            if (item1.orientationSelector) {\n                config = {...initialConfig, orientationSelector: new Selector(item1.orientationSelector) }\n            }\n            if (item1.theme) {\n                config = {...config, theme: new Selector(item1.theme)}\n            }\n            window.localStorage.setItem(key, serializeConfig(config));\n            window.localStorage.setItem(versionKey, version)\n\n            return config\n        }\n\n        // If current value is uninitialized we'll initialize it\n        if ( (item1 === null) || (item1 === undefined) || Object.keys(item1).length === 0) {\n            window.localStorage.setItem(key, serializeConfig(initialConfig));\n            return initialConfig\n        }\n        // sometimes we want to append new fields without changing the version. this code handles that.\n        if (Object.keys(item1).length < Object.keys(initialConfig).length) {\n            const item2 = {...initialConfig, ...item1}\n            window.localStorage.setItem(key, serializeConfig(item2));\n            return item2\n        }\n        //console.log(\"config = \", item1)\n\n        cache = item1 as Config\n        return cache\n    }\n\n    let setConfig = (partial: Partial<Config>) => {\n        let newConfig : Config = Object.assign(getConfig(), partial)\n        window.localStorage.setItem(key, serializeConfig(newConfig));\n        cache = newConfig\n    }\n\n    return {\n        getConfig,\n        setConfig,\n        resetConfig\n    }\n}()\n\nlet {getConfig, setConfig, resetConfig} = configManager\nlet getFavList = favListManager.getFavList\nlet setFavList = favListManager.setFavList\n\nexport {\n    getConfig, setConfig, resetConfig, getFavList, setFavList\n}\n","import { AppState, FavCase } from \"../Types\";\nimport { Config } from \"../Config\";\n/* State Manager\n * \"Passively\" updates localstorage in reduce.\n * Action types\n *  - move: respond to cube move\n *  - replay: replay case\n *  - reactToConfig: respond to changes in config\n */\nexport abstract class AbstractStateM {\n    state: AppState;\n    constructor(state: AppState) {\n        this.state = state;\n    }\n    /* when new moves arrive (from virtual cube control) */\n    abstract onMove(s: string): AppState;\n    /* when global config changes */\n    abstract onConfig(conf: Config): AppState;\n    /* when user clicks a button or presses a key */\n    abstract onControl(s: string): AppState;\n    /* when user replays an item from the favlist */\n    onReplay(case_: FavCase): AppState {\n        return this.state;\n    }\n}\n\nexport class StateFactory {\n    static create = (state: AppState) => {\n        let filler = ( (()=>1) as unknown ) as (state: AppState) => AbstractStateM;\n        return filler(state);\n    }\n}","import { AppState, FavCase, SliderOpt } from \"../Types\";\nimport { alg_generator_from_group, CaseDesc } from \"../lib/Algs\";\nimport { Face, Typ, FBpairPosBackFS, FBpairPosFrontFS } from \"../lib/Defs\";\nimport { CubieCube, CubeUtil, Mask, FaceletCube, MoveSeq } from '../lib/CubeLib';\nimport { Evaluator, SeqEvaluator, getEvaluator } from \"../lib/Evaluator\";\nimport { CachedSolver } from \"../lib/CachedSolver\";\nimport { rand_choice, arrayEqual } from '../lib/Math';\nimport { AbstractStateM, StateFactory } from \"./AbstractStateM\";\nimport { Config } from \"../Config\";\n\ntype RandomCubeT = {\n    cube: CubieCube,\n    solvers: string[],\n    ssolver: string,\n    failed?: boolean\n}\n\nexport abstract class BlockTrainerStateM extends AbstractStateM {\n    abstract solverL: number;\n    abstract solverR: number;\n    scrambleMargin: number = 2;\n    scrambleCount: number = 3;\n    algDescWithMoveCount: string = \"\";\n    expansionFactor = 5;\n    premoves: string[] = [\"\"];\n    orientations: string[] = [\"\"];\n    evaluator : Evaluator;\n    levelMaxAttempt = 1000;\n    // [case, solver]\n    abstract getRandomAnyLevel(): RandomCubeT\n    getLevelSelector() : SliderOpt | null {\n        return null\n    }\n    checkLevelConstraint(n: number) : boolean {\n        // default to true\n        let slider = this.getLevelSelector()\n        if (!slider) return true;\n        // default to true\n        // either slider at \"ANY\" or depth must match\n        return ( (slider.value === slider.l - 1) || \n                 (slider.value === n) ||\n                 (slider.value === slider.r && slider.value < n && (!!slider.extend_r)) ||\n                 (slider.value === slider.l && slider.value > n && (!!slider.extend_l))\n               );\n    }\n    levelConstraintOkayWithUpperBound(b: number) : boolean {\n        // default to true\n        let slider = this.getLevelSelector()\n        if (!slider) return true;\n        // default to true\n        // either slider at \"ANY\" or depth must match\n        return ( (slider.value === slider.l - 1) || \n                 (slider.value >= b) ||\n                 (slider.value === slider.r && (!!slider.extend_r))\n               );\n    }\n    getRandom() : RandomCubeT {\n        for (let i = 0; i < this.levelMaxAttempt; i++) {\n            let {cube, solvers, ssolver} = this.getRandomAnyLevel()\n            const premoves = this.premoves || [\"\"]\n            let bound = Math.min(...solvers.map(solver => premoves.map(pm => \n                    CachedSolver.get(solver).getPruners()[0].query(cube.apply(pm)) )).flat())\n            //console.log(\"bound estimate = \", bound, this.getLevelSelector()?.value, this.levelConstraintOkayWithUpperBound(bound))\n            if (!this.levelConstraintOkayWithUpperBound(bound)) {\n                continue;\n            }   \n            let level = Math.min(...solvers.map(solver => premoves.map(pm => \n                    CachedSolver.get(solver).solve(cube.apply(pm), 0, this.solverR, 1)[0].moves.length)).flat())\n            if (this.checkLevelConstraint(level)) {\n                //TODO: add debug mode\n                console.debug(`generated random state after ${i+1} tries.`)\n                return {cube, solvers, ssolver}\n            }\n        }\n        console.log(`failed to generate random state after ${this.levelMaxAttempt} tries`)\n        return {...this.getRandomAnyLevel(), failed: true}\n    }\n\n    constructor(state: AppState) {\n        super(state)\n        // Enable below only when we decide to support evaluator selection\n        //let evalName = this.state.config.evaluator.getActiveName()\n        //this.evaluator = getEvaluator(evalName)\n        this.evaluator = new SeqEvaluator()\n    }\n    _solve_with_solvers(cube: CubieCube, solverNames: string[]): CaseDesc[]{\n        const state = this.state;\n        const totalSolutionCap = 0 | (+(state.config.solutionNumSelector.getActiveName() || 5) * this.expansionFactor);\n        const selectedSolutionCap = +(state.config.solutionNumSelector.getActiveName() || 5);\n        let getDesc = (solverName: string) => {\n            const solver = CachedSolver.get(solverName);\n            const premoves = this.premoves || [\"\"]\n            let solutions = premoves.map(pm =>\n                solver\n                .solve(cube.apply(pm), 0, this.solverR, totalSolutionCap)\n                .map(sol => ({pre: pm, sol: sol, score: this.evaluator.evaluate(sol)}) )).flat()\n            solutions.sort((a, b) => a.score - b.score);\n            const toString = (sol: any) =>\n                (sol.pre === \"\" ? \"\" : \"(\" + sol.pre + \") \") +\n                sol.sol.toString(this.algDescWithMoveCount); // + sol.score.toFixed(2);\n            const algs = solutions.slice(0, selectedSolutionCap).map(toString);\n            let algdesc: CaseDesc = {\n                id: `${solverName}`,\n                algs,\n                kind: `${solverName}`\n            }\n            return algdesc\n        }\n        return solverNames.map(getDesc)\n    }\n\n    _solve(cube: CubieCube, solverNames: string[], options?: {\n        updateSolutionOnly?: boolean, scrambleSolver?: string,\n        scramble?: string,\n    }) {\n        const state = this.state;\n        options = options || {}\n        let algDescs = this._solve_with_solvers(cube, solverNames);\n        let setup : string\n        if (options.scramble) {\n            setup = options.scramble\n        } else if (options.updateSolutionOnly) {\n            setup = this.state.case.desc[0]!.setup!\n        } else {\n            const scramble = options.scrambleSolver === \"min2phase\"?\n            CachedSolver.get(\"min2phase\").solve(cube,0,0,0)[0].inv() :\n            (()=>{\n                const solutionLength = new MoveSeq(algDescs[0].algs[0]).remove_setup().moves.length;\n                //console.log(options)\n                //console.log(\"SOLVING CUBE \", cube)\n                let result = rand_choice(\n                    CachedSolver.get(options.scrambleSolver || solverNames[0])\n                    .solve(cube, Math.min(this.solverR, Math.max(this.solverL, solutionLength + this.scrambleMargin)),\n                        this.solverR, this.scrambleCount || 1))?.inv()\n                //if (result === undefined) {\n                //    result = rand_choice(CachedSolver.get(options.scrambleSolver || solverNames[0])\n                //    .solve(cube, 0, this.solverR, this.scrambleCount || 1)).inv()\n                //}\n                return result\n            })()\n            setup = scramble.toString()\n        }\n        if (algDescs.length === 0) {\n            algDescs = [{\n                id: `min2phase`,\n                algs: [],\n                setup,\n                kind: `min2phase`\n            }];\n        } else {\n            // populate setup into setup\n            algDescs.forEach(algDesc => algDesc.setup = setup);\n        }\n\n        const ori = (options.updateSolutionOnly) ? this.state.cube.ori : alg_generator_from_group(state.config.orientationSelector)().id;\n        const name = options.updateSolutionOnly ? this.state.name : \"hiding\";\n        // console.log(\"algdesc\", algdesc)\n        return {\n            ...state,\n            name: name,\n            cube: {\n                ...state.cube,\n                state: cube,\n                ori\n            },\n            case: {\n                state: new CubieCube().apply(setup),\n                desc: algDescs\n            }\n        };\n    }\n    _updateCase(): AppState {\n        let {cube, solvers: solverNames, ssolver: scrambleSolver, failed} = this.getRandom();\n        let inputScramble : string | undefined = undefined\n        if (this.state.scrambleInput.length > 0) {\n            inputScramble = this.state.scrambleInput[0]\n            cube = new CubieCube().apply(inputScramble)\n        }\n        let state = this._solve(cube, solverNames, {\n            updateSolutionOnly: false,\n            scrambleSolver,\n            scramble: inputScramble\n        });\n        if (inputScramble) {\n            state = {...state, \n                scrambleInput: state.scrambleInput.slice(1)\n            }\n        }\n        state = {...state, cube: {...state.cube, levelSuccess: !failed}}\n        return state\n    }\n    _updateCap(): AppState {\n        const state = this.state;\n        if (state.case.desc.length === 0) {\n            return state;\n        }\n        const [cube, solverNames] = [state.cube.state, state.case.desc!.map(x => x.kind)];\n        return this._solve(cube, solverNames, {\n            updateSolutionOnly:true\n        });\n    }\n    onReplay(case_: FavCase): AppState {\n        const cube = new CubieCube().apply(case_.setup)\n        const state1 = this._solve(cube, case_.solver, {scramble: case_.setup});\n        return {\n            ...state1,\n            mode: case_.mode\n        };\n    }\n    onControl(s: string): AppState {\n        let state = this.state;\n        if (s === \"#space\") {\n            if (state.name === \"revealed\") {\n                return this._updateCase();\n            }\n            else {\n                return {\n                    ...state,\n                    name: \"revealed\"\n                };\n            }\n        }\n        else if (s === \"#enter\") {\n            return {\n                ...state,\n                cube: {\n                    ...state.cube,\n                    state: state.case.state,\n                }\n            };\n        }\n        else {\n            return state;\n        }\n    }\n    onMove(movestr: string): AppState {\n        let state = this.state;\n        let move = new MoveSeq(movestr);\n        let cube = state.cube.state.apply(move);\n        return {\n            ...state,\n            cube: {\n                ...state.cube,\n                state: cube\n            }\n        };\n    }\n    onConfig(conf: Config): AppState {\n        // see if solution cap changed\n        let changed = !arrayEqual(this.state.config.solutionNumSelector.flags, conf.solutionNumSelector.flags);\n        if (changed) {\n            return (StateFactory.create({ ...this.state, config: conf }) as BlockTrainerStateM)._updateCap();\n        }\n        else {\n            return this.state;\n        }\n    }\n}\n// const m_premove = [[], Move.all[\"M\"], Move.all[\"M'\"], Move.all[\"M2\"]];\nexport class FbdrStateM extends BlockTrainerStateM {\n    solverL = 8;\n    solverR = 10;\n    _get_pair_solved_front() {\n        let [cp, co, ep, eo] = rand_choice(FBpairPosBackFS);\n        // for solved back-FS, ignore CP=5 and C=(1,0)\n        // for solved front-FS, ignore CP=4 and C=(0,0)\n        //let mask = Mask.copy(Mask.fs_front_mask)\n        let cube = CubeUtil.get_random_with_mask(Mask.fs_back_mask);\n        for (let i = 0; i < 8; i++) {\n            if (cube.cp[i] === 4) {\n                cube.cp[i] = cube.cp[cp];\n                cube.co[i] = cube.co[cp];\n                cube.cp[cp] = 4;\n                cube.co[cp] = co;\n            }\n        }\n        for (let i = 0; i < 12; i++) {\n            if (cube.ep[i] === 8) {\n                cube.ep[i] = cube.ep[ep];\n                cube.eo[i] = cube.eo[ep];\n                cube.ep[ep] = 8;\n                cube.eo[ep] = eo;\n            }\n        }\n        return cube;\n    }\n    _get_pair_solved_back() {\n        let [cp, co, ep, eo] = rand_choice(FBpairPosFrontFS)\n        //let mask = Mask.copy(Mask.fs_front_mask)\n        let cube = CubeUtil.get_random_with_mask(Mask.fs_front_mask);\n        for (let i = 0; i < 8; i++) {\n            if (cube.cp[i] === 5) {\n                cube.cp[i] = cube.cp[cp];\n                cube.co[i] = cube.co[cp];\n                cube.cp[cp] = 5;\n                cube.co[cp] = co;\n            }\n        }\n        for (let i = 0; i < 12; i++) {\n            if (cube.ep[i] === 9) {\n                cube.ep[i] = cube.ep[ep];\n                cube.eo[i] = cube.eo[ep];\n                cube.ep[ep] = 9;\n                cube.eo[ep] = eo;\n            }\n        }\n        //console.log(\"pair for frontFS\", [cp, co, ep, eo])\n        return cube;\n    }\n    _edge_piece_in_pattern(cube: CubieCube, idx: number, pattern: [number, number][]) {\n        let dr_ep = cube.ep.indexOf(idx);\n        let dr_eo = cube.eo[dr_ep];\n        let good = (pattern.find( ([eo, ep]) => (eo === dr_eo) && (ep === dr_ep)))\n        return good\n    }\n    _get_random_fs_back() {\n        let cube = CubeUtil.get_random_with_mask(Mask.fs_back_mask);\n        for (let i = 0; i < 1000; i++) {\n            if (this._edge_piece_in_pattern(cube, 7, this.allowed_dr) &&\n                this._edge_piece_in_pattern(cube, 8, this.allowed_pedge)) break;\n            cube = CubeUtil.get_random_with_mask(Mask.fs_back_mask);\n        }\n        return cube;\n        //return CubieCube.apply(cube, rand_choice(m_premove));\n    }\n    _get_random_fs_front() {\n        let cube = CubeUtil.get_random_with_mask(Mask.fs_front_mask);\n        for (let i = 0; i < 1000; i++) {\n            if (this._edge_piece_in_pattern(cube, 7, this.allowed_dr) &&\n                this._edge_piece_in_pattern(cube, 9, this.allowed_pedge)) break;\n            cube = CubeUtil.get_random_with_mask(Mask.fs_front_mask);\n        }\n        return cube;;\n        //return CubieCube.apply(cube, rand_choice(m_premove));\n    }\n    edgePositionMap : [number, number][] = [\n        [0, 0], [1, 0],\n        [0, 1], [1, 1],\n        [0, 2], [1, 2],\n        [0, 3], [1, 3],\n        [0, 4], [1, 4],\n        [0, 6], [1, 6],\n        [0, 7], [1, 7],\n        [0, 10], [1, 10],\n        [0, 11], [1, 11]\n    ]\n    allowed_pedge : [number, number][] = []\n    allowed_dr : [number, number][] = []\n    getLevelSelector() {return this.state.config.fbdrLevelSelector}\n    getRandomAnyLevel(): RandomCubeT {\n        const fbOnly = this.state.config.fbOnlySelector.getActiveName() === \"FB Last Pair Only\";\n        const pairSolved = this.state.config.fbPairSolvedSelector.getActiveName() !== \"Random\";\n        const scrambleType = this.state.config.fbdrScrambleSelector.getActiveName() || \"Short\";\n        const useMin2PhaseScramble = !scrambleType.startsWith(\"Short\");\n        const solvers = [fbOnly ? \"fb\" : \"fbdr\"];\n        const ssolver = useMin2PhaseScramble ? \"min2phase\" : solvers[0]\n        let active = this.state.config.fbdrSelector.getActiveNames()[0];\n        //console.log(\"active\", active)\n        this.allowed_pedge = this.state.config.fbdrPosSelector1.flags.map( (value, i) => [value, i])\n            .filter( ([value, i]) => value ).map( ([value, i]) => this.edgePositionMap[i] )\n        this.allowed_dr = this.state.config.fbdrPosSelector3.flags.map( (value, i) => [value, i])\n            .filter( ([value, i]) => value ).map( ([value, i]) => this.edgePositionMap[i] )\n\n        this.solverL = (pairSolved) ? (fbOnly ? 5 : 7) : (fbOnly ? 7 : 8)\n        if (pairSolved) {\n\n        }\n        // decide which random scramble generator to use. but prioritize use input if there's any\n        let cube\n        if (active === \"FS at back\") {\n            cube = (pairSolved) ? this._get_pair_solved_front() : this._get_random_fs_back();\n        }\n        else if (active === \"FS at front\") {\n            cube = (pairSolved) ? this._get_pair_solved_back() : this._get_random_fs_front();\n        }\n        else {\n            cube = (pairSolved) ? \n                   rand_choice([ () => this._get_pair_solved_front(), () => this._get_pair_solved_back()])()\n                   : rand_choice([ () => this._get_random_fs_back(), () => this._get_random_fs_front()])();\n        }\n        return {cube, solvers, ssolver};\n    }\n}\nexport class FbStateM extends BlockTrainerStateM {\n    solverL: number = 8;\n    solverR: number = 11;\n    //premoves = [\"\", \"x\", \"x'\", \"x2\"];\n    premoves = [\"\", \"x\", \"x'\", \"x2\"];\n    levelMaxAttempt = 2000;\n\n    // constructor(state: AppState) {\n    //     super(state)\n    //     //this.evaluator = getEvaluator(\"movement\")\n    // }\n    _find_center_connected_edges(cube: CubieCube, is_l_only: boolean) {\n        let centers = is_l_only ? [ Face.L ] : [ Face.F, Face.B, Face.L, Face.R]\n        let edges = CubeUtil.stickers.filter(c => c[2] === Typ.E && centers.includes(c[3])\n            && FaceletCube.color_of_sticker(cube, [c[0], c[1], c[2]]) === c[3]);\n        return edges;\n    }\n    _get_random(): [CubieCube, string] {\n        let active = this.state.config.fbPieceSolvedSelector.getActiveName();\n        let mask;\n        if (active === \"Random\")\n            mask = Mask.empty_mask;\n        else if (active === \"DL Solved\")\n            mask = Mask.dl_solved_mask;\n        else if (active === \"BL Solved\")\n            mask = Mask.bl_solved_mask;\n        //else if (active === \"BL Pair Solved\")\n        //    mask = Mask.bl_pair_solved_mask;\n        else if (active === \"Zhouheng Variant\")\n            mask = Mask.zhouheng_mask;\n        else\n            mask = Mask.empty_mask;\n        let cube = CubeUtil.get_random_with_mask(mask);\n        let basis = this.state.config.fbBasisSelector.getActiveName();\n        cube = (basis === \"Default\") ? cube\n              : (basis === \"DL\") ? CubeUtil.rebase_to_edge(cube, 5)[0]\n              : CubeUtil.rebase_to_edge(cube, 9)[0] // BL\n\n        let solver = (basis === \"Default\") ? \"fb\"\n                     : (basis === \"DL\") ? \"fb@dl\" \n                     : \"fb@bl\";\n\n        if (basis === \"Default\") {\n            this.premoves = [\"\", \"x\", \"x'\", \"x2\"]\n        } else {\n            this.premoves = [\"\"]\n        }\n        // if (active === \"Zhouheng Variant\") {\n        //     // B F'\n        //     cube = cube.apply(\"B F'\");\n        //     solver = \"fbdr\";\n        // }\n        const hard_str = \"Hard\";\n        const g_hard_str = \"Hard over x2y (Scramble only)\"\n        if (active === g_hard_str) {\n            solver = \"min2phase\";\n        }\n        if (active !== hard_str && active !== g_hard_str) {\n            return [cube, solver];\n        }\n        let n = 0;\n        let is_l_only = active === hard_str\n        while (true) {\n            let pairs = CubeUtil.find_pairs(cube);\n            let cc_edges = this._find_center_connected_edges(cube, is_l_only);\n            // n++;\n            if (pairs.length === 0 && cc_edges.length === 0) {\n                //console.log(\"Successful after \" + n + \" tries \");\n                return [cube, solver];\n            }\n            cube = CubeUtil.get_random_with_mask(Mask.empty_mask);\n        }\n    }\n    getLevelSelector() {return this.state.config.fbLevelSelector}\n    getRandomAnyLevel() {\n        let [cube, solver] = this._get_random();\n        return {cube, solvers: solver === \"min2phase\" ? [] : [solver], ssolver: solver};\n    }\n}\n\n\nexport class FsStateM extends BlockTrainerStateM {\n    solverL = 7;\n    solverR = 11;\n    premoves = [\"\", \"x\", \"x'\", \"x2\"];\n    levelMaxAttempt = 2000;\n\n    getLevelSelector() {return this.state.config.fsLevelSelector}\n    getRandomAnyLevel() {\n        let cube = CubeUtil.get_random_with_mask(Mask.empty_mask);\n        let name = this.state.config.fsSelector.getActiveName()\n        if (name === \"Front FS\") {\n            return {cube, solvers: [\"fs-front\"], ssolver: \"fb\"}\n        } else if (name === \"Back FS\") {\n            return {cube, solvers: [\"fs-back\"], ssolver: \"fb\"}\n        } else {\n            return {cube, solvers: [\"fs-front\", \"fs-back\"], ssolver: \"fb\"}\n        }\n    }\n}\n\nexport class FsDrStateM extends BlockTrainerStateM {\n    solverL = 7;\n    solverR = 11;\n    premoves = [\"\", \"x\", \"x'\", \"x2\"];\n    levelMaxAttempt = 1000;\n\n    getLevelSelector() {return this.state.config.fsLevelSelector}\n    getRandomAnyLevel() {\n        let cube = CubeUtil.get_random_with_mask(Mask.empty_mask);\n        let name = this.state.config.fsSelector.getActiveName()\n        if (name === \"Front FS\") {\n            return {cube, solvers: [\"fsdr-front\"], ssolver: \"fbdr\"}\n        } else if (name === \"Back FS\") {\n            return {cube, solvers: [\"fsdr-back\"], ssolver: \"fbdr\"}\n        } else {\n            return {cube, solvers: [\"fsdr-front\", \"fsdr-back\"], ssolver: \"fbdr\"}\n        }\n    }\n}\n\n\nexport class FbssStateM extends BlockTrainerStateM {\n    solverL = 8;\n    solverR = 12;\n    expansionFactor = 5;\n    levelMaxAttempt = 500;\n\n    getLevelSelector() {return this.state.config.fbssLevelSelector}\n    getRandom() {\n        let ls = this.getLevelSelector()\n        this.levelMaxAttempt = (ls.value <= 4) ? 1500 : 500;\n        return super.getRandom()\n    }\n    getRandomAnyLevel() {\n        let lp_option = this.state.config.fbssLpSelector.getActiveName()\n        let ss_option = this.state.config.fbssSsSelector.getActiveName()\n        let cube, solvers, ssolver\n        // [\"Front SS\", \"Back SS\" , \"Both\"]\n        let lp_is_front = (lp_option === \"Front FBLP\")\n        let randomMask = lp_is_front ? Mask.fs_back_mask : Mask.fs_front_mask\n        cube = CubeUtil.get_random_with_mask(randomMask)\n\n        if (ss_option === \"Front SS\") {\n            solvers = [\"fbss-front\"];\n            ssolver = \"fbss-front\"\n        } else if (ss_option === \"Back SS\") {\n            solvers = [\"fbss-back\"];\n            ssolver = \"fbss-back\"\n        } else {\n            solvers = [\"fbss-front\", \"fbss-back\"];\n            ssolver = lp_is_front ? \"lpsb-front\" : \"lpsb-back\" //(\"min2phase\"\n        }\n        return {cube, solvers, ssolver};\n    }\n}","import { CubieCube, CubeUtil, Mask } from '../lib/CubeLib';\nimport { BlockTrainerStateM } from \"./BlockTrainerStateM\";\n\nexport class SsStateM extends BlockTrainerStateM {\n    scrambleMargin = 1;\n    solverL = 8;\n    solverR = 14;\n    levelMaxAttempt = 3000;\n\n    _get_random_fb(allowed_dr_eo_ep: [number, number][]) {\n        let active = this.state.config.ssPairOnlySelector.getActiveName();\n        let mask = (active === \"DR fixed\") ? Mask.fbdr_mask : Mask.fb_mask;\n        let cube: CubieCube;\n        while (true) {\n            cube = CubeUtil.get_random_with_mask(mask);\n            if (active === \"DR fixed\")\n                break;\n            let ep = cube.ep.indexOf(7);\n            let eo = cube.eo[ep];\n            if (allowed_dr_eo_ep.find(([eo_, ep_]) => (eo === eo_) && (ep === ep_))) {\n                break;\n            }\n        }\n        return cube;\n    }\n    getLevelSelector() { return this.state.config.ssLevelSelector; }\n    getRandomAnyLevel() {\n        let active = this.state.config.ssSelector.getActiveNames()[0];\n        const drOPPositionMap: [number, number][] = [\n            [0, 0], [1, 0],\n            [0, 1], [1, 1],\n            [0, 2], [1, 2],\n            [0, 3], [1, 3],\n            [0, 4], [1, 4],\n            [0, 6], [1, 6],\n            [0, 7], [1, 7],\n            [0, 10], [1, 10],\n            [0, 11], [1, 11]\n        ];\n        //[\"UF\", \"FU\", \"UL\", \"LU\", \"UB\", \"BU\", \"UR\", \"RU\", \"DF\", \"FD\", \"DB\", \"BD\",\n        //\"DR\", \"RD\", \"BR\", \"RB\", \"FR\", \"RF\"],\n        let allowed_dr_eo_ep_patterns = this.state.config.ssPosSelector.flags.map((value, i) => [value, i])\n            .filter(([value, i]) => value).map(([value, i]) => drOPPositionMap[i]);\n        let cube = this._get_random_fb(allowed_dr_eo_ep_patterns);\n        let solvers, ssolver;\n        let solverMode = this.state.config.ssPairOnlySelector.getActiveName();\n        let pre = solverMode === \"D-Pair only\" ? \"ssdp\" : \"ss\"\n        if (active === \"Front SS\") {\n            ssolver = pre + \"-front\";\n            solvers = [ssolver];\n        }\n        else if (active === \"Back SS\") {\n            ssolver = pre + \"-back\";\n            solvers = [ssolver];\n        }\n        else {\n            solvers = [pre + \"-front\", pre + \"-back\"];\n            ssolver = \"sb\";\n        }\n        return { cube, solvers, ssolver };\n    }\n}\n\nexport class SsDPairStateM extends BlockTrainerStateM {\n    scrambleMargin = 1;\n    solverL = 8;\n    solverR = 14;\n    levelMaxAttempt = 3000;\n\n    _get_random_fb(allowed_dr_eo_ep: [number, number][]) {\n        let active = this.state.config.ssPairOnlySelector.getActiveName();\n        let mask = (active === \"SS\") ? Mask.fb_mask : Mask.fbdr_mask;\n        let cube: CubieCube;\n        while (true) {\n            cube = CubeUtil.get_random_with_mask(mask);\n            if (active !== \"SS\")\n                break;\n            let ep = cube.ep.indexOf(7);\n            let eo = cube.eo[ep];\n            if (allowed_dr_eo_ep.find(([eo_, ep_]) => (eo === eo_) && (ep === ep_))) {\n                break;\n            }\n        }\n        return cube;\n    }\n    getLevelSelector() { return this.state.config.ssLevelSelector; }\n    getRandomAnyLevel() {\n        let active = this.state.config.ssSelector.getActiveNames()[0];\n        const drPositionMap: [number, number][] = [\n            [0, 0], [1, 0],\n            [0, 1], [1, 1],\n            [0, 2], [1, 2],\n            [0, 3], [1, 3],\n            [0, 4], [1, 4],\n            [0, 6], [1, 6],\n            [0, 7], [1, 7],\n            [0, 10], [1, 10],\n            [0, 11], [1, 11]\n        ];\n        let allowed_dr_eo_ep_patterns = this.state.config.ssPosSelector.flags.map((value, i) => [value, i])\n            .filter(([value, i]) => value).map(([value, i]) => drPositionMap[i]);\n        let cube = this._get_random_fb(allowed_dr_eo_ep_patterns);\n        let solvers, ssolver;\n        if (active === \"Front SS\") {\n            solvers = [\"ss-front\"];\n            ssolver = \"ss-front\";\n        }\n        else if (active === \"Back SS\") {\n            solvers = [\"ss-back\"];\n            ssolver = \"ss-back\";\n        }\n        else {\n            solvers = [\"ss-front\", \"ss-back\"];\n            ssolver = \"sb\";\n        }\n        return { cube, solvers, ssolver };\n    }\n}\n\n","\nimport { BlockTrainerStateM } from \"./BlockTrainerStateM\";\nimport { Mask, CubeUtil, CubieCube, Move } from \"../lib/CubeLib\";\nimport { rand_choice } from \"../lib/Math\";\nimport { CachedSolver } from \"../lib/CachedSolver\";\nimport { EOLRMode } from \"../Config\";\n\nexport class LSEStateM extends BlockTrainerStateM {\n    solverL = 5;\n    solverR = 20;\n    scrambleCount = 3;\n    algDescWithMoveCount = \"STM\";\n    getRandomAnyLevel() {\n        /*\n        LSE Modes:\n        pure 4c (UFUB/ULUR, MC/NC)\n        M2 to 4c (same as above)\n        */\n\n        let bars = this.state.config.lseBarSelector.getActiveName()\n\n        let cube = CubeUtil.get_random_with_mask(Mask.lse_4c_mask);\n\n        let move = new Move().from_cube(cube, \"\")\n\n        if (bars === \"UFUB\") {\n            cube = new CubieCube().apply(rand_choice([\"U\", \"U\"])).apply(move)\n        } else {\n            cube = new CubieCube().apply(move)\n        }\n\n        let is_mc = this.state.config.lseMCSelector.getActiveName() === \"Misaligned\";\n        let lse_premove = is_mc ? [Move.all[\"M\"], Move.all[\"M'\"]] : [ [], Move.all[\"M2\"] ]\n        cube = cube.apply(rand_choice(lse_premove))\n\n        let stage = this.state.config.lseStageSelector.getActiveName()\n        let solvers = [\"lse\"]\n        let ssolver = \"lse\"\n        if (stage === \"M2 to 4c\")  {\n            cube = cube.apply(rand_choice([\"U M2\", \"U' M2\"])).apply(rand_choice([\"U\", \"U'\", \"U2\", \"id\"]))\n            return {cube, solvers, ssolver}\n        } else if (stage.startsWith(\"4b for MC\")) {\n            cube = cube.apply(rand_choice([\"U M2\", \"U' M2\"])).apply(rand_choice([\"U\", \"U'\", \"U2\", \"id\"]))\n            cube = cube.apply(rand_choice([\"M\", \"M'\"]))\n            cube = cube.apply(rand_choice([\"U\", \"U'\", \"U2\", \"id\"]))\n            return {cube, solvers, ssolver}\n        } else {\n            return {cube, solvers, ssolver}\n        }\n    }\n}\n\nconst lseEODef = [\n    {kind: \"solved\", eo: [0,0,0,0,0,0]},\n    {kind: \"arrow\", eo: [1,1,0,1,1,0]},\n    {kind: \"arrow\", eo: [0,1,1,1,0,1]},\n    {kind: \"4/0\", eo: [1,1,1,1,0,0]},\n    {kind: \"2o/0\", eo: [1,0,1,0,0,0]},\n    {kind: \"2a/0\", eo: [1,1,0,0,0,0]},\n    {kind: \"1/1\", eo: [1,0,0,0,0,1]},\n    {kind: \"1/1\", eo: [0,0,1,0,1,0]},\n    {kind: \"6flip\", eo: [1,1,1,1,1,1]},\n    {kind: \"2o/2\", eo: [0,1,0,1,1,1]},\n    {kind: \"0/2\", eo: [0,0,0,0,1,1]},\n    {kind: \"2a/2\", eo: [0,1,1,0,1,1]},\n]\nconst lseEODefLookup = function() {\n    let map = Object.assign({});\n    lseEODef.forEach( (def) => {\n        map[def.eo.toString()] = def.kind\n    })\n    return map\n}();\n\nexport class EOLRStateM extends BlockTrainerStateM {\n    solverL = 5;\n    solverR = 20;\n    scrambleCount = 3;\n    algDescWithMoveCount = \"STM\";\n\n    _getEOType(cube: CubieCube) {\n        for (let i = 0; i < 4; i++) {\n            let eo_arr = cube.eo.slice(0, 5)\n            eo_arr.push(cube.eo[6])\n            let eo = (lseEODefLookup[eo_arr.toString()])\n            if (eo) {\n\n                console.log(eo, eo_arr)\n                return eo;\n            }\n            cube = cube.apply(\"U\")\n        }\n        return \"Error\"\n    }\n\n    getRandomAnyLevel() {\n        /*\n        LSE Modes:\n        pure 4c (UFUB/ULUR, MC/NC)\n        M2 to 4c (same as above)\n        */\n\n        let targetEO = rand_choice(this.state.config.lseEOSelector.getActiveNames())\n\n        let cube: CubieCube\n        let count = 0;\n        let eolrMCMode = this.state.config.lseEOLRMCSelector.getActiveName()\n        let compare = eolrMCMode === EOLRMode.NONMC_SHORTER_ONLY || eolrMCMode === EOLRMode.MC_SHORTER_ONLY\n        let useBarbie = this.state.config.lseBarbieSelector.getActiveName() === \"EOLRb\"\n        let eodmMode = this.state.config.lseBarbieSelector.getActiveName() === \"EOdM\"\n        let useFullScramble = this.state.config.lseEOLRScrambleSelector.getActiveName() === \"Random State\"\n\n        while (true) {\n            cube = CubeUtil.get_random_with_mask(Mask.lse_mask);\n            cube = cube.apply(rand_choice([\"id\", \"M2\"]))\n            console.log(\"targetEO\", targetEO)\n\n            if (count++ > 1000) {\n                console.log(\"something wrong\")\n                break\n            }\n\n\n            if (this._getEOType(cube) !== targetEO)\n                continue\n            if (compare) {\n                let acSolver = useBarbie ? \"eolrac-b\" : \"eolrac\"\n                let mcSolver = useBarbie ? \"eolrmc-b\" : \"eolrmc\"\n                let acLength = CachedSolver.get(acSolver).solve(cube, 0, 20, 1)[0].moves.length\n                let mcLength = CachedSolver.get(mcSolver).solve(cube, 0, 20, 1)[0].moves.length\n                if ( eolrMCMode === EOLRMode.NONMC_SHORTER_ONLY && acLength > mcLength ) continue\n                if ( eolrMCMode === EOLRMode.MC_SHORTER_ONLY && mcLength > acLength ) continue\n            }\n            break\n        }\n\n        const ssolver = (useFullScramble || eodmMode) ? \"lse\" : \"lse-ab4c\";\n        let solver : string\n        switch (eolrMCMode) {\n            case EOLRMode.NONMC_ONLY: solver = useBarbie ? \"eolrac-b\" : \"eolrac\"; break;\n            case EOLRMode.MC_ONLY: solver = useBarbie ? \"eolrmc-b\" : \"eolrmc\"; break;\n            case EOLRMode.COMBINED: solver = useBarbie ? \"eolr-b\" : \"eolr\"; break;\n            case EOLRMode.NONMC_SHORTER_ONLY:\n            case EOLRMode.MC_SHORTER_ONLY: solver = useBarbie ? \"eolr-b\" : \"eolr\"; break;\n            default: solver = \"eolr\";\n        }\n\n        // in case of EOdM, override all of above\n        if (eodmMode) {\n            solver = \"eodm\"\n        }\n\n        return {cube, solvers: [solver], ssolver}\n    }\n}\n","import { AppState, StateT  } from \"../Types\";\nimport { Config } from '../Config';\nimport { alg_generator_from_group, alg_generator_from_cases, CaseDesc, createAlg, alg_generator_from_cases_contain} from \"../lib/Algs\";\nimport { CubieCube, Move, CubeUtil, MoveSeq } from '../lib/CubeLib';\nimport { AbstractStateM } from \"./AbstractStateM\";\nimport {initialize as min2phase_init, solve as min2phase_solve} from \"../lib/min2phase/min2phase-wrapper\"\nimport { arrayEqual, rand_choice } from \"../lib/Math\";\n\nexport abstract class CmllStateM extends AbstractStateM {\n    _get2PhaseSolution(cube: CubieCube): CaseDesc {\n        // Aha! f = g(b) but you modified b later, and f won't update!\n\n        let m2_away = false\n        if (cube.tp[0] !== 0) {\n            m2_away = true\n            cube = cube.apply(\"M2\")\n        }\n        console.assert(arrayEqual(cube.tp, new CubieCube().tp))\n\n        const transformed_cube = cube.to_cstimer_cube()\n        console.assert( transformed_cube.is_solveable(), \"Cube must be solveable\")\n        min2phase_init();\n        let solution = min2phase_solve(transformed_cube);\n        if (m2_away) {\n            solution += \" M2\"\n        }\n        const algDesc: CaseDesc = createAlg(\"scramble\", solution, \"scramble\")\n        console.log(solution);\n        return algDesc;\n    }\n    _generateCase(): AppState {\n        let state = this.state;\n        let { config } = state;\n        let { cmllCaseSelector, triggerSelector, cmllAufSelector, orientationSelector, nmcllSelector, hyperOriSelector } = config;\n\n        const isHyperOri = hyperOriSelector.getActiveName() !== \"off\" ;\n        const isHyperOriFB = hyperOriSelector.getActiveName() !== \"F/B\" ;\n        let generator = (() => {\n            if (!isHyperOri) {\n                return alg_generator_from_cases(cmllCaseSelector.kind, cmllCaseSelector.getActiveNames());\n            } else {\n                return alg_generator_from_cases_contain(nmcllSelector.kind, nmcllSelector.getActiveNames().map(x => `nmcll-${x}`))\n            }\n        })();\n        let trig_generator = alg_generator_from_group(triggerSelector);\n        let u_auf_generator =alg_generator_from_group(cmllAufSelector);\n        let ori_generator = alg_generator_from_group(orientationSelector);\n        let post_auf_generator = () => {\n            const choices = (isHyperOriFB) ? [\"U\", \"U'\"] : [\"\", \"U2\"]\n            return rand_choice(choices)\n        }\n        let trigger_alg: CaseDesc = trig_generator();\n        let cmll_alg: CaseDesc = generator();\n        let u_auf_alg: CaseDesc = u_auf_generator();\n        let post_auf_alg = post_auf_generator();\n        let alg_str = trigger_alg.algs + \" \" + u_auf_alg.algs + \" \" + cmll_alg.algs + post_auf_alg;\n        let moves: Move[] = new MoveSeq(alg_str).inv().moves;\n\n        let lse_cube: CubieCube\n        while (true) {\n            lse_cube = CubeUtil.get_random_lse().apply(moves)\n            if (lse_cube.is_solveable()) {\n                break;\n            }\n        }\n        let solution = this._get2PhaseSolution(lse_cube);\n        // ori based on ...?\n        let ori: string = ori_generator().id;\n        //console.log(\"current ori selector's ori \", ori)\n        return ({\n            ...state,\n            name: \"solving\",\n            cube: {\n                state: lse_cube,\n                ori,\n                history: [],\n                levelSuccess: true\n            },\n            case: {\n                state: lse_cube,\n                desc: [trigger_alg, u_auf_alg, cmll_alg, solution]\n            },\n        });\n    }\n    onControl(s: string): AppState {\n        let state = this.state;\n        if (s === \"#space\") {\n            // SCRAMBLE\n            // enter cleared solving state based on selection\n            return this._generateCase();\n        }\n        else if (s === \"#enter\") {\n            // REDO\n            return ({\n                ...state,\n                name: \"solving\",\n                cube: {\n                    ...state.cube,\n                    state: state.case.state,\n                    history: []\n                },\n                case: {\n                    ...state.case,\n                }\n            });\n        }\n        else {\n            throw new Error(\"Unrecognized control code\");\n        }\n    }\n    onConfig(conf: Config): AppState {\n        return this.state;\n    }\n}\nexport class CmllSolvingStateM extends CmllStateM {\n    onMove(move: string): AppState {\n        let state = this.state;\n        let moves = new MoveSeq(move).moves;\n        if (moves.length > 0) {\n            let move = moves[0];\n            let cube = state.cube.state.apply(move);\n            let cmll_solved = CubeUtil.is_cmll_solved(cube);\n            let newState: StateT = cmll_solved ? \"solved\" : \"solving\";\n            return ({\n                ...state,\n                cube: {\n                    ...state.cube,\n                    state: state.cube.state.apply(move),\n                    history: [...state.cube.history, move],\n                },\n                name: newState\n            });\n        }\n        else {\n            // Nothing to apply\n            return state;\n        }\n    }\n}\nexport class CmllSolvedStateM extends CmllStateM {\n    onMove(move: string): AppState {\n        return this.state;\n    }\n}\n\n\nexport abstract class OllcpStateM extends AbstractStateM {\n    _get2PhaseSolution(cube: CubieCube): CaseDesc {\n        // Aha! f = g(b) but you modified b later, and f won't update!\n\n        let m2_away = false\n        if (cube.tp[0] !== 0) {\n            m2_away = true\n            cube = cube.apply(\"M2\")\n        }\n        console.assert(arrayEqual(cube.tp, new CubieCube().tp))\n\n        const transformed_cube = cube.to_cstimer_cube()\n        console.assert( transformed_cube.is_solveable(), \"Cube must be solveable\")\n        min2phase_init();\n        let solution = min2phase_solve(transformed_cube);\n        if (m2_away) {\n            solution += \" M2\"\n        }\n        const algDesc: CaseDesc = createAlg(\"scramble\", solution, \"scramble\")\n        console.log(solution);\n        return algDesc;\n    }\n    _generateCase(): AppState {\n        let state = this.state;\n        let { config } = state;\n        let { cmllCaseSelector, triggerSelector, cmllAufSelector, orientationSelector, nmcllSelector, hyperOriSelector } = config;\n\n        const isHyperOri = hyperOriSelector.getActiveName() !== \"off\" ;\n        const isHyperOriFB = hyperOriSelector.getActiveName() !== \"F/B\" ;\n        let generator = alg_generator_from_cases(cmllCaseSelector.kind, cmllCaseSelector.getActiveNames());\n        let trig_generator = alg_generator_from_group(triggerSelector);\n        let u_auf_generator =alg_generator_from_group(cmllAufSelector);\n        let ori_generator = alg_generator_from_group(orientationSelector);\n        let post_auf_generator = () => {\n            const choices = (isHyperOriFB) ? [\"U\", \"U'\"] : [\"\", \"U2\"]\n            return rand_choice(choices)\n        }\n        let trigger_alg: CaseDesc = trig_generator();\n        let cmll_alg: CaseDesc = generator();\n        let u_auf_alg: CaseDesc = u_auf_generator();\n        let post_auf_alg = post_auf_generator();\n        let alg_str = trigger_alg.algs + \" \" + u_auf_alg.algs + \" \" + cmll_alg.algs + post_auf_alg;\n        let moves: Move[] = new MoveSeq(alg_str).inv().moves;\n\n        let lse_cube: CubieCube\n        while (true) {\n            lse_cube = CubeUtil.get_random_lse().apply(moves)\n            if (lse_cube.is_solveable()) {\n                break;\n            }\n        }\n        let solution = this._get2PhaseSolution(lse_cube);\n        // ori based on ...?\n        let ori: string = ori_generator().id;\n        //console.log(\"current ori selector's ori \", ori)\n        return ({\n            ...state,\n            name: \"solving\",\n            cube: {\n                state: lse_cube,\n                ori,\n                history: [],\n                levelSuccess: true\n            },\n            case: {\n                state: lse_cube,\n                desc: [trigger_alg, u_auf_alg, cmll_alg, solution]\n            },\n        });\n    }\n    onControl(s: string): AppState {\n        let state = this.state;\n        if (s === \"#space\") {\n            // SCRAMBLE\n            // enter cleared solving state based on selection\n            return this._generateCase();\n        }\n        else if (s === \"#enter\") {\n            // REDO\n            return ({\n                ...state,\n                name: \"solving\",\n                cube: {\n                    ...state.cube,\n                    state: state.case.state,\n                    history: []\n                },\n                case: {\n                    ...state.case,\n                }\n            });\n        }\n        else {\n            throw new Error(\"Unrecognized control code\");\n        }\n    }\n    onConfig(conf: Config): AppState {\n        return this.state;\n    }\n}\n\nexport class OllcpSolvingStateM extends OllcpStateM {\n    onMove(move: string): AppState {\n        let state = this.state;\n        let moves = new MoveSeq(move).moves;\n        if (moves.length > 0) {\n            let move = moves[0];\n            let cube = state.cube.state.apply(move);\n            // TODO: fix this\n            let cmll_solved = CubeUtil.is_cmll_solved(cube);\n            let newState: StateT = cmll_solved ? \"solved\" : \"solving\";\n            return ({\n                ...state,\n                cube: {\n                    ...state.cube,\n                    state: state.cube.state.apply(move),\n                    history: [...state.cube.history, move],\n                },\n                name: newState\n            });\n        }\n        else {\n            // Nothing to apply\n            return state;\n        }\n    }\n}\nexport class OllcpSolvedStateM extends OllcpStateM {\n    onMove(move: string): AppState {\n        return this.state;\n    }\n}\n","import { StateFactory} from './AbstractStateM';\nimport { AppState, Mode } from '../Types';\nimport { FbdrStateM, FbStateM, FsStateM, FsDrStateM, FbssStateM} from './BlockTrainerStateM';\nimport { SsStateM } from './SsStateM';\nimport { LSEStateM, EOLRStateM } from './LSETrainerStateM';\nimport { CmllSolvingStateM, CmllSolvedStateM } from './CmllStateM';\n\nStateFactory.create = function(state: AppState) {\n        let mode: Mode = state.mode;\n        switch (mode) {\n            case \"fbdr\":\n                return new FbdrStateM(state);\n            case \"ss\":\n                return new SsStateM(state);\n            case \"fbss\":\n                return new FbssStateM(state);\n            case \"fs\":\n                return new FsStateM(state);\n            case \"fsdr\":\n                return new FsDrStateM(state);\n            case \"fb\":\n                return new FbStateM(state);\n            case \"cmll\":{\n                switch (state.name) {\n                    case \"solving\": return new CmllSolvingStateM(state);\n                    case \"solved\": return new CmllSolvedStateM(state);\n                    default: throw new Error(\"impossible\");\n                }\n            }\n            case \"misc-algs\":{\n                switch (state.name) {\n                    case \"solving\": return new CmllSolvingStateM(state);\n                    case \"solved\": return new CmllSolvedStateM(state);\n                    default: throw new Error(\"impossible\");\n                }\n            }\n            case \"4c\":\n                return new LSEStateM(state);\n            case \"eopair\":\n                return new EOLRStateM(state);\n            case \"experimental\":\n                return new FbStateM(state);\n            case \"analyzer\":\n                return new FbStateM(state)\n            case \"tracking\":\n                return new FbStateM(state)\n        }\n        ;\n    }\n\nexport { StateFactory };","import { Action } from \"./Types\";\n\nconst defaultKeyMapping : { [key: string]: string } = {\n    \"I\": \"R\",\n    \"K\": \"R'\",\n    \"W\": \"B\",\n    \"O\": \"B'\",\n    \"S\": \"D\",\n    \"L\": \"D'\",\n    \"D\": \"L\",\n    \"E\": \"L'\",\n    \"J\": \"U\",\n    \"F\": \"U'\",\n    \"H\": \"F\",\n    \"G\": \"F'\",\n    \";\": \"y\",\n    \"A\": \"y'\",\n    \"U\": \"r\",\n    \"R\": \"l'\",\n    \"M\": \"r'\",\n    \"V\": \"l\",\n    \"T\": \"x\",\n    \"Y\": \"x\",\n    \"N\": \"x'\",\n    \"B\": \"x'\",\n    \".\": \"M'\",\n    \"X\": \"M'\",\n    \"5\": \"M\",\n    \"6\": \"M\",\n    \"P\": \"z\",\n    \"Q\": \"z'\",\n    \"Z\": \"d\",\n    \"C\": \"u'\",\n    \",\": \"u\",\n    \"/\": \"d'\",\n    \"ENTER\": \"#enter\",\n    \" \": \"#space\",\n  }\n\n\nconst lseKeyMapping : { [key: string]: string } = {\n    \"I\": \"M'\",\n    \"E\": \"M'\",\n    \"K\": \"M\",\n    \"D\": \"M\",\n    \"J\": \"U\",\n    \"F\": \"U'\",\n    \"S\": \"E'\",\n    \"L\": \"E\",\n    \"ENTER\": \"#enter\",\n    \" \": \"#space\",\n};\n\n\nexport abstract class KeyMapping {\n    abstract handle(evt: KeyboardEvent, dispatch: React.Dispatch<Action>) : void;\n}\n\nexport class DefaultKeyMapping extends KeyMapping {\n    handle(evt: KeyboardEvent, dispatch: React.Dispatch<Action>) {\n        // do nothing if modifier key is pressed\n        if (evt.altKey || evt.ctrlKey || evt.metaKey) return;\n        let key = evt.key.toUpperCase();\n        if (defaultKeyMapping.hasOwnProperty(key)) {\n            dispatch({\n              type: \"key\", content: defaultKeyMapping[key]\n            });\n        }\n    }\n}\n\nexport class LSEKeyMapping {\n    handle(evt: KeyboardEvent, dispatch: React.Dispatch<Action>) {\n        // do nothing if modifier key is pressed\n        if (evt.altKey || evt.ctrlKey || evt.metaKey) return;\n        let key = evt.key.toUpperCase();\n        if (lseKeyMapping.hasOwnProperty(key)) {\n            dispatch({\n              type: \"key\", content: lseKeyMapping[key]\n            });\n        }\n    }\n}","import { AppState, StateT, Mode } from \"../Types\";\nimport { CubieCube, ColorScheme } from '../lib/CubeLib';\nimport { getConfig, getFavList } from '../lib/LocalStorage';\nimport { DefaultKeyMapping, LSEKeyMapping } from \"../KeyMapping\";\n\n\nexport const getInitialState = (mode?: Mode): AppState => {\n    mode = mode || \"fbdr\";\n    let initialStateName: StateT = function () {\n        switch (mode) {\n            case \"cmll\":\n            case \"misc-algs\":\n                return \"solved\";\n            case \"fbdr\":\n            case \"ss\":\n            case \"fb\":\n            case \"4c\":\n            case \"eopair\":\n            case \"fbss\":\n            case \"fs\":\n            case \"fsdr\":\n                return \"revealed\";\n            case \"experimental\":\n                return \"revealed\";\n            case \"analyzer\":\n            case \"tracking\":\n                return \"revealed\"\n        }\n    }();\n    let ori = getConfig().orientationSelector.getActiveName() || \"YR\";\n    return {\n        name: initialStateName,\n        mode,\n        scrambleInput: [],\n        cube: {\n            state: new CubieCube(),\n            ori,\n            history: [],\n            levelSuccess: true,\n        },\n        case: {\n            state: new CubieCube(),\n            desc: []\n        },\n        prev: null,\n        config: getConfig(),\n        favList: getFavList(),\n        keyMapping: (mode === \"4c\" || mode === \"eopair\") ? new LSEKeyMapping() : new DefaultKeyMapping(),\n        colorScheme: new ColorScheme()\n    };\n};\n","\nimport { AppState, Action, FavListAction } from \"../Types\"\nimport { Config } from '../Config';\n\nimport { setConfig, setFavList} from '../lib/LocalStorage';\nimport { StateFactory } from \"./StateFactory\";\nimport { arrayEqual } from \"../lib/Math\";\nimport { getInitialState } from \"./InitialState\";\nimport ReactGA from 'react-ga';\n\nexport { getInitialState }\nfunction reduceByFavlist(state: AppState, action: FavListAction) {\n    let favList = state.favList;\n\n    switch (action.action) {\n        case \"add\":\n            favList = [...action.content, ...favList]\n            setFavList(favList)\n            break;\n        case \"remove\": {\n        // only remove one at a time for now\n            const rem = action.content[0]\n            favList = favList.filter((value) => {\n                return !(value.mode === rem.mode && value.setup === rem.setup && arrayEqual(value.solver, rem.solver))\n            })\n            setFavList(favList)\n            break;\n        };\n        case \"replay\": {\n            return StateFactory.create(state).onReplay(action.content[0])\n        }\n    }\n    return {\n        ...state,\n        favList\n    }\n}\n\nexport function reducer(state: AppState, action: Action): AppState {\n    // todo: cache values based on this\n    // console.log(\"prev state\", state)\n    switch (action.type) {\n        case \"key\": {\n            let newState = reduceByKey(state, action.content)\n            return newState\n        };\n        case \"config\": {\n            // LESSON: Object.assign is dangerous\n            let newConfig = {...state.config, ...action.content}\n\n            // enforce constraints across selectors\n            //if (newConfig.fbPairSolvedSelector.flags[1] === 1) {\n            //    newConfig.fbdrSelector.flags = [1, 0, 0]\n            //}\n            setConfig(newConfig)\n            let newState = reduceByConfig(state, newConfig)\n            return {\n                ...newState,\n                config: newConfig\n            }\n        };\n        case \"mode\": {\n            let mode = action.content\n            if (window.location.hash !== mode) {\n                ReactGA.pageview(mode);\n            }\n            window.location.hash = mode\n            \n            state = getInitialState(mode)\n            return state\n        };\n        case \"scrambleInput\":\n            return {\n                ...state,\n                scrambleInput: action.content\n            }\n        case \"favList\":\n            return reduceByFavlist(state, action)\n        case \"colorScheme\":\n            return {\n                ...state,\n                colorScheme: state.colorScheme.set(action.content)\n            }\n        case \"custom\":\n            return action.content(state)\n        default:\n            return state\n        }\n}\n\n\nfunction reduceByKey(state: AppState, code: string): AppState {\n    if (code === \"\") return state;\n\n    const stateM = StateFactory.create(state)\n    // case match on kind of operation\n    if (code[0] === \"#\") {\n        return stateM.onControl(code)\n    } else {\n        return stateM.onMove(code)\n    }\n}\nfunction reduceByConfig(state: AppState, conf: Config): AppState {\n    const stateM = StateFactory.create(state)\n    // case match on kind of operation\n    return stateM.onConfig(conf)\n}","import React from 'react'\nimport AppView from \"../components/AppView\"\nimport { reducer } from '../reducers/Reducer'\nimport { getInitialState } from \"../reducers/InitialState\";\nimport CssBaseline from '@mui/material/CssBaseline';\nimport { ThemeProvider, Theme, StyledEngineProvider } from '@mui/material/styles';\nimport { theme, themeDark } from '../theme';\nimport \"typeface-roboto\";\nimport \"fontsource-public-sans\";\nimport { resetConfig } from '../lib/LocalStorage';\n\n\ndeclare module '@mui/styles/defaultTheme' {\n  // eslint-disable-next-line @typescript-eslint/no-empty-interface\n  interface DefaultTheme extends Theme {}\n}\n\nwindow.addEventListener('keypress', function(e) {\n  if(e.keyCode === 32 && e.target === document.body) {\n    e.preventDefault();\n  }\n  if (e.altKey && e.ctrlKey && e.key === \"r\") {\n    resetConfig()\n    console.log(\"config reset\")\n  }\n});\n\nfunction App(props: {}) {\n  const [state, dispatch] = React.useReducer( reducer, getInitialState() )\n\n  const appTheme = state.config.theme.getActiveName() === \"bright\" ? theme : themeDark\n  return (\n    <StyledEngineProvider injectFirst>\n      <ThemeProvider theme={appTheme}>\n        {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n        <CssBaseline />\n        <AppView state={state} dispatch={dispatch} />\n      </ThemeProvider>\n    </StyledEngineProvider>\n  );\n}\nexport default App","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './app/App';\nimport * as serviceWorker from './serviceWorker';\n\nimport ReactGA from 'react-ga';\n\nif (process.env.NODE_ENV === 'production') {\n  ReactGA.initialize('UA-209793005-2', );\n} else {\n  console.log(\"In dev/test mode now, won't send GA\")\n}\n\nReactDOM.render(\n    <App/>,\n    document.getElementById('root'),\n  );\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","/* eslint-disable */\nfunction createArray(length) {\n\tconst arr = Array(length);\n\tfor (var i=0; i<length; i++) {\n\t\tarr[i] = 0;\n\t}\n\treturn arr;\n}\n\nfunction createArrays(length1, length2) {\n\tconst arr = Array(length1);\n\tfor (var i=0; i<length1; i++) {\n\t\tarr[i] = Array(length2);\n\t\tfor (var j=0; j<length2; j++) {\n\t\t\tarr[i][j] = 0;\n\t\t}\n\t}\n\treturn arr;\n}\n\nfunction bitOdd(i) {\n\ti ^= i >>> 1;\n\ti ^= i >>> 2;\n\ti ^= i >>> 4;\n\ti ^= i >>> 8;\n\treturn i & 1;\n}\n\nfunction bitCount(i) {\n\ti = i - ((i >>> 1) & 0x55555555);\n\ti = (i & 0x33333333) + ((i >>> 2) & 0x33333333);\n\treturn (i + (i >>> 8) + (i >>> 4)) & 0x0f;\n}\n\nfunction get4Parity(idx) {\n\tvar p = 0;\n\tfor (var i=2; i>=0; i--) {\n\t\tp += idx % (4-i);\n\t\tidx = ~~(idx / (4-i));\n\t}\n\tp &= 1;\n\treturn p;\n}\n\nfunction get8Parity(idx) {\n\tvar p = 0;\n\tfor (var i=6; i>=0; i--) {\n\t\tp += idx % (8-i);\n\t\tidx = ~~(idx / (8-i));\n\t}\n\tp &= 1;\n\treturn p;\n}\n\nfunction get12Parity(idx) {\n\tvar p = 0;\n\tfor (var i=10; i>=0; i--) {\n\t\tp += idx % (12-i);\n\t\tidx = ~~(idx / (12-i));\n\t}\n\tp &= 1;\n\treturn p;\n}\n\n\nfunction binarySearch(arr, key) {\n\tvar length = arr.length;\n\tif (key <= arr[length-1]) {\n\t\tvar l = 0;\n\t\tvar r = length-1;\n\t\twhile (l <= r) {\n\t\t\tvar mid = (l+r)>>>1;\n\t\t\tvar val = arr[mid];\n\t\t\tif (key > val) {\n\t\t\t\tl = mid + 1;\n\t\t\t} else if (key < val) {\n\t\t\t\tr = mid - 1;\n\t\t\t} else {\n\t\t\t\treturn (mid);\n\t\t\t}\n\t\t}\n\t}\n\treturn 0xffff;\n}\n\nvar fact = [1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800, 39916800, 479001600];\nvar perm3 = [[11, 10, 9], [10, 11, 9], [11, 9, 10], [9, 11, 10], [10, 9, 11], [9, 10, 11]];\nvar ud2std = [0, 1, 2, 4, 7, 9, 10, 11, 13, 16];\nvar std2ud = createArray(18);\nvar Cnk = createArrays(12, 13);\nvar move2str = [\"U \", \"U2\", \"U'\", \"R \", \"R2\", \"R'\", \"F \", \"F2\", \"F'\", \"D \", \"D2\", \"D'\", \"L \", \"L2\", \"L'\", \"B \", \"B2\", \"B'\"];\nvar urfMove = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,13,14,15,16,17], \n\t\t\t\t\t\t\t\t\t\t\t[6, 7, 8, 0, 1, 2, 3, 4, 5,15,16,17, 9,10,11,12,13,14],\n\t\t\t\t\t\t\t\t\t\t\t[3, 4, 5, 6, 7, 8, 0, 1, 2,12,13,14,15,16,17, 9,10,11],\n\t\t\t\t\t\t\t\t\t\t\t[2, 1, 0, 5, 4, 3, 8, 7, 6,11,10, 9,14,13,12,17,16,15], \n\t\t\t\t\t\t\t\t\t\t\t[8, 7, 6, 2, 1, 0, 5, 4, 3,17,16,15,11,10, 9,14,13,12],\n\t\t\t\t\t\t\t\t\t\t\t[5, 4, 3, 8, 7, 6, 2, 1, 0,14,13,12,17,16,15,11,10, 9]];\nfor (var i=0; i<12; i++) {\n\tCnk[i][0] = 1;\n\tCnk[i][i] = 1;\n\tCnk[i][i+1] = 0;\n\tfor (var j=1; j<i; j++) {\n\t\tCnk[i][j] = (Cnk[i-1][j-1] + Cnk[i-1][j]);\n\t}\n}\nfor (var i=0; i<10; i++) {\n\tstd2ud[ud2std[i]] = i;\n}\n\nvar ckmv = Array(19);//new boolean[19][18];\nvar ckmv2 = Array(11);//new boolean[11][10];\nckmv[18] = Array(18);\nckmv2[10] = Array(10);\nfor (var i=0; i<18; i++) {\n\tckmv[i] = Array(18);\n\tfor (var j=0; j<18; j++) {\n\t\tckmv[i][j] = (~~(i/3) == ~~(j/3)) || ((~~(i/3)%3 == ~~(j/3)%3) && (i>=j));\n\t}\n\tckmv[18][i] = false;\n}\nfor (var i=0; i<10; i++) {\n\tckmv2[i] = Array(10);\n\tfor (var j=0; j<10; j++) {\n\t\tckmv2[i][j] = ckmv[ud2std[i]][ud2std[j]];\n\t}\n\tckmv2[10][i] = false;\n}\n\n\n//********************************************************************************//\n\nfunction CubieCube() {\n\tthis.cp = [0, 1, 2, 3, 4, 5, 6, 7];\n\tthis.co = [0, 0, 0, 0, 0, 0, 0, 0];\n\tthis.ep = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];\n\tthis.eo = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\tthis.getFlip = function getFlip() {\n\t\tvar idx = 0;\n\t\tfor (var i=0; i<11; i++) {\n\t\t\tidx |= this.eo[i] << i;\n\t\t}\n\t\treturn idx;\n\t}\n\t\n\tthis.getFlipSym = function getFlipSym() {\n\t\tif (FlipR2S != 0) {\n\t\t\treturn FlipR2S[this.getFlip()];\n\t\t}\n\t\tfor (var k=0; k<16; k+=2) {\n\t\t\tEdgeConjugate(this, SymInv[k], temps);\n\t\t\tvar idx = binarySearch(FlipS2R, temps.getFlip());\n\t\t\tif (idx != 0xffff) {\n\t\t\t\treturn ((idx << 3) | (k >>> 1));\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tthis.setFlip = function setFlip(idx) {\n\t\tthis.eo[11] = bitOdd(idx);\n\t\tfor (var i=0; i<11; i++) {\n\t\t\tthis.eo[i] = idx & 1;\n\t\t\tidx >>>= 1;\n\t\t}\n\t}\n\t\n\tthis.getTwist = function getTwist() {\n\t\tvar idx = 0;\n\t\tfor (var i=0; i<7; i++) {\n\t\t\tidx *= 3;\n\t\t\tidx += this.co[i];\n\t\t}\n\t\treturn idx;\n\t}\n\t\n\tthis.getTwistSym = function getTwistSym() {\n\t\tif (TwistR2S != null) {\n\t\t\treturn TwistR2S[this.getTwist()];\n\t\t}\n\t\tfor (var k=0; k<16; k+=2) {\n\t\t\tCornConjugate(this, SymInv[k], temps);\n\t\t\tlet idx = binarySearch(TwistS2R, temps.getTwist());\n\t\t\tif (idx != 0xffff) {\n\t\t\t\treturn ((idx << 3) | (k >>> 1));\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\n\tthis.setTwist = function setTwist(idx) {\n\t\tvar twst = 0;\n\t\tfor (var i=6; i>=0; i--) {\n\t\t\ttwst += this.co[i] = idx % 3;\n\t\t\tidx = ~~(idx/3);\n\t\t}\n\t\tthis.co[7] = (15 - twst) % 3;\n\t}\n\t\n\tthis.getUDSlice = function getUDSlice() {\n\t\tvar idx = 0;\n\t\tvar r = 4;\n\t\tfor (var i=0; i<12; i++) {\n\t\t\tif (this.ep[i] >= 8) {\n\t\t\t\tidx += Cnk[11-i][r];\n\t\t\t\tr--;\n\t\t\t}\n\t\t}\n\t\treturn idx;\n\t}\n\n\tthis.setUDSlice = function setUDSlice(idx) {\n\t\tvar r = 4;\n\t\tfor (var i=0; i<12; i++) {\n\t\t\tif (idx >= Cnk[11-i][r]) {\n\t\t\t\tidx -= Cnk[11-i][r];\n\t\t\t\tr--;\n\t\t\t\tthis.ep[i] = (11-r);\n\t\t\t} else {\n\t\t\t\tthis.ep[i] = (i+r-4);\n\t\t\t}\n\t\t}\n\t}\n\tthis.getMPerm = function getMPerm() {\n\t\tvar m = (1 << this.ep[11]);\t\t\n\t\tvar idx = 0;\n\t\tfor (var i=10; i>=8; --i) {\n\t\t\tvar t = 1 << this.ep[i];\n\t\t\tidx += bitCount(m & (t - 1)) * fact[11-i];\n\t\t\tm |= t;\n\t\t}\n\t\treturn idx;\n\t}\t\n\tthis.setMPerm = function setMPerm(idx) {\n\t\tthis.ep[11] = 8;\n\t\tfor (var i=10; i>=8; i--) {\n\t\t\tthis.ep[i] = (idx % (12-i) + 8);\n\t\t\tidx = ~~(idx / (12-i));\n\t\t\tfor (var j=i+1; j<12; j++) {\n\t\t\t\tif (this.ep[j] >= this.ep[i])\n\t\t\t\t\tthis.ep[j]++;\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\tthis.getMid3 = function getMid3() {\n\t\tvar idxA = 0;\n\t\tvar idxB = 0;\n\t\tvar mask = 0;\n\t\tvar r = 3;\n\t\tfor (var i=11; i>=0; i--) {\n\t\t\tif (this.ep[i] >= 9) {\n\t\t\t\tidxA += Cnk[i][r--];\n\t\t\t\tvar t = 1 << this.ep[i];\n\t\t\t\tidxB += bitCount(mask & (t - 1)) * fact[2-r];\n\t\t\t\tmask |= t;\n\t\t\t}\n\t\t}\n\t\treturn (idxA * 6 + idxB);\n\t}\n\t\n\tthis.setMid3 = function setMid3(idxA) {\n\t\tvar edge = perm3[idxA % 6];\n\t\tidxA = ~~(idxA / 6);\n\t\tvar r = 3;\n\t\tfor (var i=11; i>=0; i--) {\n\t\t\tif (idxA >= Cnk[i][r]) {\n\t\t\t\tidxA -= Cnk[i][r--];\n\t\t\t\tthis.ep[i] = edge[2-r];\n\t\t\t} else {\n\t\t\t\tthis.ep[i] = (8-i+r);\n\t\t\t}\n\t\t}\t\n\t}\n\t\n\tthis.getURtoUL = function getURtoUL() {\n\t\tvar idxA = 0;\n\t\tvar idxB = 0;\n\t\tvar mask = 0;\n\t\tvar r = 3;\n\t\tfor (var i=11; i>=0; i--) {\n\t\t\tif (this.ep[i] <= 2) {\n\t\t\t\tidxA += Cnk[i][r--];\n\t\t\t\tvar t = 1 << this.ep[i];\n\t\t\t\tidxB += bitCount(mask & (t - 1)) * fact[2-r];\n\t\t\t\tmask |= t;\n\t\t\t}\n\t\t}\n\t\treturn (idxA * 6 + idxB);\t\n\t}\n\n\tthis.getDRtoDL = function getDRtoDL() {\n\t\tvar idxA = 0;\n\t\tvar idxB = 0;\n\t\tvar mask = 0;\n\t\tvar r = 3;\n\t\tfor (var i=11; i>=0; i--) {\n\t\t\tif (4 <= this.ep[i] && this.ep[i] <= 6) {\n\t\t\t\tidxA += Cnk[i][r--];\n\t\t\t\tvar t = 1 << this.ep[i];\n\t\t\t\tidxB += bitCount(mask & (t - 1)) * fact[2-r];\n\t\t\t\tmask |= t;\n\t\t\t}\n\t\t}\n\t\treturn (idxA * 6 + idxB);\t\n\t}\t\n\n\tthis.setEdgePerm = function setEdgePerm(idx) {\n\t\tthis.ep[11] = 0;\n\t\tfor (var i=10; i>=0; i--) {\n\t\t\tthis.ep[i] = (idx % (12-i));\n\t\t\tidx = ~~(idx/(12-i));\n\t\t\tfor (var j=i+1; j<12; j++) {\n\t\t\t\tif (this.ep[j] >= this.ep[i])\n\t\t\t\t\tthis.ep[j]++;\n\t\t\t}\n\t\t}\t\t\t\n\t}\n\t\n\tthis.getEdgePerm = function getEdgePerm() {\n\t\tvar m = (1 << this.ep[11]);\t\t\n\t\tvar idx = 0;\n\t\tfor (var i=10; i>=0; --i) {\n\t\t\tvar t = 1 << this.ep[i];\n\t\t\tidx += bitCount(m & (t - 1)) * fact[11-i];\n\t\t\tm |= t;\n\t\t}\n\t\treturn idx;\t\t\n\t}\n\n\tthis.getCPermSym = function getCPermSym() {\n\t\tif (EPermR2S != null) {\n\t\t\tvar idx = EPermR2S[get8Perm(this.cp)];\n\t\t\tidx ^= e2c[idx&0x0f];\n\t\t\treturn idx;\n\t\t}\n\t\tfor (var k=0; k<16; k++) {\n\t\t\tCornConjugate(this, SymInv[k], temps);\n\t\t\tvar idx = binarySearch(CPermS2R, get8Perm(temps.cp));\n\t\t\tif (idx != 0xffff) {\n\t\t\t\treturn ((idx << 4) | k);\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\t\n\tthis.getEPermSym = function getEPermSym() {\t\n\t\tif (EPermR2S != null) {\n\t\t\treturn EPermR2S[get8Perm(this.ep)];\n\t\t}\n\t\tfor (var k=0; k<16; k++) {\n\t\t\tEdgeConjugate(this, SymInv[k], temps);\n\t\t\tvar idx = binarySearch(EPermS2R, get8Perm(temps.ep));\n\t\t\tif (idx != 0xffff) {\n\t\t\t\treturn ((idx << 4) | k);\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\t\n\n\tthis.URFConjugate = function URFConjugate() {\n\t\tCornMult(urf2, this, temps);\n\t\tCornMult(temps, urf1, this);\t\t\n\t\tEdgeMult(urf2, this, temps);\n\t\tEdgeMult(temps, urf1, this);\t\t    \t\t\n\t}\n\t\n\tthis.invCubieCube = function invCubieCube() {\n\t\tfor (var edge=0; edge<12; edge++)\n\t\t\ttemps.ep[this.ep[edge]] = edge;\n\t\tfor (var edge=0; edge<12; edge++)\n\t\t\ttemps.eo[edge] = this.eo[temps.ep[edge]];\n\t\tfor (var corn=0; corn<8; corn++)\n\t\t\ttemps.cp[this.cp[corn]] = corn;\n\t\tfor (var corn=0; corn<8; corn++) {\n\t\t\tvar ori = this.co[temps.cp[corn]];\n\t\t\ttemps.co[corn] = -ori;\n\t\t\tif (temps.co[corn] < 0)\n\t\t\t\ttemps.co[corn] += 3;\n\t\t}\n\t\tthis.copy(temps);\n\t}\n\n\n\tthis.init = function init(cperm, twist, eperm, flip) {\n\t\tset8Perm(this.cp, cperm);\n\t\tthis.setTwist(twist);\n\t\tthis.setEdgePerm(eperm);\n\t\tthis.setFlip(flip);\n\t}\n\t\n\tthis.copy = function copy(c) {\n\t\tfor (var i=0; i<8; i++) {\n\t\t\tthis.cp[i] = c.cp[i];\n\t\t\tthis.co[i] = c.co[i];\n\t\t}\n\t\tfor (var i = 0; i < 12; i++) {\n\t\t\tthis.ep[i] = c.ep[i];\n\t\t\tthis.eo[i] = c.eo[i];\n\t\t}\n\t}\n}\n\nconst cctemp = new CubieCube();\nconst temps = new CubieCube();\n\nfunction set8Perm(arr, idx) {\n\tvar val = 0x76543210;\n\tfor (var i=0; i<7; i++) {\n\t\tvar p = fact[7-i];\n\t\tvar v = ~~(idx / p);\n\t\tidx %= p;\n\t\tv <<= 2;\n\t\tarr[i] = ((val >> v) & 7);\n\t\tvar m = (1 << v) - 1;\n\t\tval = (val & m) + ((val >> 4) & ~m);\n\t}\n\tarr[7] = val;\n}\n\nfunction get8Perm(arr) {\n\tvar idx = 0;\n\tvar val = 0x76543210;\n\tfor (var i=0; i<7; i++) {\n\t\tvar v = arr[i] << 2;\n\t\tidx = (8 - i) * idx + ((val >> v) & 7);\n\t\tval -= 0x11111110 << v;\n\t}\n\treturn idx;\t\n}\n\nfunction CornMult(a, b, prod) {\n\tfor (var corn=0; corn<8; corn++) {\n\t\tprod.cp[corn] = a.cp[b.cp[corn]];\n\t\tvar oriA = a.co[b.cp[corn]];\n\t\tvar oriB = b.co[corn];\n\t\tvar ori = oriA;\n\t\tori += (oriA<3) ? oriB : 3-oriB;\n\t\tori %= 3;\n\t\tif (oriA < 3 ^ oriB < 3) {\n\t\t\tori += 3;\n\t\t}\n\t\tprod.co[corn] = ori;\n\t}\n}\t\n\nfunction EdgeMult(a, b, prod) {\n\tfor (var ed=0; ed<12; ed++) {\n\t\tprod.ep[ed] = a.ep[b.ep[ed]];\n\t\tprod.eo[ed] = (b.eo[ed] ^ a.eo[b.ep[ed]]);\n\t}\n}\n\nfunction CornConjugate(a, idx, b) {\n\tCornMult(CubeSym[SymInv[idx]], a, cctemp);\n\tCornMult(cctemp, CubeSym[idx], b);\t\t\n}\n\nfunction EdgeConjugate(a, idx, b) {\n\tEdgeMult(CubeSym[SymInv[idx]], a, cctemp);\n\tEdgeMult(cctemp, CubeSym[idx], b);\t\t\n}\n\nvar CubeSym = Array(16);\nvar moveCube = Array(18);\nvar SymInv = Array(16);\nvar SymMult = Array(16);\nvar SymMove = Array(16);\nvar Sym8Mult = Array(8);\nvar Sym8Move = Array(8);\nvar Sym8MultInv = Array(8);\nvar SymMoveUD = Array(16);\nvar FlipS2R = Array(336);\nvar TwistS2R = Array(324);\nvar CPermS2R = Array(2768);\nvar EPermS2R = CPermS2R;\nvar FlipR2S = Array(2048);\nvar TwistR2S = Array(2187);\nvar EPermR2S = createArray(40320);\nfor (var i=0; i<40320; i++) {\n\tEPermR2S[i] = 0;\n}\nvar MtoEPerm = Array(40320);\nvar merge = Array(56);\nvar e2c = [0, 0, 0, 0, 1, 3, 1, 3, 1, 3, 1, 3, 0, 0, 0, 0];\nconst urf1 = new CubieCube();\nurf1.init(2531, 1373, 67026819, 1877);\nconst urf2 = new CubieCube();\nurf2.init(2089, 1906, 322752913, 255);\n\n\nfunction CubieInit() {\n\tvar mc = Array(6);\n\tmc[0] = new CubieCube();\n\tmc[0].init(15120, 0, 119750400, 0);\n\tmc[1] = new CubieCube();\n\tmc[1].init(21021, 1494, 323403417, 0);\n\tmc[2] = new CubieCube();\n\tmc[2].init(8064, 1236, 29441808, 802);\n\tmc[3] = new CubieCube();\n\tmc[3].init(9, 0, 5880, 0);\n\tmc[4] = new CubieCube();\n\tmc[4].init(1230, 412, 2949660, 0);\n\tmc[5] = new CubieCube();\n\tmc[5].init(224, 137, 328552, 1160);\n\tfor (var m=0; m<6; m++) {\n\t\tmoveCube[m*3] = mc[m];\n\t\tfor (var p=0; p<2; p++) {\n\t\t\tmoveCube[m*3+p+1] = new CubieCube();\n\t\t\tEdgeMult(moveCube[m*3+p], mc[m], moveCube[m*3+p+1]);\n\t\t\tCornMult(moveCube[m*3+p], mc[m], moveCube[m*3+p+1]);\n\t\t}\n\t}\n\tvar c = new CubieCube();\n\tvar d = new CubieCube();\n\tvar temp;\n\tvar f2 = new CubieCube();\n\tf2.init(28783, 0, 259268407, 0);\n\tvar u4 = new CubieCube();\n\tu4.init(15138, 0, 119765538, 1792);\n\tvar lr2 = new CubieCube();\n\tlr2.init(5167, 0, 83473207, 0);\n\tlr2.co = [ 3, 3, 3, 3, 3, 3, 3, 3 ];\n\tfor (var i=0; i<16; i++) {\n\t\tSymMult[i] = Array(16);\n\t\tSymMove[i] = Array(18);\n\t\tSymMoveUD[i] = Array(10);\n\t\tCubeSym[i] = new CubieCube();\n\t\tCubeSym[i].copy(c);\n\t\tCornMult(c, u4, d);\n\t\tEdgeMult(c, u4, d);\n\t\ttemp = d;\td = c;\tc = temp;\n\t\tif (i % 4 == 3) {\n\t\t\tCornMult(c, lr2, d);\n\t\t\tEdgeMult(c, lr2, d);\n\t\t\ttemp = d;\td = c;\tc = temp;\t\t\t\t\n\t\t}\n\t\tif (i % 8 == 7) {\n\t\t\tCornMult(c, f2, d);\n\t\t\tEdgeMult(c, f2, d);\n\t\t\ttemp = d;\td = c;\tc = temp;\n\t\t}\n\t}\n\n\tfor (var j=0; j<16; j++) {\n\t\tfor (var k=0; k<16; k++) {\n\t\t\tCornMult(CubeSym[j], CubeSym[k], c);\n\t\t\tif (c.cp[0] == 0 && c.cp[1] == 1 && c.cp[2] == 2) {\n\t\t\t\tSymInv[j] = k;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor (var i=0; i<16; i++) {\n\t\tfor (var j=0; j<16; j++) {\n\t\t\tCornMult(CubeSym[i], CubeSym[j], c);\n\t\t\tfor (var k=0; k<16; k++) {\n\t\t\t\tif (CubeSym[k].cp[0] == c.cp[0] && CubeSym[k].cp[1] == c.cp[1] && CubeSym[k].cp[2] == c.cp[2]) {\n\t\t\t\t\tSymMult[i][j] = k;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (var j=0; j<18; j++) {\n\t\tfor (var s=0; s<16; s++) {\n\t\t\tCornConjugate(moveCube[j], SymInv[s], c);\n\t\t\tfor (var m=0; m<18; m++) {\n\t\t\t\tvar found = 1;\n\t\t\t\tfor (var i=0; i<8; i++) {\n\t\t\t\t\tif (c.cp[i] != moveCube[m].cp[i] || c.co[i] != moveCube[m].co[i]) {\n\t\t\t\t\t\tfound = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (found) {\n\t\t\t\t\tSymMove[s][j] = m;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (var j=0; j<10; j++) {\n\t\tfor (var s=0; s<16; s++) {\n\t\t\tSymMoveUD[s][j] = std2ud[SymMove[s][ud2std[j]]];\n\t\t}\n\t}\n\tfor (var j=0; j<8; j++) {\n\t\tSym8Mult[j] = Array(8);\n\t\tSym8Move[j] = Array(18);\n\t\tSym8MultInv[j] = Array(8);\n\t\tfor (var s=0; s<8; s++) {\n\t\t\tSym8Mult[j][s] = (SymMult[j<<1][s<<1]>>>1);\n\t\t}\n\t}\n\tfor (var j=0; j<18; j++) {\n\t\tfor (var s=0; s<8; s++) {\n\t\t\tSym8Move[s][j] = SymMove[s<<1][j];\n\t\t}\n\t}\n\tfor (var j=0; j<8; j++) {\n\t\tfor (var s=0; s<8; s++) {\n\t\t\tSym8MultInv[j][s] = Sym8Mult[j][SymInv[s<<1]>>1];\n\t\t}\n\t}\n\n\tconst occ = new Array(1260);\n\n\tvar count = 0;\n\tfor (var i=0; i<64; occ[i++] = 0);\n\n\tfor (var i=0; i<2048; i++) {\n\t\tif ((occ[i>>>5]&(1<<(i&0x1f))) == 0) {\n\t\t\tc.setFlip(i);\n\t\t\tfor (var s=0; s<16; s+=2) {\n\t\t\t\tEdgeConjugate(c, s, d);\n\t\t\t\tvar idx = d.getFlip();\n\t\t\t\tocc[idx>>>5] |= 1<<(idx&0x1f);\n\t\t\t\tFlipR2S[idx] = ((count << 3) | (s >>> 1));\n\t\t\t}\n\t\t\tFlipS2R[count++] = i;\n\t\t}\n\t}\n//\talert(count);\n\tcount = 0;\n\tfor (var i=0; i<69; occ[i++] = 0);\n\tfor (var i=0; i<2187; i++) {\n\t\tif ((occ[i>>>5]&(1<<(i&0x1f))) == 0) {\n\t\t\tc.setTwist(i);\n\t\t\tfor (var s=0; s<16; s+=2) {\n\t\t\t\tCornConjugate(c, s, d);\n\t\t\t\tvar idx = d.getTwist();\n\t\t\t\tocc[idx>>>5] |= 1<<(idx&0x1f);\n\t\t\t\tTwistR2S[idx] =  ((count << 3) | (s >>> 1));\n\t\t\t}\n\t\t\tTwistS2R[count++] = i;\n\t\t}\n\t}\n//\talert(count);\n\n\tvar mask = Array(56);\n\tfor (var i=0; i<56; i++) {\n\t\tmask[i] = Array(2);\n\t\tmerge[i] = Array(56);\n\t}\n\tfor (var i=0; i<40320; i++) {\n\t\tset8Perm(c.ep, i);\n\t\tvar a = ~~(c.getURtoUL() / 6);\n\t\tvar b = ~~(c.getDRtoDL() / 6);\n\t\tmask[a][b>>>5] |= 1 << (b&0x1f);\n\t}\n\t\n\tfor (var i=0; i<56; i++) {\n\t\tcount = 0;\n\t\tfor (var j=0; j<56; j++) {\n\t\t\tif ((mask[i][j>>>5]&(1<<(j&0x1f))) != 0) {\n\t\t\t\tmerge[i][j] = count++;\n\t\t\t}\n\t\t}\n\t}\n\tcount = 0;\n\tfor (var i=0; i<1260; occ[i++] = 0);\n\tfor (var i=0; i<40320; i++) {\n\t\tif ((occ[i>>>5]&(1<<(i&0x1f))) == 0) {\n\t\t\tset8Perm(c.ep, i);\n\t\t\tfor (var s=0; s<16; s++) {\n\t\t\t\tEdgeConjugate(c, s, d);\n\t\t\t\tvar idx = get8Perm(d.ep);\n\t\t\t\tocc[idx>>>5] |= 1<<(idx&0x1f);\n\t\t\t\tvar a = d.getURtoUL();\n\t\t\t\tvar b = d.getDRtoDL();\n\t\t\t\tvar m = (merge[~~(a/6)][~~(b/6)] * 4032 + a * 12 + b % 6 * 2 + get8Parity(idx));\n\t\t\t\tMtoEPerm[m] = (count << 4 | s);\n\t\t\t\tEPermR2S[idx] = (count << 4 | s);\n\t\t\t}\n\t\t\tEPermS2R[count++] = i;\n\t\t}\n\t}\n}\n\nvar UDSliceMove = Array(495);//new char[495][18];\nvar TwistMove = Array(324);//new char[324][18];\nvar FlipMove = Array(336);//new char[336][18];\nvar UDSliceConj = Array(495);//new char[495][8];\nvar UDSliceTwistPrun = Array(495*324);//new byte[495 * 324];\nvar UDSliceFlipPrun = Array(495*336);//new byte[495 * 336];\n\t\nvar TwistFlipPrun = Array(336*324*8);//new byte[336 * 324 * 8];\n\t\n\t//phase1to2\nvar Mid3Move = Array(1320);//new char[1320][18];\nvar Mid32MPerm = Array(24);//new byte[24];\nvar CParity = Array(87);//new byte[2768/8];\n\n\t//phase2\nvar CPermMove = Array(2768);//new char[2768][18];\nvar EPermMove = Array(2768);//new char[2768][10];\nvar MPermMove = Array(24);//new byte[24][10];\nvar MPermConj = Array(24);//new byte[24][16];\nvar MCPermPrun = Array(24*2768);//new byte[24*2768];\nvar MEPermPrun = Array(24*2768);//new byte[24*2768];\n\n\nfunction CoordInit() {\n\tvar c = new CubieCube();\n\tvar d = new CubieCube();\n\tvar i, j;\n\tfor (i=0; i<2768; i++) {\n\t\tCPermMove[i] = Array(18);\n\t\tset8Perm(c.cp, CPermS2R[i]);\n\t\tfor (j=0; j<18; j++) {\n\t\t\tCornMult(c, moveCube[j], d);\n\t\t\tCPermMove[i][j] = d.getCPermSym();\n\t\t}\n\t}\t\t\n\tfor (i=0; i<2768; i++) {\n\t\tEPermMove[i] = Array(10);\n\t\tset8Perm(c.ep, EPermS2R[i]);\n\t\tfor (j=0; j<10; j++) {\n\t\t\tEdgeMult(c, moveCube[ud2std[j]], d);\n\t\t\tEPermMove[i][j] = d.getEPermSym();\n\t\t}\n\t}\n\tfor (i=0; i<336; i++) {\n\t\tFlipMove[i] = Array(18);\n\t\tc.setFlip(FlipS2R[i]);\n\t\tfor (j=0; j<18; j++) {\n\t\t\tEdgeMult(c, moveCube[j], d);\n\t\t\tFlipMove[i][j] = d.getFlipSym();\n\t\t}\n\t}\n\tfor (i=0; i<324; i++) {\n\t\tTwistMove[i] = Array(18);\n\t\tc.setTwist(TwistS2R[i]);\n\t\tfor (j=0; j<18; j++) {\n\t\t\tCornMult(c, moveCube[j], d);\n\t\t\tTwistMove[i][j] = d.getTwistSym();\n\t\t}\n\t}\n\tfor (i=0; i<495; i++) {\n\t\tUDSliceMove[i] = Array(18);\n\t\tc.setUDSlice(i);\n\t\tfor (j=0; j<18; j++) {\n\t\t\tEdgeMult(c, moveCube[j], d);\n\t\t\tUDSliceMove[i][j] = d.getUDSlice();\n\t\t}\n\t}\n\tfor (i=0; i<495; i++) {\n\t\tUDSliceConj[i] = Array(8);\n\t\tc.setUDSlice(i);\n\t\tfor (j=0; j<16; j+=2) {\n\t\t\tEdgeConjugate(c, SymInv[j], d);\n\t\t\tUDSliceConj[i][j>>>1] = d.getUDSlice();\n\t\t}\n\t}\n\tfor (i=0; i<1320; i++) {\n\t\tMid3Move[i] = Array(18);\n\t\tc.setMid3(i);\n\t\tfor (j=0; j<18; j++) {\n\t\t\tEdgeMult(c, moveCube[j], d);\n\t\t\tMid3Move[i][j] = d.getMid3();\n\t\t}\n\t}\t\n\tfor (i=0; i<24; i++) {\n\t\tc.setMPerm(i);\n\t\tMid32MPerm[c.getMid3() % 24] = i;\n\t}\n\tfor (i=0; i<2768; i++) {\n\t\tCParity[i>>>3] |= (get8Parity(CPermS2R[i])) << (i & 7);\n\t}\n\tfor (i=0; i<24; i++) {\n\t\tMPermMove[i] = Array(10);\n\t\tc.setMPerm(i);\n\t\tfor (j=0; j<10; j++) {\n\t\t\tEdgeMult(c, moveCube[ud2std[j]], d);\n\t\t\tMPermMove[i][j] = d.getMPerm();\n\t\t}\n\t}\t\t\n\tfor (i=0; i<24; i++) {\n\t\tMPermConj[i] = Array(16);\n\t\tc.setMPerm(i);\n\t\tfor (j=0; j<16; j++) {\n\t\t\tEdgeConjugate(c, SymInv[j], d);\n\t\t\tMPermConj[i][j] = d.getMPerm();\n\t\t}\n\t}\n\t\n\tvar SymState = Array(324);\n\tfor (i=0; i<324; i++) {\n\t\tc.setTwist(TwistS2R[i]);\n\t\tfor (var j=0; j<8; j++) {\n\t\t\tCornConjugate(c, j<<1, d);\n\t\t\tif (binarySearch(TwistS2R, d.getTwist()) != 0xffff) {\n\t\t\t\tSymState[i] |= (1 << j);\n\t\t\t}\n\t\t}\n\t}\n\tvar SymStateF = Array(324);\n\tfor (i=0; i<336; i++) {\n\t\tc.setFlip(FlipS2R[i]);\n\t\tfor (var j=0; j<8; j++) {\n\t\t\tEdgeConjugate(c, j<<1, d);\n\t\t\tif (binarySearch(FlipS2R, d.getFlip()) != 0xffff) {\n\t\t\t\tSymStateF[i] |= (1 << j);\n\t\t\t}\n\t\t}\n\t}\t\t\n\tfor (i=0; i<336*324*8; i++) {\n\t\tTwistFlipPrun[i] = -1;\n\t}\n\tfor (i=0; i<8; i++) {\n\t\tTwistFlipPrun[i] = 0;\n\t}\n\tvar depth = 0;\n\tvar done = 8;\n\tvar inv;\n\tvar select;\n\tvar check;\n\t\n\twhile (done < 336*324*8) {\n\t\tinv = depth > 6;\n\t\tselect = inv ? -1 : depth;\n\t\tcheck = inv ? depth : -1;\n\t\tdepth++;\n\t\tfor (i=0; i<336*324*8; i++) {\n\t\t\tif (TwistFlipPrun[i] != select)\n\t\t\t\tcontinue;\n\t\t\tvar twist = ~~(i / 2688);\n\t\t\tvar flip = i % 2688;\n\t\t\tvar fsym = i & 7;\n\t\t\tflip >>>= 3;\n\t\t\tfor (var m=0; m<18; m++) {\n\t\t\t\tvar twistx = TwistMove[twist][m];\n\t\t\t\tvar tsymx = twistx & 7;\n\t\t\t\ttwistx >>>= 3;\n\t\t\t\tvar flipx = FlipMove[flip][Sym8Move[fsym][m]];\n\t\t\t\tvar fsymx = Sym8MultInv[Sym8Mult[flipx & 7][fsym]][tsymx];\n\t\t\t\tflipx >>>= 3;\n\t\t\t\tvar idx = twistx * 2688 + (flipx << 3 | fsymx);\n\t\t\t\tif (TwistFlipPrun[idx] == check) {\n\t\t\t\t\tdone++;\n\t\t\t\t\tif (inv) {\n\t\t\t\t\t\tTwistFlipPrun[i] = depth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tTwistFlipPrun[idx] = depth;\n\t\t\t\t\t\tvar sym = SymState[twistx];\n\t\t\t\t\t\tvar symF = SymStateF[flipx];\n\t\t\t\t\t\tif (sym != 1 || symF != 1) {\n\t\t\t\t\t\t\tfor (var j=0; j<8; j++, symF >>= 1) {\n\t\t\t\t\t\t\t\tif ((symF & 1) == 1) {\n\t\t\t\t\t\t\t\t\tvar fsymxx = Sym8MultInv[fsymx][j];\n\t\t\t\t\t\t\t\t\tfor (var k=0; k<8; k++) {\n\t\t\t\t\t\t\t\t\t\tif ((sym & (1 << k)) != 0) {\n\t\t\t\t\t\t\t\t\t\t\tvar idxx = twistx * 2688 + (flipx << 3 | Sym8MultInv[fsymxx][k]);\n\t\t\t\t\t\t\t\t\t\t\tif (TwistFlipPrun[idxx] == -1) {\n\t\t\t\t\t\t\t\t\t\t\t\tTwistFlipPrun[idxx] = depth;\n\t\t\t\t\t\t\t\t\t\t\t\tdone++;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n//\t\t\tSystem.out.println(String.format(\"%2d%10d\", depth, done));\n\t}\n\tfor (i=0; i<495*324; i++) {\n\t\tUDSliceTwistPrun[i] = -1;\n\t}\n\tUDSliceTwistPrun[0] = 0;\n\tdepth = 0;\n\tdone = 1;\n\twhile (done < 495 * 324) {\n\t\tinv = depth > 6;\n\t\tselect = inv ? -1 : depth;\n\t\tcheck = inv ? depth : -1;\n\t\tdepth++;\n\t\tfor (i=0; i<495*324; i++) {\n\t\t\tif (UDSliceTwistPrun[i] == select) {\n\t\t\t\tvar slice = i % 495;\n\t\t\t\tvar twist = ~~(i / 495);\n\t\t\t\tfor (var m=0; m<18; m++) {\n\t\t\t\t\tvar twistx = TwistMove[twist][m];\n\t\t\t\t\tvar symx = twistx & 7;\n\t\t\t\t\tvar slicex = UDSliceConj[UDSliceMove[slice][m]][symx];\n\t\t\t\t\ttwistx >>>= 3;\n\t\t\t\t\tvar idx = twistx * 495 + slicex;\n\t\t\t\t\tif (UDSliceTwistPrun[idx] == check) {\n\t\t\t\t\t\tdone++;\n\t\t\t\t\t\tif (inv) {\n\t\t\t\t\t\t\tUDSliceTwistPrun[i] = depth;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tUDSliceTwistPrun[idx] = depth;\n\t\t\t\t\t\t\tvar sym = SymState[twistx];\n\t\t\t\t\t\t\tif (sym != 1) {\n\t\t\t\t\t\t\t\tfor (var j=1; j<8; j++) {\n\t\t\t\t\t\t\t\t\tsym >>= 1;\n\t\t\t\t\t\t\t\t\tif ((sym & 1) == 1) {\n\t\t\t\t\t\t\t\t\t\tvar idxx = twistx * 495 + UDSliceConj[slicex][j];\n\t\t\t\t\t\t\t\t\t\tif (UDSliceTwistPrun[idxx] == -1) {\n\t\t\t\t\t\t\t\t\t\t\tUDSliceTwistPrun[idxx] = depth;\n\t\t\t\t\t\t\t\t\t\t\tdone++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n//\t\t\tSystem.out.println(String.format(\"%2d%10d\", depth, done));\n\t}\t\t\n\n\tfor (i=0; i<495*336; i++) {\n\t\tUDSliceFlipPrun[i] = -1;\n\t}\n\tUDSliceFlipPrun[0] = 0;\n\tdepth = 0;\n\tdone = 1;\n\twhile (done < 495 * 336) {\n\t\tinv = depth > 6;\n\t\tselect = inv ? -1 : depth;\n\t\tcheck = inv ? depth : -1;\n\t\tdepth++;\n\t\tfor (i=0; i<495*336; i++) {\n\t\t\tif (UDSliceFlipPrun[i] == select) {\n\t\t\t\tvar slice = i % 495;\n\t\t\t\tvar flip = ~~(i / 495);\n\t\t\t\tfor (var m=0; m<18; m++) {\n\t\t\t\t\tvar flipx = FlipMove[flip][m];\n\t\t\t\t\tvar symx = flipx & 7;\n\t\t\t\t\tvar slicex = UDSliceConj[UDSliceMove[slice][m]][symx];\n\t\t\t\t\tflipx >>>= 3;\n\t\t\t\t\tvar idx = flipx * 495 + slicex;\n\t\t\t\t\tif (UDSliceFlipPrun[idx] == check) {\n\t\t\t\t\t\tdone++;\n\t\t\t\t\t\tif (inv) {\n\t\t\t\t\t\t\tUDSliceFlipPrun[i] = depth;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tUDSliceFlipPrun[idx] = depth;\n\t\t\t\t\t\t\tvar sym = SymStateF[flipx];\n\t\t\t\t\t\t\tif (sym != 1) {\n\t\t\t\t\t\t\t\tfor (var j=1; j<8; j++) {\n\t\t\t\t\t\t\t\t\tsym >>= 1;\n\t\t\t\t\t\t\t\t\tif ((sym & 1) == 1) {\n\t\t\t\t\t\t\t\t\t\tvar idxx = flipx * 495 + UDSliceConj[slicex][j];\n\t\t\t\t\t\t\t\t\t\tif (UDSliceFlipPrun[idxx] == -1) {\n\t\t\t\t\t\t\t\t\t\t\tUDSliceFlipPrun[idxx] = depth;\n\t\t\t\t\t\t\t\t\t\t\tdone++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n//\t\t\tdepth++;\n//\t\t\tSystem.out.println(String.format(\"%2d%10d\", depth, done));\n\t}\t\n\t\n\tSymState = Array(2768);\n\tfor (i=0; i<2768; i++) {\n\t\tset8Perm(c.ep, EPermS2R[i]);\n\t\tfor (j=1; j<16; j++) {\n\t\t\tEdgeConjugate(c, j, d);\n\t\t\tif (binarySearch(EPermS2R, get8Perm(d.ep)) != 0xffff) {\n\t\t\t\tSymState[i] |= (1 << j);\n\t\t\t}\n\t\t}\n\t}\n\tfor (i=0; i<24*2768; i++) {\n\t\tMEPermPrun[i] = -1;\n\t}\n\tMEPermPrun[0] = 0;\n\twhile (done < 24*2768) {\n\t\tinv = depth > 7;\n\t\tselect = inv ? -1 : depth;\n\t\tcheck = inv ? depth : -1;\n\t\tdepth++;\n\t\tfor (i=0; i<24*2768; i++) {\n\t\t\tif (MEPermPrun[i] == select) {\n\t\t\t\tvar mid = i % 24;\n\t\t\t\tvar edge = ~~(i / 24);\n\t\t\t\tfor (var m=0; m<10; m++) {\n\t\t\t\t\tvar edgex = EPermMove[edge][m];\n\t\t\t\t\tvar symx = edgex & 15;\n\t\t\t\t\tvar midx = MPermConj[MPermMove[mid][m]][symx];\n\t\t\t\t\tedgex >>>= 4;\n\t\t\t\t\tvar idx = edgex * 24 + midx;\n\t\t\t\t\tif (MEPermPrun[idx] == check) {\n\t\t\t\t\t\tdone++;\n\t\t\t\t\t\tif (inv) {\n\t\t\t\t\t\t\tMEPermPrun[i] = depth;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMEPermPrun[idx] = depth;\n\t\t\t\t\t\t\tvar sym = SymState[edgex];\n\t\t\t\t\t\t\tif (sym != 0) {\n\t\t\t\t\t\t\t\tfor (j=1; j<16; j++) {\n\t\t\t\t\t\t\t\t\tsym >>= 1;\n\t\t\t\t\t\t\t\t\tif ((sym & 1) == 1) {\n\t\t\t\t\t\t\t\t\t\tvar idxx = edgex * 24 + MPermConj[midx][j];\n\t\t\t\t\t\t\t\t\t\tif (MEPermPrun[idxx] == -1) {\n\t\t\t\t\t\t\t\t\t\t\tMEPermPrun[idxx] = depth;\n\t\t\t\t\t\t\t\t\t\t\tdone++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n//\t\t\tSystem.out.println(String.format(\"%2d%10d\", depth, done));\n\t}\t\t\n\t\t\n\tfor (i=0; i<24*2768; i++) {\n\t\tMCPermPrun[i] = -1;\n\t}\n\tMCPermPrun[0] = 0;\n\tdepth = 0;\n\tdone = 1;\n\twhile (done < 24*2768) {\n\t\tinv = depth > 7;\n\t\tselect = inv ? -1 : depth;\n\t\tcheck = inv ? depth : -1;\n\t\tdepth++;\n\t\tfor (i=0; i<24*2768; i++) {\n\t\t\tif (MCPermPrun[i] == select) {\n\t\t\t\tvar mid = i % 24;\n\t\t\t\tvar corn = ~~(i / 24);\n\t\t\t\tfor (var m=0; m<10; m++) {\n\t\t\t\t\tvar cornx = CPermMove[corn][ud2std[m]];\n\t\t\t\t\tvar symx = (cornx & 15);\n\t\t\t\t\tvar midx = MPermConj[MPermMove[mid][m]][symx];\n\t\t\t\t\tcornx >>>= 4;\n\t\t\t\t\tvar idx = cornx * 24 + midx;\n\t\t\t\t\tif (MCPermPrun[idx] == check) {\n\t\t\t\t\t\tdone++;\n\t\t\t\t\t\tif (inv) {\n\t\t\t\t\t\t\tMCPermPrun[i] = depth;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMCPermPrun[idx] = depth;\n\t\t\t\t\t\t\tvar sym = SymState[cornx];\n\t\t\t\t\t\t\tif (sym != 0) {\n\t\t\t\t\t\t\t\tfor (j=1; j<16; j++) {\n\t\t\t\t\t\t\t\t\tsym >>= 1;\n\t\t\t\t\t\t\t\t\tif ((sym & 1) == 1) {\n\t\t\t\t\t\t\t\t\t\tvar idxx = cornx * 24 + MPermConj[midx][j ^ e2c[j]];\n\t\t\t\t\t\t\t\t\t\tif (MCPermPrun[idxx] == -1) {\n\t\t\t\t\t\t\t\t\t\t\tMCPermPrun[idxx] = depth;\n\t\t\t\t\t\t\t\t\t\t\tdone++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n//\t\t\tSystem.out.println(String.format(\"%2d%10d\", depth, done));\n\t}\n}\t\t\t\t\t\n\nfunction randomCube() {\n\tvar eperm;\n\tvar cperm;\n\tdo {\n\t\teperm = ~~(Math.random() * 479001600);\n\t\tcperm = ~~(Math.random() * 40320);\n\t} while (((get8Parity(cperm) ^ get12Parity(eperm))) != 0);\n\tvar c = new CubieCube();\n\tc.init(cperm, ~~(Math.random() * 2187), eperm, ~~(Math.random() * 2048));\n\treturn c;\n}\n\nvar move = Array(31);\n\nvar corn = Array(20);\nvar csym = Array(20);\nvar mid3 = Array(20);\nvar e1 = Array(20);\nvar e2 = Array(20);\nvar urfidx;\n\nvar twist = Array(6);\nvar tsym = Array(6);\nvar flip = Array(6);\nvar fsym = Array(6);\nvar slice = Array(6);\nvar corn0 = Array(6);\nvar csym0 = Array(6);\nvar mid30 = Array(6);\nvar e10 = Array(6);\nvar e20 = Array(6);\nvar prun = Array(6);\n\nvar length1 = 0;\nvar maxlength2 = 0;\nvar sol = 999;\nvar valid1 = 0;\nvar valid2 = 0;\nvar solution = \"\";\nvar useSeparator = false;\n\nfunction Solve(c) {\n\tc.temps = new CubieCube();\n\tfor (var i=0; i<6; i++) {\n\t\ttwist[i] = c.getTwistSym();\n\t\ttsym[i] = twist[i] & 7;\n\t\ttwist[i] >>>= 3;\n\t\tflip[i] = c.getFlipSym();\n\t\tfsym[i] = flip[i] & 7;\n\t\tflip[i] >>>= 3;\n\t\tslice[i] = c.getUDSlice();\n\t\tcorn0[i] = c.getCPermSym();\n\t\tcsym0[i] = corn0[i] & 15;\n\t\tcorn0[i] >>>= 4;\n\t\tmid30[i] = c.getMid3();\n\t\te10[i] = c.getURtoUL();\n\t\te20[i] = c.getDRtoDL();\n\t\tprun[i] = Math.max(Math.max(UDSliceTwistPrun[twist[i] * 495 + UDSliceConj[slice[i]][tsym[i]]],\n\t\t\t\t\t\tUDSliceFlipPrun[flip[i] * 495 + UDSliceConj[slice[i]][fsym[i]]]),\n\t\t\t\t\t\tTwistFlipPrun[twist[i] * 2688 + (flip[i] << 3 | Sym8MultInv[fsym[i]][tsym[i]])]);\n\t\tc.URFConjugate();\n\t\tif (i==2) {\n\t\t\tc.invCubieCube();\n\t\t}\n\t}\n\tsolution = null;\n\tsol = 22;\n\tfor (length1=0; length1<sol; length1++) {\n\t\tmaxlength2 = Math.min(sol/2+1, sol-length1);\n\t\tfor (urfidx=0; urfidx<6; urfidx++) {\n\t\t\tcorn[0] = corn0[urfidx];\n\t\t\tcsym[0] = csym0[urfidx];\n\t\t\tmid3[0] = mid30[urfidx];\n\t\t\te1[0] = e10[urfidx];\n\t\t\te2[0] = e20[urfidx];\n\t\t\tif ((prun[urfidx] <= length1)\n\t\t\t\t\t&& phase1(twist[urfidx], tsym[urfidx], flip[urfidx], fsym[urfidx],\n\t\t\t\t\t\t\t\tslice[urfidx], length1, 18)) {\n\t\t\t\tif (solution == null) {\n\t\t\t\t\treturn \"Error 8\";\n\t\t\t\t} else {\n\t\t\t\t\treturn solution;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn \"Error 7\";\n}\n\nfunction phase1(twist, tsym, flip, fsym, slice, maxl, lm) {\n\tif (twist==0 && flip==0 && slice==0 && maxl < 5) {\n\t\treturn maxl == 0 && init2();\n\t}\n\tfor (var m=0; m<18; m++) {\n\t\tif (ckmv[lm][m]) {\n\t\t\tm+=2;\n\t\t\tcontinue;\n\t\t}\n\t\tvar slicex = UDSliceMove[slice][m];\n\t\tvar twistx = TwistMove[twist][Sym8Move[tsym][m]];\n\t\tvar tsymx = Sym8Mult[twistx & 7][tsym];\n\t\ttwistx >>>= 3;\n\t\tif (UDSliceTwistPrun[twistx * 495 + UDSliceConj[slicex][tsymx]] >= maxl) {\n\t\t\tcontinue;\n\t\t}\n\t\tvar flipx = FlipMove[flip][Sym8Move[fsym][m]];\n\t\tvar fsymx = Sym8Mult[flipx & 7][fsym];\n\t\tflipx >>>= 3;\n\t\tif (TwistFlipPrun[twistx * 2688 + (flipx << 3 | Sym8MultInv[fsymx][tsymx])] >= maxl\n\t\t\t\t||UDSliceFlipPrun[flipx * 495 + UDSliceConj[slicex][fsymx]] >= maxl) {\n\t\t\tcontinue;\n\t\t}\n\t\tmove[length1-maxl] = m;\n\t\tvalid1 = Math.min(valid1, length1-maxl);\n\t\tif (phase1(twistx, tsymx, flipx, fsymx, slicex, maxl-1, m)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction init2() {\n//\tif (System.currentTimeMillis() > timeOut) {\n//\t\treturn true;\n//\t}\n\tvalid2 = Math.min(valid2, valid1);\n\tfor (var i=valid1; i<length1; i++) {\n\t\tvar m = move[i];\n\t\tcorn[i+1] = CPermMove[corn[i]][SymMove[csym[i]][m]];\n\t\tcsym[i+1] = SymMult[corn[i+1] & 15][csym[i]];\n\t\tcorn[i+1] >>>= 4;\n\t\tmid3[i+1] = Mid3Move[mid3[i]][m];\n\t}\n\tvalid1 = length1;\n\tvar mid = Mid32MPerm[mid3[length1] % 24];\n\tvar prun = MCPermPrun[corn[length1] * 24 + MPermConj[mid][csym[length1]]];\n\tif (prun >= maxlength2) {\n\t\treturn false;\n\t}\n\tfor (var i=valid2; i<length1; i++) {\n\t\te1[i+1] = Mid3Move[e1[i]][move[i]];\n\t\te2[i+1] = Mid3Move[e2[i]][move[i]];\n\t}\n\tvalid2 = length1;\n\tvar cornx = corn[length1];\n\tvar ex = merge[~~(e1[length1]/6)][~~(e2[length1]/6)] * 4032\n\t\t\t\t + e1[length1] * 12 + e2[length1] % 6 * 2 + (((CParity[cornx>>>3]>>>(cornx&7))&1) ^ get4Parity(mid));\n\tvar edge = MtoEPerm[ex];\n\tvar esym = edge & 15;\n\tedge >>>= 4;\n\t\tprun = Math.max(MEPermPrun[edge * 24 + MPermConj[mid][esym]], prun);\n\tif (prun >= maxlength2) {\n\t\treturn false;\n\t}\n\t\tvar lm = length1==0 ? 10 : std2ud[~~(move[length1-1]/3)*3+1];\n\tfor (var i=prun; i<maxlength2; i++) {\n\t\tif (phase2(edge, esym, corn[length1], csym[length1], mid, i, length1, lm)) {\n\t\t\tsol = length1 + i;\n\t\t\tvar sb = \"\";\n\t\t\tvar urf = urfidx;\n//\t\t\tif (inverse) {\n\t\t\t\turf = (urf + 3) % 6;\n//\t\t\t}\n\t\t\tif (urf < 3) {\n\t\t\t\tfor (var s=0; s<length1; s++) {\n\t\t\t\t\tsb += move2str[urfMove[urf][move[s]]] + ' ';\n\t\t\t\t}\n\t\t\t\tfor (var s=length1; s<sol; s++) {\n\t\t\t\t\tsb += move2str[urfMove[urf][move[s]]] + ' ';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var s=sol-1; s>=length1; s--) {\n\t\t\t\t\tsb += move2str[urfMove[urf][move[s]]] + ' ';\n\t\t\t\t}\n\t\t\t\tfor (var s=length1-1; s>=0; s--) {\n\t\t\t\t\tsb += move2str[urfMove[urf][move[s]]] + ' ';\n\t\t\t\t}\n\t\t\t}\n\t\t\t// sb += \"(\" + sol + \"f)\";\n\t\t\tsolution = sb;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction phase2(edge, esym, corn, csym, mid, maxl, depth, lm) {\n\tif (edge==0 && corn==0 && mid==0) {\n\t\treturn true;\n\t}\n\tfor (var m=0; m<10; m++) {\n\t\tif (ckmv2[lm][m]) {\n\t\t\tcontinue;\n\t\t}\n\t\tvar midx = MPermMove[mid][m];\n\t\tvar edgex = EPermMove[edge][SymMoveUD[esym][m]];\n\t\tvar esymx = SymMult[edgex & 15][esym];\n\t\tedgex >>>= 4;\n\t\tif (MEPermPrun[edgex * 24 + MPermConj[midx][esymx]] >= maxl) {\n\t\t\tcontinue;\n\t\t}\n\t\tvar cornx = CPermMove[corn][SymMove[csym][ud2std[m]]];\n\t\tvar csymx = SymMult[cornx & 15][csym];\n\t\tcornx >>>= 4;\n\t\tif (MCPermPrun[cornx * 24 + MPermConj[midx][csymx]] >= maxl) {\n\t\t\tcontinue;\n\t\t}\n\t\tmove[depth] = ud2std[m];\n\t\tif (phase2(edgex, esymx, cornx, csymx, midx, maxl-1, depth+1, m)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nvar initialized = false;\n\nfunction initialize() {\n\tif (initialized) {\n\t\treturn;\n\t}\n\tCubieInit();\n\tCoordInit();\n\tinitialized = true;\n}\n\nfunction solve(c) {\n\tinitialize();\n\tconst cc = new CubieCube();\n\tcc.cp = c.cp;\n\tcc.co = c.co;\n\tcc.ep = c.ep;\n\tcc.eo = c.eo;\n\treturn Solve(cc);\n};\n\nmodule.exports.initialize = initialize;\nmodule.exports.solve = solve;\nmodule.exports.randomCube = randomCube;\n"],"sourceRoot":""}